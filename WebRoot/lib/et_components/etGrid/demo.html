<!DOCTYPE html>
<html>

<head>
    <script src="../../jquery/jquery-1.9.1.min.js"></script>
    <script src="./js/jquery-ui-1.9.2.min.js"></script>
    <!--PQ Grid files-->
    <link rel="stylesheet" href="./css/pqgrid.min.css" />
    <script src="./js/pqgrid.dev.js"></script>
    <script src='./etGrid.js'></script>

    <script>
        $(function () {
            var data = [{
                    rank: 1,
                    company: 'Exxon Mobil',
                    revenues: 339938.0,
                    profits: 36130.0
                },
                {
                    rank: 2,
                    company: 'Wal-Mart Stores',
                    orderDate: '1977-11-11',
                    revenues: 315654.0,
                    profits: 11231.0
                },
                {
                    rank: 3,
                    company: 'Royal Dutch Shell',
                    orderDate: '1977-11-11',
                    revenues: 306731.0,
                    profits: 25311.0
                },
                {
                    rank: 4,
                    company: 'BP',
                    orderDate: '1977-11-11',
                    revenues: 267600.0,
                    profits: 22341.0
                },
                {
                    rank: 5,
                    company: 'General Motors',
                    orderDate: '1977-11-11',
                    revenues: 192604.0,
                    profits: -10567.0
                },
                {
                    rank: 6,
                    company: 'Chevron',
                    orderDate: '1977-11-11',
                    revenues: 189481.0,
                    profits: 14099.0
                },
                {
                    rank: 7,
                    company: 'DaimlerChrysler',
                    orderDate: '1977-11-11',
                    revenues: 186106.3,
                    profits: 3536.3
                },
                {
                    rank: 8,
                    company: 'Toyota Motor',
                    orderDate: '1977-11-11',
                    revenues: 185805.0,
                    profits: 12119.6
                },
                {
                    rank: 9,
                    company: 'Ford Motor',
                    orderDate: '1977-11-11',
                    revenues: 177210.0,
                    profits: 2024.0
                },
                {
                    rank: 10,
                    company: 'ConocoPhillips',
                    orderDate: '1977-11-11',
                    revenues: 166683.0,
                    profits: 13529.0
                },
                {
                    rank: 11,
                    company: 'General Electric',
                    orderDate: '1977-11-11',
                    revenues: 157153.0,
                    profits: 16353.0
                },
                {
                    rank: 12,
                    company: 'Total',
                    orderDate: '1977-11-11',
                    revenues: 152360.7,
                    profits: 15250.0
                },
                {
                    rank: 13,
                    company: 'ING Group',
                    orderDate: '1977-11-11',
                    revenues: 138235.3,
                    profits: 8958.9
                },
                {
                    rank: 14,
                    company: 'Citigroup',
                    orderDate: '1977-11-11',
                    revenues: 131045.0,
                    profits: 24589.0
                },
                {
                    rank: 15,
                    company: 'AXA',
                    orderDate: '1977-11-11',
                    revenues: 129839.2,
                    profits: 5186.5
                },
                {
                    rank: 16,
                    company: 'Allianz',
                    orderDate: '1977-11-11',
                    revenues: 121406.0,
                    profits: 5442.4
                },
                {
                    rank: 17,
                    company: 'Volkswagen',
                    orderDate: '1977-11-11',
                    revenues: 118376.6,
                    profits: 1391.7
                },
                {
                    rank: 18,
                    company: 'Fortis',
                    orderDate: '1977-11-11',
                    revenues: 112351.4,
                    profits: 4896.3
                },
                {
                    rank: 19,
                    company: 'Crédit Agricole',
                    orderDate: '1977-11-11',
                    revenues: 110764.6,
                    profits: 7434.3
                },
                {
                    rank: 20,
                    company: 'American Intl. Group',
                    orderDate: '1977-11-11',
                    revenues: 108905.0,
                    profits: 10477.0
                }
            ]
            var grid = $("#grid_array").etGrid({
                columns: [{
                        display: "Rank",
                        align: "right",
                        dataType: "integer",
                        name: "rank",
                        width: '15%',
                        editable: false
                    },
                    {
                        display: 'orderDate',
                        align: 'right',
                        width: 130,
                        name: 'orderDate',
                        editor: {
                            type: 'date', // 日期编辑框
                            onSelect: function () {
                                console.log('dateselect');
                            },
                            beforeShow: function (input, inst) {
                                console.log('datebeforeshow');

                                /*  return !this.firstOpen; */
                            },
                            onClose: function () {
                                console.log('dateclose');
                            }
                        },
                        /* validations: [{    // 前台验证
                            type: 'regexp',   // 类型 正则
                            value: '^[0-9]{4}-[0-9]{2}-[0-9]{2}$',  // 所匹配的正则表达式
                            msg: '年月日格式不对'   // 错误信息
                        }] */
                    },
                    {
                        display: "Company",
                        name: "company",
                        width: '35%',
                        editor: {
                            type: 'select', // 下拉框编辑框
                            source: [
                                "ColdFusion",
                                "Erlang",
                                "Fortran",
                                "Groovy",
                                "Haskell",
                                "Java"
                            ],
                            // url:   ,
                            autoFocus: true,
                            disabled: false,
                            open: function () {
                                console.log('open');
                            },
                            select: function () {
                                console.log('select');
                            },
                            change: function () {
                                console.log('change');
                            },
                            close: function () {
                                console.log('close');
                            }
                        },
                        /* validations: [{
                            type: function (ui) {
                                var value = ui.value;
                                if ($.inArray(value, [
                                        "ColdFusion",
                                        "Erlang",
                                        "Fortran",
                                        "Groovy",
                                        "Haskell",
                                        "Java"
                                    ]) == -1) {
                                    ui.msg = value + "没找到";
                                    $('.pq-editor-focus').css('border-color', '#f00');
                                    return false;
                                }
                            }
                        }] */
                    },
                    {
                        display: "Revenues ($ millions)",
                        align: "right",
                        dataType: "float",
                        name: "revenues",
                    },
                    {
                        display: "Profits ($ millions)",
                        align: "right",
                        dataType: "float",
                        name: "profits"
                    }
                ],
                dataModel: {     // 加载数据模块
                    data: data,   // 若是前台数据 这传入data值 数组类型
                    /* location: "remote",  // 若是后台数据 传入URL值 同时location 为 remote
					url: ....., */
                },
                numberCell: {
                    resizable: false,
                    title: "#",
                    width: 30,
                    minWidth: 30
                },
                addRowByKey: true,
                // checkbox: true,
                resizable: true,
                toolbar: {
                    items: [{
                        type: "button",
                        label: '添加',
                        icon: 'plus',
                        listeners: [{
                            click: add
                        }]
                    }]
                },
                // summaryRowIndx:[0]   //后台渲染摘要行   传入的摘要行数据的索引值
                /* summary: { //  前台渲染摘要行    摘要行集合    
                    totalColumns: ['revenues', 'profits'], //合计冻结行 
                    keyWordCol: 'rank', //关键字所在列的列名
                    averageColumns: ['revenues', 'profits'], // 平均冻结行
                    maxColumns: ['revenues', 'profits'], // 最大值冻结行
                    minColumns: ['revenues', 'profits'] //  最小值冻结行
                }, */
                cellBeforeSave: function () {
                    console.log('cellBeforeSave')
                },
                cellSave: function () {
                    console.log('cellSave')
                },
                refresh: function () {
                    console.log('refresh')
                },
                render: function () {
                    console.log('render');
                },
                editorBlur: function (event, ui) {
                    console.log('editorBlur', ui);
                },
                editorEnd: function () {

                },
                load: function () {

                }
            });
            $('#text1').click(function () {
                grid.addRow({
                    company: 55555,
                    profits: 11111,
                    revenues: 222222,
                    rank: 2323
                });
                var num = grid.getAllData();
                var selecteds = grid.selectGetChecked();
                var selecteds2 = grid.selectGet();

                grid.editCell(num.length -1, 'revenues');

            });
            $('#text2').click(function () {
                console.log(grid.option('dataModel').getUrl().data)
            });

            /*grid.on('keydown', function(evt){
                if(evt.key == 'Tab') {
                    grid.addRow({});
                }
            });*/
            function add() {
                grid.addRow()
            }
        });
    </script>
</head>

<body>
    <button id='text1'>增加指定数据同时带光标定位的行</button>
    <button id='text2'>测试2</button>
    <div id="grid_array" style="margin:100px;"></div>
</body>

</html>