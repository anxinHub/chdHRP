<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chd.hrp.ass.dao.repair.AssRepairRecMapper">
	
	<resultMap id="assRepairRec" type="com.chd.hrp.ass.entity.repair.AssRepairRec">
	<result property="group_id" column="group_id"/>
	<result property="hos_id" column="hos_id"/>
	<result property="copy_code" column="copy_code"/>
	<result property="ass_year" column="ass_year"/>
	<result property="ass_month" column="ass_month"/>
	<result property="repair_rec_no" column="repair_rec_no"/>
	<result property="rep_team_code" column="rep_team_code"/>
	<result property="fixed_dept_id" column="fixed_dept_id"/>
	<result property="fixed_dept_no" column="fixed_dept_no"/>
	<result property="ass_nature" column="ass_nature"/>
	<result property="ass_name" column="ass_name"/>
	<result property="dept_name" column="dept_name"/>
	<result property="ass_card_no" column="ass_card_no"/>
	<result property="apply_no" column="apply_no"/>
	<result property="is_inner" column="is_inner"/>
	<result property="trouble_level" column="trouble_level"/>
	<result property="repair_level" column="repair_level"/>
	<result property="repair_date" column="repair_date"/>
	<result property="repair_engr" column="repair_engr"/>
	<result property="repair_hours" column="repair_hours"/>
	<result property="is_contract" column="is_contract"/>
	<result property="contract_no" column="contract_no"/>
	<result property="repair_money" column="repair_money"/>
	<result property="other_money" column="other_money"/>
	<result property="state" column="state"/>
	<result property="state_name" column="state_name"/>
	<result property="create_emp" column="create_emp"/>
	<result property="create_name" column="create_name"/>
	<result property="create_date" column="create_date"/>
	<result property="audit_emp" column="audit_emp"/>
	<result property="audit_name" column="audit_name"/>
	<result property="repair_desc" column="repair_desc"/>
	</resultMap>
		
	<resultMap id="assRepairRecMap" type="java.util.Map">
	<result property="group_id" column="group_id"/>
	<result property="hos_id" column="hos_id"/>
	<result property="copy_code" column="copy_code"/>
	<result property="ass_year" column="ass_year"/>
	<result property="ass_month" column="ass_month"/>
	<result property="repair_rec_no" column="repair_rec_no"/>
	<result property="rep_team_code" column="rep_team_code"/>
	<result property="fixed_dept_id" column="fixed_dept_id"/>
	<result property="fixed_dept_no" column="fixed_dept_no"/>
	<result property="ass_nature" column="ass_nature"/>
	<result property="ass_name" column="ass_name"/>
	<result property="ass_card_no" column="ass_card_no"/>
	<result property="apply_no" column="apply_no"/>
	<result property="is_inner" column="is_inner"/>
	<result property="trouble_level" column="trouble_level"/>
	<result property="repair_level" column="repair_level"/>
	<result property="repair_date" column="repair_date"/>
	<result property="repair_engr" column="repair_engr"/>
	<result property="repair_hours" column="repair_hours"/>
	<result property="is_contract" column="is_contract"/>
	<result property="contract_no" column="contract_no"/>
	<result property="repair_money" column="repair_money"/>
	<result property="other_money" column="other_money"/>
	<result property="state" column="state"/>
	<result property="create_emp" column="create_emp"/>
	<result property="create_date" column="create_date"/>
	<result property="audit_emp" column="audit_emp"/>
	<result property="repair_desc" column="repair_desc"/>
	</resultMap>
	
	<insert id="add" useGeneratedKeys="true" >
	
		INSERT INTO ASS_REPAIR_REC (
		<trim suffix="" suffixOverrides=",">
		group_id
		,
		hos_id
		,
		copy_code
		,
		ass_year
		,
		ass_month
		,
		repair_rec_no
		,
		rep_team_code
		,
		fixed_dept_id
		,
		fixed_dept_no
		,
		ass_nature
		,
		<if test="ass_name != null and ass_name != ''">
		ass_name
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		ass_card_no
		,
		</if>
		<if test="apply_no != null and apply_no != ''">
		apply_no
		,
		</if>
		<if test="is_inner != null and is_inner != ''">
		is_inner
		,
		</if>
		<if test="trouble_level != null and trouble_level != ''">
		trouble_level
		,
		</if>
		<if test="repair_level != null and repair_level != ''">
		repair_level
		,
		</if>
		<if test="repair_date != null and repair_date != ''">
		repair_date
		,
		</if>
		<if test="repair_engr != null and repair_engr != ''">
		repair_engr
		,
		</if>
		<if test="repair_hours != null and repair_hours != ''">
		repair_hours
		,
		</if>
		<if test="is_contract != null and is_contract != ''">
		is_contract
		,
		</if>
		<if test="contract_no != null and contract_no != ''">
		contract_no
		,
		</if>
		<if test="repair_money != null and repair_money != ''">
		repair_money
		,
		</if>
		<if test="other_money != null and other_money != ''">
		other_money
		,
		</if>
		<if test="state != null and state != ''">
		state
		,
		</if>
		<if test="create_emp != null and create_emp != ''">
		create_emp
		,
		</if>
		<if test="create_date != null and create_date != ''">
		create_date
		,
		</if>
		<if test="audit_emp != null and audit_emp != ''">
		audit_emp
		,
		</if>
		<if test="repair_desc != null and repair_desc != ''">
		repair_desc
		,
		</if>
		</trim>
		) VALUES (
		<trim suffix="" suffixOverrides=",">
		#{group_id,jdbcType=INTEGER}
		,
		#{hos_id,jdbcType=INTEGER}
		,
		#{copy_code,jdbcType=VARCHAR}
		,
		#{ass_year,jdbcType=VARCHAR}
		,
		#{ass_month,jdbcType=VARCHAR}
		,
		#{repair_rec_no,jdbcType=VARCHAR}
		,
		#{rep_team_code,jdbcType=VARCHAR}
		,
		#{fixed_dept_id,jdbcType=INTEGER}
		,
		#{fixed_dept_no,jdbcType=INTEGER}
		,
		#{ass_nature,jdbcType=VARCHAR}
		,
		<if test="ass_name != null and ass_name != ''">
		#{ass_name,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		#{ass_card_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="apply_no != null and apply_no != ''">
		#{apply_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="is_inner != null and is_inner != ''">
		#{is_inner,jdbcType=INTEGER}
		,
		</if>
		<if test="trouble_level != null and trouble_level != ''">
		#{trouble_level,jdbcType=INTEGER}
		,
		</if>
		<if test="repair_level != null and repair_level != ''">
		#{repair_level,jdbcType=INTEGER}
		,
		</if>
		<if test="repair_date != null and repair_date != ''">
		to_date(#{repair_date},'yyyy-MM-dd')
		,
		</if>
		<if test="repair_engr != null and repair_engr != ''">
		#{repair_engr,jdbcType=VARCHAR}
		,
		</if>
		<if test="repair_hours != null and repair_hours != ''">
		#{repair_hours,jdbcType=INTEGER}
		,
		</if>
		<if test="is_contract != null and is_contract != ''">
		#{is_contract,jdbcType=INTEGER}
		,
		</if>
		<if test="contract_no != null and contract_no != ''">
		#{contract_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="repair_money != null and repair_money != ''">
		#{repair_money,jdbcType=INTEGER}
		,
		</if>
		<if test="other_money != null and other_money != ''">
		#{other_money,jdbcType=INTEGER}
		,
		</if>
		<if test="state != null and state != ''">
		#{state,jdbcType=INTEGER}
		,
		</if>
		<if test="create_emp != null and create_emp != ''">
		#{create_emp,jdbcType=INTEGER}
		,
		</if>
		<if test="create_date != null and create_date != ''">
		to_date(#{create_date},'yyyy-MM-dd')
		,
		</if>
		<if test="audit_emp != null and audit_emp != ''">
		#{audit_emp,jdbcType=INTEGER}
		,
		</if>
		<if test="repair_desc != null and repair_desc != ''">
		#{repair_desc,jdbcType=VARCHAR}
		
		</if>
		</trim>		
		)
	
	</insert>
	<insert id="addBatch" parameterType="java.util.List" >
	
		INSERT INTO ASS_REPAIR_REC (
		group_id
		,
		hos_id
		,
		copy_code
		,
		ass_year
		,
		ass_month
		,
		repair_rec_no
		,
		rep_team_code
		,
		fixed_dept_id
		,
		fixed_dept_no
		,
		ass_nature
		,
		ass_name
		,
		ass_card_no
		,
		apply_no
		,
		is_inner
		,
		trouble_level
		,
		repair_level
		,
		repair_date
		,
		repair_engr
		,
		repair_hours
		,
		is_contract
		,
		contract_no
		,
		repair_money
		,
		other_money
		,
		state
		,
		create_emp
		,
		create_date
		,
		audit_emp
		,
		repair_desc
		
		) select ASS_REPAIR_REC_SEQ.nextval , t.* from(
		<foreach collection="list" item="item" index="index" separator=" union all " >
			select 		
			#{item.group_id,jdbcType=INTEGER}
			,
			#{item.hos_id,jdbcType=INTEGER}
			,
			#{item.copy_code,jdbcType=VARCHAR}
			,
			#{item.ass_year,jdbcType=VARCHAR}
			,
			#{item.ass_month,jdbcType=VARCHAR}
			,
			#{item.repair_rec_no,jdbcType=VARCHAR}
			,
			#{item.rep_team_code,jdbcType=VARCHAR}
			,
			#{item.fixed_dept_id,jdbcType=INTEGER}
			,
			#{item.fixed_dept_no,jdbcType=INTEGER}
			,
			#{item.ass_nature,jdbcType=VARCHAR}
			,
			#{item.ass_name,jdbcType=VARCHAR}
			,
			#{item.ass_card_no,jdbcType=VARCHAR}
			,
			#{item.apply_no,jdbcType=VARCHAR}
			,
			#{item.is_inner,jdbcType=INTEGER}
			,
			#{item.trouble_level,jdbcType=INTEGER}
			,
			#{item.repair_level,jdbcType=INTEGER}
			,
			#{item.repair_date,jdbcType=DATE}
			,
			#{item.repair_engr,jdbcType=VARCHAR}
			,
			#{item.repair_hours,jdbcType=INTEGER}
			,
			#{item.is_contract,jdbcType=INTEGER}
			,
			#{item.contract_no,jdbcType=VARCHAR}
			,
			#{item.repair_money,jdbcType=INTEGER}
			,
			#{item.other_money,jdbcType=INTEGER}
			,
			#{item.state,jdbcType=INTEGER}
			,
			#{item.create_emp,jdbcType=INTEGER}
			,
			#{item.create_date,jdbcType=DATE}
			,
			#{item.audit_emp,jdbcType=INTEGER}
			,
			#{item.repair_desc,jdbcType=VARCHAR}
			
		    from dual
		</foreach>
		)t
	</insert>
	
	<update id="update" parameterType="java.util.Map">
	
		UPDATE ass_repair_rec 
		<trim prefix="SET"  suffixOverrides=","> 
		<if test="rep_team_code != null and rep_team_code != ''">
		rep_team_code = #{rep_team_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="fixed_dept_id != null and fixed_dept_id != ''">
		fixed_dept_id = #{fixed_dept_id,jdbcType=INTEGER}
		,
		</if>
		<if test="fixed_dept_no != null and fixed_dept_no != ''">
		fixed_dept_no = #{fixed_dept_no,jdbcType=INTEGER}
		,
		</if>
		<if test="ass_nature != null and ass_nature != ''">
		ass_nature = #{ass_nature,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_name != null and ass_name != ''">
		ass_name = #{ass_name,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		,
		</if>
		apply_no = #{apply_no,jdbcType=VARCHAR}
		,
		is_inner = #{is_inner,jdbcType=INTEGER}
		,
		trouble_level = #{trouble_level,jdbcType=INTEGER}
		,
		repair_level = #{repair_level,jdbcType=INTEGER}
		,
		repair_date = to_date(#{repair_date},'yyyy-MM-dd')
		,
		repair_engr = #{repair_engr,jdbcType=VARCHAR}
		,
		repair_hours = #{repair_hours,jdbcType=INTEGER}
		,
		is_contract = #{is_contract,jdbcType=INTEGER}
		,
		contract_no = #{contract_no,jdbcType=VARCHAR}
		,
		repair_money = #{repair_money,jdbcType=INTEGER}
		,
		other_money = #{other_money,jdbcType=INTEGER}
		,
		state = #{state,jdbcType=INTEGER}
		,
		<if test="create_emp != null and create_emp != ''">
		create_emp = #{create_emp,jdbcType=INTEGER}
		,
		</if>
		<if test="create_date != null and create_date != ''">
		create_date = to_date(#{create_date},'yyyy-MM-dd')
		,
		</if>
		<if test="audit_emp != null and audit_emp != ''">
		audit_emp = #{audit_emp,jdbcType=INTEGER}
		,
		</if>
		<if test="repair_desc != null and repair_desc != ''">
		repair_desc = #{repair_desc,jdbcType=VARCHAR}
		,
		</if>
		</trim>
		where                     
			group_id = #{group_id,jdbcType=INTEGER}
		and	hos_id = #{hos_id,jdbcType=INTEGER}
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		AND repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
	</update>
	<update id="auditAssRepairRec" parameterType="java.util.Map">
	
		UPDATE ass_repair_rec 
		set
		state = 3
		,
		audit_emp = #{audit_emp,jdbcType=INTEGER}
		where                     
			group_id = #{group_id,jdbcType=INTEGER}
		and	hos_id = #{hos_id,jdbcType=INTEGER}
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		AND repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
	</update>
	<update id="backAssRepairRec" parameterType="java.util.Map">
	
		UPDATE ass_repair_rec 
		set
		state = 2
		,
		audit_emp = ''
		where                     
			group_id = #{group_id,jdbcType=INTEGER}
		and	hos_id = #{hos_id,jdbcType=INTEGER}
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		AND repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
	</update>
	<update id="countAssRepairRec" parameterType="java.util.Map">
	
		UPDATE ass_repair_rec 
		set
		state = 4
		,
		audit_emp = #{audit_emp,jdbcType=INTEGER}
		where                     
			group_id = #{group_id,jdbcType=INTEGER}
		and	hos_id = #{hos_id,jdbcType=INTEGER}
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		AND repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
	</update>
	<update id="updateBatch" parameterType="java.util.List">
	
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_repair_rec 
			<trim prefix="SET"  suffixOverrides=","> 
			<if test="item.rep_team_code != null and item.rep_team_code != ''">
			rep_team_code = #{item.rep_team_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.fixed_dept_id != null and item.fixed_dept_id != ''">
			fixed_dept_id = #{item.fixed_dept_id,jdbcType=INTEGER}
			,
			</if>
			<if test="item.fixed_dept_no != null and item.fixed_dept_no != ''">
			fixed_dept_no = #{item.fixed_dept_no,jdbcType=INTEGER}
			,
			</if>
			<if test="item.ass_nature != null and item.ass_nature != ''">
			ass_nature = #{item.ass_nature,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_name != null and item.ass_name != ''">
			ass_name = #{item.ass_name,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_card_no != null and item.ass_card_no != ''">
			ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.apply_no != null and item.apply_no != ''">
			apply_no = #{item.apply_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.is_inner != null and item.is_inner != ''">
			is_inner = #{item.is_inner,jdbcType=INTEGER}
			,
			</if>
			<if test="item.trouble_level != null and item.trouble_level != ''">
			trouble_level = #{item.trouble_level,jdbcType=INTEGER}
			,
			</if>
			<if test="item.repair_level != null and item.repair_level != ''">
			repair_level = #{item.repair_level,jdbcType=INTEGER}
			,
			</if>
			<if test="item.repair_date != null and item.repair_date != ''">
			repair_date = #{item.repair_date,jdbcType=DATE}
			,
			</if>
			<if test="item.repair_engr != null and item.repair_engr != ''">
			repair_engr = #{item.repair_engr,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.repair_hours != null and item.repair_hours != ''">
			repair_hours = #{item.repair_hours,jdbcType=INTEGER}
			,
			</if>
			<if test="item.is_contract != null and item.is_contract != ''">
			is_contract = #{item.is_contract,jdbcType=INTEGER}
			,
			</if>
			<if test="item.contract_no != null and item.contract_no != ''">
			contract_no = #{item.contract_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.repair_money != null and item.repair_money != ''">
			repair_money = #{item.repair_money,jdbcType=INTEGER}
			,
			</if>
			<if test="item.other_money != null and item.other_money != ''">
			other_money = #{item.other_money,jdbcType=INTEGER}
			,
			</if>
			<if test="item.state != null and item.state != ''">
			state = #{item.state,jdbcType=INTEGER}
			,
			</if>
			<if test="item.create_emp != null and item.create_emp != ''">
			create_emp = #{item.create_emp,jdbcType=INTEGER}
			,
			</if>
			<if test="item.create_date != null and item.create_date != ''">
			create_date = #{item.create_date,jdbcType=DATE}
			,
			</if>
			<if test="item.audit_emp != null and item.audit_emp != ''">
			audit_emp = #{item.audit_emp,jdbcType=INTEGER}
			,
			</if>
			<if test="item.repair_desc != null and item.repair_desc != ''">
			repair_desc = #{item.repair_desc,jdbcType=VARCHAR}
			,
			</if>
			</trim>
			<where>                     
			<if test="item.group_id != null and item.group_id != ''">
			AND group_id = #{item.group_id,jdbcType=INTEGER}
			</if>  
			<if test="item.hos_id != null and item.hos_id != ''">
			AND hos_id = #{item.hos_id,jdbcType=INTEGER}
			</if>  
			<if test="item.copy_code != null and item.copy_code != ''">
			AND copy_code = #{item.copy_code,jdbcType=VARCHAR}
			</if>  
			<if test="item.ass_year != null and item.ass_year != ''">
			AND ass_year = #{item.ass_year,jdbcType=VARCHAR}
			</if>  
			<if test="item.ass_month != null and item.ass_month != ''">
			AND ass_month = #{item.ass_month,jdbcType=VARCHAR}
			</if>  
			<if test="item.repair_rec_no != null and item.repair_rec_no != ''">
			AND repair_rec_no = #{item.repair_rec_no,jdbcType=VARCHAR}
			</if>  
			<if test="item.rep_team_code != null and item.rep_team_code != ''">
			AND rep_team_code = #{item.rep_team_code,jdbcType=VARCHAR}
			</if>  
			<if test="item.fixed_dept_id != null and item.fixed_dept_id != ''">
			AND fixed_dept_id = #{item.fixed_dept_id,jdbcType=INTEGER}
			</if>  
			<if test="item.fixed_dept_no != null and item.fixed_dept_no != ''">
			AND fixed_dept_no = #{item.fixed_dept_no,jdbcType=INTEGER}
			</if>  
			<if test="item.ass_nature != null and item.ass_nature != ''">
			AND ass_nature = #{item.ass_nature,jdbcType=VARCHAR}
			</if>  
			<if test="item.ass_name != null and item.ass_name != ''">
			AND ass_name = #{item.ass_name,jdbcType=VARCHAR}
			</if>  
			<if test="item.ass_card_no != null and item.ass_card_no != ''">
			AND ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
			</if>  
			<if test="item.apply_no != null and item.apply_no != ''">
			AND apply_no = #{item.apply_no,jdbcType=VARCHAR}
			</if>  
			<if test="item.is_inner != null and item.is_inner != ''">
			AND is_inner = #{item.is_inner,jdbcType=INTEGER}
			</if>  
			<if test="item.trouble_level != null and item.trouble_level != ''">
			AND trouble_level = #{item.trouble_level,jdbcType=INTEGER}
			</if>  
			<if test="item.repair_level != null and item.repair_level != ''">
			AND repair_level = #{item.repair_level,jdbcType=INTEGER}
			</if>  
			<if test="item.repair_date != null and item.repair_date != ''">
			AND repair_date = #{item.repair_date,jdbcType=DATE}
			</if>  
			<if test="item.repair_engr != null and item.repair_engr != ''">
			AND repair_engr = #{item.repair_engr,jdbcType=VARCHAR}
			</if>  
			<if test="item.repair_hours != null and item.repair_hours != ''">
			AND repair_hours = #{item.repair_hours,jdbcType=INTEGER}
			</if>  
			<if test="item.is_contract != null and item.is_contract != ''">
			AND is_contract = #{item.is_contract,jdbcType=INTEGER}
			</if>  
			<if test="item.contract_no != null and item.contract_no != ''">
			AND contract_no = #{item.contract_no,jdbcType=VARCHAR}
			</if>  
			<if test="item.repair_money != null and item.repair_money != ''">
			AND repair_money = #{item.repair_money,jdbcType=INTEGER}
			</if>  
			<if test="item.other_money != null and item.other_money != ''">
			AND other_money = #{item.other_money,jdbcType=INTEGER}
			</if>  
			<if test="item.state != null and item.state != ''">
			AND state = #{item.state,jdbcType=INTEGER}
			</if>  
			<if test="item.create_emp != null and item.create_emp != ''">
			AND create_emp = #{item.create_emp,jdbcType=INTEGER}
			</if>  
			<if test="item.create_date != null and item.create_date != ''">
			AND create_date = #{item.create_date,jdbcType=DATE}
			</if>  
			<if test="item.audit_emp != null and item.audit_emp != ''">
			AND audit_emp = #{item.audit_emp,jdbcType=INTEGER}
			</if>  
			<if test="item.repair_desc != null and item.repair_desc != ''">
			AND repair_desc = #{item.repair_desc,jdbcType=VARCHAR}
			</if>  
			</where>  			
		</foreach>
	</update>
	
	<delete id="delete" parameterType="java.util.Map">
	
		DELETE FROM ass_repair_rec 
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND group_id = #{group_id,jdbcType=INTEGER}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND hos_id = #{hos_id,jdbcType=INTEGER}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_year != null and ass_year != ''">
		AND ass_year = #{ass_year,jdbcType=VARCHAR}
		</if>
		<if test="ass_month != null and ass_month != ''">
		AND ass_month = #{ass_month,jdbcType=VARCHAR}
		</if>
		<if test="repair_rec_no != null and repair_rec_no != ''">
		AND repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
		</if>
		<if test="rep_team_code != null and rep_team_code != ''">
		AND rep_team_code = #{rep_team_code,jdbcType=VARCHAR}
		</if>
		<if test="fixed_dept_id != null and fixed_dept_id != ''">
		AND fixed_dept_id = #{fixed_dept_id,jdbcType=INTEGER}
		</if>
		<if test="fixed_dept_no != null and fixed_dept_no != ''">
		AND fixed_dept_no = #{fixed_dept_no,jdbcType=INTEGER}
		</if>
		<if test="ass_nature != null and ass_nature != ''">
		AND ass_nature = #{ass_nature,jdbcType=VARCHAR}
		</if>
		<if test="ass_name != null and ass_name != ''">
		AND ass_name = #{ass_name,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="apply_no != null and apply_no != ''">
		AND apply_no = #{apply_no,jdbcType=VARCHAR}
		</if>
		<if test="is_inner != null and is_inner != ''">
		AND is_inner = #{is_inner,jdbcType=INTEGER}
		</if>
		<if test="trouble_level != null and trouble_level != ''">
		AND trouble_level = #{trouble_level,jdbcType=INTEGER}
		</if>
		<if test="repair_level != null and repair_level != ''">
		AND repair_level = #{repair_level,jdbcType=INTEGER}
		</if>
		<if test="repair_date != null and repair_date != ''">
		AND repair_date = #{repair_date,jdbcType=DATE}
		</if>
		<if test="repair_engr != null and repair_engr != ''">
		AND repair_engr = #{repair_engr,jdbcType=VARCHAR}
		</if>
		<if test="repair_hours != null and repair_hours != ''">
		AND repair_hours = #{repair_hours,jdbcType=INTEGER}
		</if>
		<if test="is_contract != null and is_contract != ''">
		AND is_contract = #{is_contract,jdbcType=INTEGER}
		</if>
		<if test="contract_no != null and contract_no != ''">
		AND contract_no = #{contract_no,jdbcType=VARCHAR}
		</if>
		<if test="repair_money != null and repair_money != ''">
		AND repair_money = #{repair_money,jdbcType=INTEGER}
		</if>
		<if test="other_money != null and other_money != ''">
		AND other_money = #{other_money,jdbcType=INTEGER}
		</if>
		<if test="state != null and state != ''">
		AND state = #{state,jdbcType=INTEGER}
		</if>
		<if test="create_emp != null and create_emp != ''">
		AND create_emp = #{create_emp,jdbcType=INTEGER}
		</if>
		<if test="create_date != null and create_date != ''">
		AND create_date = #{create_date,jdbcType=DATE}
		</if>
		<if test="audit_emp != null and audit_emp != ''">
		AND audit_emp = #{audit_emp,jdbcType=INTEGER}
		</if>
		<if test="repair_desc != null and repair_desc != ''">
		AND repair_desc = #{repair_desc,jdbcType=VARCHAR}
		</if>
		</where>  
	</delete>
	<delete id="deleteBatch" parameterType="java.util.List">
		DELETE FROM ass_repair_rec 
		<where>
			<foreach collection="list" index="index" item="item" open="(" separator="or" close=")">
				<if test="item.group_id != null and item.group_id != ''">
				AND group_id = #{item.group_id,jdbcType=INTEGER}
				</if>
				<if test="item.hos_id != null and item.hos_id != ''">
				AND hos_id = #{item.hos_id,jdbcType=INTEGER}
				</if>
				<if test="item.copy_code != null and item.copy_code != ''">
				AND copy_code = #{item.copy_code,jdbcType=VARCHAR}
				</if>
				<if test="item.ass_year != null and item.ass_year != ''">
				AND ass_year = #{item.ass_year,jdbcType=VARCHAR}
				</if>
				<if test="item.ass_month != null and item.ass_month != ''">
				AND ass_month = #{item.ass_month,jdbcType=VARCHAR}
				</if>
				<if test="item.repair_rec_no != null and item.repair_rec_no != ''">
				AND repair_rec_no = #{item.repair_rec_no,jdbcType=VARCHAR}
				</if>
				<if test="item.rep_team_code != null and item.rep_team_code != ''">
				AND rep_team_code = #{item.rep_team_code,jdbcType=VARCHAR}
				</if>
				<if test="item.fixed_dept_id != null and item.fixed_dept_id != ''">
				AND fixed_dept_id = #{item.fixed_dept_id,jdbcType=INTEGER}
				</if>
				<if test="item.fixed_dept_no != null and item.fixed_dept_no != ''">
				AND fixed_dept_no = #{item.fixed_dept_no,jdbcType=INTEGER}
				</if>
				<if test="item.ass_nature != null and item.ass_nature != ''">
				AND ass_nature = #{item.ass_nature,jdbcType=VARCHAR}
				</if>
				<if test="item.ass_name != null and item.ass_name != ''">
				AND ass_name = #{item.ass_name,jdbcType=VARCHAR}
				</if>
				<if test="item.ass_card_no != null and item.ass_card_no != ''">
				AND ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
				</if>
				<if test="item.apply_no != null and item.apply_no != ''">
				AND apply_no = #{item.apply_no,jdbcType=VARCHAR}
				</if>
				<if test="item.is_inner != null and item.is_inner != ''">
				AND is_inner = #{item.is_inner,jdbcType=INTEGER}
				</if>
				<if test="item.trouble_level != null and item.trouble_level != ''">
				AND trouble_level = #{item.trouble_level,jdbcType=INTEGER}
				</if>
				<if test="item.repair_level != null and item.repair_level != ''">
				AND repair_level = #{item.repair_level,jdbcType=INTEGER}
				</if>
				<if test="item.repair_date != null and item.repair_date != ''">
				AND repair_date = #{item.repair_date,jdbcType=DATE}
				</if>
				<if test="item.repair_engr != null and item.repair_engr != ''">
				AND repair_engr = #{item.repair_engr,jdbcType=VARCHAR}
				</if>
				<if test="item.repair_hours != null and item.repair_hours != ''">
				AND repair_hours = #{item.repair_hours,jdbcType=INTEGER}
				</if>
				<if test="item.is_contract != null and item.is_contract != ''">
				AND is_contract = #{item.is_contract,jdbcType=INTEGER}
				</if>
				<if test="item.contract_no != null and item.contract_no != ''">
				AND contract_no = #{item.contract_no,jdbcType=VARCHAR}
				</if>
				<if test="item.repair_money != null and item.repair_money != ''">
				AND repair_money = #{item.repair_money,jdbcType=INTEGER}
				</if>
				<if test="item.other_money != null and item.other_money != ''">
				AND other_money = #{item.other_money,jdbcType=INTEGER}
				</if>
				<if test="item.state != null and item.state != ''">
				AND state = #{item.state,jdbcType=INTEGER}
				</if>
				<if test="item.create_emp != null and item.create_emp != ''">
				AND create_emp = #{item.create_emp,jdbcType=INTEGER}
				</if>
				<if test="item.create_date != null and item.create_date != ''">
				AND create_date = #{item.create_date,jdbcType=DATE}
				</if>
				<if test="item.audit_emp != null and item.audit_emp != ''">
				AND audit_emp = #{item.audit_emp,jdbcType=INTEGER}
				</if>
				<if test="item.repair_desc != null and item.repair_desc != ''">
				AND repair_desc = #{item.repair_desc,jdbcType=VARCHAR}
				</if>
			</foreach>
	    </where>  
	</delete>
	<select id="query" parameterType="java.util.Map" resultMap="assRepairRec" >
	
		 select a.group_id, a.hos_id, a.copy_code, a.ass_year, a.ass_month
		      , a.repair_rec_no, a.rep_team_code, a.fixed_dept_id, a.fixed_dept_no,t.dept_name, a.ass_nature
		      , a.ass_name, a.ass_card_no, a.apply_no, a.is_inner, c.user_name as audit_name
		      , d.user_name as create_name, a.trouble_level, a.repair_level, a.repair_date, 
		      case when a.IS_INNER = 0 then a.repair_engr when a.IS_INNER = 1 then hed.emp_name else '' end  repair_engr
		      , a.repair_hours, a.is_contract, a.contract_no, a.repair_money, a.other_money
		      , case a.state
		        when 5 then '待维修'
		        when 6 then '维修中'
		        when 7 then '维修完成'
		      end as state_name, a.create_emp, a.create_date, a.audit_emp, a.repair_desc
		    from ASS_REPAIR_REC a
		    left  join HOS_DEPT_DICT t on 
		    t.group_id = a.group_id
		    and t.hos_id = a.hos_id
		    and t.dept_no = a.fixed_dept_no
		    left join sys_user c on a.group_id = c.group_id
		    and a.hos_id = c.hos_id
		    and a.copy_code = c.copy_code
		    and a.audit_emp = c.user_id 
		      left join sys_user d on 
		      a.group_id = d.group_id
		    and a.hos_id = d.hos_id
		    and a.copy_code = d.copy_code
		    and a.create_emp = d.user_id 
		    
		    left join hos_emp_dict hed on
		    a.group_id = hed.group_id
		    and a.hos_id = hed.hos_id
		    and a.repair_engr = to_char(hed.emp_id)
		    and hed.is_stop = 0
		    
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND a.group_id = #{group_id,jdbcType=INTEGER}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND a.hos_id = #{hos_id,jdbcType=INTEGER}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_year != null and ass_year != ''">
		AND a.ass_year = #{ass_year,jdbcType=VARCHAR}
		</if>
		<if test="ass_month != null and ass_month != ''">
		AND a.ass_month = #{ass_month,jdbcType=VARCHAR}
		</if>
		<if test="repair_rec_no != null and repair_rec_no != ''">
		AND a.repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
		</if>
		<if test="rep_team_code != null and rep_team_code != ''">
		AND a.rep_team_code = #{rep_team_code,jdbcType=VARCHAR}
		</if>
		<if test="fixed_dept_id != null and fixed_dept_id != ''">
		AND a.fixed_dept_id = #{fixed_dept_id,jdbcType=INTEGER}
		</if>
		<if test="fixed_dept_no != null and fixed_dept_no != ''">
		AND a.fixed_dept_no = #{fixed_dept_no,jdbcType=INTEGER}
		</if>
		<if test="ass_nature != null and ass_nature != ''">
		AND a.ass_nature = #{ass_nature,jdbcType=VARCHAR}
		</if>
		<if test="ass_name != null and ass_name != ''">
		AND a.ass_name = #{ass_name,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="apply_no != null and apply_no != ''">
		AND a.apply_no = #{apply_no,jdbcType=VARCHAR}
		</if>
		<if test="is_inner != null and is_inner != ''">
		AND a.is_inner = #{is_inner,jdbcType=INTEGER}
		</if>
		<if test="trouble_level != null and trouble_level != ''">
		AND a.trouble_level = #{trouble_level,jdbcType=INTEGER}
		</if>
		<if test="repair_level != null and repair_level != ''">
		AND a.repair_level = #{repair_level,jdbcType=INTEGER}
		</if>
		<if test="repair_date != null and repair_date != ''">
		AND a.repair_date = #{repair_date,jdbcType=DATE}
		</if>
		<if test="repair_engr != null and repair_engr != ''">
		AND a.repair_engr = #{repair_engr,jdbcType=VARCHAR}
		</if>
		<if test="repair_hours != null and repair_hours != ''">
		AND a.repair_hours = #{repair_hours,jdbcType=INTEGER}
		</if>
		<if test="is_contract != null and is_contract != ''">
		AND a.is_contract = #{is_contract,jdbcType=INTEGER}
		</if>
		<if test="contract_no != null and contract_no != ''">
		AND a.contract_no = #{contract_no,jdbcType=VARCHAR}
		</if>
		<if test="repair_money != null and repair_money != ''">
		AND a.repair_money = #{repair_money,jdbcType=INTEGER}
		</if>
		<if test="other_money != null and other_money != ''">
		AND a.other_money = #{other_money,jdbcType=INTEGER}
		</if>
		<if test="state != null and state != ''">
		AND a.state = #{state,jdbcType=INTEGER}
		</if>
		<if test="create_emp != null and create_emp != ''">
		AND a.create_emp = #{create_emp,jdbcType=INTEGER}
		</if>
		<if test="create_date != null and create_date != ''">
		AND a.create_date = #{create_date,jdbcType=DATE}
		</if>
		<if test="audit_emp != null and audit_emp != ''">
		AND a.audit_emp = #{audit_emp,jdbcType=INTEGER}
		</if>
		<if test="repair_desc != null and repair_desc != ''">
		AND a.repair_desc = #{repair_desc,jdbcType=VARCHAR}
		</if>
		</where>   
		order by a.group_id asc
	</select>
	<select id="queryByCode" resultMap="assRepairRec"  parameterType="java.util.Map" >
	
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_year,
			a.ass_month,
			a.repair_rec_no,
			a.rep_team_code,
			a.fixed_dept_id,
			a.fixed_dept_no,
			b.dept_code||' '||b.dept_name dept_name,
			a.ass_nature,
			a.ass_name,
			a.ass_card_no,
			a.apply_no,
			a.is_inner,
			a.trouble_level,
			a.repair_level,
			a.repair_date,
			a.repair_engr,
			a.repair_hours,
			a.is_contract,
			a.contract_no,
			a.repair_money,
			a.other_money,
			a.state,
			a.create_emp,
			a.create_date,
			a.audit_emp,
			a.repair_desc
			FROM ass_repair_rec a
			left join hos_dept_dict b on
			a.group_id = b.group_id
			and a.hos_id = b.hos_id
			and a.fixed_dept_id = b.dept_id
			and b.is_stop = 0
		WHERE 
			a.group_id = #{group_id}   and 
			a.hos_id = #{hos_id}   and 
			a.copy_code = #{copy_code}   and 
			a.repair_rec_no = #{repair_rec_no} 
	
	</select>
	<select id="queryByUniqueness" resultMap="assRepairRec"  parameterType="java.util.Map" >
	
		SELECT 
		group_id,
		hos_id,
		copy_code,
		ass_year,
		ass_month,
		repair_rec_no,
		rep_team_code,
		fixed_dept_id,
		fixed_dept_no,
		ass_nature,
		ass_name,
		ass_card_no,
		apply_no,
		is_inner,
		trouble_level,
		repair_level,
		repair_date,
		repair_engr,
		repair_hours,
		is_contract,
		contract_no,
		repair_money,
		other_money,
		state,
		create_emp,
		create_date,
		audit_emp,
		repair_desc
		FROM ASS_REPAIR_REC 
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND group_id = #{group_id,jdbcType=INTEGER}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND hos_id = #{hos_id,jdbcType=INTEGER}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_year != null and ass_year != ''">
		AND ass_year = #{ass_year,jdbcType=VARCHAR}
		</if>
		<if test="ass_month != null and ass_month != ''">
		AND ass_month = #{ass_month,jdbcType=VARCHAR}
		</if>
		<if test="repair_rec_no != null and repair_rec_no != ''">
		AND repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
		</if>
		<if test="rep_team_code != null and rep_team_code != ''">
		AND rep_team_code = #{rep_team_code,jdbcType=VARCHAR}
		</if>
		<if test="fixed_dept_id != null and fixed_dept_id != ''">
		AND fixed_dept_id = #{fixed_dept_id,jdbcType=INTEGER}
		</if>
		<if test="fixed_dept_no != null and fixed_dept_no != ''">
		AND fixed_dept_no = #{fixed_dept_no,jdbcType=INTEGER}
		</if>
		<if test="ass_nature != null and ass_nature != ''">
		AND ass_nature = #{ass_nature,jdbcType=VARCHAR}
		</if>
		<if test="ass_name != null and ass_name != ''">
		AND ass_name = #{ass_name,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="apply_no != null and apply_no != ''">
		AND apply_no = #{apply_no,jdbcType=VARCHAR}
		</if>
		<if test="is_inner != null and is_inner != ''">
		AND is_inner = #{is_inner,jdbcType=INTEGER}
		</if>
		<if test="trouble_level != null and trouble_level != ''">
		AND trouble_level = #{trouble_level,jdbcType=INTEGER}
		</if>
		<if test="repair_level != null and repair_level != ''">
		AND repair_level = #{repair_level,jdbcType=INTEGER}
		</if>
		<if test="repair_date != null and repair_date != ''">
		AND repair_date = #{repair_date,jdbcType=DATE}
		</if>
		<if test="repair_engr != null and repair_engr != ''">
		AND repair_engr = #{repair_engr,jdbcType=VARCHAR}
		</if>
		<if test="repair_hours != null and repair_hours != ''">
		AND repair_hours = #{repair_hours,jdbcType=INTEGER}
		</if>
		<if test="is_contract != null and is_contract != ''">
		AND is_contract = #{is_contract,jdbcType=INTEGER}
		</if>
		<if test="contract_no != null and contract_no != ''">
		AND contract_no = #{contract_no,jdbcType=VARCHAR}
		</if>
		<if test="repair_money != null and repair_money != ''">
		AND repair_money = #{repair_money,jdbcType=INTEGER}
		</if>
		<if test="other_money != null and other_money != ''">
		AND other_money = #{other_money,jdbcType=INTEGER}
		</if>
		<if test="state != null and state != ''">
		AND state = #{state,jdbcType=INTEGER}
		</if>
		<if test="create_emp != null and create_emp != ''">
		AND create_emp = #{create_emp,jdbcType=INTEGER}
		</if>
		<if test="create_date != null and create_date != ''">
		AND create_date = #{create_date,jdbcType=DATE}
		</if>
		<if test="audit_emp != null and audit_emp != ''">
		AND audit_emp = #{audit_emp,jdbcType=INTEGER}
		</if>
		<if test="repair_desc != null and repair_desc != ''">
		AND repair_desc = #{repair_desc,jdbcType=VARCHAR}
		</if>
		</where>   
		order by group_id asc
	</select>
	<select id="queryExists" resultMap="assRepairRec"  parameterType="java.util.Map" >
	
		SELECT 
		group_id,
		hos_id,
		copy_code,
		ass_year,
		ass_month,
		repair_rec_no,
		rep_team_code,
		fixed_dept_id,
		fixed_dept_no,
		ass_nature,
		ass_name,
		ass_card_no,
		apply_no,
		is_inner,
		trouble_level,
		repair_level,
		repair_date,
		repair_engr,
		repair_hours,
		is_contract,
		contract_no,
		repair_money,
		other_money,
		state,
		create_emp,
		create_date,
		audit_emp,
		repair_desc
		FROM ASS_REPAIR_REC 
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND group_id = #{group_id,jdbcType=INTEGER}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND hos_id = #{hos_id,jdbcType=INTEGER}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_year != null and ass_year != ''">
		AND ass_year = #{ass_year,jdbcType=VARCHAR}
		</if>
		<if test="ass_month != null and ass_month != ''">
		AND ass_month = #{ass_month,jdbcType=VARCHAR}
		</if>
		<if test="repair_rec_no != null and repair_rec_no != ''">
		AND repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
		</if>
		<if test="rep_team_code != null and rep_team_code != ''">
		AND rep_team_code = #{rep_team_code,jdbcType=VARCHAR}
		</if>
		<if test="fixed_dept_id != null and fixed_dept_id != ''">
		AND fixed_dept_id = #{fixed_dept_id,jdbcType=INTEGER}
		</if>
		<if test="fixed_dept_no != null and fixed_dept_no != ''">
		AND fixed_dept_no = #{fixed_dept_no,jdbcType=INTEGER}
		</if>
		<if test="ass_nature != null and ass_nature != ''">
		AND ass_nature = #{ass_nature,jdbcType=VARCHAR}
		</if>
		<if test="ass_name != null and ass_name != ''">
		AND ass_name = #{ass_name,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="apply_no != null and apply_no != ''">
		AND apply_no = #{apply_no,jdbcType=VARCHAR}
		</if>
		<if test="is_inner != null and is_inner != ''">
		AND is_inner = #{is_inner,jdbcType=INTEGER}
		</if>
		<if test="trouble_level != null and trouble_level != ''">
		AND trouble_level = #{trouble_level,jdbcType=INTEGER}
		</if>
		<if test="repair_level != null and repair_level != ''">
		AND repair_level = #{repair_level,jdbcType=INTEGER}
		</if>
		<if test="repair_date != null and repair_date != ''">
		AND repair_date = #{repair_date,jdbcType=DATE}
		</if>
		<if test="repair_engr != null and repair_engr != ''">
		AND repair_engr = #{repair_engr,jdbcType=VARCHAR}
		</if>
		<if test="repair_hours != null and repair_hours != ''">
		AND repair_hours = #{repair_hours,jdbcType=INTEGER}
		</if>
		<if test="is_contract != null and is_contract != ''">
		AND is_contract = #{is_contract,jdbcType=INTEGER}
		</if>
		<if test="contract_no != null and contract_no != ''">
		AND contract_no = #{contract_no,jdbcType=VARCHAR}
		</if>
		<if test="repair_money != null and repair_money != ''">
		AND repair_money = #{repair_money,jdbcType=INTEGER}
		</if>
		<if test="other_money != null and other_money != ''">
		AND other_money = #{other_money,jdbcType=INTEGER}
		</if>
		<if test="state != null and state != ''">
		AND state = #{state,jdbcType=INTEGER}
		</if>
		<if test="create_emp != null and create_emp != ''">
		AND create_emp = #{create_emp,jdbcType=INTEGER}
		</if>
		<if test="create_date != null and create_date != ''">
		AND create_date = #{create_date,jdbcType=DATE}
		</if>
		<if test="audit_emp != null and audit_emp != ''">
		AND audit_emp = #{audit_emp,jdbcType=INTEGER}
		</if>
		<if test="repair_desc != null and repair_desc != ''">
		AND repair_desc = #{repair_desc,jdbcType=VARCHAR}
		</if>
		</where>   
		order by group_id asc
	</select>
	
	<!-- 资产维修打印主表 -->
	<select id="queryaAssRepairRecBatch" parameterType="java.util.Map" resultType="java.util.Map">
		select a.repair_rec_no as id, a.repair_rec_no, a.COPY_CODE, a.group_id, a.hos_id
				, a.ass_year, a.ass_month, t.rep_team_code, r.ass_nature, r.ass_name
				, r.ass_card_no, r.apply_no,  a.repair_date
				, to_char(a.repair_date, 'yyyy-mm-dd') as repair_date, a.repair_engr
				, a.repair_hours, a.repair_desc, s.user_name as AUDIT_EMP, s1.user_name as create_emp
				, to_char(a.create_date, 'yyyy-mm-dd') as create_date, to_char(a.other_money,'FM999,999,999.00') other_money,
			   to_char(a.repair_money,'FM999,999,999.00') repair_money, m.contract_no,
         case 
			    when a.trouble_level = 0 then '一般'
			    when a.trouble_level = 1 then '严重'
			    else null
			  end as trouble_level
			    , case 
			    when a.repair_level = 0 then '小修'
			    when a.repair_level = 1 then '中修'
			      when a.repair_level = 2 then '大修'
			    else null
			  end as repair_level,
			  case 
			    when a.state = 5 then '待维修'
			    when a.state = 6 then '维修中'
			        when a.state = 7 then '维修完成'
			    else null
			  end as state
			  , case 
			    when a.is_inner = 0 then '是'
			    when a.is_inner = 1 then '否'
			    else null
			  end as is_inner
			  , case 
			    when a.is_contract = 0 then '是'
			    when a.is_contract = 1 then '否'
			    else null
			  end as is_contract,
	        l.dept_name
				from ASS_REPAIR_REC a
				left join ASS_REPAIR_TEAM_DICT t on t.group_id = a.group_id
				and t.hos_id = a.hos_id
				and a.rep_team_code = t.rep_team_code
				and t.is_stop = 0 
				left join sys_user s on s.user_id = a.AUDIT_EMP
	      and s.group_id = a.group_id
	      and s.hos_id = a.hos_id
	      and s.is_stop = 0 
	      left join sys_user s1 on s1.user_id = a.create_emp
	      and s1.group_id = a.group_id
	      and s1.hos_id = a.hos_id
	      and s1.is_stop = 0 
	      left join ASS_REPAIR_APPLY r on r.group_id = a.group_id
	      and r.hos_id = a.hos_id
	      and r.copy_code = a.copy_code
	      and a.apply_no = r.apply_no 
	      left join ASS_REPAIR_REC rr on rr.group_id = a.group_id
	      and rr.hos_id = a.hos_id
	      and rr.copy_code = a.copy_code
	      and rr.ass_card_no = a.ass_card_no 
	        left join ASS_CONTRACT_MAIN m on m.group_id = a.group_id
	      and m.hos_id = a.hos_id
	      and m.copy_code = a.copy_code
	      and m.contract_no = a.contract_no 
	      left join HOS_DEPT_DICT l on
	      l.group_id = a.group_id
	      and l.hos_id = a.hos_id
	      and l.dept_no = a.fixed_dept_no
    	where                     
			a.group_id = #{group_id}
			AND a.hos_id = #{hos_id}
			AND a.copy_code = #{copy_code}
			AND a.repair_rec_no in (${paraId})
	<!-- <where>
		<if test="group_id !=null and group_id !='' ">
				and a.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id !=null and hos_id !='' ">
				and a.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code !=null and copy_code !='' ">
				and a.copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			and a.copy_code in  (${paraId})
		</where> -->
    	
  
	
	</select>
	
	<select id="querAssRepairRecByPrint" parameterType="java.util.Map" resultType="java.util.Map">
		select a.repair_rec_no as id, a.repair_rec_no, a.COPY_CODE, a.group_id, a.hos_id
				, a.ass_year, a.ass_month, t.rep_team_code, r.ass_nature, r.ass_name
				, r.ass_card_no, r.apply_no,  a.repair_date
				, to_char(a.repair_date, 'yyyy-mm-dd') as repair_date, a.repair_engr
				, a.repair_hours, a.repair_desc, s.user_name as AUDIT_EMP, s1.user_name as create_emp
				, to_char(a.create_date, 'yyyy-mm-dd') as create_date, to_char(a.other_money,'FM999,999,999.00') other_money,
			  to_char(a.repair_money,'FM999,999,999.00') repair_money, m.contract_no,
         case 
			    when a.trouble_level = 0 then '一般'
			    when a.trouble_level = 1 then '严重'
			    else null
			  end as trouble_level
			    , case 
			    when a.repair_level = 0 then '小修'
			    when a.repair_level = 1 then '中修'
			      when a.repair_level = 2 then '大修'
			    else null
			  end as repair_level,
			  case 
			    when a.state = 5 then '待维修'
			    when a.state = 6 then '维修中'
			        when a.state = 7 then '维修完成'
			    else null
			  end as state
			  , case 
			    when a.is_inner = 0 then '是'
			    when a.is_inner = 1 then '否'
			    else null
			  end as is_inner
			  , case 
			    when a.is_contract = 0 then '是'
			    when a.is_contract = 1 then '否'
			    else null
			  end as is_contract,
	        l.dept_name
				from ASS_REPAIR_REC a
				left join ASS_REPAIR_TEAM_DICT t on t.group_id = a.group_id
				and t.hos_id = a.hos_id
				and a.rep_team_code = t.rep_team_code
				and t.is_stop = 0 
				left join sys_user s on s.user_id = a.AUDIT_EMP
	      and s.group_id = a.group_id
	      and s.hos_id = a.hos_id
	      and s.is_stop = 0 
	      left join sys_user s1 on s1.user_id = a.create_emp
	      and s1.group_id = a.group_id
	      and s1.hos_id = a.hos_id
	      and s1.is_stop = 0 
	      left join ASS_REPAIR_APPLY r on r.group_id = a.group_id
	      and r.hos_id = a.hos_id
	      and r.copy_code = a.copy_code
	      and a.apply_no = r.apply_no 
	      left join ASS_REPAIR_REC rr on rr.group_id = a.group_id
	      and rr.hos_id = a.hos_id
	      and rr.copy_code = a.copy_code
	      and rr.ass_card_no = a.ass_card_no 
	        left join ASS_CONTRACT_MAIN m on m.group_id = a.group_id
	      and m.hos_id = a.hos_id
	      and m.copy_code = a.copy_code
	      and m.contract_no = a.contract_no 
	      left join HOS_DEPT_DICT l on
	      l.group_id = a.group_id
	      and l.hos_id = a.hos_id
	      and l.dept_no = a.fixed_dept_no
     where                     
			a.group_id = #{group_id}
			AND a.hos_id = #{hos_id}
			AND a.copy_code = #{copy_code}
			AND a.repair_rec_no = #{repair_rec_no}
    <!--  <where>
		<if test="group_id !=null and group_id !='' ">
				and a.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id !=null and hos_id !='' ">
				and a.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code !=null and copy_code !='' ">
				and a.copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			
			
		</where> -->
  
	
	</select>
	<!-- 资产维修打印从表 -->
	<select id="queryAssRepairRec_detail" parameterType="java.util.Map" resultType="java.util.Map">
		select a.repair_rec_no as id, a.COPY_CODE, a.group_id, a.hos_id, to_char(a.stuff_money,'FM999,999,999.00') stuff_money,a.inv_code
			, a.inv_num, to_char(a.inv_price,'FM999,999,999.00') inv_price, s.inv_code, s.inv_name
		from ASS_REPAIR_REC_DETAIL a
			left join ass_inv_arrt s on s.group_id = a.group_id
			and s.hos_id = a.hos_id
			and s.copy_code = a.copy_code
			and s.inv_code = a.inv_code
     
     where                     
			a.group_id = #{group_id,jdbcType=INTEGER}
			AND a.hos_id = #{hos_id,jdbcType=INTEGER}
			AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
			<if test="paraId != null and paraId != ''">
			AND a.repair_rec_no in  (${paraId})
			</if>
			<if test="repair_rec_no != null and repair_rec_no != ''">
			AND a.repair_rec_no = #{repair_rec_no,jdbcType=VARCHAR}
			</if>
     
      <!-- <where>
			<if test="group_id !=null and group_id !='' ">
				and a.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id !=null and hos_id !='' ">
				and a.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code !=null and copy_code !='' ">
				and a.copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			
			<if test="copy_code !=null and p_num ==1">
				and a.copy_code in (${paraId})
			</if>
			<if test="copy_code !=null and p_num ==0">
				and  a.copy_code=#{copy_code,jdbcType=NUMERIC}
			</if>	
		</where> -->
   
	
	</select>
</mapper>

