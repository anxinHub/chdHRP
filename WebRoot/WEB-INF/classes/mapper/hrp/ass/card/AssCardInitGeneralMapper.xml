<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">     
<mapper namespace="com.chd.hrp.ass.dao.card.AssCardInitGeneralMapper">
	
	<resultMap id="assCardInitGeneral" type="com.chd.hrp.ass.entity.card.AssCardInitGeneral">  
		<result property="group_id" column="group_id"/>
		<result property="hos_id" column="hos_id"/>
		<result property="copy_code" column="copy_code"/>
		<result property="ass_card_no" column="ass_card_no"/>
		<result property="ass_ori_card_no" column="ass_ori_card_no"/>
		<result property="ass_id" column="ass_id"/>
		<result property="ass_no" column="ass_no"/>
		<result property="gb_code" column="gb_code"/>
		<result property="gb_code_name" column="gb_code_name"/>
		<result property="ass_spec" column="ass_spec"/>
		<result property="ass_mondl" column="ass_mondl"/>
		<result property="ass_brand" column="ass_brand"/>
		<result property="ass_amount" column="ass_amount"/>
		<result property="unit_code" column="unit_code"/>
		<result property="fac_id" column="fac_id"/>
		<result property="fac_no" column="fac_no"/>
		<result property="ven_id" column="ven_id"/>
		<result property="ven_no" column="ven_no"/>
		<result property="is_dept" column="is_dept"/>
		<result property="dept_id" column="dept_id"/>
		<result property="dept_no" column="dept_no"/>
		<result property="store_id" column="store_id"/>
		<result property="store_no" column="store_no"/>
		<result property="price" column="price"/>
		<result property="depre_money" column="depre_money"/>
		<result property="manage_depre_money" column="manage_depre_money"/>
		<result property="cur_money" column="cur_money"/>
		<result property="fore_money" column="fore_money"/>
		<result property="buy_type" column="buy_type"/>
		<result property="use_state" column="use_state"/>
		<result property="is_depr" column="is_depr"/>
		<result property="depr_method" column="depr_method"/>
		<result property="acc_depre_amount" column="acc_depre_amount"/>
		<result property="is_manage_depre" column="is_manage_depre"/>
		<result property="manage_depr_method" column="manage_depr_method"/>
		<result property="manage_depre_amount" column="manage_depre_amount"/>
		<result property="is_measure" column="is_measure"/>
		<result property="is_throw" column="is_throw"/>
		<result property="pact_code" column="pact_code"/>
		<result property="ins_money" column="ins_money"/>
		<result property="ins_date" column="ins_date"/>
		<result property="accept_emp" column="accept_emp"/>
		<result property="accept_date" column="accept_date"/>
		<result property="service_date" column="service_date"/>
		<result property="ass_seq_no" column="ass_seq_no"/>
		<result property="location" column="location"/>
		<result property="note" column="note"/>
		<result property="ass_in_no" column="ass_in_no"/>
		<result property="in_date" column="in_date"/>
		<result property="run_date" column="run_date"/>
		<result property="is_bar" column="is_bar"/>
		<result property="bar_type" column="bar_type"/>
		<result property="bar_code" column="bar_code"/>
		<result property="bar_url" column="bar_url"/>
		<result property="car_place" column="car_place"/>
		<result property="car_sign" column="car_sign"/>
		<result property="car_frame" column="car_frame"/>
		<result property="car_engine" column="car_engine"/>
		<result property="car_brand" column="car_brand"/>
		<result property="car_gas" column="car_gas"/>
		<result property="ass_purpose" column="ass_purpose" />
		<result property="proj_id" column="proj_id" />
		<result property="proj_no" column="proj_no" />
		<result property="add_depre_month" column="add_depre_month" />
		<result property="add_manage_month" column="add_manage_month" />
		<result property="contract_code" column="contract_code" />
		<result property="file_number" column="file_number" />
		<result property="man_code" column="man_code" />
	</resultMap>
		
	<resultMap id="assCardInitGeneralMap" type="java.util.Map">
		<result property="group_id" column="group_id"/>
		<result property="hos_id" column="hos_id"/>
		<result property="copy_code" column="copy_code"/>
		<result property="ass_card_no" column="ass_card_no"/>
		<result property="ass_ori_card_no" column="ass_ori_card_no"/>
		<result property="ass_id" column="ass_id"/>
		<result property="ass_no" column="ass_no"/>
		<result property="gb_code" column="gb_code"/>
		<result property="gb_code_name" column="gb_code_name"/>
		<result property="ass_spec" column="ass_spec"/>
		<result property="ass_mondl" column="ass_mondl"/>
		<result property="ass_brand" column="ass_brand"/>
		<result property="ass_amount" column="ass_amount"/>
		<result property="unit_code" column="unit_code"/>
		<result property="fac_id" column="fac_id"/>
		<result property="fac_no" column="fac_no"/>
		<result property="ven_id" column="ven_id"/>
		<result property="ven_no" column="ven_no"/>
		<result property="is_dept" column="is_dept"/>
		<result property="dept_id" column="dept_id"/>
		<result property="dept_no" column="dept_no"/>
		<result property="store_id" column="store_id"/>
		<result property="store_no" column="store_no"/>
		<result property="price" column="price"/>
		<result property="depre_money" column="depre_money"/>
		<result property="manage_depre_money" column="manage_depre_money"/>
		<result property="cur_money" column="cur_money"/>
		<result property="fore_money" column="fore_money"/>
		<result property="buy_type" column="buy_type"/>
		<result property="use_state" column="use_state"/>
		<result property="is_depr" column="is_depr"/>
		<result property="depr_method" column="depr_method"/>
		<result property="acc_depre_amount" column="acc_depre_amount"/>
		<result property="is_manage_depre" column="is_manage_depre"/>
		<result property="manage_depr_method" column="manage_depr_method"/>
		<result property="manage_depre_amount" column="manage_depre_amount"/>
		<result property="is_measure" column="is_measure"/>
		<result property="is_throw" column="is_throw"/>
		<result property="pact_code" column="pact_code"/>
		<result property="ins_money" column="ins_money"/>
		<result property="ins_date" column="ins_date"/>
		<result property="accept_emp" column="accept_emp"/>
		<result property="accept_date" column="accept_date"/>
		<result property="service_date" column="service_date"/>
		<result property="ass_seq_no" column="ass_seq_no"/>
		<result property="location" column="location"/>
		<result property="note" column="note"/>
		<result property="ass_in_no" column="ass_in_no"/>
		<result property="in_date" column="in_date"/>
		<result property="run_date" column="run_date"/>
		<result property="is_bar" column="is_bar"/>
		<result property="bar_type" column="bar_type"/>
		<result property="bar_code" column="bar_code"/>
		<result property="bar_url" column="bar_url"/>
		<result property="car_place" column="car_place"/>
		<result property="car_sign" column="car_sign"/>
		<result property="car_frame" column="car_frame"/>
		<result property="car_engine" column="car_engine"/>
		<result property="car_brand" column="car_brand"/>
		<result property="car_gas" column="car_gas"/>
		<result property="ass_purpose" column="ass_purpose" />
		<result property="proj_id" column="proj_id" />
		<result property="proj_no" column="proj_no" />
		<result property="add_depre_month" column="add_depre_month" />
		<result property="add_manage_month" column="add_manage_month" />
		<result property="contract_code" column="contract_code" />
		<result property="file_number" column="file_number" />
		<result property="man_code" column="man_code" />
	</resultMap>
	
	<insert id="add" useGeneratedKeys="true" >
	
		INSERT INTO ASS_CARD_INIT_GENERAL (
		<trim suffix="" suffixOverrides=",">
		<if test="group_id != null and group_id != ''">
		group_id
		,
		</if>
		<if test="hos_id != null and hos_id != ''">
		hos_id
		,
		</if>
		<if test="copy_code != null and copy_code != ''">
		copy_code
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		ass_card_no
		,
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		ass_ori_card_no
		,
		</if>
		<if test="ass_id != null and ass_id != ''">
		ass_id
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		ass_no
		,
		</if>
		<if test="gb_code != null and gb_code != ''">
		gb_code
		,
		</if>
		<if test="ass_spec != null and ass_spec != ''">
		ass_spec
		,
		</if>
		<if test="ass_mondl != null and ass_mondl != ''">
		ass_mondl
		,
		</if>
		<if test="ass_brand != null and ass_brand != ''">
		ass_brand
		,
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		ass_amount
		,
		</if>
		<if test="unit_code != null and unit_code != ''">
		unit_code
		,
		</if>
		<if test="fac_id != null and fac_id != ''">
		fac_id
		,
		</if>
		<if test="fac_no != null and fac_no != ''">
		fac_no
		,
		</if>
		<if test="ven_id != null and ven_id != '' ">
		ven_id
		,
		</if>
		<if test="ven_no != null and ven_no != '' ">
		ven_no
		,
		</if>
		<if test="is_dept != null and is_dept != ''">
		is_dept
		,
		</if>
		<if test="dept_id != null and dept_id != ''">
		dept_id
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		dept_no
		,
		</if>
		<if test="store_id != null and store_id != ''">
		store_id
		,
		</if>
		<if test="store_no != null and store_no != ''">
		store_no
		,
		</if>
		<if test="price != null and price != ''">
		price
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		depre_money
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		manage_depre_money
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		cur_money
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		fore_money
		,
		</if>
		<if test="buy_type != null and buy_type != ''">
		buy_type
		,
		</if>
		<if test="use_state != null and use_state != ''">
		use_state
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		is_depr
		,
		</if>
		<if test="depr_method != null and depr_method != ''">
		depr_method
		,
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		acc_depre_amount
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		is_manage_depre
		,
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		manage_depr_method
		,
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		manage_depre_amount
		,
		</if>
		<if test="is_measure != null and is_measure != ''">
		is_measure
		,
		</if>
		<if test="is_throw != null and is_throw != ''">
		is_throw
		,
		</if>
		<if test="pact_code != null and pact_code != ''">
		pact_code
		,
		</if>
		<if test="ins_money != null and ins_money != ''">
		ins_money
		,
		</if>
		<if test="ins_date != null and ins_date != ''">
		ins_date
		,
		</if>
		<if test="accept_emp != null and accept_emp != ''">
		accept_emp
		,
		</if>
		<if test="accept_date != null and accept_date != ''">
		accept_date
		,
		</if>
		<if test="service_date != null and service_date != ''">
		service_date
		,
		</if>
		<if test="ass_seq_no != null and ass_seq_no != ''">
		ass_seq_no
		,
		</if>
		<if test="location != null and location != ''">
		location
		,
		</if>
		<if test="note != null and note != ''">
		note
		,
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		ass_in_no
		,
		</if>
		<if test="in_date != null and in_date != ''">
		in_date
		,
		</if>
		<if test="run_date != null and run_date != ''">
		run_date
		,
		</if>
		<if test="is_bar != null and is_bar != ''">
		is_bar
		,
		</if>
		<if test="bar_type != null and bar_type != ''">
		bar_type
		,
		</if>
		<if test="bar_code != null and bar_code != ''">
		bar_code
		,
		</if>
		<if test="bar_url != null and bar_url != ''">
		bar_url
		,
		</if>
		<if test="car_place != null and car_place != ''">
		car_place
		,
		</if>
		<if test="car_sign != null and car_sign != ''">
		car_sign
		,
		</if>
		<if test="car_frame != null and car_frame != ''">
		car_frame
		,
		</if>
		<if test="car_engine != null and car_engine != ''">
		car_engine
		,
		</if>
		<if test="car_brand != null and car_brand != ''">
		car_brand
		,
		</if>
		<if test="car_gas != null and car_gas != ''">
		car_gas
		,
		</if>
		<if test="ass_purpose != null and ass_purpose != ''">
		ass_purpose
		,
		</if>
		<if test="proj_id != null and proj_id != ''">
		proj_id
		,
		</if>
		<if test="proj_no != null and proj_no != ''">
		proj_no
		,
		</if>
		<if test="add_depre_month != null and add_depre_month != ''">
		add_depre_month
		,
		</if>
		<if test="add_manage_month != null and add_manage_month != ''">
		add_manage_month
		,
		</if>
		<if test="contract_code != null and contract_code != ''">
		contract_code
		,
		</if>
		<if test="file_number != null and file_number != ''">
		file_number
		,
		</if>
		<if test="man_code != null and man_code != ''">
		man_code
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		proc_store_id
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		proc_store_no
		,
		</if>
		</trim>
		) VALUES (
		<trim suffix="" suffixOverrides=",">
		<if test="group_id != null and group_id != ''">
		to_number(#{group_id})
		,
		</if>
		<if test="hos_id != null and hos_id != ''">
		to_number(#{hos_id})
		,
		</if>
		<if test="copy_code != null and copy_code != ''">
		#{copy_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		#{ass_card_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		#{ass_ori_card_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_id != null and ass_id != ''">
		to_number(#{ass_id})
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		to_number(#{ass_no})
		,
		</if>
		<if test="gb_code != null and gb_code != ''">
		#{gb_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_spec != null and ass_spec != ''">
		#{ass_spec,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_mondl != null and ass_mondl != ''">
		#{ass_mondl,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_brand != null and ass_brand != ''">
		#{ass_brand,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		to_number(#{ass_amount})
		,
		</if>
		<if test="unit_code != null and unit_code != ''">
		#{unit_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="fac_id != null and fac_id != ''">
		to_number(#{fac_id})
		,
		</if>
		<if test="fac_no != null and fac_no != ''">
		to_number(#{fac_no})
		,
		</if>
		<if test="ven_id != null and ven_id != '' ">
		to_number(#{ven_id})
		,
		</if>
		<if test="ven_no != null and ven_no != '' ">
		to_number(#{ven_no})
		,
		</if>
		<if test="is_dept != null and is_dept != ''">
		to_number(#{is_dept})
		,
		</if>
		<if test="dept_id != null and dept_id != ''">
		to_number(#{dept_id})
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		to_number(#{dept_no})
		,
		</if>
		<if test="store_id != null and store_id != ''">
		to_number(#{store_id})
		,
		</if>
		<if test="store_no != null and store_no != ''">
		to_number(#{store_no})
		,
		</if>
		<if test="price != null and price != ''">
		to_number(#{price})
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		to_number(#{depre_money})
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		to_number(#{manage_depre_money})
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		to_number(#{cur_money})
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		to_number(#{fore_money})
		,
		</if>
		<if test="buy_type != null and buy_type != ''">
		#{buy_type,jdbcType=VARCHAR}
		,
		</if>
		<if test="use_state != null and use_state != ''">
		to_number(#{use_state})
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		to_number(#{is_depr})
		,
		</if>
		<if test="depr_method != null and depr_method != ''">
		#{depr_method,jdbcType=VARCHAR}
		,
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		to_number(#{acc_depre_amount})
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		to_number(#{is_manage_depre})
		,
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		#{manage_depr_method,jdbcType=VARCHAR}
		,
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		to_number(#{manage_depre_amount})
		,
		</if>
		<if test="is_measure != null and is_measure != ''">
		to_number(#{is_measure})
		,
		</if>
		<if test="is_throw != null and is_throw != ''">
		to_number(#{is_throw})
		,
		</if>
		<if test="pact_code != null and pact_code != ''">
		#{pact_code}
		,
		</if>
		<if test="ins_money != null and ins_money != ''">
		to_number(#{ins_money})
		,
		</if>
		<if test="ins_date != null and ins_date != ''">
		to_date(#{ins_date},'YYYY-MM-DD')
		,
		</if>
		<if test="accept_emp != null and accept_emp != ''">
		to_number(#{accept_emp})
		,
		</if>
		<if test="accept_date != null and accept_date != ''">
		to_date(#{accept_date},'YYYY-MM-DD')
		,
		</if>
		<if test="service_date != null and service_date != ''">
		to_date(#{service_date},'YYYY-MM-DD')
		,
		</if>
		<if test="ass_seq_no != null and ass_seq_no != ''">
		#{ass_seq_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="location != null and location != ''">
		#{location,jdbcType=VARCHAR}
		,
		</if>
		<if test="note != null and note != ''">
		#{note,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		#{ass_in_no}
		,
		</if>
		<if test="in_date != null and in_date != ''">
		to_date(#{in_date},'YYYY-MM-DD')
		,
		</if>
		<if test="run_date != null and run_date != ''">
		to_date(#{run_date},'YYYY-MM-DD')
		,
		</if>
		<if test="is_bar != null and is_bar != ''">
		to_number(#{is_bar})
		,
		</if>
		<if test="bar_type != null and bar_type != ''">
		to_number(#{bar_type})
		,
		</if>
		<if test="bar_code != null and bar_code != ''">
		#{bar_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="bar_url != null and bar_url != ''">
		#{bar_url,jdbcType=VARCHAR}
		,
		</if>
		<if test="car_place != null and car_place != ''">
		#{car_place,jdbcType=VARCHAR}
		,
		</if>
		<if test="car_sign != null and car_sign != ''">
		#{car_sign,jdbcType=VARCHAR}
		,
		</if>
		<if test="car_frame != null and car_frame != ''">
		#{car_frame,jdbcType=VARCHAR}
		,
		</if>
		<if test="car_engine != null and car_engine != ''">
		#{car_engine,jdbcType=VARCHAR}
		,
		</if>
		<if test="car_brand != null and car_brand != ''">
		#{car_brand,jdbcType=VARCHAR}
		,
		</if>
		<if test="car_gas != null and car_gas != ''">
		to_number(#{car_gas})
		,
		</if>
		<if test="ass_purpose != null and ass_purpose != ''">
		#{ass_purpose}
		,
		</if>
		<if test="proj_id != null and proj_id != ''">
		to_number(#{proj_id})
		,
		</if>
		<if test="proj_no != null and proj_no != ''">
		to_number(#{proj_no})
		,
		</if>
		<if test="add_depre_month != null and add_depre_month != ''">
		to_number(#{add_depre_month})
		,
		</if>
		<if test="add_manage_month != null and add_manage_month != ''">
		to_number(#{add_manage_month})
		,
		</if>
		<if test="contract_code != null and contract_code != ''">
		#{contract_code}
		,
		</if>
		<if test="file_number != null and file_number != ''">
		#{file_number}
		,
		</if>
		<if test="man_code != null and man_code != ''">
		#{man_code}
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		to_number(#{proc_store_id})
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		to_number(#{proc_store_no})
		,
		</if>
		</trim>		
		)
	
	</insert>
	<insert id="addBatch" parameterType="java.util.List" >
	
		INSERT INTO ASS_CARD_INIT_GENERAL (
		group_id
		,
		hos_id
		,
		copy_code
		,
		ass_card_no
		,
		ass_ori_card_no
		,
		ass_id
		,
		ass_no
		,
		gb_code
		,
		ass_spec
		,
		ass_mondl
		,
		ass_brand
		,
		ass_amount
		,
		unit_code
		,
		fac_id
		,
		fac_no
		,
		ven_id
		,
		ven_no
		,
		is_dept
		,
		dept_id
		,
		dept_no
		,
		store_id
		,
		store_no
		,
		price
		,
		depre_money
		,
		manage_depre_money
		,
		cur_money
		,
		fore_money
		,
		buy_type
		,
		use_state
		,
		is_depr
		,
		depr_method
		,
		acc_depre_amount
		,
		is_manage_depre
		,
		manage_depr_method
		,
		manage_depre_amount
		,
		is_measure
		,
		is_throw
		,
		pact_code
		,
		ins_money
		,
		ins_date
		,
		accept_emp
		,
		accept_date
		,
		service_date
		,
		ass_seq_no
		,
		location
		,
		note
		,
		ass_in_no
		,
		in_date
		,
		run_date
		,
		is_bar
		,
		bar_type
		,
		bar_code
		,
		bar_url
		,
		car_place
		,
		car_sign
		,
		car_frame
		,
		car_engine
		,
		car_brand
		,
		car_gas
		,
		ass_purpose
		,
		proj_id
		,
		proj_no
		,
		contract_code
		,
		file_number
		,
		man_code
		,
		proc_store_id
		,
		proc_store_no
		) select t.* from(
		<foreach collection="list" item="item" index="index" separator=" union all " >
			select 		
			#{item.group_id}
			,
			#{item.hos_id}
			,
			#{item.copy_code,jdbcType=VARCHAR}
			,
			#{item.ass_card_no,jdbcType=VARCHAR}
			,
			#{item.ass_ori_card_no,jdbcType=VARCHAR}
			,
			#{item.ass_id}
			,
			#{item.ass_no}
			,
			#{item.gb_code,jdbcType=VARCHAR}
			,
			#{item.ass_spec,jdbcType=VARCHAR}
			,
			#{item.ass_mondl,jdbcType=VARCHAR}
			,
			#{item.ass_brand,jdbcType=VARCHAR}
			,
			#{item.ass_amount}
			,
			#{item.unit_code,jdbcType=VARCHAR}
			,
			#{item.fac_id}
			,
			#{item.fac_no}
			,
			#{item.ven_id}
			,
			#{item.ven_no}
			,
			#{item.is_dept}
			,
			#{item.dept_id}
			,
			#{item.dept_no}
			,
			#{item.store_id}
			,
			#{item.store_no}
			,
			#{item.price}
			,
			#{item.depre_money}
			,
			#{item.manage_depre_money}
			,
			#{item.cur_money}
			,
			#{item.fore_money}
			,
			#{item.buy_type,jdbcType=VARCHAR}
			,
			#{item.use_state}
			,
			#{item.is_depr}
			,
			#{item.depr_method,jdbcType=VARCHAR}
			,
			#{item.acc_depre_amount}
			,
			#{item.is_manage_depre}
			,
			#{item.manage_depr_method,jdbcType=VARCHAR}
			,
			#{item.manage_depre_amount}
			,
			#{item.is_measure}
			,
			#{item.is_throw}
			,
			#{item.pact_code}
			,
			#{item.ins_money}
			,
			#{item.ins_date,jdbcType=DATE}
			,
			#{item.accept_emp}
			,
			#{item.accept_date,jdbcType=DATE}
			,
			#{item.service_date,jdbcType=DATE}
			,
			#{item.ass_seq_no,jdbcType=VARCHAR}
			,
			#{item.location,jdbcType=VARCHAR}
			,
			#{item.note,jdbcType=VARCHAR}
			,
			#{item.ass_in_no}
			,
			#{item.in_date,jdbcType=DATE}
			,
			#{item.run_date,jdbcType=DATE}
			,
			#{item.is_bar}
			,
			#{item.bar_type}
			,
			#{item.bar_code,jdbcType=VARCHAR}
			,
			#{item.bar_url,jdbcType=VARCHAR}
			,
			#{item.car_place,jdbcType=VARCHAR}
			,
			#{item.car_sign,jdbcType=VARCHAR}
			,
			#{item.car_frame,jdbcType=VARCHAR}
			,
			#{item.car_engine,jdbcType=VARCHAR}
			,
			#{item.car_brand,jdbcType=VARCHAR}
			,
			#{item.car_gas}
			,
			#{item.ass_purpose,jdbcType=VARCHAR}
			,
			#{item.proj_id,jdbcType=INTEGER}
			,
			#{item.proj_no,jdbcType=INTEGER}
			,
			#{item.contract_code,jdbcType=VARCHAR}
			,
			#{item.file_number,jdbcType=VARCHAR}
			,
			#{item.man_code,jdbcType=VARCHAR}
			,
			#{item.proc_store_id,jdbcType=INTEGER}
			,
			#{item.proc_store_no,jdbcType=INTEGER}
		    from dual
		</foreach>
		)t
	</insert>
	
	<update id="update" parameterType="java.util.Map">
	
		UPDATE ASS_CARD_INIT_GENERAL 
		<trim prefix="SET"  suffixOverrides=","> 
		ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
		,
		<if test="ass_id != null and ass_id != ''">
		ass_id = to_number(#{ass_id})
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		ass_no = to_number(#{ass_no})
		,
		</if>
		gb_code = #{gb_code,jdbcType=VARCHAR}
		,
		ass_spec = #{ass_spec,jdbcType=VARCHAR}
		,
		ass_mondl = #{ass_mondl,jdbcType=VARCHAR}
		,
		ass_brand = #{ass_brand,jdbcType=VARCHAR}
		,
		<if test="ass_amount != null and ass_amount != ''">
		ass_amount = to_number(#{ass_amount})
		,
		</if>
		unit_code = #{unit_code,jdbcType=VARCHAR}
		,
		
		<!-- 台州bug :在if中增加 != 'undefined' 的判断 修改保存时不选厂商和供应商出现的报错问题-->
		<if test="fac_id != null and fac_id != '' and fac_id != 'undefined'">
		fac_id = to_number(#{fac_id})
		,
		</if>
		<if test="fac_no != null and fac_no != '' and fac_no != 'undefined'">
		fac_no = to_number(#{fac_no})
		,
		</if>
		<if test="ven_id != null and ven_id != '' and ven_id != 'undefined'">
		ven_id = to_number(#{ven_id})
		,
		</if>
		<if test="ven_no != null and ven_no != '' and ven_no != 'undefined'">
		ven_no = to_number(#{ven_no})
		,
		</if>
		<if test="is_dept != null and is_dept != ''">
		is_dept = to_number(#{is_dept})
		,
		</if>
		<if test="dept_id != null and dept_id != ''">
		dept_id = to_number(#{dept_id})
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		dept_no = to_number(#{dept_no})
		,
		</if>
		<if test="store_id != null and store_id != ''">
		store_id = to_number(#{store_id})
		,
		</if>
		<if test="store_no != null and store_no != ''">
		store_no = to_number(#{store_no})
		,
		</if>
		<if test="price != null and price != ''">
		price = to_number(#{price})
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		depre_money = to_number(#{depre_money})
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		manage_depre_money = to_number(#{manage_depre_money})
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		cur_money = to_number(#{cur_money})
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		fore_money = to_number(#{fore_money})
		,
		</if>
		buy_type = #{buy_type,jdbcType=VARCHAR}
		,
		<if test="use_state != null and use_state != ''">
		use_state = to_number(#{use_state})
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		is_depr = to_number(#{is_depr})
		,
		</if>
		depr_method = #{depr_method,jdbcType=VARCHAR}
		,
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		acc_depre_amount = to_number(#{acc_depre_amount})
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		is_manage_depre = to_number(#{is_manage_depre})
		,
		</if>
		manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		,
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		manage_depre_amount = to_number(#{manage_depre_amount})
		,
		</if>
		<if test="is_measure != null and is_measure != ''">
		is_measure = to_number(#{is_measure})
		,
		</if>
		<if test="is_throw != null and is_throw != ''">
		is_throw = to_number(#{is_throw})
		,
		</if>
		<if test="pact_code != null and pact_code != ''">
		pact_code = #{pact_code}
		,
		</if>
		<if test="ins_money != null and ins_money != ''">
		ins_money = to_number(#{ins_money})
		,
		</if>
		<if test="ins_date != null and ins_date != ''">
		ins_date = to_date(#{ins_date},'YYYY-MM-DD')
		,
		</if>
		<if test="accept_emp != null and accept_emp != ''">
		accept_emp = to_number(#{accept_emp})
		,
		</if>
		<if test="accept_date != null and accept_date != ''">
		accept_date = to_date(#{accept_date},'YYYY-MM-DD')
		,
		</if>
		<if test="service_date != null and service_date != ''">
		service_date = to_date(#{service_date},'YYYY-MM-DD')
		,
		</if>
		ass_seq_no = #{ass_seq_no,jdbcType=VARCHAR}
		,
		location = #{location,jdbcType=VARCHAR}
		,
		note = #{note,jdbcType=VARCHAR}
		,
		<if test="ass_in_no != null and ass_in_no != ''">
		ass_in_no = #{ass_in_no}
		,
		</if>
		<if test="in_date != null and in_date != ''">
		in_date = to_date(#{in_date},'YYYY-MM-DD')
		,
		</if>
		<if test="run_date != null and run_date != ''">
		run_date = to_date(#{run_date},'YYYY-MM-DD')
		,
		</if>
		<if test="is_bar != null and is_bar != ''">
		is_bar = to_number(#{is_bar})
		,
		</if>
		<if test="bar_type != null and bar_type != ''">
		bar_type = to_number(#{bar_type})
		,
		</if>
		bar_code = #{bar_code,jdbcType=VARCHAR}
		,
		bar_url = #{bar_url,jdbcType=VARCHAR}
		,
		car_place = #{car_place,jdbcType=VARCHAR}
		,
		car_sign = #{car_sign,jdbcType=VARCHAR}
		,
		car_frame = #{car_frame,jdbcType=VARCHAR}
		,
		car_engine = #{car_engine,jdbcType=VARCHAR}
		,
		car_brand = #{car_brand,jdbcType=VARCHAR}
		,
		<if test="car_gas != null and car_gas != ''">
		car_gas = to_number(#{car_gas})
		,
		</if>
		ass_purpose = #{ass_purpose,jdbcType=VARCHAR}
		,
		<if test="proj_id != null and proj_id != ''">
		proj_id = to_number(#{proj_id})
		,
		</if>
		<if test="proj_no != null and proj_no != ''">
		proj_no = to_number(#{proj_no})
		,
		</if>
		<if test="contract_code != null and contract_code != ''">
		contract_code = #{contract_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="file_number != null and file_number != ''">
		file_number = #{file_number,jdbcType=VARCHAR}
		,
		</if>
		<if test="man_code != null and man_code != ''">
		man_code = #{man_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		proc_store_id = to_number(#{proc_store_id})
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		proc_store_no = to_number(#{proc_store_no})
		,
		</if>
		</trim>
		where                     
		group_id = #{group_id}
		AND hos_id = #{hos_id}
		AND copy_code = #{copy_code}
		AND ass_card_no = #{ass_card_no}
	</update>
	<update id="updateBatch" parameterType="java.util.List">
	
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ASS_CARD_INIT_GENERAL 
			<trim prefix="SET"  suffixOverrides=","> 
			<if test="item.ass_ori_card_no != null and item.ass_ori_card_no != ''">
			ass_ori_card_no = #{item.ass_ori_card_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_id != null and item.ass_id != ''">
			ass_id = #{item.ass_id}
			,
			</if>
			<if test="item.ass_no != null and item.ass_no != ''">
			ass_no = #{item.ass_no}
			,
			</if>
			<if test="item.gb_code != null and item.gb_code != ''">
			gb_code = #{item.gb_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_spec != null and item.ass_spec != ''">
			ass_spec = #{item.ass_spec,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_mondl != null and item.ass_mondl != ''">
			ass_mondl = #{item.ass_mondl,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_brand != null and item.ass_brand != ''">
			ass_brand = #{item.ass_brand,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_amount != null and item.ass_amount != ''">
			ass_amount = #{item.ass_amount}
			,
			</if>
			<if test="item.unit_code != null and item.unit_code != ''">
			unit_code = #{item.unit_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.fac_id != null and item.fac_id != ''">
			fac_id = #{item.fac_id}
			,
			</if>
			<if test="item.fac_no != null and item.fac_no != ''">
			fac_no = #{item.fac_no}
			,
			</if>
			<if test="item.ven_id != null and item.ven_id != ''">
			ven_id = #{item.ven_id}
			,
			</if>
			<if test="item.ven_no != null and item.ven_no != ''">
			ven_no = #{item.ven_no}
			,
			</if>
			<if test="item.is_dept != null and item.is_dept != ''">
			is_dept = #{item.is_dept}
			,
			</if>
			<if test="item.dept_id != null and item.dept_id != ''">
			dept_id = #{item.dept_id}
			,
			</if>
			<if test="item.dept_no != null and item.dept_no != ''">
			dept_no = #{item.dept_no}
			,
			</if>
			<if test="item.store_id != null and item.store_id != ''">
			store_id = #{item.store_id}
			,
			</if>
			<if test="item.store_no != null and item.store_no != ''">
			store_no = #{item.store_no}
			,
			</if>
			<if test="item.price != null and item.price != ''">
			price = #{item.price}
			,
			</if>
			<if test="item.depre_money != null and item.depre_money != ''">
			depre_money = #{item.depre_money}
			,
			</if>
			<if test="item.manage_depre_money != null and item.manage_depre_money != ''">
			manage_depre_money = #{item.manage_depre_money}
			,
			</if>
			<if test="item.cur_money != null and item.cur_money != ''">
			cur_money = #{item.cur_money}
			,
			</if>
			<if test="item.fore_money != null and item.fore_money != ''">
			fore_money = #{item.fore_money}
			,
			</if>
			<if test="item.buy_type != null and item.buy_type != ''">
			buy_type = #{item.buy_type,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.use_state != null and item.use_state != ''">
			use_state = #{item.use_state}
			,
			</if>
			<if test="item.is_depr != null and item.is_depr != ''">
			is_depr = #{item.is_depr}
			,
			</if>
			<if test="item.depr_method != null and item.depr_method != ''">
			depr_method = #{item.depr_method,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.acc_depre_amount != null and item.acc_depre_amount != ''">
			acc_depre_amount = #{item.acc_depre_amount}
			,
			</if>
			<if test="item.is_manage_depre != null and item.is_manage_depre != ''">
			is_manage_depre = #{item.is_manage_depre}
			,
			</if>
			<if test="item.manage_depr_method != null and item.manage_depr_method != ''">
			manage_depr_method = #{item.manage_depr_method,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.manage_depre_amount != null and item.manage_depre_amount != ''">
			manage_depre_amount = #{item.manage_depre_amount}
			,
			</if>
			<if test="item.is_measure != null and item.is_measure != ''">
			is_measure = #{item.is_measure}
			,
			</if>
			<if test="item.is_throw != null and item.is_throw != ''">
			is_throw = #{item.is_throw}
			,
			</if>
			<if test="item.pact_code != null and item.pact_code != ''">
			pact_code = #{item.pact_code}
			,
			</if>
			<if test="item.ins_money != null and item.ins_money != ''">
			ins_money = #{item.ins_money}
			,
			</if>
			<if test="item.ins_date != null and item.ins_date != ''">
			ins_date = #{item.ins_date,jdbcType=DATE}
			,
			</if>
			<if test="item.accept_emp != null and item.accept_emp != ''">
			accept_emp = #{item.accept_emp}
			,
			</if>
			<if test="item.accept_date != null and item.accept_date != ''">
			accept_date = #{item.accept_date,jdbcType=DATE}
			,
			</if>
			<if test="item.service_date != null and item.service_date != ''">
			service_date = #{item.service_date,jdbcType=DATE}
			,
			</if>
			<if test="item.ass_seq_no != null and item.ass_seq_no != ''">
			ass_seq_no = #{item.ass_seq_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.location != null and item.location != ''">
			location = #{item.location,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.note != null and item.note != ''">
			note = #{item.note,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_in_no != null and item.ass_in_no != ''">
			ass_in_no = #{item.ass_in_no}
			,
			</if>
			<if test="item.in_date != null and item.in_date != ''">
			in_date = #{item.in_date,jdbcType=DATE}
			,
			</if>
			<if test="item.run_date != null and item.run_date != ''">
			run_date = #{item.run_date,jdbcType=DATE}
			,
			</if>
			<if test="item.is_bar != null and item.is_bar != ''">
			is_bar = #{item.is_bar}
			,
			</if>
			<if test="item.bar_type != null and item.bar_type != ''">
			bar_type = #{item.bar_type}
			,
			</if>
			<if test="item.bar_code != null and item.bar_code != ''">
			bar_code = #{item.bar_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.bar_url != null and item.bar_url != ''">
			bar_url = #{item.bar_url,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.car_place != null and item.car_place != ''">
			car_place = #{item.car_place,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.car_sign != null and item.car_sign != ''">
			car_sign = #{item.car_sign,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.car_frame != null and item.car_frame != ''">
			car_frame = #{item.car_frame,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.car_engine != null and item.car_engine != ''">
			car_engine = #{item.car_engine,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.car_brand != null and item.car_brand != ''">
			car_brand = #{item.car_brand,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.car_gas != null and item.car_gas != ''">
			car_gas = #{item.car_gas}
			,
			</if>
			<if test="item.contract_code != null and item.contract_code != ''">
			contract_code = #{item.contract_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.file_number != null and item.file_number != ''">
			file_number = #{item.file_number,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.man_code != null and item.man_code != ''">
			man_code = #{item.man_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.proc_store_id != null and item.proc_store_id != ''">
			proc_store_id = to_number(#{item.proc_store_id})
			,
			</if>
			<if test="item.proc_store_no != null and item.proc_store_no != ''">
			proc_store_no = to_number(#{item.proc_store_no})
			,
			</if>
			</trim>
			<where>                     
			<if test="item.group_id != null and item.group_id != ''">
			AND group_id = #{item.group_id}
			</if>  
			<if test="item.hos_id != null and item.hos_id != ''">
			AND hos_id = #{item.hos_id}
			</if>  
			<if test="item.copy_code != null and item.copy_code != ''">
			AND copy_code = #{item.copy_code,jdbcType=VARCHAR}
			</if>  
			<if test="item.ass_card_no != null and item.ass_card_no != ''">
			AND ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
			</if>  
			</where>  			
		</foreach>
	</update>
	
	<delete id="delete" parameterType="java.util.Map">
	
		begin
			<if test="is_del_rel == 1">
			delete from ASS_ACCESSORY_INIT_GENERAL where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_RESOURCE_INIT_GENERAL where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_SHARE_DEPT_INIT_GENERAL where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_FILE_INIT_GENERAL where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_PHOTO_INIT_GENERAL where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_PAY_STAGE_INIT_GENERAL where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_DEPRE_ACC_INIT_GENERAL where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_DEPRE_MANAGE_INIT_GENERAL where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			</if>
	
			DELETE FROM ASS_CARD_INIT_GENERAL 
			<where>                     
			AND group_id = #{group_id}
			AND hos_id = #{hos_id}
			AND copy_code = #{copy_code,jdbcType=VARCHAR}
			<if test="ass_card_no != null and ass_card_no != ''">
			AND ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
			</if>
			</where>
			;
		end;  
	</delete>
	<delete id="deleteBatch" parameterType="java.util.List">
		DELETE FROM ASS_CARD_INIT_GENERAL 
		<where>
			<foreach collection="list" index="index" item="item" open="(" separator="or" close=")">
				group_id = #{item.group_id}
				AND hos_id = #{item.hos_id}
				AND copy_code = #{item.copy_code,jdbcType=VARCHAR}
				AND ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
			</foreach>
	    </where>  
	</delete>
	<select id="query" parameterType="java.util.Map" resultMap="assCardInitGeneral" >
		select * from (
		SELECT 
		      a.group_id,
		      a.hos_id,
		      a.copy_code,
		      a.ass_card_no,
		      a.ass_ori_card_no,
		      a.ass_id,
		      a.ass_no,
		      ad.ass_code ass_id_code,
		      ad.ass_name ass_id_name,
		      a.gb_code,
		      a.ass_spec,
		      a.ass_mondl,
		      a.ass_brand,
		      a.ass_amount,
		      a.unit_code,
		      hu.unit_name unit_code_name,
		      a.fac_id,
		      a.fac_no,
		      hfd.fac_code fac_id_code,
		      hfd.fac_name fac_id_name,
		      a.ven_id,
		      a.ven_no,
		      hsd.sup_code ven_id_code,
		      hsd.sup_name ven_id_name,
		      a.is_dept,
		      case when a.is_dept = 0 then '在库' when a.is_dept = 1 then '在用' else '' end is_dept_name,
		      a.dept_id,
		      a.dept_no,
		      hdd.dept_code dept_id_code,
		      hdd.dept_name dept_id_name,
		      a.store_id,
		      a.store_no,
		      htd.store_code store_id_code,
		      htd.store_name store_id_name,
		      a.price,
		      a.depre_money,
		      a.manage_depre_money,
		      a.cur_money,
		      a.fore_money,
		      a.buy_type,
		      abtd.bus_type_name buy_type_name,
		      a.use_state,
		      acus.state_name use_state_name,
		      a.is_depr,
		      case when a.is_depr = 0  then '否' when a.is_depr = 1 then '是' else '' end is_depr_name,
		      a.depr_method,
		      admd1.ass_depre_name depr_method_name,
		      a.acc_depre_amount,
		      a.is_manage_depre,
		      case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
		      a.manage_depr_method,
		      admd2.ass_depre_name manage_depr_method_name,
		      a.manage_depre_amount,
		      a.is_measure,
		      case when a.is_measure  = 0 then '否' when a.is_measure  = 1 then '是' else '' end is_measure_name,
		      a.is_throw,
		      case when a.is_throw  = 0 then '否' when a.is_throw  = 1 then '是' else '' end is_throw_name,
		      a.pact_code,
		      a.ins_money,
		      a.ins_date,
		      a.accept_emp,
		      su.emp_name accept_emp_name,
		      a.accept_date,
		      a.service_date,
		      a.ass_seq_no,
		      a.location,
		      a.note,
		      a.ass_in_no,
		      a.in_date,
		      a.run_date,
		      a.is_bar,
		      case when a.is_bar = 0 then '否' when a.is_bar = 1 then '是' else '' end is_bar_name,
		      a.bar_type,
		      case when a.bar_type = 1 then '一维条码' when a.bar_type = 2 then '二维条码' else '' end bar_type_name,
		      a.bar_code,
		      a.bar_url,
		      a.car_place,
		      a.car_sign,
		      a.car_frame,
		      a.car_engine,
		      a.car_brand,
		      a.car_gas,
		      a.proj_id,
		      a.proj_no,
		      hpd.proj_code proj_id_code,
		      hpd.proj_name proj_id_name,
		      a.ass_purpose,
		      aud.equi_usage_name ass_purpose_name,
		      a.add_depre_month,
			  a.add_manage_month,
			  a.contract_code,
			  a.file_number,
			  a.man_code,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name  
    FROM ASS_CARD_INIT_GENERAL a
    
	    left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_fac_dict hfd on
	    a.group_id = hfd.group_id
	    and a.hos_id = hfd.hos_id
	    and a.fac_id = hfd.fac_id
	    and hfd.is_stop = 0  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join hos_store_dict htd on
	    a.group_id = htd.group_id
	    and a.hos_id = htd.hos_id
	    and a.store_id = htd.store_id
	    and htd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    
	    left join hos_emp_dict su on
	    a.group_id = su.group_id
	    and a.hos_id = su.hos_id
		and a.accept_emp = su.emp_id
		and su.is_stop = 0
		
		left join hos_proj_dict hpd on
		a.group_id = hpd.group_id
	    and a.hos_id = hpd.hos_id
	    and a.proj_id = hpd.proj_id
	    and hpd.is_stop = 0  
	    
	    left join ass_usage_dict aud on
	    a.group_id = aud.group_id
	    and a.hos_id = aud.hos_id
	    and a.copy_code = aud.copy_code
	    and a.ass_purpose = aud.equi_usage_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
		<where>                     
			AND a.group_id = #{group_id}
			AND a.hos_id = #{hos_id}
			AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
			<if test="ass_card_no != null and ass_card_no != ''">
			AND (
				upper(a.ass_card_no) like upper('%${ass_card_no}%')
				or ad.ass_name like '%${ass_card_no}%'
				or ad.spell_code like '%${ass_card_no}%'
			)
			</if>
			<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
			AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
			</if>
			<if test="ass_id != null and ass_id != ''">
			AND a.ass_id = to_number(#{ass_id})
			</if>
			<if test="ass_no != null and ass_no != ''">
			AND a.ass_no = to_number(#{ass_no})
			</if>
			<if test="ass_type_id != null and ass_type_id != ''">
			AND atd.ass_type_id = to_number(#{ass_type_id})
			</if>
			<if test="fina_type_code != null and fina_type_code != ''">
			AND atd.acc_type_code = #{fina_type_code}
			</if>
			<if test="gb_code != null and gb_code != ''">
			AND a.gb_code like '%${gb_code}%'
			</if>
			<if test="ass_spec != null and ass_spec != ''">
			AND a.ass_spec = #{ass_spec,jdbcType=VARCHAR}
			</if>
			<if test="ass_mondl != null and ass_mondl != ''">
			AND a.ass_mondl = #{ass_mondl,jdbcType=VARCHAR}
			</if>
			<if test="ass_brand != null and ass_brand != ''">
			AND a.ass_brand = #{ass_brand,jdbcType=VARCHAR}
			</if>
			<if test="ass_amount != null and ass_amount != ''">
			AND a.ass_amount = #{ass_amount}
			</if>
			<if test="unit_code != null and unit_code != ''">
			AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
			</if>
			<if test="fac_id != null and fac_id != ''">
			AND a.fac_id = to_number(#{fac_id})
			</if>
			<if test="fac_no != null and fac_no != ''">
			AND a.fac_no = to_number(#{fac_no})
			</if>
			<if test="ven_id != null and ven_id != ''">
			AND a.ven_id = to_number(#{ven_id})
			</if>
			<if test="ven_no != null and ven_no != ''">
			AND a.ven_no = to_number(#{ven_no})
			</if>
			<if test="proj_id != null and proj_id != ''">
			AND a.proj_id = to_number(#{proj_id})
			</if>
			<if test="proj_no != null and proj_no != ''">
			AND a.proj_no = to_number(#{proj_no})
			</if>
			<if test="is_dept != null and is_dept != ''">
			AND a.is_dept = to_number(#{is_dept})
			</if>
			<if test="dept_id != null and dept_id != ''">
			AND a.dept_id = #{dept_id}
			</if>
			<if test="store_id != null and store_id != ''">
			AND a.store_id = #{store_id}
			</if>
			<if test="store_no != null and store_no != ''">
			AND a.store_no = #{store_no}
			</if>
			<if test="price != null and price != '' and price != '0' and price != 0">
			AND a.price = #{price}
			</if>
			<if test="depre_money != null and depre_money != ''">
			AND a.depre_money = #{depre_money}
			</if>
			<if test="manage_depre_money != null and manage_depre_money != ''">
			AND a.manage_depre_money = #{manage_depre_money}
			</if>
			<if test="cur_money != null and cur_money != ''">
			AND a.cur_money = #{cur_money}
			</if>
			<if test="fore_money != null and fore_money != ''">
			AND a.fore_money = #{fore_money}
			</if>
			<if test="buy_type != null and buy_type != ''">
			AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
			</if>
			<if test="use_state != null and use_state != ''">
			AND a.use_state = to_number(#{use_state})
			</if>
			<if test="is_depr != null and is_depr != ''">
			AND a.is_depr = #{is_depr}
			</if>
			<if test="depr_method != null and depr_method != ''">
			AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
			</if>
			<if test="acc_depre_amount != null and acc_depre_amount != ''">
			AND a.acc_depre_amount = #{acc_depre_amount}
			</if>
			<if test="is_manage_depre != null and is_manage_depre != ''">
			AND a.is_manage_depre = #{is_manage_depre}
			</if>
			<if test="manage_depr_method != null and manage_depr_method != ''">
			AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
			</if>
			<if test="manage_depre_amount != null and manage_depre_amount != ''">
			AND a.manage_depre_amount = #{manage_depre_amount}
			</if>
			<if test="is_measure != null and is_measure != ''">
			AND a.is_measure = #{is_measure}
			</if>
			<if test="is_throw != null and is_throw != ''">
			AND a.is_throw = #{is_throw}
			</if>
			<if test="pact_code != null and pact_code != ''">
			AND a.pact_code = #{pact_code}
			</if>
			<if test="ins_money != null and ins_money != ''">
			AND a.ins_money = #{ins_money}
			</if>
			<if test="ins_date != null and ins_date != ''">
			AND a.ins_date = #{ins_date,jdbcType=DATE}
			</if>
			<if test="accept_emp != null and accept_emp != ''">
			AND a.accept_emp = #{accept_emp}
			</if>
			<if test="accept_date != null and accept_date != ''">
			AND a.accept_date = #{accept_date,jdbcType=DATE}
			</if>
			<if test="service_date != null and service_date != ''">
			AND a.service_date = #{service_date,jdbcType=DATE}
			</if>
			<if test="ass_seq_no != null and ass_seq_no != ''">
			AND a.ass_seq_no = #{ass_seq_no,jdbcType=VARCHAR}
			</if>
			<if test="location != null and location != ''">
			AND a.location like '%${location}%'
			</if>
			<if test="note != null and note != ''">
			AND a.note like '%${note}%'
			</if>
			<if test="ass_in_no != null and ass_in_no != ''">
			AND a.ass_in_no = #{ass_in_no}
			</if>
			<if test="in_date_beg != null and in_date_beg != ''">
			AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
			</if>
			<if test="in_date_end != null and in_date_end != ''">
			AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
			</if>
			<if test="run_date_beg != null and run_date_beg != '' ">
			AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
			</if>
			<if test="run_date_end != null and run_date_end != ''">
			AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
			</if>
			<if test="is_bar != null and is_bar != ''">
			AND a.is_bar = #{is_bar}
			</if>
			<if test="bar_type != null and bar_type != ''">
			AND a.bar_type = #{bar_type}
			</if>
			<if test="bar_code != null and bar_code != ''">
			AND a.bar_code = #{bar_code,jdbcType=VARCHAR}
			</if>
			<if test="bar_url != null and bar_url != ''">
			AND a.bar_url = #{bar_url,jdbcType=VARCHAR}
			</if>
			<if test="car_place != null and car_place != ''">
			AND a.car_place = #{car_place,jdbcType=VARCHAR}
			</if>
			<if test="car_sign != null and car_sign != ''">
			AND a.car_sign = #{car_sign,jdbcType=VARCHAR}
			</if>
			<if test="car_frame != null and car_frame != ''">
			AND a.car_frame = #{car_frame,jdbcType=VARCHAR}
			</if>
			<if test="car_engine != null and car_engine != ''">
			AND a.car_engine = #{car_engine,jdbcType=VARCHAR}
			</if>
			<if test="car_brand != null and car_brand != ''">
			AND a.car_brand = #{car_brand,jdbcType=VARCHAR}
			</if>
			<if test="car_gas != null and car_gas != ''">
			AND a.car_gas = #{car_gas}
			</if>
			<if test="ass_purpose != null and ass_purpose != ''">
			AND a.ass_purpose = #{ass_purpose,jdbcType=VARCHAR}
			</if>
			<if test="man_code != null and man_code != ''">
			and a.man_code = #{man_code,jdbcType=VARCHAR}
			</if>
			<if test="proc_store_id != null and proc_store_id != ''">
			AND a.proc_store_id = to_number(#{proc_store_id})
			</if>
		</where>   
		union all
		
		SELECT 
		      null group_id,
		      null hos_id,
		      null copy_code,
		      '合计' ass_card_no,
		      null ass_ori_card_no,
		      null ass_id,
		      null ass_no,
		      null ass_id_code,
		      null ass_id_name,
		      null gb_code,
		      null ass_spec,
		      null ass_mondl,
		      null ass_brand,
		      null ass_amount,
		      null unit_code,
		      null unit_code_name,
		      null fac_id,
		      null fac_no,
		      null fac_id_code,
		      null fac_id_name,
		      null ven_id,
		      null ven_no,
		      null ven_id_code,
		      null ven_id_name,
		      null is_dept,
		      null is_dept_name,
		      null dept_id,
		      null dept_no,
		      null dept_id_code,
		      null dept_id_name,
		      null store_id,
		      null store_no,
		      null store_id_code,
		      null store_id_name,
		      sum(a.price) price,
		      sum(a.depre_money) depre_money,
		      sum(a.manage_depre_money) manage_depre_money,
		      sum(a.cur_money) cur_money,
		      sum(a.fore_money) fore_money,
		      null buy_type,
		      null buy_type_name,
		      null use_state,
		      null use_state_name,
		      null is_depr,
		      null is_depr_name,
		      null depr_method,
		      null depr_method_name,
		      null acc_depre_amount,
		      null is_manage_depre,
		      null is_manage_depre_name,
		      null manage_depr_method,
		      null manage_depr_method_name,
	          null manage_depre_amount,
	          null is_measure,
	          null is_measure_name,
	          null is_throw,
	          null is_throw_name,
	          null pact_code,
	          sum(a.ins_money) ins_money,
	          null ins_date,
	          null accept_emp,
	          null accept_emp_name,
	          null accept_date,
	          null service_date,
	          null ass_seq_no,
	          null location,
	          null note,
	          null ass_in_no,
	          null in_date,
	          null run_date,
	          null is_bar,
	          null is_bar_name,
	          null bar_type,
	          null bar_type_name,
	          null bar_code,
	          null bar_url,
	          null car_place,
	          null car_sign,
	          null car_frame,
	          null car_engine,
	          null car_brand,
	          null car_gas,
	          null proj_id,
	          null proj_no,
	          null proj_id_code,
	          null proj_id_name,
	          null ass_purpose,
	          null ass_purpose_name,
	          null add_depre_month,
	          null add_manage_month,
	          null contract_code,
	      	  null file_number,
	      	  null man_code,
			  null proc_store_id,
			  null proc_store_no,
			  null proc_store_id_code,
		      null proc_store_id_name  
    FROM ASS_CARD_INIT_GENERAL a
    
      left join ass_no_dict ad on
      a.group_id = ad.group_id
      and a.hos_id = ad.hos_id
      and a.copy_code = ad.copy_code
      and a.ass_id = ad.ass_id
      and ad.is_stop = 0  
      
      left join ass_type_dict atd on
      ad.group_id = atd.group_id
      and ad.hos_id = atd.hos_id
      and ad.copy_code = atd.copy_code
      and ad.ass_type_id = atd.ass_type_id
      and atd.is_stop = 0  
      
      <where>                     
			AND a.group_id = #{group_id}
			AND a.hos_id = #{hos_id}
			AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
			<if test="ass_card_no != null and ass_card_no != ''">
			AND (
				upper(a.ass_card_no) like upper('%${ass_card_no}%')
				or ad.ass_name like '%${ass_card_no}%'
				or ad.spell_code like '%${ass_card_no}%'
			)
			</if>
			<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
			AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
			</if>
			<if test="ass_id != null and ass_id != ''">
			AND a.ass_id = to_number(#{ass_id})
			</if>
			<if test="ass_no != null and ass_no != ''">
			AND a.ass_no = to_number(#{ass_no})
			</if>
			<if test="ass_type_id != null and ass_type_id != ''">
			AND atd.ass_type_id = to_number(#{ass_type_id})
			</if>
			<if test="fina_type_code != null and fina_type_code != ''">
			AND atd.acc_type_code = #{fina_type_code}
			</if>
			<if test="gb_code != null and gb_code != ''">
			AND a.gb_code like '%${gb_code}%'
			</if>
			<if test="ass_spec != null and ass_spec != ''">
			AND a.ass_spec = #{ass_spec,jdbcType=VARCHAR}
			</if>
			<if test="ass_mondl != null and ass_mondl != ''">
			AND a.ass_mondl = #{ass_mondl,jdbcType=VARCHAR}
			</if>
			<if test="ass_brand != null and ass_brand != ''">
			AND a.ass_brand = #{ass_brand,jdbcType=VARCHAR}
			</if>
			<if test="ass_amount != null and ass_amount != ''">
			AND a.ass_amount = #{ass_amount}
			</if>
			<if test="unit_code != null and unit_code != ''">
			AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
			</if>
			<if test="fac_id != null and fac_id != ''">
			AND a.fac_id = to_number(#{fac_id})
			</if>
			<if test="fac_no != null and fac_no != ''">
			AND a.fac_no = to_number(#{fac_no})
			</if>
			<if test="ven_id != null and ven_id != ''">
			AND a.ven_id = to_number(#{ven_id})
			</if>
			<if test="ven_no != null and ven_no != ''">
			AND a.ven_no = to_number(#{ven_no})
			</if>
			<if test="proj_id != null and proj_id != ''">
			AND a.proj_id = to_number(#{proj_id})
			</if>
			<if test="proj_no != null and proj_no != ''">
			AND a.proj_no = to_number(#{proj_no})
			</if>
			<if test="is_dept != null and is_dept != ''">
			AND a.is_dept = to_number(#{is_dept})
			</if>
			<if test="dept_id != null and dept_id != ''">
			AND a.dept_id = #{dept_id}
			</if>
			<if test="store_id != null and store_id != ''">
			AND a.store_id = #{store_id}
			</if>
			<if test="store_no != null and store_no != ''">
			AND a.store_no = #{store_no}
			</if>
			<if test="price != null and price != '' and price != '0' and price != 0">
			AND a.price = #{price}
			</if>
			<if test="depre_money != null and depre_money != ''">
			AND a.depre_money = #{depre_money}
			</if>
			<if test="manage_depre_money != null and manage_depre_money != ''">
			AND a.manage_depre_money = #{manage_depre_money}
			</if>
			<if test="cur_money != null and cur_money != ''">
			AND a.cur_money = #{cur_money}
			</if>
			<if test="fore_money != null and fore_money != ''">
			AND a.fore_money = #{fore_money}
			</if>
			<if test="buy_type != null and buy_type != ''">
			AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
			</if>
			<if test="use_state != null and use_state != ''">
			AND a.use_state = to_number(#{use_state})
			</if>
			<if test="is_depr != null and is_depr != ''">
			AND a.is_depr = #{is_depr}
			</if>
			<if test="depr_method != null and depr_method != ''">
			AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
			</if>
			<if test="acc_depre_amount != null and acc_depre_amount != ''">
			AND a.acc_depre_amount = #{acc_depre_amount}
			</if>
			<if test="is_manage_depre != null and is_manage_depre != ''">
			AND a.is_manage_depre = #{is_manage_depre}
			</if>
			<if test="manage_depr_method != null and manage_depr_method != ''">
			AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
			</if>
			<if test="manage_depre_amount != null and manage_depre_amount != ''">
			AND a.manage_depre_amount = #{manage_depre_amount}
			</if>
			<if test="is_measure != null and is_measure != ''">
			AND a.is_measure = #{is_measure}
			</if>
			<if test="is_throw != null and is_throw != ''">
			AND a.is_throw = #{is_throw}
			</if>
			<if test="pact_code != null and pact_code != ''">
			AND a.pact_code = #{pact_code}
			</if>
			<if test="ins_money != null and ins_money != ''">
			AND a.ins_money = #{ins_money}
			</if>
			<if test="ins_date != null and ins_date != ''">
			AND a.ins_date = #{ins_date,jdbcType=DATE}
			</if>
			<if test="accept_emp != null and accept_emp != ''">
			AND a.accept_emp = #{accept_emp}
			</if>
			<if test="accept_date != null and accept_date != ''">
			AND a.accept_date = #{accept_date,jdbcType=DATE}
			</if>
			<if test="service_date != null and service_date != ''">
			AND a.service_date = #{service_date,jdbcType=DATE}
			</if>
			<if test="ass_seq_no != null and ass_seq_no != ''">
			AND a.ass_seq_no = #{ass_seq_no,jdbcType=VARCHAR}
			</if>
			<if test="location != null and location != ''">
			AND a.location like '%${location}%'
			</if>
			<if test="note != null and note != ''">
			AND a.note like '%${note}%'
			</if>
			<if test="ass_in_no != null and ass_in_no != ''">
			AND a.ass_in_no = #{ass_in_no}
			</if>
			<if test="in_date_beg != null and in_date_beg != ''">
			AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
			</if>
			<if test="in_date_end != null and in_date_end != ''">
			AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
			</if>
			<if test="run_date_beg != null and run_date_beg != '' ">
			AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
			</if>
			<if test="run_date_end != null and run_date_end != ''">
			AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
			</if>
			<if test="is_bar != null and is_bar != ''">
			AND a.is_bar = #{is_bar}
			</if>
			<if test="bar_type != null and bar_type != ''">
			AND a.bar_type = #{bar_type}
			</if>
			<if test="bar_code != null and bar_code != ''">
			AND a.bar_code = #{bar_code,jdbcType=VARCHAR}
			</if>
			<if test="bar_url != null and bar_url != ''">
			AND a.bar_url = #{bar_url,jdbcType=VARCHAR}
			</if>
			<if test="car_place != null and car_place != ''">
			AND a.car_place = #{car_place,jdbcType=VARCHAR}
			</if>
			<if test="car_sign != null and car_sign != ''">
			AND a.car_sign = #{car_sign,jdbcType=VARCHAR}
			</if>
			<if test="car_frame != null and car_frame != ''">
			AND a.car_frame = #{car_frame,jdbcType=VARCHAR}
			</if>
			<if test="car_engine != null and car_engine != ''">
			AND a.car_engine = #{car_engine,jdbcType=VARCHAR}
			</if>
			<if test="car_brand != null and car_brand != ''">
			AND a.car_brand = #{car_brand,jdbcType=VARCHAR}
			</if>
			<if test="car_gas != null and car_gas != ''">
			AND a.car_gas = #{car_gas}
			</if>
			<if test="ass_purpose != null and ass_purpose != ''">
			AND a.ass_purpose = #{ass_purpose,jdbcType=VARCHAR}
			</if>
			<if test="contract_code != null and contract_code != ''">
			AND a.contract_code = #{contract_code,jdbcType=VARCHAR}
			</if>
			<if test="file_number != null and file_number != ''">
			AND a.file_number = #{file_number,jdbcType=VARCHAR}
			</if>
			<if test="man_code != null and man_code != ''">
			and a.man_code = #{man_code,jdbcType=VARCHAR}
			</if>
			<if test="proc_store_id != null and proc_store_id != ''">
			AND a.proc_store_id = to_number(#{proc_store_id})
			</if>
		</where> ) t
		order by t.ass_card_no desc
	</select>
	<select id="queryPrint" parameterType="java.util.Map" resultMap="assCardInitGeneralMap" >
		select * from (
		SELECT 
		      a.group_id,
		      a.hos_id,
		      a.copy_code,
		      a.ass_card_no,
		      a.ass_ori_card_no,
		      a.ass_id,
		      a.ass_no,
		      ad.ass_code ass_id_code,
		      ad.ass_name ass_id_name,
		      a.gb_code,
		      a.ass_spec,
		      a.ass_mondl,
		      a.ass_brand,
		      a.ass_amount,
		      a.unit_code,
		      hu.unit_name unit_code_name,
		      a.fac_id,
		      a.fac_no,
		      hfd.fac_code fac_id_code,
		      hfd.fac_name fac_id_name,
		      a.ven_id,
		      a.ven_no,
		      hsd.sup_code ven_id_code,
		      hsd.sup_name ven_id_name,
		      a.is_dept,
		      case when a.is_dept = 0 then '在库' when a.is_dept = 1 then '在用' else '' end is_dept_name,
		      a.dept_id,
		      a.dept_no,
		      hdd.dept_code dept_id_code,
		      hdd.dept_name dept_id_name,
		      a.store_id,
		      a.store_no,
		      htd.store_code store_id_code,
		      htd.store_name store_id_name,
		      a.price,
		      a.depre_money,
		      a.manage_depre_money,
		      a.cur_money,
		      a.fore_money,
		      a.buy_type,
		      abtd.bus_type_name buy_type_name,
		      a.use_state,
		      acus.state_name use_state_name,
		      a.is_depr,
		      case when a.is_depr = 0  then '否' when a.is_depr = 1 then '是' else '' end is_depr_name,
		      a.depr_method,
		      admd1.ass_depre_name depr_method_name,
		      a.acc_depre_amount,
		      a.is_manage_depre,
		      case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
		      a.manage_depr_method,
		      admd2.ass_depre_name manage_depr_method_name,
		      a.manage_depre_amount,
		      a.is_measure,
		      case when a.is_measure  = 0 then '否' when a.is_measure  = 1 then '是' else '' end is_measure_name,
		      a.is_throw,
		      case when a.is_throw  = 0 then '否' when a.is_throw  = 1 then '是' else '' end is_throw_name,
		      a.pact_code,
		      a.ins_money,
		      a.ins_date,
		      a.accept_emp,
		      su.emp_name accept_emp_name,
		      a.accept_date,
		      a.service_date,
		      a.ass_seq_no,
		      a.location,
		      a.note,
		      a.ass_in_no,
		      a.in_date,
		      a.run_date,
		      a.is_bar,
		      case when a.is_bar = 0 then '否' when a.is_bar = 1 then '是' else '' end is_bar_name,
		      a.bar_type,
		      case when a.bar_type = 1 then '一维条码' when a.bar_type = 2 then '二维条码' else '' end bar_type_name,
		      a.bar_code,
		      a.bar_url,
		      a.car_place,
		      a.car_sign,
		      a.car_frame,
		      a.car_engine,
		      a.car_brand,
		      a.car_gas,
		      a.proj_id,
		      a.proj_no,
		      hpd.proj_code proj_id_code,
		      hpd.proj_name proj_id_name,
		      a.ass_purpose,
		      aud.equi_usage_name ass_purpose_name,
		      a.add_depre_month,
			  a.add_manage_month,
			  a.contract_code,
			  a.file_number,
			  a.man_code,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name  
    FROM ASS_CARD_INIT_GENERAL a
    
	    left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_fac_dict hfd on
	    a.group_id = hfd.group_id
	    and a.hos_id = hfd.hos_id
	    and a.fac_id = hfd.fac_id
	    and hfd.is_stop = 0  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join hos_store_dict htd on
	    a.group_id = htd.group_id
	    and a.hos_id = htd.hos_id
	    and a.store_id = htd.store_id
	    and htd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    
	    left join hos_emp_dict su on
	    a.group_id = su.group_id
	    and a.hos_id = su.hos_id
		and a.accept_emp = su.emp_id
		and su.is_stop = 0
		
		left join hos_proj_dict hpd on
		a.group_id = hpd.group_id
	    and a.hos_id = hpd.hos_id
	    and a.proj_id = hpd.proj_id
	    and hpd.is_stop = 0  
	    
	    left join ass_usage_dict aud on
	    a.group_id = aud.group_id
	    and a.hos_id = aud.hos_id
	    and a.copy_code = aud.copy_code
	    and a.ass_purpose = aud.equi_usage_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
		<where>                     
			AND a.group_id = #{group_id}
			AND a.hos_id = #{hos_id}
			AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
			<if test="ass_card_no != null and ass_card_no != ''">
			AND (
				upper(a.ass_card_no) like upper('%${ass_card_no}%')
				or ad.ass_name like '%${ass_card_no}%'
				or ad.spell_code like '%${ass_card_no}%'
			)
			</if>
			<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
			AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
			</if>
			<if test="ass_id != null and ass_id != ''">
			AND a.ass_id = to_number(#{ass_id})
			</if>
			<if test="ass_no != null and ass_no != ''">
			AND a.ass_no = to_number(#{ass_no})
			</if>
			<if test="ass_type_id != null and ass_type_id != ''">
			AND atd.ass_type_id = to_number(#{ass_type_id})
			</if>
			<if test="fina_type_code != null and fina_type_code != ''">
			AND atd.acc_type_code = #{fina_type_code}
			</if>
			<if test="gb_code != null and gb_code != ''">
			AND a.gb_code like '%${gb_code}%'
			</if>
			<if test="ass_spec != null and ass_spec != ''">
			AND a.ass_spec = #{ass_spec,jdbcType=VARCHAR}
			</if>
			<if test="ass_mondl != null and ass_mondl != ''">
			AND a.ass_mondl = #{ass_mondl,jdbcType=VARCHAR}
			</if>
			<if test="ass_brand != null and ass_brand != ''">
			AND a.ass_brand = #{ass_brand,jdbcType=VARCHAR}
			</if>
			<if test="ass_amount != null and ass_amount != ''">
			AND a.ass_amount = #{ass_amount}
			</if>
			<if test="unit_code != null and unit_code != ''">
			AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
			</if>
			<if test="fac_id != null and fac_id != ''">
			AND a.fac_id = to_number(#{fac_id})
			</if>
			<if test="fac_no != null and fac_no != ''">
			AND a.fac_no = to_number(#{fac_no})
			</if>
			<if test="ven_id != null and ven_id != ''">
			AND a.ven_id = to_number(#{ven_id})
			</if>
			<if test="ven_no != null and ven_no != ''">
			AND a.ven_no = to_number(#{ven_no})
			</if>
			<if test="proj_id != null and proj_id != ''">
			AND a.proj_id = to_number(#{proj_id})
			</if>
			<if test="proj_no != null and proj_no != ''">
			AND a.proj_no = to_number(#{proj_no})
			</if>
			<if test="is_dept != null and is_dept != ''">
			AND a.is_dept = to_number(#{is_dept})
			</if>
			<if test="dept_id != null and dept_id != ''">
			AND a.dept_id = #{dept_id}
			</if>
			<if test="store_id != null and store_id != ''">
			AND a.store_id = #{store_id}
			</if>
			<if test="store_no != null and store_no != ''">
			AND a.store_no = #{store_no}
			</if>
			<if test="price != null and price != '' and price != '0' and price != 0">
			AND a.price = #{price}
			</if>
			<if test="depre_money != null and depre_money != ''">
			AND a.depre_money = #{depre_money}
			</if>
			<if test="manage_depre_money != null and manage_depre_money != ''">
			AND a.manage_depre_money = #{manage_depre_money}
			</if>
			<if test="cur_money != null and cur_money != ''">
			AND a.cur_money = #{cur_money}
			</if>
			<if test="fore_money != null and fore_money != ''">
			AND a.fore_money = #{fore_money}
			</if>
			<if test="buy_type != null and buy_type != ''">
			AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
			</if>
			<if test="use_state != null and use_state != ''">
			AND a.use_state = to_number(#{use_state})
			</if>
			<if test="is_depr != null and is_depr != ''">
			AND a.is_depr = #{is_depr}
			</if>
			<if test="depr_method != null and depr_method != ''">
			AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
			</if>
			<if test="acc_depre_amount != null and acc_depre_amount != ''">
			AND a.acc_depre_amount = #{acc_depre_amount}
			</if>
			<if test="is_manage_depre != null and is_manage_depre != ''">
			AND a.is_manage_depre = #{is_manage_depre}
			</if>
			<if test="manage_depr_method != null and manage_depr_method != ''">
			AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
			</if>
			<if test="manage_depre_amount != null and manage_depre_amount != ''">
			AND a.manage_depre_amount = #{manage_depre_amount}
			</if>
			<if test="is_measure != null and is_measure != ''">
			AND a.is_measure = #{is_measure}
			</if>
			<if test="is_throw != null and is_throw != ''">
			AND a.is_throw = #{is_throw}
			</if>
			<if test="pact_code != null and pact_code != ''">
			AND a.pact_code = #{pact_code}
			</if>
			<if test="ins_money != null and ins_money != ''">
			AND a.ins_money = #{ins_money}
			</if>
			<if test="ins_date != null and ins_date != ''">
			AND a.ins_date = #{ins_date,jdbcType=DATE}
			</if>
			<if test="accept_emp != null and accept_emp != ''">
			AND a.accept_emp = #{accept_emp}
			</if>
			<if test="accept_date != null and accept_date != ''">
			AND a.accept_date = #{accept_date,jdbcType=DATE}
			</if>
			<if test="service_date != null and service_date != ''">
			AND a.service_date = #{service_date,jdbcType=DATE}
			</if>
			<if test="ass_seq_no != null and ass_seq_no != ''">
			AND a.ass_seq_no = #{ass_seq_no,jdbcType=VARCHAR}
			</if>
			<if test="location != null and location != ''">
			AND a.location like '%${location}%'
			</if>
			<if test="note != null and note != ''">
			AND a.note like '%${note}%'
			</if>
			<if test="ass_in_no != null and ass_in_no != ''">
			AND a.ass_in_no = #{ass_in_no}
			</if>
			<if test="in_date_beg != null and in_date_beg != ''">
			AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
			</if>
			<if test="in_date_end != null and in_date_end != ''">
			AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
			</if>
			<if test="run_date_beg != null and run_date_beg != '' ">
			AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
			</if>
			<if test="run_date_end != null and run_date_end != ''">
			AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
			</if>
			<if test="is_bar != null and is_bar != ''">
			AND a.is_bar = #{is_bar}
			</if>
			<if test="bar_type != null and bar_type != ''">
			AND a.bar_type = #{bar_type}
			</if>
			<if test="bar_code != null and bar_code != ''">
			AND a.bar_code = #{bar_code,jdbcType=VARCHAR}
			</if>
			<if test="bar_url != null and bar_url != ''">
			AND a.bar_url = #{bar_url,jdbcType=VARCHAR}
			</if>
			<if test="car_place != null and car_place != ''">
			AND a.car_place = #{car_place,jdbcType=VARCHAR}
			</if>
			<if test="car_sign != null and car_sign != ''">
			AND a.car_sign = #{car_sign,jdbcType=VARCHAR}
			</if>
			<if test="car_frame != null and car_frame != ''">
			AND a.car_frame = #{car_frame,jdbcType=VARCHAR}
			</if>
			<if test="car_engine != null and car_engine != ''">
			AND a.car_engine = #{car_engine,jdbcType=VARCHAR}
			</if>
			<if test="car_brand != null and car_brand != ''">
			AND a.car_brand = #{car_brand,jdbcType=VARCHAR}
			</if>
			<if test="car_gas != null and car_gas != ''">
			AND a.car_gas = #{car_gas}
			</if>
			<if test="ass_purpose != null and ass_purpose != ''">
			AND a.ass_purpose = #{ass_purpose,jdbcType=VARCHAR}
			</if>
			<if test="man_code != null and man_code != ''">
			and a.man_code = #{man_code,jdbcType=VARCHAR}
			</if>
			<if test="proc_store_id != null and proc_store_id != ''">
			AND a.proc_store_id = to_number(#{proc_store_id})
			</if>
		</where>   
		union all
		
		SELECT 
		      null group_id,
		      null hos_id,
		      null copy_code,
		      '合计' ass_card_no,
		      null ass_ori_card_no,
		      null ass_id,
		      null ass_no,
		      null ass_id_code,
		      null ass_id_name,
		      null gb_code,
		      null ass_spec,
		      null ass_mondl,
		      null ass_brand,
		      null ass_amount,
		      null unit_code,
		      null unit_code_name,
		      null fac_id,
		      null fac_no,
		      null fac_id_code,
		      null fac_id_name,
		      null ven_id,
		      null ven_no,
		      null ven_id_code,
		      null ven_id_name,
		      null is_dept,
		      null is_dept_name,
		      null dept_id,
		      null dept_no,
		      null dept_id_code,
		      null dept_id_name,
		      null store_id,
		      null store_no,
		      null store_id_code,
		      null store_id_name,
		      sum(a.price) price,
		      sum(a.depre_money) depre_money,
		      sum(a.manage_depre_money) manage_depre_money,
		      sum(a.cur_money) cur_money,
		      sum(a.fore_money) fore_money,
		      null buy_type,
		      null buy_type_name,
		      null use_state,
		      null use_state_name,
		      null is_depr,
		      null is_depr_name,
		      null depr_method,
		      null depr_method_name,
		      null acc_depre_amount,
		      null is_manage_depre,
		      null is_manage_depre_name,
		      null manage_depr_method,
		      null manage_depr_method_name,
	          null manage_depre_amount,
	          null is_measure,
	          null is_measure_name,
	          null is_throw,
	          null is_throw_name,
	          null pact_code,
	          sum(a.ins_money) ins_money,
	          null ins_date,
	          null accept_emp,
	          null accept_emp_name,
	          null accept_date,
	          null service_date,
	          null ass_seq_no,
	          null location,
	          null note,
	          null ass_in_no,
	          null in_date,
	          null run_date,
	          null is_bar,
	          null is_bar_name,
	          null bar_type,
	          null bar_type_name,
	          null bar_code,
	          null bar_url,
	          null car_place,
	          null car_sign,
	          null car_frame,
	          null car_engine,
	          null car_brand,
	          null car_gas,
	          null proj_id,
	          null proj_no,
	          null proj_id_code,
	          null proj_id_name,
	          null ass_purpose,
	          null ass_purpose_name,
	          null add_depre_month,
	          null add_manage_month,
	          null contract_code,
	      	  null file_number,
	      	  null man_code,
			  null proc_store_id,
			  null proc_store_no,
			  null proc_store_id_code,
		      null proc_store_id_name  
    FROM ASS_CARD_INIT_GENERAL a
    
      left join ass_no_dict ad on
      a.group_id = ad.group_id
      and a.hos_id = ad.hos_id
      and a.copy_code = ad.copy_code
      and a.ass_id = ad.ass_id
      and ad.is_stop = 0  
      
      left join ass_type_dict atd on
      ad.group_id = atd.group_id
      and ad.hos_id = atd.hos_id
      and ad.copy_code = atd.copy_code
      and ad.ass_type_id = atd.ass_type_id
      and atd.is_stop = 0  
      
      <where>                     
			AND a.group_id = #{group_id}
			AND a.hos_id = #{hos_id}
			AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
			<if test="ass_card_no != null and ass_card_no != ''">
			AND (
				upper(a.ass_card_no) like upper('%${ass_card_no}%')
				or ad.ass_name like '%${ass_card_no}%'
				or ad.spell_code like '%${ass_card_no}%'
			)
			</if>
			<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
			AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
			</if>
			<if test="ass_id != null and ass_id != ''">
			AND a.ass_id = to_number(#{ass_id})
			</if>
			<if test="ass_no != null and ass_no != ''">
			AND a.ass_no = to_number(#{ass_no})
			</if>
			<if test="ass_type_id != null and ass_type_id != ''">
			AND atd.ass_type_id = to_number(#{ass_type_id})
			</if>
			<if test="fina_type_code != null and fina_type_code != ''">
			AND atd.acc_type_code = #{fina_type_code}
			</if>
			<if test="gb_code != null and gb_code != ''">
			AND a.gb_code like '%${gb_code}%'
			</if>
			<if test="ass_spec != null and ass_spec != ''">
			AND a.ass_spec = #{ass_spec,jdbcType=VARCHAR}
			</if>
			<if test="ass_mondl != null and ass_mondl != ''">
			AND a.ass_mondl = #{ass_mondl,jdbcType=VARCHAR}
			</if>
			<if test="ass_brand != null and ass_brand != ''">
			AND a.ass_brand = #{ass_brand,jdbcType=VARCHAR}
			</if>
			<if test="ass_amount != null and ass_amount != ''">
			AND a.ass_amount = #{ass_amount}
			</if>
			<if test="unit_code != null and unit_code != ''">
			AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
			</if>
			<if test="fac_id != null and fac_id != ''">
			AND a.fac_id = to_number(#{fac_id})
			</if>
			<if test="fac_no != null and fac_no != ''">
			AND a.fac_no = to_number(#{fac_no})
			</if>
			<if test="ven_id != null and ven_id != ''">
			AND a.ven_id = to_number(#{ven_id})
			</if>
			<if test="ven_no != null and ven_no != ''">
			AND a.ven_no = to_number(#{ven_no})
			</if>
			<if test="proj_id != null and proj_id != ''">
			AND a.proj_id = to_number(#{proj_id})
			</if>
			<if test="proj_no != null and proj_no != ''">
			AND a.proj_no = to_number(#{proj_no})
			</if>
			<if test="is_dept != null and is_dept != ''">
			AND a.is_dept = to_number(#{is_dept})
			</if>
			<if test="dept_id != null and dept_id != ''">
			AND a.dept_id = #{dept_id}
			</if>
			<if test="store_id != null and store_id != ''">
			AND a.store_id = #{store_id}
			</if>
			<if test="store_no != null and store_no != ''">
			AND a.store_no = #{store_no}
			</if>
			<if test="price != null and price != '' and price != '0' and price != 0">
			AND a.price = #{price}
			</if>
			<if test="depre_money != null and depre_money != ''">
			AND a.depre_money = #{depre_money}
			</if>
			<if test="manage_depre_money != null and manage_depre_money != ''">
			AND a.manage_depre_money = #{manage_depre_money}
			</if>
			<if test="cur_money != null and cur_money != ''">
			AND a.cur_money = #{cur_money}
			</if>
			<if test="fore_money != null and fore_money != ''">
			AND a.fore_money = #{fore_money}
			</if>
			<if test="buy_type != null and buy_type != ''">
			AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
			</if>
			<if test="use_state != null and use_state != ''">
			AND a.use_state = to_number(#{use_state})
			</if>
			<if test="is_depr != null and is_depr != ''">
			AND a.is_depr = #{is_depr}
			</if>
			<if test="depr_method != null and depr_method != ''">
			AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
			</if>
			<if test="acc_depre_amount != null and acc_depre_amount != ''">
			AND a.acc_depre_amount = #{acc_depre_amount}
			</if>
			<if test="is_manage_depre != null and is_manage_depre != ''">
			AND a.is_manage_depre = #{is_manage_depre}
			</if>
			<if test="manage_depr_method != null and manage_depr_method != ''">
			AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
			</if>
			<if test="manage_depre_amount != null and manage_depre_amount != ''">
			AND a.manage_depre_amount = #{manage_depre_amount}
			</if>
			<if test="is_measure != null and is_measure != ''">
			AND a.is_measure = #{is_measure}
			</if>
			<if test="is_throw != null and is_throw != ''">
			AND a.is_throw = #{is_throw}
			</if>
			<if test="pact_code != null and pact_code != ''">
			AND a.pact_code = #{pact_code}
			</if>
			<if test="ins_money != null and ins_money != ''">
			AND a.ins_money = #{ins_money}
			</if>
			<if test="ins_date != null and ins_date != ''">
			AND a.ins_date = #{ins_date,jdbcType=DATE}
			</if>
			<if test="accept_emp != null and accept_emp != ''">
			AND a.accept_emp = #{accept_emp}
			</if>
			<if test="accept_date != null and accept_date != ''">
			AND a.accept_date = #{accept_date,jdbcType=DATE}
			</if>
			<if test="service_date != null and service_date != ''">
			AND a.service_date = #{service_date,jdbcType=DATE}
			</if>
			<if test="ass_seq_no != null and ass_seq_no != ''">
			AND a.ass_seq_no = #{ass_seq_no,jdbcType=VARCHAR}
			</if>
			<if test="location != null and location != ''">
			AND a.location like '%${location}%'
			</if>
			<if test="note != null and note != ''">
			AND a.note like '%${note}%'
			</if>
			<if test="ass_in_no != null and ass_in_no != ''">
			AND a.ass_in_no = #{ass_in_no}
			</if>
			<if test="in_date_beg != null and in_date_beg != ''">
			AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
			</if>
			<if test="in_date_end != null and in_date_end != ''">
			AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
			</if>
			<if test="run_date_beg != null and run_date_beg != '' ">
			AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
			</if>
			<if test="run_date_end != null and run_date_end != ''">
			AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
			</if>
			<if test="is_bar != null and is_bar != ''">
			AND a.is_bar = #{is_bar}
			</if>
			<if test="bar_type != null and bar_type != ''">
			AND a.bar_type = #{bar_type}
			</if>
			<if test="bar_code != null and bar_code != ''">
			AND a.bar_code = #{bar_code,jdbcType=VARCHAR}
			</if>
			<if test="bar_url != null and bar_url != ''">
			AND a.bar_url = #{bar_url,jdbcType=VARCHAR}
			</if>
			<if test="car_place != null and car_place != ''">
			AND a.car_place = #{car_place,jdbcType=VARCHAR}
			</if>
			<if test="car_sign != null and car_sign != ''">
			AND a.car_sign = #{car_sign,jdbcType=VARCHAR}
			</if>
			<if test="car_frame != null and car_frame != ''">
			AND a.car_frame = #{car_frame,jdbcType=VARCHAR}
			</if>
			<if test="car_engine != null and car_engine != ''">
			AND a.car_engine = #{car_engine,jdbcType=VARCHAR}
			</if>
			<if test="car_brand != null and car_brand != ''">
			AND a.car_brand = #{car_brand,jdbcType=VARCHAR}
			</if>
			<if test="car_gas != null and car_gas != ''">
			AND a.car_gas = #{car_gas}
			</if>
			<if test="ass_purpose != null and ass_purpose != ''">
			AND a.ass_purpose = #{ass_purpose,jdbcType=VARCHAR}
			</if>
			<if test="contract_code != null and contract_code != ''">
			AND a.contract_code = #{contract_code,jdbcType=VARCHAR}
			</if>
			<if test="file_number != null and file_number != ''">
			AND a.file_number = #{file_number,jdbcType=VARCHAR}
			</if>
			<if test="man_code != null and man_code != ''">
			and a.man_code = #{man_code,jdbcType=VARCHAR}
			</if>
			<if test="proc_store_id != null and proc_store_id != ''">
			AND a.proc_store_id = to_number(#{proc_store_id})
			</if>
		</where> ) t
		order by t.ass_card_no desc
	</select>
	<select id="queryByCode" resultMap="assCardInitGeneral"  parameterType="java.util.Map" >
	
		SELECT 
		      a.group_id,
		      a.hos_id,
		      a.copy_code,
		      a.ass_card_no,
		      a.ass_ori_card_no,
		      a.ass_id,
		      a.ass_no,
		      ad.ass_code ass_id_code,
		      ad.ass_name ass_id_name,
		      a.gb_code,
		      a.gb_code || ' ' || agc.gb_name gb_code_name,
		      a.ass_spec,
		      a.ass_mondl,
		      a.ass_brand,
		      a.ass_amount,
		      a.unit_code,
		      hu.unit_name unit_code_name,
		      a.fac_id,
		      a.fac_no,
		      hfd.fac_code fac_id_code,
		      hfd.fac_name fac_id_name,
		      a.ven_id,
		      a.ven_no,
		      hsd.sup_code ven_id_code,
		      hsd.sup_name ven_id_name,
		      a.is_dept,
		     case when a.is_dept = 0 then '在库' when a.is_dept = 1 then '在用' else '' end is_dept_name,
		      a.dept_id,
		      a.dept_no,
		      hdd.dept_code dept_id_code,
		      hdd.dept_name dept_id_name,
		      a.store_id,
		      a.store_no,
		      htd.store_code store_id_code,
		      htd.store_name store_id_name,
		      a.price,
		      a.depre_money,
		      a.manage_depre_money,
		      a.cur_money,
		      a.fore_money,
		      a.buy_type,
		      abtd.bus_type_name buy_type_name,
		      a.use_state,
		      acus.state_name use_state_name,
		      a.is_depr,
		      case when a.is_depr = 0  then '否' when a.is_depr = 1 then '是' else '' end is_depr_name,
		      a.depr_method,
		      admd1.ass_depre_name depr_method_name,
		      a.acc_depre_amount,
		      a.is_manage_depre,
		      case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
		      a.manage_depr_method,
		      admd2.ass_depre_name manage_depr_method_name,
		      a.manage_depre_amount,
		      a.is_measure,
		      case when a.is_measure  = 0 then '否' when a.is_measure  = 1 then '是' else '' end is_measure_name,
		      a.is_throw,
		      case when a.is_throw  = 0 then '否' when a.is_throw  = 1 then '是' else '' end is_throw_name,
		      a.pact_code,
		      a.ins_money,
		      a.ins_date,
		      a.accept_emp,
		      su.emp_name accept_emp_name,
		      a.accept_date,
		      a.service_date,
		      a.ass_seq_no,
		      a.location,
		      a.note,
		      a.ass_in_no,
		      a.in_date,
		      a.run_date,
		      a.is_bar,
		      case when a.is_bar = 0 then '否' when a.is_bar = 1 then '是' else '' end is_bar_name,
		      a.bar_type,
		      case when a.bar_type = 1 then '一维条码' when a.bar_type = 2 then '二维条码' else '' end bar_type_name,
		      a.bar_code,
		      a.bar_url,
		      a.car_place,
		      a.car_sign,
		      a.car_frame,
		      a.car_engine,
		      a.car_brand,
		      a.car_gas,
		      a.proj_id,
		      a.proj_no,
		      hpd.proj_code proj_id_code,
		      hpd.proj_name proj_id_name,
		      a.ass_purpose,
		      aud.equi_usage_name ass_purpose_name,
		      a.add_depre_month,
			  a.add_manage_month,
			  a.contract_code,
			  a.file_number ,
			  a.man_code,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name  
    FROM ASS_CARD_INIT_GENERAL a
    
	    left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_fac_dict hfd on
	    a.group_id = hfd.group_id
	    and a.hos_id = hfd.hos_id
	    and a.fac_id = hfd.fac_id
	    and hfd.is_stop = 0  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join hos_store_dict htd on
	    a.group_id = htd.group_id
	    and a.hos_id = htd.hos_id
	    and a.store_id = htd.store_id
	    and htd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    
	    left join hos_emp_dict su on
	    a.group_id = su.group_id
	    and a.hos_id = su.hos_id
		and a.accept_emp = su.emp_id
		and su.is_stop = 0
	    
	    left join hos_proj_dict hpd on
		a.group_id = hpd.group_id
	    and a.hos_id = hpd.hos_id
	    and a.proj_id = hpd.proj_id
	    and hpd.is_stop = 0  
	    
	    left join ass_usage_dict aud on
	    a.group_id = aud.group_id
	    and a.hos_id = aud.hos_id
	    and a.copy_code = aud.copy_code
	    and a.ass_purpose = aud.equi_usage_code
	    left  join ass_gb_dict agc
			on
				a.gb_code = agc.gb_code
	
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0			
				
		WHERE 
		a.group_id = #{group_id}   and 
		a.hos_id = #{hos_id}   and 
		a.copy_code = #{copy_code,jdbcType=VARCHAR}   and 
		a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR} 
	
	</select>
	<select id="queryByUniqueness" resultMap="assCardInitGeneral"  parameterType="java.util.Map" >
	
		SELECT 
		      a.group_id,
		      a.hos_id,
		      a.copy_code,
		      a.ass_card_no,
		      a.ass_ori_card_no,
		      a.ass_id,
		      a.ass_no,
		      ad.ass_code ass_id_code,
		      ad.ass_name ass_id_name,
		      a.gb_code,
		      a.ass_spec,
		      a.ass_mondl,
		      a.ass_brand,
		      a.ass_amount,
		      a.unit_code,
		      hu.unit_name unit_code_name,
		      a.fac_id,
		      a.fac_no,
		      hfd.fac_code fac_id_code,
		      hfd.fac_name fac_id_name,
		      a.ven_id,
		      a.ven_no,
		      hsd.sup_code ven_id_code,
		      hsd.sup_name ven_id_name,
		      a.is_dept,
		      case when a.is_dept = 0 then '在库' when a.is_dept = 1 then '在用' else '' end is_dept_name,
		      a.dept_id,
		      a.dept_no,
		      hdd.dept_code dept_id_code,
		      hdd.dept_name dept_id_name,
		      a.store_id,
		      a.store_no,
		      htd.store_code store_id_code,
		      htd.store_name store_id_name,
		      a.price,
		      a.depre_money,
		      a.manage_depre_money,
		      a.cur_money,
		      a.fore_money,
		      a.buy_type,
		      abtd.bus_type_name buy_type_name,
		      a.use_state,
		      acus.state_name use_state_name,
		      a.is_depr,
		      case when a.is_depr = 0  then '否' when a.is_depr = 1 then '是' else '' end is_depr_name,
		      a.depr_method,
		      admd1.ass_depre_name depr_method_name,
		      a.acc_depre_amount,
		      a.is_manage_depre,
		      case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
		      a.manage_depr_method,
		      admd2.ass_depre_name manage_depr_method_name,
		      a.manage_depre_amount,
		      a.is_measure,
		      case when a.is_measure  = 0 then '否' when a.is_measure  = 1 then '是' else '' end is_measure_name,
		      a.is_throw,
		      case when a.is_throw  = 0 then '否' when a.is_throw  = 1 then '是' else '' end is_throw_name,
		      a.pact_code,
		      a.ins_money,
		      a.ins_date,
		      a.accept_emp,
		      su.emp_name accept_emp_name,
		      a.accept_date,
		      a.service_date,
		      a.ass_seq_no,
		      a.location,
		      a.note,
		      a.ass_in_no,
		      a.in_date,
		      a.run_date,
		      a.is_bar,
		      case when a.is_bar = 0 then '否' when a.is_bar = 1 then '是' else '' end is_bar_name,
		      a.bar_type,
		      case when a.bar_type = 1 then '一维条码' when a.bar_type = 2 then '二维条码' else '' end bar_type_name,
		      a.bar_code,
		      a.bar_url,
		      a.car_place,
		      a.car_sign,
		      a.car_frame,
		      a.car_engine,
		      a.car_brand,
		      a.car_gas,
		      a.proj_id,
		      a.proj_no,
		      hpd.proj_code proj_id_code,
		      hpd.proj_name proj_id_name,
		      a.ass_purpose,
		      aud.equi_usage_name ass_purpose_name,
		      a.contract_code,
			  a.file_number ,
			  a.man_code,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name  
    FROM ASS_CARD_INIT_GENERAL a
    
	    left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_fac_dict hfd on
	    a.group_id = hfd.group_id
	    and a.hos_id = hfd.hos_id
	    and a.fac_id = hfd.fac_id
	    and hfd.is_stop = 0  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join hos_store_dict htd on
	    a.group_id = htd.group_id
	    and a.hos_id = htd.hos_id
	    and a.store_id = htd.store_id
	    and htd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    left join hos_emp_dict su on
	    a.group_id = su.group_id
	    and a.hos_id = su.hos_id
		and a.accept_emp = su.emp_id
		and su.is_stop = 0
		
		left join hos_proj_dict hpd on
		a.group_id = hpd.group_id
	    and a.hos_id = hpd.hos_id
	    and a.proj_id = hpd.proj_id
	    and hpd.is_stop = 0  
	    
	    left join ass_usage_dict aud on
	    a.group_id = aud.group_id
	    and a.hos_id = aud.hos_id
	    and a.copy_code = aud.copy_code
	    and a.ass_purpose = aud.equi_usage_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND a.group_id = #{group_id}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND a.hos_id = #{hos_id}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND a.ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = #{ass_id}
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = #{ass_no}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code = #{gb_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_spec != null and ass_spec != ''">
		AND a.ass_spec = #{ass_spec,jdbcType=VARCHAR}
		</if>
		<if test="ass_mondl != null and ass_mondl != ''">
		AND a.ass_mondl = #{ass_mondl,jdbcType=VARCHAR}
		</if>
		<if test="ass_brand != null and ass_brand != ''">
		AND a.ass_brand = #{ass_brand,jdbcType=VARCHAR}
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="fac_id != null and fac_id != ''">
		AND a.fac_id = #{fac_id}
		</if>
		<if test="fac_no != null and fac_no != ''">
		AND a.fac_no = #{fac_no}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = #{ven_id}
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = #{ven_no}
		</if>
		<if test="is_dept != null and is_dept != ''">
		AND a.is_dept = #{is_dept}
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = #{dept_id}
		</if>
		<if test="dept_no != null and dept_no != ''">
		AND a.dept_no = #{dept_no}
		</if>
		<if test="store_id != null and store_id != ''">
		AND a.store_id = #{store_id}
		</if>
		<if test="store_no != null and store_no != ''">
		AND a.store_no = #{store_no}
		</if>
		<if test="price != null and price != ''">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = #{use_state}
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="is_measure != null and is_measure != ''">
		AND a.is_measure = #{is_measure}
		</if>
		<if test="is_throw != null and is_throw != ''">
		AND a.is_throw = #{is_throw}
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="ins_money != null and ins_money != ''">
		AND a.ins_money = #{ins_money}
		</if>
		<if test="ins_date != null and ins_date != ''">
		AND a.ins_date = #{ins_date,jdbcType=DATE}
		</if>
		<if test="accept_emp != null and accept_emp != ''">
		AND a.accept_emp = #{accept_emp}
		</if>
		<if test="accept_date != null and accept_date != ''">
		AND a.accept_date = #{accept_date,jdbcType=DATE}
		</if>
		<if test="service_date != null and service_date != ''">
		AND a.service_date = #{service_date,jdbcType=DATE}
		</if>
		<if test="ass_seq_no != null and ass_seq_no != ''">
		AND a.ass_seq_no = #{ass_seq_no,jdbcType=VARCHAR}
		</if>
		<if test="location != null and location != ''">
		AND a.location = #{location,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note = #{note,jdbcType=VARCHAR}
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="is_bar != null and is_bar != ''">
		AND a.is_bar = #{is_bar}
		</if>
		<if test="bar_type != null and bar_type != ''">
		AND a.bar_type = #{bar_type}
		</if>
		<if test="bar_code != null and bar_code != ''">
		AND a.bar_code = #{bar_code,jdbcType=VARCHAR}
		</if>
		<if test="bar_url != null and bar_url != ''">
		AND a.bar_url = #{bar_url,jdbcType=VARCHAR}
		</if>
		<if test="car_place != null and car_place != ''">
		AND a.car_place = #{car_place,jdbcType=VARCHAR}
		</if>
		<if test="car_sign != null and car_sign != ''">
		AND a.car_sign = #{car_sign,jdbcType=VARCHAR}
		</if>
		<if test="car_frame != null and car_frame != ''">
		AND a.car_frame = #{car_frame,jdbcType=VARCHAR}
		</if>
		<if test="car_engine != null and car_engine != ''">
		AND a.car_engine = #{car_engine,jdbcType=VARCHAR}
		</if>
		<if test="car_brand != null and car_brand != ''">
		AND a.car_brand = #{car_brand,jdbcType=VARCHAR}
		</if>
		<if test="car_gas != null and car_gas != ''">
		AND a.car_gas = #{car_gas}
		</if>
		<if test="man_code != null and man_code != ''">
		and a.man_code = #{man_code,jdbcType=VARCHAR}
		</if>
		</where>   
		order by a.ass_card_no asc
	</select>
	<select id="queryExists" resultMap="assCardInitGeneral"  parameterType="java.util.Map" >
	
		SELECT 
		      a.group_id,
		      a.hos_id,
		      a.copy_code,
		      a.ass_card_no,
		      a.ass_ori_card_no,
		      a.ass_id,
		      a.ass_no,
		      ad.ass_code ass_id_code,
		      ad.ass_name ass_id_name,
		      a.gb_code,
		      a.ass_spec,
		      a.ass_mondl,
		      a.ass_brand,
		      a.ass_amount,
		      a.unit_code,
		      hu.unit_name unit_code_name,
		      a.fac_id,
		      a.fac_no,
		      hfd.fac_code fac_id_code,
		      hfd.fac_name fac_id_name,
		      a.ven_id,
		      a.ven_no,
		      hsd.sup_code ven_id_code,
		      hsd.sup_name ven_id_name,
		      a.is_dept,
		      case when a.is_dept = 0 then '在库' when a.is_dept = 1 then '在用' else '' end is_dept_name,
		      a.dept_id,
		      a.dept_no,
		      hdd.dept_code dept_id_code,
		      hdd.dept_name dept_id_name,
		      a.store_id,
		      a.store_no,
		      htd.store_code store_id_code,
		      htd.store_name store_id_name,
		      a.price,
		      a.depre_money,
		      a.manage_depre_money,
		      a.cur_money,
		      a.fore_money,
		      a.buy_type,
		      abtd.bus_type_name buy_type_name,
		      a.use_state,
		      acus.state_name use_state_name,
		      a.is_depr,
		      case when a.is_depr = 0  then '否' when a.is_depr = 1 then '是' else '' end is_depr_name,
		      a.depr_method,
		      admd1.ass_depre_name depr_method_name,
		      a.acc_depre_amount,
		      a.is_manage_depre,
		      case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
		      a.manage_depr_method,
		      admd2.ass_depre_name manage_depr_method_name,
		      a.manage_depre_amount,
		      a.is_measure,
		      case when a.is_measure  = 0 then '否' when a.is_measure  = 1 then '是' else '' end is_measure_name,
		      a.is_throw,
		      case when a.is_throw  = 0 then '否' when a.is_throw  = 1 then '是' else '' end is_throw_name,
		      a.pact_code,
		      a.ins_money,
		      a.ins_date,
		      a.accept_emp,
		      su.emp_name accept_emp_name,
		      a.accept_date,
		      a.service_date,
		      a.ass_seq_no,
		      a.location,
		      a.note,
		      a.ass_in_no,
		      a.in_date,
		      a.run_date,
		      a.is_bar,
		      case when a.is_bar = 0 then '否' when a.is_bar = 1 then '是' else '' end is_bar_name,
		      a.bar_type,
		      case when a.bar_type = 1 then '一维条码' when a.bar_type = 2 then '二维条码' else '' end bar_type_name,
		      a.bar_code,
		      a.bar_url,
		      a.car_place,
		      a.car_sign,
		      a.car_frame,
		      a.car_engine,
		      a.car_brand,
		      a.car_gas,
		      a.proj_id,
		      a.proj_no,
		      hpd.proj_code proj_id_code,
		      hpd.proj_name proj_id_name,
		      a.ass_purpose,
		      aud.equi_usage_name ass_purpose_name,
		      a.contract_code,
			  a.file_number,
			  a.man_code,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name  
    FROM ASS_CARD_INIT_GENERAL a
    
	    left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_fac_dict hfd on
	    a.group_id = hfd.group_id
	    and a.hos_id = hfd.hos_id
	    and a.fac_id = hfd.fac_id
	    and hfd.is_stop = 0  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join hos_store_dict htd on
	    a.group_id = htd.group_id
	    and a.hos_id = htd.hos_id
	    and a.store_id = htd.store_id
	    and htd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    
	    left join hos_emp_dict su on
	    a.group_id = su.group_id
	    and a.hos_id = su.hos_id
		and a.accept_emp = su.emp_id
		and su.is_stop = 0
		
		left join hos_proj_dict hpd on
		a.group_id = hpd.group_id
	    and a.hos_id = hpd.hos_id
	    and a.proj_id = hpd.proj_id
	    and hpd.is_stop = 0  
	    
	    left join ass_usage_dict aud on
	    a.group_id = aud.group_id
	    and a.hos_id = aud.hos_id
	    and a.copy_code = aud.copy_code
	    and a.ass_purpose = aud.equi_usage_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
		<where>                     
			<if test="group_id != null and group_id != ''">
			AND a.group_id = #{group_id}
			</if>
			<if test="hos_id != null and hos_id != ''">
			AND a.hos_id = #{hos_id}
			</if>
			<if test="copy_code != null and copy_code != ''">
			AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="ass_card_no != null and ass_card_no != ''">
			AND a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
			</if>
			<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
			AND a.ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
			</if>
			<if test="ass_id != null and ass_id != ''">
			AND a.ass_id = #{ass_id}
			</if>
			<if test="ass_no != null and ass_no != ''">
			AND a.ass_no = #{ass_no}
			</if>
			<if test="gb_code != null and gb_code != ''">
			AND a.gb_code = #{gb_code,jdbcType=VARCHAR}
			</if>
			<if test="ass_spec != null and ass_spec != ''">
			AND a.ass_spec = #{ass_spec,jdbcType=VARCHAR}
			</if>
			<if test="ass_mondl != null and ass_mondl != ''">
			AND a.ass_mondl = #{ass_mondl,jdbcType=VARCHAR}
			</if>
			<if test="ass_brand != null and ass_brand != ''">
			AND a.ass_brand = #{ass_brand,jdbcType=VARCHAR}
			</if>
			<if test="ass_amount != null and ass_amount != ''">
			AND a.ass_amount = #{ass_amount}
			</if>
			<if test="unit_code != null and unit_code != ''">
			AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
			</if>
			<if test="fac_id != null and fac_id != ''">
			AND a.fac_id = #{fac_id}
			</if>
			<if test="fac_no != null and fac_no != ''">
			AND a.ac_no = #{fac_no}
			</if>
			<if test="ven_id != null and ven_id != ''">
			AND a.ven_id = #{ven_id}
			</if>
			<if test="ven_no != null and ven_no != ''">
			AND a.ven_no = #{ven_no}
			</if>
			<if test="is_dept != null and is_dept != ''">
			AND a.is_dept = #{is_dept}
			</if>
			<if test="dept_id != null and dept_id != ''">
			AND a.dept_id = #{dept_id}
			</if>
			<if test="dept_no != null and dept_no != ''">
			AND a.dept_no = #{dept_no}
			</if>
			<if test="store_id != null and store_id != ''">
			AND a.store_id = #{store_id}
			</if>
			<if test="store_no != null and store_no != ''">
			AND a.store_no = #{store_no}
			</if>
			<if test="price != null and price != ''">
			AND a.price = #{price}
			</if>
			<if test="depre_money != null and depre_money != ''">
			AND a.depre_money = #{depre_money}
			</if>
			<if test="manage_depre_money != null and manage_depre_money != ''">
			AND a.manage_depre_money = #{manage_depre_money}
			</if>
			<if test="cur_money != null and cur_money != ''">
			AND a.cur_money = #{cur_money}
			</if>
			<if test="fore_money != null and fore_money != ''">
			AND a.fore_money = #{fore_money}
			</if>
			<if test="buy_type != null and buy_type != ''">
			AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
			</if>
			<if test="use_state != null and use_state != ''">
			AND a.use_state = #{use_state}
			</if>
			<if test="is_depr != null and is_depr != ''">
			AND a.is_depr = #{is_depr}
			</if>
			<if test="depr_method != null and depr_method != ''">
			AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
			</if>
			<if test="acc_depre_amount != null and acc_depre_amount != ''">
			AND a.acc_depre_amount = #{acc_depre_amount}
			</if>
			<if test="is_manage_depre != null and is_manage_depre != ''">
			AND a.is_manage_depre = #{is_manage_depre}
			</if>
			<if test="manage_depr_method != null and manage_depr_method != ''">
			AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
			</if>
			<if test="manage_depre_amount != null and manage_depre_amount != ''">
			AND a.manage_depre_amount = #{manage_depre_amount}
			</if>
			<if test="is_measure != null and is_measure != ''">
			AND a.is_measure = #{is_measure}
			</if>
			<if test="is_throw != null and is_throw != ''">
			AND a.is_throw = #{is_throw}
			</if>
			<if test="pact_code != null and pact_code != ''">
			AND a.pact_code = #{pact_code}
			</if>
			<if test="ins_money != null and ins_money != ''">
			AND a.ins_money = #{ins_money}
			</if>
			<if test="ins_date != null and ins_date != ''">
			AND a.ins_date = #{ins_date,jdbcType=DATE}
			</if>
			<if test="accept_emp != null and accept_emp != ''">
			AND a.accept_emp = #{accept_emp}
			</if>
			<if test="accept_date != null and accept_date != ''">
			AND a.accept_date = #{accept_date,jdbcType=DATE}
			</if>
			<if test="service_date != null and service_date != ''">
			AND a.service_date = #{service_date,jdbcType=DATE}
			</if>
			<if test="ass_seq_no != null and ass_seq_no != ''">
			AND a.ass_seq_no = #{ass_seq_no,jdbcType=VARCHAR}
			</if>
			<if test="location != null and location != ''">
			AND a.location = #{location,jdbcType=VARCHAR}
			</if>
			<if test="note != null and note != ''">
			AND a.note = #{note,jdbcType=VARCHAR}
			</if>
			<if test="ass_in_no != null and ass_in_no != ''">
			AND a.ass_in_no = #{ass_in_no}
			</if>
			<if test="in_date != null and in_date != ''">
			AND a.in_date = #{in_date,jdbcType=DATE}
			</if>
			<if test="run_date != null and run_date != ''">
			AND a.run_date = #{run_date,jdbcType=DATE}
			</if>
			<if test="is_bar != null and is_bar != ''">
			AND a.is_bar = #{is_bar}
			</if>
			<if test="bar_type != null and bar_type != ''">
			AND a.bar_type = #{bar_type}
			</if>
			<if test="bar_code != null and bar_code != ''">
			AND a.bar_code = #{bar_code,jdbcType=VARCHAR}
			</if>
			<if test="bar_url != null and bar_url != ''">
			AND a.bar_url = #{bar_url,jdbcType=VARCHAR}
			</if>
			<if test="car_place != null and car_place != ''">
			AND a.car_place = #{car_place,jdbcType=VARCHAR}
			</if>
			<if test="car_sign != null and car_sign != ''">
			AND a.car_sign = #{car_sign,jdbcType=VARCHAR}
			</if>
			<if test="car_frame != null and car_frame != ''">
			AND a.car_frame = #{car_frame,jdbcType=VARCHAR}
			</if>
			<if test="car_engine != null and car_engine != ''">
			AND a.car_engine = #{car_engine,jdbcType=VARCHAR}
			</if>
			<if test="car_brand != null and car_brand != ''">
			AND a.car_brand = #{car_brand,jdbcType=VARCHAR}
			</if>
			<if test="car_gas != null and car_gas != ''">
			AND a.car_gas = #{car_gas}
			</if>
			<if test="man_code != null and man_code != ''">
			and a.man_code = #{man_code,jdbcType=VARCHAR}
			</if>
		</where>   
		order by a.ass_card_no asc
	</select>
	
	<select id="queryByAssOriCardNo" parameterType="java.util.Map" resultType="java.lang.Integer">
		SELECT count(0) 
		FROM ASS_CARD_INIT_GENERAL 
		WHERE 
			group_id = #{group_id}
			AND hos_id = #{hos_id}
			AND copy_code = #{copy_code}
			AND ass_ori_card_no = #{ass_ori_card_no}
	</select>
	
	<select id="queryCardByMap" parameterType="java.util.Map" resultMap="assCardInitGeneralMap" >
		SELECT 
		      a.group_id,
		      a.hos_id,
		      a.copy_code,
		      a.ass_card_no 
    FROM ASS_CARD_INIT_GENERAL a
		<where>                     
			AND a.group_id = #{group_id}
			AND a.hos_id = #{hos_id}
			AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		</where>   
		order by a.ass_card_no desc
	</select>
</mapper>

