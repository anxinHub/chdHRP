<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chd.hrp.cost.dao.analysis.c05.C05Mapper">

	<resultMap id="c0501" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="id" column="id" />
		<result property="item_code" column="item_code" />
		<result property="item_name" column="item_name" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="hos_code" column="hos_code" />
		<result property="hos_name" column="hos_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
		<result property="t_7" column="t_7" />
		<result property="t_8" column="t_8" />
		<result property="t_9" column="t_9" />
		<result property="t_10" column="t_10" />
		<result property="t_11" column="t_11" />
		<result property="t_12" column="t_12" />
		<result property="t_13" column="t_13" />
	</resultMap>

	<insert id="addAnalysisC0501" parameterType="java.util.Map">
		INSERT INTO cost_c0501
		(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!-- , t_8, t_9, t_10, t_11, t_12, t_13 -->
		)

		select
		cidn.group_id,cidn.hos_id,cidn.copy_code,#{acc_year,jdbcType=VARCHAR},#{acc_month,jdbcType=VARCHAR},
		cidn.cost_item_code,cidn.cost_item_name,
		item.t1,item.t2, item.t3, item.t4, item.t5, item.t6, item.t7
		from cost_item_dict_no cidn
		left join
		(select
		a.group_id,a.hos_id,a.copy_code,a.acc_year,a.acc_month,a.cost_item_id,a.cost_item_no,
		a.dir_amount t1 ,b.dir_amount t2,
		nvl(a.dir_amount,0) - nvl(b.dir_amount,0) t3 , (a.dir_amount / b.dir_amount) * 100 t4,
		c.dir_amount t5,
		nvl(a.dir_amount,0) - nvl(c.dir_amount,0) t6 , (a.dir_amount / c.dir_amount) * 100 t7
		from
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		#{year_month,jdbcType=VARCHAR} and
		cdcd.source_id in (select source_id from hos_source where source_code not in
		('002','003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		)a
		left join
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('002','003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		)b on a.group_id = b.group_id and a.hos_id = b.hos_id and a.copy_code =
		b.copy_code
		and a.acc_year = b.acc_year and a.acc_month = b.acc_month
		and a.cost_item_id = b.cost_item_id and a.cost_item_no = b.cost_item_no
		left join
		(
		select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('002','003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		) c on a.group_id = c.group_id and a.hos_id = c.hos_id and a.copy_code
		= c.copy_code
		and a.acc_year = c.acc_year and a.acc_month = c.acc_month
		and a.cost_item_id = c.cost_item_id and a.cost_item_no = c.cost_item_no
		)item on item.group_id = cidn.group_id and item.hos_id = cidn.hos_id
		and item.copy_code = cidn.copy_code and item.cost_item_id =
		cidn.cost_item_id
		and item.cost_item_no = cidn.cost_item_no
		order by cidn.cost_item_code
	</insert>

	<delete id="deleteAnalysisC0501">

		delete from cost_c0501
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0501" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0501
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
			
		</where>
			)select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>
	
	<select id="queryC0501Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0501
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
			
		</where>
			)select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>

	<insert id="addAnalysisC0502" parameterType="java.util.Map">
		INSERT INTO cost_c0502
		(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!-- , t_8, t_9, t_10, t_11, t_12, t_13 -->
		)
		select
		cidn.group_id,cidn.hos_id,cidn.copy_code,#{acc_year,jdbcType=VARCHAR},#{acc_month,jdbcType=VARCHAR},
		cidn.cost_item_code,cidn.cost_item_name,
		item.t1,item.t2, item.t3, item.t4, item.t5, item.t6, item.t7
		from cost_item_dict_no cidn
		left join
		(select
		a.group_id,a.hos_id,a.copy_code,a.acc_year,a.acc_month,a.cost_item_id,a.cost_item_no,
		a.dir_amount t1 ,b.dir_amount t2,
		nvl(a.dir_amount,0) - nvl(b.dir_amount,0) t3 , (a.dir_amount / b.dir_amount) * 100 t4,
		c.dir_amount t5,
		nvl(a.dir_amount,0) - nvl(c.dir_amount,0) t6 , (a.dir_amount / c.dir_amount) * 100 t7
		from
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		#{year_month,jdbcType=VARCHAR} and
		cdcd.source_id in (select source_id from hos_source where source_code not in
		('003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		)a
		left join
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		)b on a.group_id = b.group_id and a.hos_id = b.hos_id and a.copy_code =
		b.copy_code
		and a.acc_year = b.acc_year and a.acc_month = b.acc_month
		and a.cost_item_id = b.cost_item_id and a.cost_item_no = b.cost_item_no
		left join
		(
		select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		) c on a.group_id = c.group_id and a.hos_id = c.hos_id and a.copy_code
		= c.copy_code
		and a.acc_year = c.acc_year and a.acc_month = c.acc_month
		and a.cost_item_id = c.cost_item_id and a.cost_item_no = c.cost_item_no
		)item on item.group_id = cidn.group_id and item.hos_id = cidn.hos_id
		and item.copy_code = cidn.copy_code and item.cost_item_id =
		cidn.cost_item_id
		and item.cost_item_no = cidn.cost_item_no
		order by cidn.cost_item_code
	</insert>

	<delete id="deleteAnalysisC0502">

		delete from cost_c0502
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0502" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0502
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		 )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>
	
	<select id="queryC0502Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0502
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		 )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>

	<insert id="addAnalysisC0503" parameterType="java.util.Map">
		INSERT INTO cost_c0503
		(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!-- , t_8, t_9, t_10, t_11, t_12, t_13 -->
		)
		select
		cidn.group_id,cidn.hos_id,cidn.copy_code,#{acc_year,jdbcType=VARCHAR},#{acc_month,jdbcType=VARCHAR},
		cidn.cost_item_code,cidn.cost_item_name,
		item.t1,item.t2, item.t3, item.t4, item.t5, item.t6, item.t7
		from cost_item_dict_no cidn
		left join
		(select
		a.group_id,a.hos_id,a.copy_code,a.acc_year,a.acc_month,a.cost_item_id,a.cost_item_no,
		a.dir_amount t1 ,b.dir_amount t2,
		nvl(a.dir_amount,0) - nvl(b.dir_amount,0) t3 , (a.dir_amount / b.dir_amount) * 100 t4,
		c.dir_amount t5,
		nvl(a.dir_amount,0) - nvl(c.dir_amount,0) t6 , (a.dir_amount / c.dir_amount) * 100 t7
		from
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		#{year_month,jdbcType=VARCHAR} and
		cdcd.source_id in (select source_id from hos_source where source_code not in
		('002'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		)a
		left join
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('002'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		)b on a.group_id = b.group_id and a.hos_id = b.hos_id and a.copy_code =
		b.copy_code
		and a.acc_year = b.acc_year and a.acc_month = b.acc_month
		and a.cost_item_id = b.cost_item_id and a.cost_item_no = b.cost_item_no
		left join
		(
		select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('002'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		) c on a.group_id = c.group_id and a.hos_id = c.hos_id and a.copy_code
		= c.copy_code
		and a.acc_year = c.acc_year and a.acc_month = c.acc_month
		and a.cost_item_id = c.cost_item_id and a.cost_item_no = c.cost_item_no
		)item on item.group_id = cidn.group_id and item.hos_id = cidn.hos_id
		and item.copy_code = cidn.copy_code and item.cost_item_id =
		cidn.cost_item_id
		and item.cost_item_no = cidn.cost_item_no
		order by cidn.cost_item_code
	</insert>

	<delete id="deleteAnalysisC0503">

		delete from cost_c0503
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0503" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0503
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		 )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>

    <select id="queryC0503Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0503
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		 )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>

	<insert id="addAnalysisC0504" parameterType="java.util.Map">
		INSERT INTO cost_c0504
		(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!-- , t_8, t_9, t_10, t_11, t_12, t_13 -->
		)
		select
		cidn.group_id,cidn.hos_id,cidn.copy_code,#{acc_year,jdbcType=VARCHAR},#{acc_month,jdbcType=VARCHAR},
		cidn.cost_item_code,cidn.cost_item_name,
		item.t1,item.t2, item.t3, item.t4, item.t5, item.t6, item.t7
		from cost_item_dict_no cidn
		left join
		(select
		a.group_id,a.hos_id,a.copy_code,a.acc_year,a.acc_month,a.cost_item_id,a.cost_item_no,
		a.dir_amount t1 ,b.dir_amount t2,
		nvl(a.dir_amount,0) - nvl(b.dir_amount,0) t3 , (a.dir_amount / b.dir_amount) * 100 t4,
		c.dir_amount t5,
		nvl(a.dir_amount,0) - nvl(c.dir_amount,0) t6 , (a.dir_amount / c.dir_amount) * 100 t7
		from
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		#{year_month,jdbcType=VARCHAR}
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		)a
		left join
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'mm')
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		)b on a.group_id = b.group_id and a.hos_id = b.hos_id and a.copy_code =
		b.copy_code
		and a.acc_year = b.acc_year and a.acc_month = b.acc_month
		and a.cost_item_id = b.cost_item_id and a.cost_item_no = b.cost_item_no
		left join
		(
		select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'mm')
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.cost_item_id,cdcd.cost_item_no
		) c on a.group_id = c.group_id and a.hos_id = c.hos_id and a.copy_code
		= c.copy_code
		and a.acc_year = c.acc_year and a.acc_month = c.acc_month
		and a.cost_item_id = c.cost_item_id and a.cost_item_no = c.cost_item_no
		)item on item.group_id = cidn.group_id and item.hos_id = cidn.hos_id
		and item.copy_code = cidn.copy_code and item.cost_item_id =
		cidn.cost_item_id
		and item.cost_item_no = cidn.cost_item_no
		order by cidn.cost_item_code
	</insert>

	<delete id="deleteAnalysisC0504">

		delete from cost_c0504
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0504" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0504
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		  )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>
	
	<select id="queryC0504Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0504
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		  )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>
	
	<insert id="addAnalysisC0505" parameterType="java.util.Map">

		INSERT INTO cost_c0505
		(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!-- , t_8, t_9, t_10, t_11, t_12, t_13 -->
		)
		select
		#{group_id}, #{hos_id},#{copy_code,jdbcType=VARCHAR} ,#{acc_year,jdbcType=VARCHAR}
		,#{acc_month,jdbcType=VARCHAR} ,
		hdd.dept_code,hdd.dept_name,
		item.t1,item.t2, item.t3, item.t4, item.t5, item.t6, item.t7
		from hos_dept_dict hdd
		left join
		(select
		a.group_id,a.hos_id,a.copy_code,a.acc_year,a.acc_month,a.dept_id,a.dept_no,
		a.dir_amount t1 ,b.dir_amount t2,
		nvl(a.dir_amount,0) - nvl(b.dir_amount,0) t3 , (a.dir_amount / b.dir_amount) * 100 t4,
		c.dir_amount t5,
		nvl(a.dir_amount,0) - nvl(c.dir_amount,0) t6 , (a.dir_amount / c.dir_amount) * 100 t7
		from
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		#{year_month,jdbcType=VARCHAR} and
		cdcd.source_id in (select source_id from hos_source where source_code not in
		('002','003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		)a
		left join
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('002','003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		)b on a.group_id = b.group_id and a.hos_id = b.hos_id and a.copy_code =
		b.copy_code
		and a.acc_year = b.acc_year and a.acc_month = b.acc_month
		and a.dept_id = b.dept_id and a.dept_no = b.dept_no
		left join
		(
		select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('002','003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		) c on a.group_id = c.group_id and a.hos_id = c.hos_id and a.copy_code
		= c.copy_code
		and a.acc_year = c.acc_year and a.acc_month = c.acc_month
		and a.dept_id = c.dept_id and a.dept_no = c.dept_no
		)item on item.group_id = hdd.group_id and item.hos_id = hdd.hos_id
		and item.dept_id = hdd.dept_id and item.dept_no = hdd.dept_no
		order by hdd.dept_code
	</insert>
	<delete id="deleteAnalysisC0505">

		delete from cost_c0505
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0505" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0505 t1

		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
			and exists(select 1 from hos_dept
			t2
			left join acc_dept_attr t3 on t2.group_id=t3.group_id and
			t2.hos_id=t3.hos_id and t2.dept_id=t3.dept_id
			where t1.group_id=t2.group_id and t1.hos_id=t2.hos_id and
			t1.dept_code=t2.dept_code and type_code not in('04'))
		</where>
		  )select acc_year,
		dept_code,dept_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		dept_code,dept_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by dept_code
	</select>
	
	<select id="queryC0505Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0505 t1

		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
			and exists(select 1 from hos_dept
			t2
			left join acc_dept_attr t3 on t2.group_id=t3.group_id and
			t2.hos_id=t3.hos_id and t2.dept_id=t3.dept_id
			where t1.group_id=t2.group_id and t1.hos_id=t2.hos_id and
			t1.dept_code=t2.dept_code and type_code not in('04'))
		</where>
		  )select acc_year,
		dept_code,dept_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		dept_code,dept_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by dept_code
	</select>

	<insert id="addAnalysisC0506" parameterType="java.util.Map">

		INSERT INTO cost_c0506
		(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!-- , t_8, t_9, t_10, t_11, t_12, t_13 -->
		)
		select
		#{group_id}, #{hos_id},#{copy_code,jdbcType=VARCHAR} ,#{acc_year,jdbcType=VARCHAR}
		,#{acc_month,jdbcType=VARCHAR},
		hdd.dept_code,hdd.dept_name,
		item.t1,item.t2, item.t3, item.t4, item.t5, item.t6, item.t7
		from hos_dept_dict hdd
		left join
		(select
		a.group_id,a.hos_id,a.copy_code,a.acc_year,a.acc_month,a.dept_id,a.dept_no,
		a.dir_amount t1 ,b.dir_amount t2,
		nvl(a.dir_amount,0) - nvl(b.dir_amount,0) t3 , (a.dir_amount / b.dir_amount) * 100 t4,
		c.dir_amount t5,
		nvl(a.dir_amount,0) - nvl(c.dir_amount,0) t6 , (a.dir_amount / c.dir_amount) * 100 t7
		from
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		#{year_month,jdbcType=VARCHAR} and
		cdcd.source_id in (select source_id from hos_source where source_code not in
		('003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		)a
		left join
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		)b on a.group_id = b.group_id and a.hos_id = b.hos_id and a.copy_code =
		b.copy_code
		and a.acc_year = b.acc_year and a.acc_month = b.acc_month
		and a.dept_id = b.dept_id and a.dept_no = b.dept_no
		left join
		(
		select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('003','004'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		) c on a.group_id = c.group_id and a.hos_id = c.hos_id and a.copy_code
		= c.copy_code
		and a.acc_year = c.acc_year and a.acc_month = c.acc_month
		and a.dept_id = c.dept_id and a.dept_no = c.dept_no
		)item on item.group_id = hdd.group_id and item.hos_id = hdd.hos_id
		and item.dept_id = hdd.dept_id and item.dept_no = hdd.dept_no
		order by hdd.dept_code
	</insert>
	<delete id="deleteAnalysisC0506">

		delete from cost_c0506
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0506" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0506
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		 )select acc_year,
		dept_code,dept_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		dept_code,dept_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by dept_code
	</select>
	
	<select id="queryC0506Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0506
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		 )select acc_year,
		dept_code,dept_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		dept_code,dept_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by dept_code
	</select>


	<insert id="addAnalysisC0507" parameterType="java.util.Map">

		INSERT INTO cost_c0507
		(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!-- , t_8, t_9, t_10, t_11, t_12, t_13 -->
		)
		select
		#{group_id}, #{hos_id},#{copy_code,jdbcType=VARCHAR} ,#{acc_year,jdbcType=VARCHAR}
		,#{acc_month,jdbcType=VARCHAR} ,
		hdd.dept_code,hdd.dept_name,
		item.t1,item.t2, item.t3, item.t4, item.t5, item.t6, item.t7
		from hos_dept_dict hdd
		left join
		(select
		a.group_id,a.hos_id,a.copy_code,a.acc_year,a.acc_month,a.dept_id,a.dept_no,
		a.dir_amount t1 ,b.dir_amount t2,
		nvl(a.dir_amount,0) - nvl(b.dir_amount,0) t3 , (a.dir_amount / b.dir_amount) * 100 t4,
		c.dir_amount t5,
		nvl(a.dir_amount,0) - nvl(c.dir_amount,0) t6 , (a.dir_amount / c.dir_amount) * 100 t7
		from
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		#{year_month,jdbcType=VARCHAR} and
		cdcd.source_id in (select source_id from hos_source where source_code not in
		('002'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		)a
		left join
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('002'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		)b on a.group_id = b.group_id and a.hos_id = b.hos_id and a.copy_code =
		b.copy_code
		and a.acc_year = b.acc_year and a.acc_month = b.acc_month
		and a.dept_id = b.dept_id and a.dept_no = b.dept_no
		left join
		(
		select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'mm')
		and cdcd.source_id in (select source_id from hos_source where source_code
		not in ('002'))
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		) c on a.group_id = c.group_id and a.hos_id = c.hos_id and a.copy_code
		= c.copy_code
		and a.acc_year = c.acc_year and a.acc_month = c.acc_month
		and a.dept_id = c.dept_id and a.dept_no = c.dept_no
		)item on item.group_id = hdd.group_id and item.hos_id = hdd.hos_id
		and item.dept_id = hdd.dept_id and item.dept_no = hdd.dept_no
		order by hdd.dept_code
	</insert>

	<delete id="deleteAnalysisC0507">

		delete from cost_c0507
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0507" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0507
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month}
			</if>
 -->		
           <!--  <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
 </where>
		 )select acc_year,
		dept_code,dept_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		dept_code,dept_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by dept_code
	</select>

    <select id="queryC0507Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0507
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month}
			</if>
 -->		
           <!--  <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
 </where>
		 )select acc_year,
		dept_code,dept_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		dept_code,dept_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by dept_code
	</select>

	<insert id="addAnalysisC0508" parameterType="java.util.Map">

		INSERT INTO cost_c0508
		(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!-- , t_8, t_9, t_10, t_11, t_12, t_13 -->
		)
		select
		#{group_id}, #{hos_id},#{copy_code,jdbcType=VARCHAR} ,#{acc_year,jdbcType=VARCHAR}
		,#{acc_month,jdbcType=VARCHAR} ,
		hdd.dept_code,hdd.dept_name,
		item.t1,item.t2, item.t3, item.t4, item.t5, item.t6, item.t7
		from hos_dept_dict hdd
		left join
		(select
		a.group_id,a.hos_id,a.copy_code,a.acc_year,a.acc_month,a.dept_id,a.dept_no,
		a.dir_amount t1 ,b.dir_amount t2,
		nvl(a.dir_amount,0) - nvl(b.dir_amount,0) t3 , (a.dir_amount / b.dir_amount) * 100 t4,
		c.dir_amount t5,
		nvl(a.dir_amount,0) - nvl(c.dir_amount,0) t6 , (a.dir_amount / c.dir_amount) * 100 t7
		from
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		#{year_month,jdbcType=VARCHAR}
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		)a
		left join
		(select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-12),'mm')
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		)b on a.group_id = b.group_id and a.hos_id = b.hos_id and a.copy_code =
		b.copy_code
		and a.acc_year = b.acc_year and a.acc_month = b.acc_month
		and a.dept_id = b.dept_id and a.dept_no = b.dept_no
		left join
		(
		select
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no,sum(dir_amount) dir_amount
		from cost_dept_cost_data cdcd
		left join hos_dept_dict hdd on hdd.group_id = cdcd.group_id and hdd.hos_id
		= cdcd.hos_id
		and hdd.dept_id = cdcd.dept_id and cdcd.dept_no = cdcd.dept_no
		left join acc_dept_attr ada on ada.group_id = hdd.group_id and ada.hos_id
		= hdd.hos_id
		and ada.dept_id = hdd.dept_id
		where cdcd.acc_year || '' || cdcd.acc_month =
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'yyyy') ||''||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || '' ||
		'01','yyyymmdd'),-1),'mm')
		and ada.type_code in (select type_code from acc_dept_type where type_code
		= '04')
		and hdd.is_stop = '0'
		and cdcd.dir_amount != 0
		group by
		cdcd.group_id,cdcd.hos_id,cdcd.copy_code,cdcd.acc_year,cdcd.acc_month,
		cdcd.dept_id,cdcd.dept_no
		) c on a.group_id = c.group_id and a.hos_id = c.hos_id and a.copy_code
		= c.copy_code
		and a.acc_year = c.acc_year and a.acc_month = c.acc_month
		and a.dept_id = c.dept_id and a.dept_no = c.dept_no
		)item on item.group_id = hdd.group_id and item.hos_id = hdd.hos_id
		and item.dept_id = hdd.dept_id and item.dept_no = hdd.dept_no
		order by hdd.dept_code
	</insert>

	<delete id="deleteAnalysisC0508">

		delete from cost_c0508
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryC0508Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0508
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		 )select acc_year,
		dept_code,dept_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		dept_code,dept_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by dept_code
	</select>
	
	<select id="queryAnalysisC0508" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8,
		t_9,
		t_10,
		t_11,
		t_12,
		t_13
		from COST_C0508
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		 )select acc_year,
		dept_code,dept_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		dept_code,dept_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by dept_code
	</select>

	<insert id="addAnalysisC0509" parameterType="java.util.Map">

	</insert>

	<delete id="deleteAnalysisC0509">

		delete from cost_c0509
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0509" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0501
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			 <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> 
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
		</where>
		group by group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name
		 )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>


	<insert id="addAnalysisC0510" parameterType="java.util.Map">

	</insert>

	<delete id="deleteAnalysisC0510">

		delete from cost_c0510
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>

	</delete>

	<select id="queryAnalysisC0510" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0502
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			 <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> 
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
		</where>
		group by group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name
		 )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>

	<insert id="addAnalysisC0511" parameterType="java.util.Map">

	</insert>

	<delete id="deleteAnalysisC0511">

		delete from cost_c0511
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>
	</delete>

	<select id="queryAnalysisC0511" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0503
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			 <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> 
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
		</where>
		group by group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name
		)select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>


	<insert id="addAnalysisC0512" parameterType="java.util.Map">

	</insert>

	<delete id="deleteAnalysisC0512">

		delete from cost_c0512
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>
	</delete>

	<select id="queryAnalysisC0512" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0504
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			 <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> 
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
		</where>
		group by group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name
		 )select acc_year,
		item_code,item_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		item_code,item_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by item_code
	</select>


	<insert id="addAnalysisC0513" parameterType="java.util.Map">

		INSERT INTO cost_c0513(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!--, t_8, t_9, t_10, t_11, t_12, t_13 -->
		)

		select
		item.group_id,item.hos_id,item.copy_code,item.acc_year,item.acc_month,
		hid.hos_code,hid.hos_name,
		item.t1,item.t2,item.t3,item.t4,item.t5,item.t6,item.t7
		from hos_info_dict hid
		left join
		( SELECT a.group_id, a.hos_id, a.copy_code, a.acc_year, a.acc_month
		, a.dir_amount AS t1, b.dir_amount AS t2, nvl(a.dir_amount, 0) -
		nvl(b.dir_amount, 0) AS t3
		, a.dir_amount / b.dir_amount * 100 AS t4, c.dir_amount AS t5,
		nvl(a.dir_amount, 0) - nvl(c.dir_amount, 0) AS t6, a.dir_amount /
		c.dir_amount * 100 AS t7
		FROM (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month,
		SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		left join hos_info_dict hid on hid.group_id = cdcd.group_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		#{year_month,jdbcType=VARCHAR}
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('002', '003', '004'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) a
		LEFT JOIN (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		, SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		(to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -12), 'yyyy') || NULL ||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -12), 'mm'))
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('002', '003', '004'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) b ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.copy_code = b.copy_code
		AND a.acc_year = b.acc_year
		AND a.acc_month = b.acc_month
		LEFT JOIN (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		,SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		(to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -1), 'yyyy') || NULL ||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -1), 'mm'))
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('002', '003', '004'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) c ON a.group_id = c.group_id
		AND a.hos_id = c.hos_id
		AND a.copy_code = c.copy_code
		AND a.acc_year = c.acc_year
		AND a.acc_month = c.acc_month
		) item on item.group_id = hid.group_id and item.hos_id = hid.hos_id
		where hid.is_stop = '0'

	</insert>

	<delete id="deleteAnalysisC0513">
		delete from cost_c0513
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>
	</delete>

	<select id="queryAnalysisC0513" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0505 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name
		 )select acc_year,
		hos_code,hos_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		hos_code,hos_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by hos_code
	</select>
	
	<select id="queryC0513Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0505 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name
		 )select acc_year,
		hos_code,hos_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		hos_code,hos_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by hos_code
	</select>

	<insert id="addAnalysisC0514" parameterType="java.util.Map">
		INSERT INTO cost_c0514(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!--, t_8, t_9, t_10, t_11, t_12, t_13 -->
		)

		select
		item.group_id,item.hos_id,item.copy_code,item.acc_year,item.acc_month,
		hid.hos_code,hid.hos_name,
		item.t1,item.t2,item.t3,item.t4,item.t5,item.t6,item.t7
		from hos_info_dict hid
		left join
		( SELECT a.group_id, a.hos_id, a.copy_code, a.acc_year, a.acc_month
		, a.dir_amount AS t1, b.dir_amount AS t2, nvl(a.dir_amount, 0) -
		nvl(b.dir_amount, 0) AS t3
		, a.dir_amount / b.dir_amount * 100 AS t4, c.dir_amount AS t5,
		nvl(a.dir_amount, 0) - nvl(c.dir_amount, 0) AS t6, a.dir_amount /
		c.dir_amount * 100 AS t7
		FROM (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month,
		SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		left join hos_info_dict hid on hid.group_id = cdcd.group_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		#{year_month,jdbcType=VARCHAR}
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('003', '004'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) a
		LEFT JOIN (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		, SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		(to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -12), 'yyyy') || NULL ||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -12), 'mm'))
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('003', '004'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) b ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.copy_code = b.copy_code
		AND a.acc_year = b.acc_year
		AND a.acc_month = b.acc_month
		LEFT JOIN (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		,SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		(to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -1), 'yyyy') || NULL ||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -1), 'mm'))
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('003', '004'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) c ON a.group_id = c.group_id
		AND a.hos_id = c.hos_id
		AND a.copy_code = c.copy_code
		AND a.acc_year = c.acc_year
		AND a.acc_month = c.acc_month
		) item on item.group_id = hid.group_id and item.hos_id = hid.hos_id
		where hid.is_stop = '0'
	</insert>

	<delete id="deleteAnalysisC0514">
		delete from cost_c0514
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>
	</delete>

	<select id="queryAnalysisC0514" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0506 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
		<!-- 	<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' "> 
				AND acc_month = #{acc_month}
			</if>-->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name
		 )select acc_year,
		hos_code,hos_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		hos_code,hos_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by hos_code
	</select>
	
	<select id="queryC0514Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0506 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
		<!-- 	<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' "> 
				AND acc_month = #{acc_month}
			</if>-->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name
		 )select acc_year,
		hos_code,hos_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		hos_code,hos_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by hos_code
	</select>

	<insert id="addAnalysisC0515" parameterType="java.util.Map">
		INSERT INTO cost_c0515(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!--, t_8, t_9, t_10, t_11, t_12, t_13 -->
		)

		select
		item.group_id,item.hos_id,item.copy_code,item.acc_year,item.acc_month,
		hid.hos_code,hid.hos_name,
		item.t1,item.t2,item.t3,item.t4,item.t5,item.t6,item.t7
		from hos_info_dict hid
		left join
		( SELECT a.group_id, a.hos_id, a.copy_code, a.acc_year, a.acc_month
		, a.dir_amount AS t1, b.dir_amount AS t2, nvl(a.dir_amount, 0) -
		nvl(b.dir_amount, 0) AS t3
		, a.dir_amount / b.dir_amount * 100 AS t4, c.dir_amount AS t5,
		nvl(a.dir_amount, 0) - nvl(c.dir_amount, 0) AS t6, a.dir_amount /
		c.dir_amount * 100 AS t7
		FROM (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month,
		SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		left join hos_info_dict hid on hid.group_id = cdcd.group_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		#{year_month,jdbcType=VARCHAR}
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('002'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) a
		LEFT JOIN (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		, SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		(to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -12), 'yyyy') || NULL ||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -12), 'mm'))
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('002'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) b ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.copy_code = b.copy_code
		AND a.acc_year = b.acc_year
		AND a.acc_month = b.acc_month
		LEFT JOIN (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		,SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		(to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -1), 'yyyy') || NULL ||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -1), 'mm'))
		AND cdcd.source_id IN (SELECT source_id
		FROM hos_source
		WHERE source_code NOT IN ('002'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) c ON a.group_id = c.group_id
		AND a.hos_id = c.hos_id
		AND a.copy_code = c.copy_code
		AND a.acc_year = c.acc_year
		AND a.acc_month = c.acc_month
		) item on item.group_id = hid.group_id and item.hos_id = hid.hos_id
		where hid.is_stop = '0'
	</insert>

	<delete id="deleteAnalysisC0515">
		delete from cost_c0515
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>
	</delete>

	<select id="queryAnalysisC0515" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0507 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name
		 )select acc_year,
		hos_code,hos_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		hos_code,hos_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by hos_code
	</select>
    
    <select id="queryC0515Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0507 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name
		 )select acc_year,
		hos_code,hos_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		hos_code,hos_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by hos_code
	</select>

	<insert id="addAnalysisC0516" parameterType="java.util.Map">
		INSERT INTO cost_c0516(
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7<!--, t_8, t_9, t_10, t_11, t_12, t_13 -->
		)

		select
		item.group_id,item.hos_id,item.copy_code,item.acc_year,item.acc_month,
		hid.hos_code,hid.hos_name,
		item.t1,item.t2,item.t3,item.t4,item.t5,item.t6,item.t7
		from hos_info_dict hid
		left join
		( SELECT a.group_id, a.hos_id, a.copy_code, a.acc_year, a.acc_month
		, a.dir_amount AS t1, b.dir_amount AS t2, nvl(a.dir_amount, 0) -
		nvl(b.dir_amount, 0) AS t3
		, a.dir_amount / b.dir_amount * 100 AS t4, c.dir_amount AS t5,
		nvl(a.dir_amount, 0) - nvl(c.dir_amount, 0) AS t6, a.dir_amount /
		c.dir_amount * 100 AS t7
		FROM (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month,
		SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		left join hos_info_dict hid on hid.group_id = cdcd.group_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		#{year_month,jdbcType=VARCHAR}
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) a
		LEFT JOIN (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		, SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		(to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -12), 'yyyy') || NULL ||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -12), 'mm'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) b ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.copy_code = b.copy_code
		AND a.acc_year = b.acc_year
		AND a.acc_month = b.acc_month
		LEFT JOIN (
		SELECT cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		,SUM(dir_amount) AS dir_amount
		FROM cost_dept_cost_data cdcd
		LEFT JOIN hos_dept_dict hdd ON hdd.group_id = cdcd.group_id
		AND hdd.hos_id = cdcd.hos_id
		AND hdd.dept_id = cdcd.dept_id
		AND cdcd.dept_no = cdcd.dept_no
		LEFT JOIN acc_dept_attr ada ON ada.group_id = hdd.group_id
		AND ada.hos_id = hdd.hos_id
		AND ada.dept_id = hdd.dept_id
		WHERE (cdcd.acc_year || NULL || cdcd.acc_month) =
		(to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -1), 'yyyy') || NULL ||
		to_char(add_months(to_date(#{year_month,jdbcType=VARCHAR} || NULL ||
		'01', 'yyyymmdd'), -1), 'mm'))
		AND ada.type_code IN (SELECT type_code
		FROM acc_dept_type
		WHERE type_code = '04')
		AND hdd.is_stop = '0'
		AND cdcd.dir_amount != 0
		GROUP BY cdcd.group_id, cdcd.hos_id, cdcd.copy_code, cdcd.acc_year,
		cdcd.acc_month
		) c ON a.group_id = c.group_id
		AND a.hos_id = c.hos_id
		AND a.copy_code = c.copy_code
		AND a.acc_year = c.acc_year
		AND a.acc_month = c.acc_month
		) item on item.group_id = hid.group_id and item.hos_id = hid.hos_id
		where hid.is_stop = '0'
	</insert>

	<delete id="deleteAnalysisC0516">
		delete from cost_c0516
		<where>
			<if test="group_id != null and group_id != ''">
				group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year,jdbcType=VARCHAR}
			</if>
			<if test="acc_month != null and acc_month != ''">
				AND acc_month = #{acc_month,jdbcType=VARCHAR}
			</if>

		</where>
	</delete>

	<select id="queryAnalysisC0516" parameterType="java.util.Map"
		resultMap="c0501">
		 with temp as 
(
		select
		t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0508 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name
		  )select acc_year,
		hos_code,hos_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		hos_code,hos_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by hos_code
	</select>

    <select id="queryC0516Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3,
		sum(t_4) t_4,
		sum(t_5) t_5,
		sum(t_6) t_6,
		sum(t_7) t_7,
		sum(t_8) t_8,
		sum(t_9) t_9,
		sum(t_10) t_10,
		sum(t_11) t_11,
		sum(t_12) t_12,
		sum(t_13) t_13
		from COST_C0508 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if test="acc_month!= null and acc_month != '' ">
				AND acc_month = #{acc_month}
			</if> -->
			<!-- <if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''">
				AND acc_year || acc_month between #{year_month_begin} and #{year_month_end}
			 </if> -->
			 <if test="year_month_begin != null and year_month_begin != '' ">
				AND acc_year || acc_month = #{year_month_begin} 
			 </if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		copy_code,
		acc_year,
		acc_month,
		hos_code,
		hos_name
		  )select acc_year,
		hos_code,hos_name, sum(t_1) t_1, sum(t_2) t_2, sum(t_3) t_3, sum(t_4) t_4,
		sum(t_5) t_5, sum(t_6) t_6, sum(t_7) t_7, sum(t_8) t_8,
		sum(t_9) t_9, sum(t_10) t_10, sum(t_11) t_11,
		sum(t_12) t_12, sum(t_13) t_13 from temp
		group by acc_year,
		hos_code,hos_name
		union all
		select null,null, '总计', sum(t_1), sum(t_2), sum(t_3), sum(t_4),
		sum(t_5), sum(t_6), sum(t_7), sum(t_8),
		sum(t_9), sum(t_10) , sum(t_11),
		sum(t_12), sum(t_13) from temp
		order by hos_code
	</select>
    
</mapper>

