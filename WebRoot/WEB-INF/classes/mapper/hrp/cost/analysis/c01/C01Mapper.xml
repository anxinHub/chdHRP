<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chd.hrp.cost.dao.analysis.c01.C01Mapper">

	<resultMap id="c0101" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="item_code" column="item_code" />
		<result property="item_name" column="item_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0102" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="item_code" column="item_code" />
		<result property="item_name" column="item_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
		<result property="t_7" column="t_7" />
		<result property="t_8" column="t_8" />

	</resultMap>
	<resultMap id="c0103" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0104" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0105" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0106" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0107" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0108" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0109" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0110" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0111" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0112" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="item_code" column="item_code" />
		<result property="item_name" column="item_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0113" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="item_code" column="item_code" />
		<result property="item_name" column="item_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
		<result property="t_7" column="t_7" />
		<result property="t_8" column="t_8" />
	</resultMap>
	<resultMap id="c0114" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="hos_code" column="hos_code" />
		<result property="hos_name" column="hos_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0115" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="hos_code" column="hos_code" />
		<result property="hos_name" column="hos_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0116" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="hos_code" column="hos_code" />
		<result property="hos_name" column="hos_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	<resultMap id="c0117" type="java.util.Map">
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="hos_code" column="hos_code" />
		<result property="hos_name" column="hos_name" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>



	<select id="queryAnalysisC0101" parameterType="java.util.Map"
		resultMap="c0101">
		   with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0101
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
			order by item_code asc
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				item_code,item_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , item_code, item_name
      order by item_code
	</select>
	
	<select id="queryC0101Print" parameterType="java.util.Map"	resultType="java.util.Map">
		   with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0101
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
			order by item_code asc
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				item_code,item_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , item_code, item_name
      order by item_code
	</select>

	<delete id="deleteCostAnalysisC0101" parameterType="java.util.Map">

		DELETE FROM
		cost_c0101 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}

	</delete>


	<insert id="addCostAnalysisC0101" parameterType="java.util.Map">

		INSERT INTO cost_c0101
		(group_id, hos_id, copy_code, acc_year, acc_month, item_code, item_name, t_1,
		t_2, t_3, t_4, t_5, t_6)
		select #{group_id}, #{hos_id}, #{copy_code}, #{acc_year},
		#{acc_month},t1.item_code, t1.item_name, t2.income_money,
		t3.income_money, t4.cost_money, t5.cost_money, t2.income_money -
		t4.cost_money, t3.income_money - t5.cost_money
		from
		(select 1 item_code, '医疗业务成本' item_name
		from dual
		union all
		select 2 item_code, '门诊' item_name
		from dual
		union all
		select 3 item_code, '住院' item_name
		from dual
		union all
		select 4 item_code, '医疗成本' item_name
		from dual
		union all
		select 5 item_code, '门诊' item_name
		from dual
		union all
		select 6 item_code, '住院' item_name
		from dual
		union all
		select 7 item_code, '医疗全成本' item_name
		from dual
		union all
		select 8 item_code, '门诊' item_name
		from dual
		union all
		select 9 item_code, '住院' item_name
		from dual
		union all
		select 10 item_code, '医院全成本' item_name
		from dual
		union all
		select 11 item_code, '门诊' item_name
		from dual
		union all
		select 12 item_code, '住院' item_name from dual) t1
		left join
		(

		select item_code,sum(income_money) income_money from(
		select 1 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='01'

		union all
		select 1 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='02'
		union all
		select 2 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='01'
		union all
		select 3 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='02'
		union all
		select 4 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='01'
		union all
		select 4 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='02'
		union all
		select 5 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='01'
		union all
		select 6 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='02'
		union all
		select 7 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='01'
		union all
		select 7 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='02'
		union all
		select 8 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='01'
		union all
		select 9 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='02'
		union all
		select 10 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='01'
		union all
		select 10 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='02'
		union all
		select 11 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='01'
		union all
		select 12 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code
		='02'

		) group by item_code
		) t2 on t1.item_code=t2.item_code

		left join
		(

		select item_code,sum(income_money) income_money from(
		select 1 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 1 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		union all
		select 2 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 3 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		union all
		select 4 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 4 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		union all
		select 5 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 6 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		union all
		select 7 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 7 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		union all
		select 8 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 9 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		union all
		select 10 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 10 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		union all
		select 11 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 12 item_code,sum(income_money) income_money from
		v_cost_appl_dept_income
		where group_id=#{group_id} and hos_id=#{hos_id} and copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'

		) group by item_code
		) t3 on t1.item_code=t3.item_code
		left join

		(
		select item_code,
		sum(cost_money) cost_money from(
		select 1 item_code,
		sum(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
		t1.indir_med_ass_amount) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id =
		tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr=1
		and natur_code ='01'
		union all
		select 1 item_code,
		sum(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
		t1.indir_med_ass_amount) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id =
		tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr=1
		and natur_code ='02'
		union all
		select 2 item_code,
		sum(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
		t1.indir_med_ass_amount) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id =
		tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr=1
		and natur_code ='01'
		union all
		select 3 item_code,
		sum(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
		t1.indir_med_ass_amount) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id =
		tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr=1
		and natur_code ='02'
		union all
		select 4 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id =
		tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr=1
		and natur_code ='01'
		union all
		select 4 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id =
		tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr=1
		and natur_code ='02'
		union all
		select 5 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr=1
		and natur_code ='01'
		union all
		select 6 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr=1
		and natur_code ='02'
		union all
		select 7 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr
		in(1,2) and natur_code ='01'
		union all
		select 7 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr
		in(1,2) and natur_code ='02'
		union all
		select 8 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr
		in(1,2) and natur_code ='01'
		union all
		select 9 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and tv.source_attr
		in(1,2) and natur_code ='02'
		union all
		select 10 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code ='01'
		union all
		select 10 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code ='02'
		union all
		select 11 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code ='01'
		union all
		select 12 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month=#{acc_month} and natur_code ='02'
		) group by item_code
		) t4 on t1.item_code=t4.item_code
		left join
		(
		select item_code,
		sum(cost_money) cost_money from (
		select 1 item_code,
		sum(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
		t1.indir_med_ass_amount) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		=1 and natur_code ='01'

		union all
		select 1 item_code,
		sum(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
		t1.indir_med_ass_amount) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		=1
		and natur_code ='02'
		union all
		select 2 item_code,
		sum(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
		t1.indir_med_ass_amount) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		=1
		and natur_code ='01'
		union all
		select 3 item_code,
		sum(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
		t1.indir_med_ass_amount) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		=1
		and natur_code ='02'
		union all
		select 4 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		=1
		and natur_code ='01'
		union all
		select 4 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		=1
		and natur_code ='02'
		union all
		select 5 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		=1
		and natur_code ='01'
		union all
		select 6 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		=1
		and natur_code ='02'
		union all
		select 7 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		in(1,2)
		and natur_code ='01'
		union all
		select 7 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		in(1,2)
		and natur_code ='02'
		union all
		select 8 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		in(1,2)
		and natur_code ='01'
		union all
		select 9 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		inner join
		hos_source tv
		on t1.group_id = tv.group_id
		and t1.hos_id = tv.hos_id
		and
		t1.source_id = tv.source_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month&lt;=#{acc_month} and tv.source_attr
		in(1,2)
		and natur_code ='02'
		union all
		select 10 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 10 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		union all
		select 11 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='01'
		union all
		select 12 item_code,
		sum(dir_amount + dir_ass_amount + dir_med_amount +
		indir_med_ass_amount+DIR_MAN_AMOUNT+INDIR_ASS_MAN_AMOUNT+INDIR_MED_MAN_AMOUNT
		+INDIR_ASS_MED_MAN_AMOUNT) cost_money
		from cost_dept_cost t1
		left join acc_dept_attr b
		on t1.group_id = b.group_id
		and t1.hos_id = b.hos_id
		and t1.dept_id = b.dept_id
		where t1.group_id=#{group_id} and t1.hos_id=#{hos_id} and
		copy_code=#{copy_code}
		and acc_year=#{acc_year} and acc_month &lt;=#{acc_month}
		and natur_code ='02'
		) group by item_code
		) t5 on t1.item_code=t5.item_code
	</insert>


	<select id="queryAnalysisC0102" parameterType="java.util.Map"
		resultMap="c0102">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8
		from COST_C0102
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
			order by item_code asc
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				item_code,item_name, sum(t_1) t_1,max(t_2) t_2, sum(t_3) t_3,max(t_4) t_4, sum(t_5) 
				t_5,max(t_6) t_6,sum(t_7) t_7,max(t_8) t_8 from temp
				group by  group_id,hos_id,copy_code,acc_year,
				item_code,item_name
      order by item_code
	</select>
	
	<select id="queryC0102Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8
		from COST_C0102
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
			order by item_code asc
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				item_code,item_name, sum(t_1) t_1,max(t_2) t_2, sum(t_3) t_3,max(t_4) t_4, sum(t_5) 
				t_5,max(t_6) t_6,sum(t_7) t_7,max(t_8) t_8 from temp
				group by  group_id,hos_id,copy_code,acc_year,
				item_code,item_name
      order by item_code
	</select>
	
	<delete id="deleteCostAnalysisC0102" parameterType="java.util.Map">
		DELETE FROM
		cost_c0102 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0102" parameterType="java.util.Map">
		INSERT INTO
		cost_c0102 (
		group_id
		,
		hos_id
		,
		copy_code
		,
		acc_year
		,
		acc_month
		,
		item_code
		,
		item_name
		,
		t_1
		,
		t_2
		,
		t_3
		,
		t_4
		,
		t_5
		,
		t_6
		,
		t_7
		,
		t_8

		)

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		1 as item_code,
		'医疗业务成本' as item_name,
		(select sum(money) from cost_income
		where
		appl_dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t1
		,
		(select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt;=#{acc_month}
		) as t2
		,
		0 as t3
		,
		0 as t4
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month =#{acc_month}
		) as t5
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t6
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month =#{acc_month})
		-
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		)
		) as t7
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id =
		#{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		)
		-
		(select sum(dir_amount) from cost_dept_dri_data
		where
		dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		)
		) as t8
		from
		dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		2 as item_code,'其中门诊' as item_name,
		(select sum(money)
		from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t1
		,
		(select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt;= #{acc_month}
		) as t2
		,
		0 as t3
		,
		0
		as t4
		,
		(select sum(dir_amount) from cost_dept_dri_data
		where dept_id in
		(select dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t5
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and natur_code ='05'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt;= #{acc_month}
		) as t6
		,
		((select sum(money) from
		cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and natur_code ='05'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		)
		-
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and natur_code ='05'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		)
		) as t7
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('02','03','04')
		and natur_code ='05'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt;= #{acc_month}
		)
		-
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and natur_code ='05'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt;= #{acc_month}
		)
		) as t8

		from dual


		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		3 as
		item_code,'住院' as item_name,
		(select sum(money) from cost_income
		where
		appl_dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t1
		,
		(select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('02','03','04')
		and natur_code ='03'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt;= #{acc_month}
		) as t2
		,
		0 as t3
		,
		0 as t4
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t5
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;= #{acc_month}
		) as t6
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		) as t7
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt;= #{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;= #{acc_month}
		)
		) as t8

		from
		dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		4 as item_code,'医疗成本' as item_name,
		(select sum(money)
		from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month =#{acc_month}
		) as t1
		,
		(select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id
		= #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;=
		#{acc_month}
		) as t2
		,
		0 as t3
		,
		0 as t4
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t5
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		)
		as t6
		,
		((select sum(money) from cost_income
		where
		appl_dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)

		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		)
		-
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		)
		) as t7
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id
		= #{hos_id}
		)

		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}

		)
		-
		(select sum(dir_amount) from cost_dept_dri_data
		where
		dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		)
		) as t8

		from dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		5 as item_code,'其中门诊' as
		item_name,
		(select sum(money) from cost_income
		where appl_dept_id in
		(select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code ='05'
		and group_id = #{group_id}
		and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t1
		,
		(select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and natur_code ='05'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt; =#{acc_month}
		) as t2
		,
		0 as t3
		,
		0 as t4
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t5
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t6
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		) as t7
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		)
		) as t8

		from
		dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		6 as item_code ,'住院' as item_name,
		(select sum(money)
		from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t1
		,
		(select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t2
		,
		0 as t3
		,
		0
		as t4
		,
		(select sum(dir_amount) from cost_dept_dri_data
		where dept_id in
		(select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code ='03'
		and group_id = #{group_id}
		and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t5
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and natur_code ='03'
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t6
		,

		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)) as t7
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		)
		) as t8
		from
		dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		7 as item_code ,'医疗全成本' as item_name,
		(select sum(money)
		from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t1
		,
		(select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id
		= #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		) as t2
		,
		0 as t3
		,
		0 as t4
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t5
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		) as t6
		,
		((select sum(money) from cost_income
		where
		appl_dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		)
		-
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)

		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		)
		) as t7

		,
		((select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id
		= #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		)
		-
		(select sum(dir_amount) from cost_dept_dri_data
		where
		dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month})
		) as t8

		from dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		8 as item_code,'其中门诊' as
		item_name,
		(select sum(money) from cost_income
		where appl_dept_id in
		(select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code ='05'
		and group_id = #{group_id}
		and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t1
		,
		(select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and natur_code ='05'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt; =#{acc_month}
		) as t2
		,
		0 as t3
		,
		0 as t4
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t5
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t6
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month})
		) as t7
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		)
		) as t8
		from
		dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		9 as item_code,'住院' as item_name,
		(select sum(money) from
		cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and natur_code ='03'
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t1
		,
		(select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t2
		,
		0 as t3
		,
		0
		as t4
		,
		(
		select sum(dir_amount) from cost_dept_dri_data
		where dept_id in
		(select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code ='03'
		and group_id = #{group_id}
		and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t5
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and natur_code ='03'
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t6
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		) as t7
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month})
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month})
		) as t8
		from
		dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		10 as item_code ,'医院全成本' as item_name,
		(select sum(money)
		from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t1
		,
		(select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id
		= #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		) as t2
		,
		0 as t3
		,
		0 as t4
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t5
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		) as t6
		,
		((select sum(money) from cost_income
		where
		appl_dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month})
		-
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		)
		)as t7
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id
		= #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month})
		-
		(select sum(dir_amount) from cost_dept_dri_data
		where
		dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month})
		) as t8

		from dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		11 as item_code,'其中门诊' as
		item_name,
		(select sum(money) from cost_income
		where appl_dept_id in
		(select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code ='05'
		and group_id = #{group_id}
		and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t1
		,
		(select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('01','02','03','04')
		and natur_code ='05'
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt; =#{acc_month}
		) as t2
		,
		0 as t3
		,
		0 as t4
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t5
		,
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t6
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)

		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		) as t7
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='05'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month})
		) as t8

		from
		dual

		union all

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		12 as item_code,'住院' as item_name,
		(select sum(money)
		from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t1
		,
		(select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t2
		,
		0 as t3
		,
		0
		as t4
		,
		(select sum(dir_amount) from cost_dept_dri_data
		where dept_id in
		(select dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code ='03'
		and group_id = #{group_id}
		and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t5
		,
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('01','02','03','04')
		and natur_code ='03'
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t6
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		) as t7
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and natur_code
		='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month})
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('01','02','03','04')
		and
		natur_code ='03'
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month})
		) as t8

		from
		dual
	</insert>

	<select id="queryAnalysisC0103" parameterType="java.util.Map"
		resultMap="c0103">
		 with temp as 
(
		select
    c3.group_id,
    c3.hos_id,
    c3.copy_code,
    c3.acc_year,
    c3.acc_month,
    c3.dept_code,
    c3.dept_name,
    c3.t_1,
    c3.t_2,
    c3.t_3,
    c3.t_4,
    c3.t_5,
    c3.t_6,
    hdd.dept_level
    from COST_C0103 c3
    left join hos_dept_dict hdd on 
    c3.group_id=hdd.group_id and c3.hos_id=hdd.hos_id and c3.dept_code=hdd.dept_code
		<where>
				 c3.group_id = #{group_id,jdbcType=INTEGER}
				AND c3.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c3.copy_code = #{copy_code,jdbcType=VARCHAR}
				and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c3.acc_year || c3.acc_month between #{begin_date} and #{end_date}
			</if>
			<if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
			<if test="dept_code != null and dept_code != ''">
				AND c3.dept_code = #{dept_code}
			</if>
			and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)
    select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code, dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
    
	</select>
	
	<select id="queryC0103Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c3.group_id,
    c3.hos_id,
    c3.copy_code,
    c3.acc_year,
    c3.acc_month,
    c3.dept_code,
    c3.dept_name,
    c3.t_1,
    c3.t_2,
    c3.t_3,
    c3.t_4,
    c3.t_5,
    c3.t_6,
    hdd.dept_level
    from COST_C0103 c3
    left join hos_dept_dict hdd on 
    c3.group_id=hdd.group_id and c3.hos_id=hdd.hos_id and c3.dept_code=hdd.dept_code
		<where>
				 c3.group_id = #{group_id,jdbcType=INTEGER}
				AND c3.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c3.copy_code = #{copy_code,jdbcType=VARCHAR}
				and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c3.acc_year || c3.acc_month between #{begin_date} and #{end_date}
			</if>
			<if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
			<if test="dept_code != null and dept_code != ''">
				AND c3.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)
    select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code, dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
    
	</select>
	
	<delete id="deleteCostAnalysisC0103" parameterType="java.util.Map">
		DELETE FROM
		cost_c0103 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0103" parameterType="java.util.Map">
		INSERT INTO
		cost_c0103 (
		group_id
		,
		hos_id
		,
		copy_code
		,
		acc_year
		,
		acc_month
		,
		dept_code
		,
		dept_name
		,
		t_1
		,
		t_2
		,
		t_3
		,
		t_4
		,
		t_5
		,
		t_6


		)

		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		dept.dept_code
		,
		dept.dept_name
		,
		(select sum(money) from cost_income
		where appl_dept_id
		in (select dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month=#{acc_month}
		) as t1
		,
		(select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt;=#{acc_month}
		) as t2
		,

		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month
		=#{acc_month}
		) as t3
		,
		(select sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t4
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month =#{acc_month})
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		) as t5
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt; =#{acc_month}
		)
		-
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		)
		) as t6
		from (
		(select dept_code,dept_name from
		Hos_Dept_Dict
		where dept_id in (select appl_dept_id from cost_income
		where
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		) dept

		)

	</insert>

	<select id="queryAnalysisC0104" parameterType="java.util.Map"
		resultMap="c0104">
		 with temp as 
(
		select
    c4.group_id,
    c4.hos_id,
    c4.copy_code,
    c4.acc_year,
    c4.acc_month,
    c4.dept_code,
    c4.dept_name,
    c4.t_1,
    c4.t_2,
    c4.t_3,
    c4.t_4,
    c4.t_5,
    c4.t_6,
    hdd.dept_level
    from COST_C0104 c4
    left join hos_dept_dict hdd on 
    c4.group_id=hdd.group_id and c4.hos_id=hdd.hos_id and c4.dept_code=hdd.dept_code
		<where>
				AND c4.group_id = #{group_id,jdbcType=INTEGER}
				AND c4.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c4.copy_code = #{copy_code,jdbcType=VARCHAR}
				and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c4.acc_year || c4.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c4.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code, dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
	</select>
	
	<select id="queryC0104Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c4.group_id,
    c4.hos_id,
    c4.copy_code,
    c4.acc_year,
    c4.acc_month,
    c4.dept_code,
    c4.dept_name,
    c4.t_1,
    c4.t_2,
    c4.t_3,
    c4.t_4,
    c4.t_5,
    c4.t_6,
    hdd.dept_level
    from COST_C0104 c4
    left join hos_dept_dict hdd on 
    c4.group_id=hdd.group_id and c4.hos_id=hdd.hos_id and c4.dept_code=hdd.dept_code
		<where>
				AND c4.group_id = #{group_id,jdbcType=INTEGER}
				AND c4.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c4.copy_code = #{copy_code,jdbcType=VARCHAR}
				and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c4.acc_year || c4.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c4.dept_code = #{dept_code}
			</if>
			and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code, dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
	</select>
	
	<delete id="deleteCostAnalysisC0104" parameterType="java.util.Map">
		DELETE FROM
		cost_c0104 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0104" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0105" parameterType="java.util.Map"
		resultMap="c0105">
		 with temp as 
(
		select
    c5.group_id,
    c5.hos_id,
    c5.copy_code,
    c5.acc_year,
    c5.acc_month,
    c5.dept_code,
    c5.dept_name,
    c5.t_1,
    c5.t_2,
    c5.t_3,
    c5.t_4,
    c5.t_5,
    c5.t_6,
    hdd.dept_level
    from COST_C0105 c5
    left join hos_dept_dict hdd on 
    c5.group_id=hdd.group_id and c5.hos_id=hdd.hos_id and c5.dept_code=hdd.dept_code
		<where>
				 c5.group_id = #{group_id,jdbcType=INTEGER}
				AND c5.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c5.copy_code = #{copy_code,jdbcType=VARCHAR}
                and hdd.is_stop=0			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c5.acc_year || c5.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c5.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name
   union all
   select  null,null, null,null, '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by dept_code
	</select>
	
	<select id="queryC0105Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c5.group_id,
    c5.hos_id,
    c5.copy_code,
    c5.acc_year,
    c5.acc_month,
    c5.dept_code,
    c5.dept_name,
    c5.t_1,
    c5.t_2,
    c5.t_3,
    c5.t_4,
    c5.t_5,
    c5.t_6,
    hdd.dept_level
    from COST_C0105 c5
    left join hos_dept_dict hdd on 
    c5.group_id=hdd.group_id and c5.hos_id=hdd.hos_id and c5.dept_code=hdd.dept_code
		<where>
				 c5.group_id = #{group_id,jdbcType=INTEGER}
				AND c5.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c5.copy_code = #{copy_code,jdbcType=VARCHAR}
                and hdd.is_stop=0			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c5.acc_year || c5.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c5.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name
   union all
   select  null,null, null,null, '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by dept_code
	</select>
	
	<delete id="deleteCostAnalysisC0105" parameterType="java.util.Map">
		DELETE FROM
		cost_c0105 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0105" parameterType="java.util.Map">
		INSERT INTO
		(group_id,
		hos_id,
		copy_code,
		acc_year,
		acc_month,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		)
		select
		#{group_id} ,
		#{hos_id} ,
		#{copy_code} ,
		#{acc_year} ,
		#{acc_month} ,
		dept.dept_code
		,
		dept.dept_name
		,
		(select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month=#{acc_month}
		) as t1
		,
		(select sum(money) from cost_income
		where appl_dept_id in (select dept_id from ACC_DEPT_ATTR where
		type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id =
		#{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and
		copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month
		&lt;=#{acc_month}
		) as t2
		,

		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month
		=#{acc_month}
		) as t3
		,
		(select sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and
		group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt; =#{acc_month}
		) as t4
		,
		((select sum(money) from cost_income
		where appl_dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month =#{acc_month})
		-
		(select
		sum(dir_amount) from cost_dept_dri_data
		where dept_id in (select
		dept_id from ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and
		acc_year=#{acc_year}
		and acc_month=#{acc_month}
		)
		) as t5
		,
		((select
		sum(money) from cost_income
		where appl_dept_id in (select dept_id from
		ACC_DEPT_ATTR where type_code in
		('02','03','04')
		and group_id =
		#{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id
		= #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and
		acc_month &lt; =#{acc_month}
		)
		-
		(select sum(dir_amount) from
		cost_dept_dri_data
		where dept_id in (select dept_id from ACC_DEPT_ATTR
		where type_code in
		('02','03','04')
		and group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id = #{group_id}
		and hos_id = #{hos_id}
		and copy_code=#{copy_code}
		and acc_year=#{acc_year}
		and acc_month &lt;
		=#{acc_month}
		)
		) as t6
		from (
		(select dept_code,dept_name from
		Hos_Dept_Dict
		where dept_id in (select appl_dept_id from cost_income
		where
		group_id = #{group_id} and
		hos_id = #{hos_id}
		)
		and group_id =
		#{group_id}
		and hos_id = #{hos_id}
		) dept

		)
	</insert>

	<select id="queryAnalysisC0106" parameterType="java.util.Map"
		resultMap="c0106">
		 with temp as 
(
		select
    c6.group_id,
    c6.hos_id,
    c6.copy_code,
    c6.acc_year,
    c6.acc_month,
    c6.dept_code,
    c6.dept_name,
    c6.t_1,
    c6.t_2,
    c6.t_3,
    c6.t_4,
    c6.t_5,
    c6.t_6,
    hdd.dept_level
    from COST_C0106 c6
    left join hos_dept_dict hdd on 
    c6.group_id=hdd.group_id and c6.hos_id=hdd.hos_id and c6.dept_code=hdd.dept_code
		<where>
				 c6.group_id = #{group_id,jdbcType=INTEGER}
				AND c6.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c6.copy_code = #{copy_code,jdbcType=VARCHAR}
			    and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c6.acc_year || c6.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c6.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
	</select>
	
	<select id="queryC0106Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c6.group_id,
    c6.hos_id,
    c6.copy_code,
    c6.acc_year,
    c6.acc_month,
    c6.dept_code,
    c6.dept_name,
    c6.t_1,
    c6.t_2,
    c6.t_3,
    c6.t_4,
    c6.t_5,
    c6.t_6,
    hdd.dept_level
    from COST_C0106 c6
    left join hos_dept_dict hdd on 
    c6.group_id=hdd.group_id and c6.hos_id=hdd.hos_id and c6.dept_code=hdd.dept_code
		<where>
				 c6.group_id = #{group_id,jdbcType=INTEGER}
				AND c6.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c6.copy_code = #{copy_code,jdbcType=VARCHAR}
			    and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c6.acc_year || c6.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c6.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
	</select>
	
	<delete id="deleteCostAnalysisC0106" parameterType="java.util.Map">
		DELETE FROM
		cost_c0106 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0106" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0107" parameterType="java.util.Map"
		resultMap="c0107">
		 with temp as 
(
		select
    c7.group_id,
    c7.hos_id,
    c7.copy_code,
    c7.acc_year,
    c7.acc_month,
    c7.dept_code,
    c7.dept_name,
    c7.t_1,
    c7.t_2,
    c7.t_3,
    c7.t_4,
    c7.t_5,
    c7.t_6,
    hdd.dept_level
    from COST_C0107 c7
    left join hos_dept_dict hdd on 
    c7.group_id=hdd.group_id and c7.hos_id=hdd.hos_id and c7.dept_code=hdd.dept_code
		<where>
				 c7.group_id = #{group_id,jdbcType=INTEGER}
				AND c7.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c7.copy_code = #{copy_code,jdbcType=VARCHAR}
                and hdd.is_stop=0			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c7.acc_year || c7.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0 ">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c7.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
	</select>
	
	<select id="queryC0107Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c7.group_id,
    c7.hos_id,
    c7.copy_code,
    c7.acc_year,
    c7.acc_month,
    c7.dept_code,
    c7.dept_name,
    c7.t_1,
    c7.t_2,
    c7.t_3,
    c7.t_4,
    c7.t_5,
    c7.t_6,
    hdd.dept_level
    from COST_C0107 c7
    left join hos_dept_dict hdd on 
    c7.group_id=hdd.group_id and c7.hos_id=hdd.hos_id and c7.dept_code=hdd.dept_code
		<where>
				 c7.group_id = #{group_id,jdbcType=INTEGER}
				AND c7.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c7.copy_code = #{copy_code,jdbcType=VARCHAR}
                and hdd.is_stop=0			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c7.acc_year || c7.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0 ">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c7.dept_code = #{dept_code}
			</if>
			and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
	</select>
	
	<delete id="deleteCostAnalysisC0107" parameterType="java.util.Map">
		DELETE FROM
		cost_c0107 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0107" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0108" parameterType="java.util.Map"
		resultMap="c0108">
		 with temp as 
(
		select
    c8.group_id,
    c8.hos_id,
    c8.copy_code,
    c8.acc_year,
    c8.acc_month,
    c8.dept_code,
    c8.dept_name,
    c8.t_1,
    c8.t_2,
    c8.t_3,
    c8.t_4,
    c8.t_5,
    c8.t_6,
    hdd.dept_level
    from COST_C0108 c8
    left join hos_dept_dict hdd on 
    c8.group_id=hdd.group_id and c8.hos_id=hdd.hos_id and c8.dept_code=hdd.dept_code
		<where>
				 c8.group_id = #{group_id,jdbcType=INTEGER}
				AND c8.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c8.copy_code = #{copy_code,jdbcType=VARCHAR}
			    and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c8.acc_year || c8.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c8.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
	</select>
	
	<select id="queryC0108Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c8.group_id,
    c8.hos_id,
    c8.copy_code,
    c8.acc_year,
    c8.acc_month,
    c8.dept_code,
    c8.dept_name,
    c8.t_1,
    c8.t_2,
    c8.t_3,
    c8.t_4,
    c8.t_5,
    c8.t_6,
    hdd.dept_level
    from COST_C0108 c8
    left join hos_dept_dict hdd on 
    c8.group_id=hdd.group_id and c8.hos_id=hdd.hos_id and c8.dept_code=hdd.dept_code
		<where>
				 c8.group_id = #{group_id,jdbcType=INTEGER}
				AND c8.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c8.copy_code = #{copy_code,jdbcType=VARCHAR}
			    and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c8.acc_year || c8.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
            <if test="dept_level == 0">
			    and hdd.is_last='1'
			</if>
			<if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			</if>
			<if test="dept_code != null and dept_code != ''">
				AND c8.dept_code = #{dept_code}
			</if>
					and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name,  sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3
      , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6
    from temp group by group_id, hos_id, copy_code, acc_year
      , dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by dept_code
	</select>
	
	<delete id="deleteCostAnalysisC0108" parameterType="java.util.Map">
		DELETE FROM
		cost_c0108 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0108" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0109" parameterType="java.util.Map"
		resultMap="c0109">
		 with temp as 
(
		select
    c9.group_id,
    c9.hos_id,
    c9.copy_code,
    c9.acc_year,
    c9.acc_month,
    c9.dept_code,
    c9.dept_name,
    c9.t_1,
    c9.t_2,
    c9.t_3,
    c9.t_4,
    c9.t_5,
    c9.t_6,
    hdd.dept_level
    from COST_C0109 c9
    left join hos_dept_dict hdd on 
    c9.group_id=hdd.group_id and c9.hos_id=hdd.hos_id and c9.dept_code=hdd.dept_code
		<where>
				 c9.group_id = #{group_id,jdbcType=INTEGER}
				AND c9.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c9.copy_code = #{copy_code,jdbcType=VARCHAR}
				and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c9.acc_year || c9.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
             <if test="dept_level == 0">
			    and hdd.is_last='1'
			 </if>
			 <if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			 </if>
			<if test="dept_code != null and dept_code != ''">
				AND c9.dept_code = #{dept_code}
			</if>
				and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by dept_code
	</select>
	
	<select id="queryC0109Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c9.group_id,
    c9.hos_id,
    c9.copy_code,
    c9.acc_year,
    c9.acc_month,
    c9.dept_code,
    c9.dept_name,
    c9.t_1,
    c9.t_2,
    c9.t_3,
    c9.t_4,
    c9.t_5,
    c9.t_6,
    hdd.dept_level
    from COST_C0109 c9
    left join hos_dept_dict hdd on 
    c9.group_id=hdd.group_id and c9.hos_id=hdd.hos_id and c9.dept_code=hdd.dept_code
		<where>
				 c9.group_id = #{group_id,jdbcType=INTEGER}
				AND c9.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c9.copy_code = #{copy_code,jdbcType=VARCHAR}
				and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c9.acc_year || c9.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
             <if test="dept_level == 0">
			    and hdd.is_last='1'
			 </if>
			 <if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			 </if>
			<if test="dept_code != null and dept_code != ''">
				AND c9.dept_code = #{dept_code}
			</if>
			and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by dept_code
	</select>
	
	<delete id="deleteCostAnalysisC0109" parameterType="java.util.Map">
		DELETE FROM
		cost_c0109 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0109" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0110" parameterType="java.util.Map"
		resultMap="c0110">
		 with temp as 
(
		select
    c10.group_id,
    c10.hos_id,
    c10.copy_code,
    c10.acc_year,
    c10.acc_month,
    c10.dept_code,
    c10.dept_name,
    c10.t_1,
    c10.t_2,
    c10.t_3,
    c10.t_4,
    c10.t_5,
    c10.t_6,
    hdd.dept_level
    from COST_C0110 c10
    left join hos_dept_dict hdd on 
    c10.group_id=hdd.group_id and c10.hos_id=hdd.hos_id and c10.dept_code=hdd.dept_code
		<where>
				 c10.group_id = #{group_id,jdbcType=INTEGER}
				AND c10.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c10.copy_code = #{copy_code,jdbcType=VARCHAR}
				and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c10.acc_year || c10.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
             <if test="dept_level == 0">
			    and hdd.is_last='1'
			 </if>
			 <if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			 </if>
			<if test="dept_code != null and dept_code != ''">
				AND c10.dept_code = #{dept_code}
			</if>
			and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by dept_code
	</select>
	
	<select id="queryC0110Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c10.group_id,
    c10.hos_id,
    c10.copy_code,
    c10.acc_year,
    c10.acc_month,
    c10.dept_code,
    c10.dept_name,
    c10.t_1,
    c10.t_2,
    c10.t_3,
    c10.t_4,
    c10.t_5,
    c10.t_6,
    hdd.dept_level
    from COST_C0110 c10
    left join hos_dept_dict hdd on 
    c10.group_id=hdd.group_id and c10.hos_id=hdd.hos_id and c10.dept_code=hdd.dept_code
		<where>
				 c10.group_id = #{group_id,jdbcType=INTEGER}
				AND c10.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c10.copy_code = #{copy_code,jdbcType=VARCHAR}
				and hdd.is_stop=0
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c10.acc_year || c10.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
             <if test="dept_level == 0">
			    and hdd.is_last='1'
			 </if>
			 <if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			 </if>
			<if test="dept_code != null and dept_code != ''">
				AND c10.dept_code = #{dept_code}
			</if>
			and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by dept_code
	</select>
	
	<delete id="deleteCostAnalysisC0110" parameterType="java.util.Map">
		DELETE FROM
		cost_c0110 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0110" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0111" parameterType="java.util.Map"
		resultMap="c0111">
		 with temp as 
(
		select
    c11.group_id,
    c11.hos_id,
    c11.copy_code,
    c11.acc_year,
    c11.acc_month,
    c11.dept_code,
    c11.dept_name,
    c11.t_1,
    c11.t_2,
    c11.t_3,
    c11.t_4,
    c11.t_5,
    c11.t_6,
    hdd.dept_level
    from COST_C0111 c11
    left join hos_dept_dict hdd on 
    c11.group_id=hdd.group_id and c11.hos_id=hdd.hos_id and c11.dept_code=hdd.dept_code
		<where>
				 c11.group_id = #{group_id,jdbcType=INTEGER}
				AND c11.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c11.copy_code = #{copy_code,jdbcType=VARCHAR}
                and hdd.is_stop=0			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c11.acc_year || c11.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
             <if test="dept_level == 0">
			    and hdd.is_last='1'
			 </if>
			 <if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			 </if>
			<if test="dept_code != null and dept_code != ''">
				AND c11.dept_code = #{dept_code}
			</if>
			and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by dept_code
	</select>
	
	<select id="queryC0111Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
    c11.group_id,
    c11.hos_id,
    c11.copy_code,
    c11.acc_year,
    c11.acc_month,
    c11.dept_code,
    c11.dept_name,
    c11.t_1,
    c11.t_2,
    c11.t_3,
    c11.t_4,
    c11.t_5,
    c11.t_6,
    hdd.dept_level
    from COST_C0111 c11
    left join hos_dept_dict hdd on 
    c11.group_id=hdd.group_id and c11.hos_id=hdd.hos_id and c11.dept_code=hdd.dept_code
		<where>
				 c11.group_id = #{group_id,jdbcType=INTEGER}
				AND c11.hos_id = #{hos_id,jdbcType=INTEGER}
				AND c11.copy_code = #{copy_code,jdbcType=VARCHAR}
                and hdd.is_stop=0			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND c11.acc_year || c11.acc_month between #{begin_date} and #{end_date}
			</if>
<!-- 			<if test="dept_level != null and dept_level != ''"> -->
<!-- 				AND hdd.dept_level = #{dept_level} -->
<!-- 			</if> -->
             <if test="dept_level == 0">
			    and hdd.is_last='1'
			 </if>
			 <if test="dept_level != 0">
			    AND hdd.dept_level = #{dept_level}
			 </if>
			<if test="dept_code != null and dept_code != ''">
				AND c11.dept_code = #{dept_code}
			</if>
			and hdd.dept_code in (
			  select hd.dept_code
			 		 from v_user_data_perm b
					 left join hos_dept hd
					 on b.group_id = hd.group_id
					 and b.hos_id = hd.hos_id
					 and b.perm_code = hd.dept_id
					 where b.group_id = #{group_id}
					 and b.hos_id = #{hos_id}
					 and  b.user_id = #{user_id}
					 and  b.table_code = 'HOS_DEPT_DICT'
					 and (b.is_write = 1 or b.is_read = 1)
			
			)
		</where>
		)select group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,copy_code,acc_year,
				dept_code,dept_name
   union all
   select  null,null, null,null,null , '总计', sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by dept_code
	</select>
	
	<delete id="deleteCostAnalysisC0111" parameterType="java.util.Map">
		DELETE FROM
		cost_c0111 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0111" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0112" parameterType="java.util.Map"
		resultMap="c0112">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0112
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
		)select group_id,hos_id,acc_year,
				item_code,item_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				item_code,item_name
   union all
   select  null,null,'总计', null , null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by item_code
	</select>
	
	<select id="queryC0112Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0112
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
		)select group_id,hos_id,acc_year,
				item_code,item_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				item_code,item_name
   union all
   select  null,null,'总计', null , null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
     order by item_code
	</select>
	
	<delete id="deleteCostAnalysisC0112" parameterType="java.util.Map">
		DELETE FROM
		cost_c0112 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0112" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0113" parameterType="java.util.Map"
		resultMap="c0113">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8
		from COST_C0113
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
		)select group_id,hos_id,acc_year,
				item_code,item_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				item_code,item_name
   union all
   select  null,null, '总计',null ,null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
      order by item_code
	</select>
	
	<select id="queryC0113Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		item_code,
		item_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6,
		t_7,
		t_8
		from COST_C0113
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
		)select group_id,hos_id,acc_year,
				item_code,item_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				item_code,item_name
   union all
   select  null,null, '总计',null ,null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
      order by item_code
	</select>
	
	<delete id="deleteCostAnalysisC0113" parameterType="java.util.Map">
		DELETE FROM
		cost_c0113 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0113" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0114" parameterType="java.util.Map"
		resultMap="c0114">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0114
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>

		</where>
		)select group_id,hos_id,acc_year,
				hos_code,hos_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				hos_code,hos_name
   union all
   select  null,null, null, '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
      order by hos_code
	</select>
	
	<select id="queryC0114Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0114
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>

		</where>
		)select group_id,hos_id,acc_year,
				hos_code,hos_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				hos_code,hos_name
   union all
   select  null,null, null, '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
      order by hos_code
	</select>
	
	<delete id="deleteCostAnalysisC0114" parameterType="java.util.Map">
		DELETE FROM
		cost_c0114 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0114" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0115" parameterType="java.util.Map"
		resultMap="c0115">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0115
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
		)select group_id,hos_id,acc_year,
				hos_code,hos_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				hos_code,hos_name
   union all
   select  null,null, null , '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by hos_code
	</select>
	
	<select id="queryC0115Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0115
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
		)select group_id,hos_id,acc_year,
				hos_code,hos_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				hos_code,hos_name
   union all
   select  null,null, null , '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by hos_code
	</select>
	
	<delete id="deleteCostAnalysisC0115" parameterType="java.util.Map">
		DELETE FROM
		cost_c0115 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0115" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0116" parameterType="java.util.Map"
		resultMap="c0116">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0116
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
			)select group_id,hos_id,acc_year,
				hos_code,hos_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				hos_code,hos_name
   union all
   select  null,null, null , '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by hos_code
	</select>
	
	<select id="queryC0116Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0116
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
			)select group_id,hos_id,acc_year,
				hos_code,hos_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				hos_code,hos_name
   union all
   select  null,null, null , '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by hos_code
	</select>
	
	<delete id="deleteCostAnalysisC0116" parameterType="java.util.Map">
		DELETE FROM
		cost_c0116 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0116" parameterType="java.util.Map">

	</insert>

	<select id="queryAnalysisC0117" parameterType="java.util.Map"
		resultMap="c0117">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0117
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
			)select group_id,hos_id,acc_year,
				hos_code,hos_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				hos_code,hos_name
   union all
   select  null,null, null , '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by hos_code
	</select>
	
	<select id="queryC0117Print" parameterType="java.util.Map"	resultType="java.util.Map">
		 with temp as 
(
		select
		group_id,
		hos_id,
		acc_year,
		acc_month,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3,
		t_4,
		t_5,
		t_6
		from COST_C0117
		<where>
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			
			<if
				test="begin_date != null and begin_date != '' and end_date != null and end_date != ''">
				AND acc_year || acc_month between #{begin_date} and #{end_date}
			</if>
		</where>
			)select group_id,hos_id,acc_year,
				hos_code,hos_name, sum(t_1) t_1, max(t_2) t_2, sum(t_3) t_3 , max(t_4) t_4, sum(t_5) t_5, max(t_6) t_6 from temp
				group by group_id,hos_id,acc_year,
				hos_code,hos_name
   union all
   select  null,null, null , '总计',null, sum(t_1), sum(t_2), sum(t_3) , sum(t_4), sum(t_5), sum(t_6) from temp
    order by hos_code
	</select>
	
	<delete id="deleteCostAnalysisC0117" parameterType="java.util.Map">
		DELETE FROM
		cost_c0117 WHERE
		group_id = #{group_id} and
		hos_id = #{hos_id} and
		copy_code = #{copy_code} and
		acc_year = #{acc_year} and
		acc_month =
		#{acc_month}
	</delete>
	<insert id="addCostAnalysisC0117" parameterType="java.util.Map">

	</insert>


	<!-- <select id="queryAnalysisC0101" parameterType="java.util.Map" resultType="java.util.Map"> -->
	<!-- ${sql} -->
	<!-- </select> -->

</mapper>

