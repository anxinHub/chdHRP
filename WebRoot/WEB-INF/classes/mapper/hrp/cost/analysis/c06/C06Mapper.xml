<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chd.hrp.cost.dao.analysis.c06.C06Mapper">

	<resultMap id="c0601" type="java.util.Map">
		<result property="id" column="id" />
		<result property="group_id" column="group_id" />
		<result property="hos_id" column="hos_id" />
		<result property="copy_code" column="copy_code" />
		<result property="acc_year" column="acc_year" />
		<result property="acc_month" column="acc_month" />
		<result property="type_code" column="type_code" />
		<result property="natur_code" column="natur_code" />
		<result property="sort_code" column="sort_code" />
		<result property="dept_code" column="dept_code" />
		<result property="dept_name" column="dept_name" />
		<result property="dept_code_hb" column="dept_code_hb" />
		<result property="dept_name_hb" column="dept_name_hb" />
		<result property="hos_name" column="hos_name" />
		<result property="hos_code" column="hos_code" />
		<result property="hos_name_hb" column="hos_name_hb" />
		<result property="hos_code_hb" column="hos_code_hb" />
		<result property="t_1" column="t_1" />
		<result property="t_2" column="t_2" />
		<result property="t_3" column="t_3" />
		<result property="t_4" column="t_4" />
		<result property="t_5" column="t_5" />
		<result property="t_6" column="t_6" />
	</resultMap>
	


	<select id="queryAnalysisC0601" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0601

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
<!-- 			<if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''"> -->
				AND acc_year || acc_month = #{year_month_begin} 
<!-- 			 </if> -->
			<if test="natur_code != null and natur_code != ''">
				AND natur_code = #{natur_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3,
		t_1 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0601
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="natur_code != null and natur_code != ''">
				AND natur_code = #{natur_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3,
		t_1 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
 )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
  select null, null, null, null, null
      , '合计', sum(t_1), sum(t_2)
      , sum(t_3), null, '合计', sum(t_4)
      , sum(t_5), sum(t_6)
    from temp
	</select>
	
	<select id="queryC0601Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0601

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
<!-- 			<if test="year_month_begin != null and year_month_begin != '' and year_month_end != null and year_month_end != ''"> -->
				AND acc_year || acc_month = #{year_month_begin} 
<!-- 			 </if> -->
			
				<if test="natur_code != null and natur_code != ''">
				AND natur_code = #{natur_code,jdbcType=VARCHAR}
			</if>
			
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3,
		t_1 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0601
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="natur_code != null and natur_code != ''">
				AND natur_code = #{natur_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3,
		t_1 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
 )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select null, null, null, null, null
      , '合计', sum(t_1), sum(t_2)
      , sum(t_3), null, '合计', sum(t_4)
      , sum(t_5), sum(t_6)
    from temp
	</select>
	
	<select id="queryAnalysisC0602" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="source_attr != null and source_attr != ''">
				AND source_id in ${source_attr}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
			<if test="source_attr != null and source_attr != ''">
				AND source_id in ${source_attr}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
 )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), null ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryC0602Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<if test="source_attr != null and source_attr != ''">
				AND source_id in ${source_attr}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
			<if test="source_attr != null and source_attr != ''">
				AND source_id in ${source_attr}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
 )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), null ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryAnalysisC0603" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0603

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0603
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
 )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	<select id="queryC0603Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0603

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0603
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
 )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	<select id="queryAnalysisC0604" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0604

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0604
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
)select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryC0604Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0604

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0604
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
)select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryAnalysisC0605" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0605

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0605
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
  )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryC0605Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0605

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0605
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
  )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryAnalysisC0606" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0606

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0606
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			 AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
  )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryC0606Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.copy_code,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0606

		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0606
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<if test="copy_code != null and copy_code != ''">
				AND copy_code = #{copy_code,jdbcType=VARCHAR}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			 AND acc_year || acc_month = #{year_month_begin}
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by group_id,
		hos_id,
		copy_code,
		dept_code,
		dept_name
		order by t_3 desc,
		t_1 )) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND
		a.copy_code = b.copy_code
		AND a.id = b.id
  )select id,group_id,hos_id,copy_code,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryAnalysisC0607" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.hos_code,
		a.hos_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.hos_code hos_code_hb,
		b.hos_name hos_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			sort_code='1'
			and  type_code in ('01','02','03')
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name
		order by t_3,
		t_1 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			sort_code='2'
			and  type_code in ('01','02','03')
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name
		order by t_3,
		t_1 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.id = b.id
)select id,group_id,hos_id,hos_code,hos_name,
				 t_1,t_2, t_3,hos_code_hb, hos_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryC0607Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.hos_code,
		a.hos_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.hos_code hos_code_hb,
		b.hos_name hos_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			sort_code='1'
			and  type_code in ('01','02','03')
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name
		order by t_3,
		t_1 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			sort_code='2'
			and  type_code in ('01','02','03')
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin} 
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name
		order by t_3,
		t_1 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.id = b.id
)select id,group_id,hos_id,hos_code,hos_name,
				 t_1,t_2, t_3,hos_code_hb, hos_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryAnalysisC0608" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.hos_code,
		a.hos_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.hos_code hos_code_hb,
		b.hos_name hos_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			
				AND acc_year || acc_month = #{year_month_begin}
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name
		order by t_3,
		t_1 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name
		order by t_3,
		t_1 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.id = b.id
)select id,group_id,hos_id,hos_code,hos_name,
				 t_1,t_2, t_3,hos_code_hb, hos_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryC0608Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.hos_code,
		a.hos_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.hos_code hos_code_hb,
		b.hos_name hos_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			
				AND acc_year || acc_month = #{year_month_begin}
			 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name
		order by t_3,
		t_1 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		hos_code,
		hos_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0602 t1
		left join hos_info t2 on t1.group_id=t2.group_id and t1.hos_id=t2.hos_id
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
				AND acc_year || acc_month = #{year_month_begin}
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		hos_code,
		hos_name
		order by t_3,
		t_1 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.id = b.id
)select id,group_id,hos_id,hos_code,hos_name,
				 t_1,t_2, t_3,hos_code_hb, hos_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryAnalysisC0609" parameterType="java.util.Map" resultMap="c0601">
with temp as
 (select rownum as id,
         tt.group_id,
         tt.hos_id,
         tt.hos_code,
         tt.hos_name,
         tt.t_1,
         tt.t_2,
         tt.t_3,
         cc.hos_code as hos_code_hb,
         cc.hos_name as hos_name_hb,
         cc.t_4,
         cc.t_5,
         cc.t_6
    from (select t1.group_id,
                 t1.hos_id,
                 hos_code,
                 hos_name,
                 sum(t_1) as t_1,
                 sum(t_2) as t_2,
                 sum(t_3) as t_3
            from (SELECT a.group_id,
                         a.hos_id,
                        
                         a.dept_code,
                         a.dept_name,
                         t3.type_code,
                         t3.natur_code,
                         nvl(b.amount, 0) AS t_1,
                         nvl(c.amount, 0) AS t_2,
                         CASE
                           WHEN nvl(c.amount, 0) = 0 THEN
                            0
                           ELSE
                            (nvl(b.amount, 0) - nvl(c.amount, 0)) /
                            nvl(c.amount, 0) * 100
                         END AS t_3
                    FROM hos_dept_dict a
                    LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                FROM cost_dept_cost
                                <where>
                                <if test="group_id != null and group_id != ''">
				                   AND group_id = #{group_id,jdbcType=INTEGER}
			                    </if>
			                    <if test="hos_id != null and hos_id != ''">
				                   AND hos_id = #{hos_id,jdbcType=INTEGER}
			                    </if>
			                      AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin}
			                   
                                and source_id in ('1', '2')
                                </where>
                               GROUP BY dept_id) b
                      ON a.dept_id = b.dept_id
                    LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                FROM cost_dept_cost
                               <where>
                                <if test="group_id != null and group_id != ''">
				                   AND group_id = #{group_id,jdbcType=INTEGER}
			                    </if>
			                    <if test="hos_id != null and hos_id != ''">
				                   AND hos_id = #{hos_id,jdbcType=INTEGER}
			                    </if>
			                      AND acc_year || acc_month = #{acc_year_begin}-1 || #{acc_month_begin}
			                   
                                and source_id in ('1', '2')
                               </where>
                               GROUP BY dept_id) c
                      ON a.dept_id = c.dept_id
                   inner join acc_dept_attr t3
                      on a.group_id = t3.group_id
                     and a.hos_id = t3.hos_id
                     and a.dept_id = t3.dept_id
                   WHERE a.is_last = '1'
                     AND a.group_id = '3'
                     AND a.hos_id = '3') t1
            left join hos_info t2
              on t1.group_id = t2.group_id
             and t1.hos_id = t2.hos_id
           group by t1.group_id, t1.hos_id, hos_code, hos_name) tt
    left join (select t3.group_id,
                     t3.hos_id,
                     hos_code,
                     hos_name,
                     sum(t_4) as t_4,
                     sum(t_5) as t_5,
                     sum(t_6) as t_6
                from (SELECT a.group_id,
                             a.hos_id,
                             a.dept_code,
                             a.dept_name,
                             t3.type_code,
                             t3.natur_code,
                             nvl(b.amount, 0) AS t_4,
                             nvl(c.amount, 0) AS t_5,
                             CASE
                               WHEN nvl(c.amount, 0) = 0 THEN
                                0
                               ELSE
                                (nvl(b.amount, 0) - nvl(c.amount, 0)) /
                                nvl(c.amount, 0) * 100
                             END AS t_6
                        FROM hos_dept_dict a
                        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                    FROM cost_dept_cost
                                   <where>
                                    <if test="group_id != null and group_id != ''">
				                       AND group_id = #{group_id,jdbcType=INTEGER}
			                        </if>
			                        <if test="hos_id != null and hos_id != ''">
				                       AND hos_id = #{hos_id,jdbcType=INTEGER}
			                        </if>
			                          AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin}
			                        
                                       and source_id in ('1', '2')
                                   </where>
                                   GROUP BY dept_id) b
                          ON a.dept_id = b.dept_id
                        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                    FROM cost_dept_cost
                                   <where>
                                     <if test="group_id != null and group_id != ''">
				                        AND group_id = #{group_id,jdbcType=INTEGER}
			                         </if>
			                         <if test="hos_id != null and hos_id != ''">
				                        AND hos_id = #{hos_id,jdbcType=INTEGER}
			                         </if>
			                          AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin}-1 
			                        
                                        and source_id in ('1', '2')
                                   </where>
                                   GROUP BY dept_id) c
                          ON a.dept_id = c.dept_id
                       inner join acc_dept_attr t3
                          on a.group_id = t3.group_id
                         and a.hos_id = t3.hos_id
                         and a.dept_id = t3.dept_id
                       WHERE a.is_last = '1'
                         AND a.group_id = '3'
                         AND a.hos_id = '3') t3
                left join hos_info t4
                  on t3.group_id = t4.group_id
                 and t3.hos_id = t4.hos_id
               group by t3.group_id, t3.hos_id, hos_code, hos_name) cc
      on tt.group_id = cc.group_id
     and tt.hos_id = cc.hos_id)
select id, group_id, hos_id, hos_code, hos_name, t_1, t_2, t_3, hos_code_hb, hos_name_hb, t_4, t_5, t_6
  from temp
union all
select null, null, null, null, '合计', sum(t_1), sum(t_2), sum(t_3), null, '合计', sum(t_4), sum(t_5), sum(t_6)
  from temp
	
	
	</select>
	
	<select id="queryC0609Print" parameterType="java.util.Map" resultType="java.util.Map">
with temp as
 (select rownum as id,
         tt.group_id,
         tt.hos_id,
         tt.hos_code,
         tt.hos_name,
         tt.t_1,
         tt.t_2,
         tt.t_3,
         cc.hos_code as hos_code_hb,
         cc.hos_name as hos_name_hb,
         cc.t_4,
         cc.t_5,
         cc.t_6
    from (select t1.group_id,
                 t1.hos_id,
                 hos_code,
                 hos_name,
                 sum(t_1) as t_1,
                 sum(t_2) as t_2,
                 sum(t_3) as t_3
            from (SELECT a.group_id,
                         a.hos_id,
                        
                         a.dept_code,
                         a.dept_name,
                         t3.type_code,
                         t3.natur_code,
                         nvl(b.amount, 0) AS t_1,
                         nvl(c.amount, 0) AS t_2,
                         CASE
                           WHEN nvl(c.amount, 0) = 0 THEN
                            0
                           ELSE
                            (nvl(b.amount, 0) - nvl(c.amount, 0)) /
                            nvl(c.amount, 0) * 100
                         END AS t_3
                    FROM hos_dept_dict a
                    LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                FROM cost_dept_cost
                                <where>
                                <if test="group_id != null and group_id != ''">
				                   AND group_id = #{group_id,jdbcType=INTEGER}
			                    </if>
			                    <if test="hos_id != null and hos_id != ''">
				                   AND hos_id = #{hos_id,jdbcType=INTEGER}
			                    </if>
			                      AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin}
			                   
                                and source_id in ('1', '2')
                                </where>
                               GROUP BY dept_id) b
                      ON a.dept_id = b.dept_id
                    LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                FROM cost_dept_cost
                               <where>
                                <if test="group_id != null and group_id != ''">
				                   AND group_id = #{group_id,jdbcType=INTEGER}
			                    </if>
			                    <if test="hos_id != null and hos_id != ''">
				                   AND hos_id = #{hos_id,jdbcType=INTEGER}
			                    </if>
			                      AND acc_year || acc_month = #{acc_year_begin}-1 || #{acc_month_begin}
			                   
                                and source_id in ('1', '2')
                               </where>
                               GROUP BY dept_id) c
                      ON a.dept_id = c.dept_id
                   inner join acc_dept_attr t3
                      on a.group_id = t3.group_id
                     and a.hos_id = t3.hos_id
                     and a.dept_id = t3.dept_id
                   WHERE a.is_last = '1'
                     AND a.group_id = '3'
                     AND a.hos_id = '3') t1
            left join hos_info t2
              on t1.group_id = t2.group_id
             and t1.hos_id = t2.hos_id
           group by t1.group_id, t1.hos_id, hos_code, hos_name) tt
    left join (select t3.group_id,
                     t3.hos_id,
                     hos_code,
                     hos_name,
                     sum(t_4) as t_4,
                     sum(t_5) as t_5,
                     sum(t_6) as t_6
                from (SELECT a.group_id,
                             a.hos_id,
                             a.dept_code,
                             a.dept_name,
                             t3.type_code,
                             t3.natur_code,
                             nvl(b.amount, 0) AS t_4,
                             nvl(c.amount, 0) AS t_5,
                             CASE
                               WHEN nvl(c.amount, 0) = 0 THEN
                                0
                               ELSE
                                (nvl(b.amount, 0) - nvl(c.amount, 0)) /
                                nvl(c.amount, 0) * 100
                             END AS t_6
                        FROM hos_dept_dict a
                        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                    FROM cost_dept_cost
                                   <where>
                                    <if test="group_id != null and group_id != ''">
				                       AND group_id = #{group_id,jdbcType=INTEGER}
			                        </if>
			                        <if test="hos_id != null and hos_id != ''">
				                       AND hos_id = #{hos_id,jdbcType=INTEGER}
			                        </if>
			                          AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin}
			                        
                                       and source_id in ('1', '2')
                                   </where>
                                   GROUP BY dept_id) b
                          ON a.dept_id = b.dept_id
                        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                    FROM cost_dept_cost
                                   <where>
                                     <if test="group_id != null and group_id != ''">
				                        AND group_id = #{group_id,jdbcType=INTEGER}
			                         </if>
			                         <if test="hos_id != null and hos_id != ''">
				                        AND hos_id = #{hos_id,jdbcType=INTEGER}
			                         </if>
			                          AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin}-1 
			                        
                                        and source_id in ('1', '2')
                                   </where>
                                   GROUP BY dept_id) c
                          ON a.dept_id = c.dept_id
                       inner join acc_dept_attr t3
                          on a.group_id = t3.group_id
                         and a.hos_id = t3.hos_id
                         and a.dept_id = t3.dept_id
                       WHERE a.is_last = '1'
                         AND a.group_id = '3'
                         AND a.hos_id = '3') t3
                left join hos_info t4
                  on t3.group_id = t4.group_id
                 and t3.hos_id = t4.hos_id
               group by t3.group_id, t3.hos_id, hos_code, hos_name) cc
      on tt.group_id = cc.group_id
     and tt.hos_id = cc.hos_id)
select id, group_id, hos_id, hos_code, hos_name, t_1, t_2, t_3, hos_code_hb, hos_name_hb, t_4, t_5, t_6
  from temp
union all
select null, null, null, null, '合计', sum(t_1), sum(t_2), sum(t_3), null, '合计', sum(t_4), sum(t_5), sum(t_6)
  from temp
	
	
	</select>
	
	<select id="queryAnalysisC0610" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as
 (select rownum as id,
         tt.group_id,
         tt.hos_id,
         tt.hos_code,
         tt.hos_name,
         tt.t_1,
         tt.t_2,
         tt.t_3,
         cc.hos_code as hos_code_hb,
         cc.hos_name as hos_name_hb,
         cc.t_4,
         cc.t_5,
         cc.t_6
    from (select t1.group_id,
                 t1.hos_id,
                 hos_code,
                 hos_name,
                 sum(t_1) as t_1,
                 sum(t_2) as t_2,
                 sum(t_3) as t_3
            from (SELECT a.group_id,
                         a.hos_id,
                        
                         a.dept_code,
                         a.dept_name,
                         t3.type_code,
                         t3.natur_code,
                         nvl(b.amount, 0) AS t_1,
                         nvl(c.amount, 0) AS t_2,
                         CASE
                           WHEN nvl(c.amount, 0) = 0 THEN
                            0
                           ELSE
                            (nvl(b.amount, 0) - nvl(c.amount, 0)) /
                            nvl(c.amount, 0) * 100
                         END AS t_3
                    FROM hos_dept_dict a
                    LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                FROM cost_dept_cost
                                <where>
                                <if test="group_id != null and group_id != ''">
				                   AND group_id = #{group_id,jdbcType=INTEGER}
			                    </if>
			                    <if test="hos_id != null and hos_id != ''">
				                   AND hos_id = #{hos_id,jdbcType=INTEGER}
			                    </if>
			                      AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin} 
			                   
                                 and source_id in ('1', '2','3','4')
                                </where>
                               GROUP BY dept_id) b
                      ON a.dept_id = b.dept_id
                    LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                FROM cost_dept_cost
                               <where>
                                <if test="group_id != null and group_id != ''">
				                   AND group_id = #{group_id,jdbcType=INTEGER}
			                    </if>
			                    <if test="hos_id != null and hos_id != ''">
				                   AND hos_id = #{hos_id,jdbcType=INTEGER}
			                    </if>
			                      AND acc_year || acc_month = #{acc_year_begin}-1 || #{acc_month_begin}
			                    
                                 and source_id in ('1', '2','3','4')
                               </where>
                               GROUP BY dept_id) c
                      ON a.dept_id = c.dept_id
                   inner join acc_dept_attr t3
                      on a.group_id = t3.group_id
                     and a.hos_id = t3.hos_id
                     and a.dept_id = t3.dept_id
                   WHERE a.is_last = '1'
                     AND a.group_id = '3'
                     AND a.hos_id = '3') t1
            left join hos_info t2
              on t1.group_id = t2.group_id
             and t1.hos_id = t2.hos_id
           group by t1.group_id, t1.hos_id, hos_code, hos_name) tt
    left join (select t3.group_id,
                     t3.hos_id,
                     hos_code,
                     hos_name,
                     sum(t_4) as t_4,
                     sum(t_5) as t_5,
                     sum(t_6) as t_6
                from (SELECT a.group_id,
                             a.hos_id,
                             a.dept_code,
                             a.dept_name,
                             t3.type_code,
                             t3.natur_code,
                             nvl(b.amount, 0) AS t_4,
                             nvl(c.amount, 0) AS t_5,
                             CASE
                               WHEN nvl(c.amount, 0) = 0 THEN
                                0
                               ELSE
                                (nvl(b.amount, 0) - nvl(c.amount, 0)) /
                                nvl(c.amount, 0) * 100
                             END AS t_6
                        FROM hos_dept_dict a
                        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                    FROM cost_dept_cost
                                   <where>
                                    <if test="group_id != null and group_id != ''">
				                       AND group_id = #{group_id,jdbcType=INTEGER}
			                        </if>
			                        <if test="hos_id != null and hos_id != ''">
				                       AND hos_id = #{hos_id,jdbcType=INTEGER}
			                        </if>
			                          AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin} 
			                       
                                        and source_id in ('1', '2','3','4')
                                   </where>
                                   GROUP BY dept_id) b
                          ON a.dept_id = b.dept_id
                        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                    FROM cost_dept_cost
                                   <where>
                                     <if test="group_id != null and group_id != ''">
				                        AND group_id = #{group_id,jdbcType=INTEGER}
			                         </if>
			                         <if test="hos_id != null and hos_id != ''">
				                        AND hos_id = #{hos_id,jdbcType=INTEGER}
			                         </if>
			                           AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin}-1 
			                         
                                        and source_id in ('1', '2','3','4')
                                   </where>
                                   GROUP BY dept_id) c
                          ON a.dept_id = c.dept_id
                       inner join acc_dept_attr t3
                          on a.group_id = t3.group_id
                         and a.hos_id = t3.hos_id
                         and a.dept_id = t3.dept_id
                       WHERE a.is_last = '1'
                         AND a.group_id = '3'
                         AND a.hos_id = '3') t3
                left join hos_info t4
                  on t3.group_id = t4.group_id
                 and t3.hos_id = t4.hos_id
               group by t3.group_id, t3.hos_id, hos_code, hos_name) cc
      on tt.group_id = cc.group_id
     and tt.hos_id = cc.hos_id)
select id, group_id, hos_id, hos_code, hos_name, t_1, t_2, t_3, hos_code_hb, hos_name_hb, t_4, t_5, t_6
  from temp
union all
select null, null, null, null, '合计', sum(t_1), sum(t_2), sum(t_3), null, '合计', sum(t_4), sum(t_5), sum(t_6)
  from temp  
	</select>
	
<select id="queryC0610Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as
 (select rownum as id,
         tt.group_id,
         tt.hos_id,
         tt.hos_code,
         tt.hos_name,
         tt.t_1,
         tt.t_2,
         tt.t_3,
         cc.hos_code as hos_code_hb,
         cc.hos_name as hos_name_hb,
         cc.t_4,
         cc.t_5,
         cc.t_6
    from (select t1.group_id,
                 t1.hos_id,
                 hos_code,
                 hos_name,
                 sum(t_1) as t_1,
                 sum(t_2) as t_2,
                 sum(t_3) as t_3
            from (SELECT a.group_id,
                         a.hos_id,
                        
                         a.dept_code,
                         a.dept_name,
                         t3.type_code,
                         t3.natur_code,
                         nvl(b.amount, 0) AS t_1,
                         nvl(c.amount, 0) AS t_2,
                         CASE
                           WHEN nvl(c.amount, 0) = 0 THEN
                            0
                           ELSE
                            (nvl(b.amount, 0) - nvl(c.amount, 0)) /
                            nvl(c.amount, 0) * 100
                         END AS t_3
                    FROM hos_dept_dict a
                    LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                FROM cost_dept_cost
                                <where>
                                <if test="group_id != null and group_id != ''">
				                   AND group_id = #{group_id,jdbcType=INTEGER}
			                    </if>
			                    <if test="hos_id != null and hos_id != ''">
				                   AND hos_id = #{hos_id,jdbcType=INTEGER}
			                    </if>
			                      AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin} 
			                   
                                 and source_id in ('1', '2','3','4')
                                </where>
                               GROUP BY dept_id) b
                      ON a.dept_id = b.dept_id
                    LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                FROM cost_dept_cost
                               <where>
                                <if test="group_id != null and group_id != ''">
				                   AND group_id = #{group_id,jdbcType=INTEGER}
			                    </if>
			                    <if test="hos_id != null and hos_id != ''">
				                   AND hos_id = #{hos_id,jdbcType=INTEGER}
			                    </if>
			                      AND acc_year || acc_month = #{acc_year_begin}-1 || #{acc_month_begin}
			                    
                                 and source_id in ('1', '2','3','4')
                               </where>
                               GROUP BY dept_id) c
                      ON a.dept_id = c.dept_id
                   inner join acc_dept_attr t3
                      on a.group_id = t3.group_id
                     and a.hos_id = t3.hos_id
                     and a.dept_id = t3.dept_id
                   WHERE a.is_last = '1'
                     AND a.group_id = '3'
                     AND a.hos_id = '3') t1
            left join hos_info t2
              on t1.group_id = t2.group_id
             and t1.hos_id = t2.hos_id
           group by t1.group_id, t1.hos_id, hos_code, hos_name) tt
    left join (select t3.group_id,
                     t3.hos_id,
                     hos_code,
                     hos_name,
                     sum(t_4) as t_4,
                     sum(t_5) as t_5,
                     sum(t_6) as t_6
                from (SELECT a.group_id,
                             a.hos_id,
                             a.dept_code,
                             a.dept_name,
                             t3.type_code,
                             t3.natur_code,
                             nvl(b.amount, 0) AS t_4,
                             nvl(c.amount, 0) AS t_5,
                             CASE
                               WHEN nvl(c.amount, 0) = 0 THEN
                                0
                               ELSE
                                (nvl(b.amount, 0) - nvl(c.amount, 0)) /
                                nvl(c.amount, 0) * 100
                             END AS t_6
                        FROM hos_dept_dict a
                        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                    FROM cost_dept_cost
                                   <where>
                                    <if test="group_id != null and group_id != ''">
				                       AND group_id = #{group_id,jdbcType=INTEGER}
			                        </if>
			                        <if test="hos_id != null and hos_id != ''">
				                       AND hos_id = #{hos_id,jdbcType=INTEGER}
			                        </if>
			                          AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin} 
			                       
                                        and source_id in ('1', '2','3','4')
                                   </where>
                                   GROUP BY dept_id) b
                          ON a.dept_id = b.dept_id
                        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                                    FROM cost_dept_cost
                                   <where>
                                     <if test="group_id != null and group_id != ''">
				                        AND group_id = #{group_id,jdbcType=INTEGER}
			                         </if>
			                         <if test="hos_id != null and hos_id != ''">
				                        AND hos_id = #{hos_id,jdbcType=INTEGER}
			                         </if>
			                           AND acc_year || acc_month = #{acc_year_begin} || #{acc_month_begin}-1 
			                         
                                        and source_id in ('1', '2','3','4')
                                   </where>
                                   GROUP BY dept_id) c
                          ON a.dept_id = c.dept_id
                       inner join acc_dept_attr t3
                          on a.group_id = t3.group_id
                         and a.hos_id = t3.hos_id
                         and a.dept_id = t3.dept_id
                       WHERE a.is_last = '1'
                         AND a.group_id = '3'
                         AND a.hos_id = '3') t3
                left join hos_info t4
                  on t3.group_id = t4.group_id
                 and t3.hos_id = t4.hos_id
               group by t3.group_id, t3.hos_id, hos_code, hos_name) cc
      on tt.group_id = cc.group_id
     and tt.hos_id = cc.hos_id)
select id, group_id, hos_id, hos_code, hos_name, t_1, t_2, t_3, hos_code_hb, hos_name_hb, t_4, t_5, t_6
  from temp
union all
select null, null, null, null, '合计', sum(t_1), sum(t_2), sum(t_3), null, '合计', sum(t_4), sum(t_5), sum(t_6)
  from temp  
	</select>
	
	<select id="queryAnalysisC0611" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0607 t1
		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin}
			  
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name
		order by dept_code desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0607 t1
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month &lt;= #{year_month_begin} 
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name
		order by dept_code desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.dept_code = b.dept_code
 )select id,group_id,hos_id,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryC0611Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0607 t1
		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin}
			  
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name
		order by t_3 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0607 t1
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin} 
			
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name
		order by t_3 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.id = b.id
 )select id,group_id,hos_id,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryAnalysisC0612" parameterType="java.util.Map"
		resultMap="c0601">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0608 t1
		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
		     AND acc_year || acc_month = #{year_month_begin} 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name
		order by t_3 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0608 t1
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin} 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name
		order by t_3 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.id = b.id
 )select id,group_id,hos_id,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>
	
	<select id="queryC0612Print" parameterType="java.util.Map"	resultType="java.util.Map">
 with temp as 
(
		SELECT a.id,
		a.group_id,
		a.hos_id,
		a.dept_code,
		a.dept_name,
		a.t_1,
		a.t_2,
		a.t_3,
		b.dept_code dept_code_hb,
		b.dept_name dept_name_hb,
		b.t_1 t_4,
		b.t_2 t_5,
		b.t_3 t_6
		FROM
		(select rownum id,
		group_id,
		hos_id,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0608 t1
		<where>
			sort_code='1'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
		     AND acc_year || acc_month = #{year_month_begin} 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name
		order by t_3 desc)) a
		LEFT JOIN (select rownum id,
		group_id,
		hos_id,
		dept_code,
		dept_name,
		t_1,
		t_2,
		t_3
		from (select t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name,
		sum(t_1) t_1,
		sum(t_2) t_2,
		sum(t_3) t_3
		FROM COST_C0608 t1
		<where>
			sort_code='2'
			<if test="group_id != null and group_id != ''">
				AND t1.group_id = #{group_id,jdbcType=INTEGER}
			</if>
			<if test="hos_id != null and hos_id != ''">
				AND t1.hos_id = #{hos_id,jdbcType=INTEGER}
			</if>
			<!-- <if test="acc_year != null and acc_year != ''">
				AND acc_year = #{acc_year}
			</if>
			<if
				test="acc_month1 != null and acc_month1 != '' and acc_month2 != null and acc_month2 != ''">
				AND acc_month between #{acc_month1} and #{acc_month2}
			</if> -->
			AND acc_year || acc_month = #{year_month_begin} 
			<if test="type_code != null and type_code != ''">
				AND type_code = #{type_code,jdbcType=VARCHAR}
			</if>
		</where>
		group by t1.group_id,
		t1.hos_id,
		dept_code,
		dept_name
		order by t_3 desc)) b
		ON a.group_id = b.group_id
		AND a.hos_id = b.hos_id
		AND a.id = b.id
 )select id,group_id,hos_id,dept_code,dept_name,
				 t_1,t_2, t_3,dept_code_hb, dept_name_hb,t_4,t_5,t_6 from temp
   union all
   select  null,null, null,null ,'合计', sum(t_1), sum(t_2), sum(t_3) ,null ,'合计', sum(t_4), sum(t_5), sum(t_6) from temp
    
	</select>

</mapper>

