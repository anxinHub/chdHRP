<?xml version="1.0" encoding="UTF-8" ?>
<root>
	<!-- 成本分摊存储过程 -->
	<sql id="PKG_COST_ANALYSIS" type="proc"><![CDATA[
	CREATE OR REPLACE PACKAGE pkg_cost_analysis IS
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0101_proc
  || 功能描述 ：医疗受益总表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0101_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0103_proc
  || 功能描述 ：临床结余分析 医疗业务成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0103_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0104_proc
  || 功能描述 ：临床结余分析 医疗成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0104_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0105_proc
  || 功能描述 ：临床结余分析 医疗全成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0105_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0106_proc
  || 功能描述 ：临床结余分析 医院全成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0106_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0107_proc
  || 功能描述 ：临床结余分析 自身经营收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0107_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0108_proc
  || 功能描述 ：医技结余分析 医疗业务成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0108_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0109_proc
  || 功能描述 ：医技结余分析 医疗成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0109_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0110_proc
  || 功能描述 ：医技结余分析 医疗全成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0110_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0111_proc
  || 功能描述 ：临床结余分析 医院全成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0111_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0112_proc
  || 功能描述 ：集团医疗受益总表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0112_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0114_proc
  || 功能描述 ：集团结余分析 医疗业务成本收益明细表 
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0114_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0115_proc
  || 功能描述 ：集团结余分析 医疗成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0115_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0116_proc
  || 功能描述 ：集团结余分析 医疗全成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0116_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0117_proc
  || 功能描述 ：集团结余分析 医院全成本收益明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0117_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0201_proc
  || 功能描述 ：临床构成分析 医疗构成分析总表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0201_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0202_proc
  || 功能描述 ：临床构成分析 医疗业务构成分析明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0202_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0203_proc
  || 功能描述 ：临床构成分析 医疗构成分析明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0203_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0204_proc
  || 功能描述 ：临床构成分析 医疗全成本构成分析明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0204_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0205_proc
  || 功能描述 ：临床构成分析 医院全成本构成分析明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0205_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0206_proc
  || 功能描述 ：收入构成分析 明细表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0206_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0301_proc
  || 功能描述 ：收入分类分析
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0301_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0302_proc
  || 功能描述 ：医疗成本构成
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0302_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0401_proc
  || 功能描述 ：科室成本习性
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0401_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0501_proc
  || 功能描述 ：医疗业务成本对比分析
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0501_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0502_proc
  || 功能描述 ：科室医疗业务成本对比分析
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0502_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0601_proc
  || 功能描述 ：门诊住院收入排序
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0601_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0602_proc
  || 功能描述 ：门诊住院收入排序
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0602_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0603_proc
  || 功能描述 ：门诊住院收入排序
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0603_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0604_proc
  || 功能描述 ：门诊住院收入排序
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0604_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0605_proc
  || 功能描述 ：门诊住院收入排序
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0605_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0606_proc
  || 功能描述 ：门诊住院收入排序
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0606_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0607_proc
  || 功能描述 ：医院收临床益排序表
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0607_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );

  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0608_proc
  || 功能描述 ：医技收益排序
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0608_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ); /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0701_proc
  || 功能描述 ：诊次成本分析
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0701_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ); /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0801_proc
  || 功能描述 ：医院成本指标分析
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0801_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ); /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c0802_proc
  || 功能描述 ：集团成本指标分析
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c0802_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_c09_proc
  || 功能描述 ：门诊盈亏分析
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_c09_proc(p_group_id  NUMBER
                                  , --集团ID
                                   p_hos_id    NUMBER
                                  , --医院ID
                                   p_copy_code VARCHAR2
                                  , --帐套编码
                                   p_acc_year  VARCHAR2
                                  , --分析年度
                                   p_acc_month VARCHAR2 --分析月份
                                   );
  /*-------------------------------------------------------------------------
  || 过程名称 ：cost_analysis_proc
  || 功能描述 ：成本分析执行入口
  || 参数描述 ：参数标识          名称             输入/输出    类型
  ||            -------------------------------------------------------------
  ||            prm_group_id        集团             IN           NUMBER
  ||            prm_hos_id          医院             IN           NUMBER
  ||            prm_copy_code       账套             IN           VARCHAR2
  ||            prm_acc_year        年度             IN           VARCHAR2
  ||            prm_acc_month       月份             IN           VARCHAR2
  ||
  || 作    者 ：           完成日期 ：
  ||-------------------------------------------------------------------------
  || 修改记录 ：           修改日期：
  ||-------------------------------------------------------------------------*/
  PROCEDURE cost_analysis_proc(p_group_id  NUMBER
                              , --集团ID
                               p_hos_id    NUMBER
                              , --医院ID
                               p_copy_code VARCHAR2
                              , --帐套编码
                               p_acc_year  VARCHAR2
                              , --分析年度
                               p_acc_month VARCHAR2 --分析月份
                               );
END pkg_cost_analysis;
	
	]]></sql>
	<sql id="PKG_COST_ANALYSIS_BODY" type="proc"><![CDATA[
	
	CREATE OR REPLACE PACKAGE BODY pkg_cost_analysis IS
  PROCEDURE cost_analysis_c0101_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *医疗受益总表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE NUMBER(4)                     项目编码
    ITEM_NAME VARCHAR2(50) Y                项目名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                成本_本期
    T_4       NUMBER(30,6) Y                成本_累计
    T_5       NUMBER(30,6) Y                收益_本期
    T_6       NUMBER(30,6) Y                收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0101
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0101
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,t1.item_code
            ,t1.item_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,t2.income_money - t4.cost_money
            ,t3.income_money - t5.cost_money
        FROM (SELECT 1 item_code, '医疗业务成本' item_name
                FROM dual
              UNION ALL
              SELECT 2 item_code, '门诊' item_name
                FROM dual
              UNION ALL
              SELECT 3 item_code, '住院' item_name
                FROM dual
              UNION ALL
              SELECT 4 item_code, '医疗成本' item_name
                FROM dual
              UNION ALL
              SELECT 5 item_code, '门诊' item_name
                FROM dual
              UNION ALL
              SELECT 6 item_code, '住院' item_name
                FROM dual
              UNION ALL
              SELECT 7 item_code, '医疗全成本' item_name
                FROM dual
              UNION ALL
              SELECT 8 item_code, '门诊' item_name
                FROM dual
              UNION ALL
              SELECT 9 item_code, '住院' item_name
                FROM dual
              UNION ALL
              SELECT 10 item_code, '医院全成本' item_name
                FROM dual
              UNION ALL
              SELECT 11 item_code, '门诊' item_name
                FROM dual
              UNION ALL
              SELECT 12 item_code, '住院' item_name
                FROM dual) t1
        LEFT JOIN (
                   
                   SELECT item_code, SUM(income_money) income_money
                     FROM (SELECT 1 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code IN ('01', '02')
                            UNION ALL
                            
                            SELECT 2 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 3 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 4 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code IN ('01', '02')
                            UNION ALL
                            SELECT 5 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 6 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 7 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code IN ('01', '02')
                            
                            UNION ALL
                            SELECT 8 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 9 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 10 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code IN ('01', '02')
                            
                            UNION ALL
                            SELECT 11 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 12 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            
                            )
                    GROUP BY item_code) t2
          ON t1.item_code = t2.item_code
      
        LEFT JOIN (
                   
                   SELECT item_code, SUM(income_money) income_money
                     FROM (SELECT 1 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code IN ('01', '02')
                            
                            UNION ALL
                            SELECT 2 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 3 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 4 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code IN ('01', '02')
                            
                            UNION ALL
                            SELECT 5 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 6 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 7 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code IN ('01', '02')
                            
                            UNION ALL
                            SELECT 8 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 9 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 10 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code IN ('01', '02')
                            
                            UNION ALL
                            SELECT 11 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 12 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND hos_id = p_hos_id
                               AND copy_code = p_copy_code
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            
                            )
                    GROUP BY item_code) t3
          ON t1.item_code = t3.item_code
        LEFT JOIN
      
       (SELECT item_code, SUM(cost_money) cost_money
          FROM (SELECT 1 item_code
                      ,SUM(t1.dir_amount + t1.dir_ass_amount +
                           t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code IN ('01', '02')
                
                UNION ALL
                SELECT 2 item_code
                      ,SUM(t1.dir_amount + t1.dir_ass_amount +
                           t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '01'
                UNION ALL
                SELECT 3 item_code
                      ,SUM(t1.dir_amount + t1.dir_ass_amount +
                           t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '02'
                UNION ALL
                SELECT 4 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code IN ('01', '02')
                
                UNION ALL
                SELECT 5 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '01'
                UNION ALL
                SELECT 6 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '02'
                UNION ALL
                SELECT 7 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr IN (1, 2)
                   AND natur_code IN ('01', '02')
                
                UNION ALL
                SELECT 8 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr IN (1, 2)
                   AND natur_code = '01'
                UNION ALL
                SELECT 9 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr IN (1, 2)
                   AND natur_code = '02'
                UNION ALL
                SELECT 10 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND natur_code IN ('01', '02')
                
                UNION ALL
                SELECT 11 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND natur_code = '01'
                UNION ALL
                SELECT 12 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 WHERE t1.group_id = p_group_id
                   AND t1.hos_id = p_hos_id
                   AND copy_code = p_copy_code
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND natur_code = '02')
         GROUP BY item_code) t4
          ON t1.item_code = t4.item_code
        LEFT JOIN (SELECT item_code, SUM(cost_money) cost_money
                     FROM (SELECT 1 item_code
                                 ,SUM(t1.dir_amount + t1.dir_ass_amount +
                                      t1.dir_med_amount +
                                      t1.indir_med_ass_amount) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code IN ('01', '02')
                           
                           UNION ALL
                           SELECT 2 item_code
                                 ,SUM(t1.dir_amount + t1.dir_ass_amount +
                                      t1.dir_med_amount +
                                      t1.indir_med_ass_amount) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 3 item_code
                                 ,SUM(t1.dir_amount + t1.dir_ass_amount +
                                      t1.dir_med_amount +
                                      t1.indir_med_ass_amount) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 4 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code IN ('01', '02')
                           
                           UNION ALL
                           SELECT 5 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 6 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 7 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr IN (1, 2)
                              AND natur_code IN ('01', '02')
                           
                           UNION ALL
                           SELECT 8 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr IN (1, 2)
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 9 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr IN (1, 2)
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 10 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND natur_code IN ('01', '02')
                           
                           UNION ALL
                           SELECT 11 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 12 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND natur_code = '02')
                    GROUP BY item_code) t5
          ON t1.item_code = t5.item_code
      
      ;
  
    /*
    ****************************************************************************
    *医疗受益分析           结束
    ****************************************************************************
    */
  
    DELETE FROM cost_c0102
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0102
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_5
      ,t_6
      ,t_7
      ,t_8)
      SELECT group_id
            ,hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,item_code
            ,item_name
            ,t_1
            ,t_2
            ,t_3
            ,t_4
            ,t_5
            ,t_6
        FROM cost_c0101
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
  
  END cost_analysis_c0101_proc;
  PROCEDURE cost_analysis_c0103_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *临床结余分析 医疗业务成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0103
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0103
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,a.dept_code
            ,a.dept_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,t2.income_money - t4.cost_money
            ,t3.income_money - t5.cost_money
        FROM (
              
              SELECT t1.dept_id
                     ,SUM(t1.dir_amount + t1.dir_ass_amount +
                          t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                FROM cost_dept_cost t1
                LEFT JOIN acc_dept_attr b
                  ON t1.group_id = b.group_id
                 AND t1.hos_id = b.hos_id
                 AND t1.dept_id = b.dept_id
               INNER JOIN hos_source tv
                  ON t1.group_id = tv.group_id
                 AND t1.hos_id = tv.hos_id
                 AND t1.source_id = tv.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                 AND tv.source_attr = 1
                 AND type_code = '01'
               GROUP BY t1.dept_id) t5
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = t5.dept_id
        
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND a.is_stop = 0
        LEFT JOIN acc_dept_attr b
          ON t5.dept_id = b.dept_id
         AND b.group_id = p_group_id
         AND b.hos_id = p_hos_id
         AND b.type_code = '01'
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '01'
                    GROUP BY dept_id) t2
          ON t5.dept_id = t2.dept_id
      
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND type_code = '01'
                    GROUP BY dept_id) t3
          ON t5.dept_id = t3.dept_id
        LEFT JOIN
      
       (
        
        SELECT t1.dept_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
           AND t1.dept_id = b.dept_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND copy_code = p_copy_code
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr = 1
           AND type_code = '01'
         GROUP BY t1.dept_id) t4
          ON t5.dept_id = t4.dept_id
      
      ;
  
    /*
    ****************************************************************************
    *临床结余分析 医疗业务成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0103_proc;
  PROCEDURE cost_analysis_c0104_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *临床结余分析 医疗成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0104
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0104
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,a.dept_code
            ,a.dept_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,t2.income_money - t4.cost_money
            ,t3.income_money - t5.cost_money
        FROM (
              
              SELECT t1.dept_id
                     ,SUM(t1.dir_amount + t1.dir_ass_amount +
                          t1.dir_med_amount + t1.indir_med_ass_amount +
                          DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                          INDIR_MED_MAN_AMOUNT + INDIR_ASS_MED_MAN_AMOUNT) cost_money
                FROM cost_dept_cost t1
                LEFT JOIN acc_dept_attr b
                  ON t1.group_id = b.group_id
                 AND t1.hos_id = b.hos_id
                 AND t1.dept_id = b.dept_id
               INNER JOIN hos_source tv
                  ON t1.group_id = tv.group_id
                 AND t1.hos_id = tv.hos_id
                 AND t1.source_id = tv.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                 AND tv.source_attr = 1
                 AND type_code = '01'
               GROUP BY t1.dept_id) t5
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = t5.dept_id
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND a.is_stop = 0
        LEFT JOIN acc_dept_attr b
          ON t5.dept_id = b.dept_id
         AND b.group_id = p_group_id
         AND b.hos_id = p_hos_id
         AND b.type_code = '01'
      
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '01'
                    GROUP BY dept_id) t2
          ON t5.dept_id = t2.dept_id
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND type_code = '01'
                    GROUP BY dept_id) t3
          ON t5.dept_id = t3.dept_id
        LEFT JOIN
      
       (
        
        SELECT t1.dept_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
           AND t1.dept_id = b.dept_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND copy_code = p_copy_code
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr = 1
           AND type_code = '01'
         GROUP BY t1.dept_id) t4
          ON t5.dept_id = t4.dept_id
      
      ;
  
    /*
    ****************************************************************************
    *临床结余分析 医疗成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0104_proc;
  PROCEDURE cost_analysis_c0105_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *临床结余分析 医疗全成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0105
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0105
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,a.dept_code
            ,a.dept_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,t2.income_money - t4.cost_money
            ,t3.income_money - t5.cost_money
        FROM (
              
              SELECT t1.dept_id
                     
                     ,SUM(t1.dir_amount + t1.dir_ass_amount +
                          t1.dir_med_amount + t1.indir_med_ass_amount +
                          DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                          INDIR_MED_MAN_AMOUNT + INDIR_ASS_MED_MAN_AMOUNT) cost_money
                FROM cost_dept_cost t1
                LEFT JOIN acc_dept_attr b
                  ON t1.group_id = b.group_id
                 AND t1.hos_id = b.hos_id
                 AND t1.dept_id = b.dept_id
               INNER JOIN hos_source tv
                  ON t1.group_id = tv.group_id
                 AND t1.hos_id = tv.hos_id
                 AND t1.source_id = tv.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                 AND tv.source_attr IN (1, 2)
                 AND type_code = '01'
               GROUP BY t1.dept_id) t5
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = t5.dept_id
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND a.is_stop = 0
        LEFT JOIN acc_dept_attr b
          ON t5.dept_id = b.dept_id
         AND b.group_id = p_group_id
         AND b.hos_id = p_hos_id
         AND b.type_code = '01'
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '01'
                    GROUP BY dept_id) t2
          ON t5.dept_id = t2.dept_id
         
      
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND type_code = '01'
                    GROUP BY dept_id) t3
          ON t5.dept_id = t3.dept_id
         
        LEFT JOIN
      
       (
        
        SELECT t1.dept_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
           AND t1.dept_id = b.dept_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND copy_code = p_copy_code
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr IN (1, 2)
           AND type_code = '01'
         GROUP BY t1.dept_id) t4
          ON t5.dept_id = t4.dept_id
         
      
      ;
  
    /*
    ****************************************************************************
    *临床结余分析 医疗全成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0105_proc;
  PROCEDURE cost_analysis_c0106_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *临床结余分析 医院全成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0106
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0106
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,a.dept_code
            ,a.dept_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,t2.income_money - t4.cost_money
            ,t3.income_money - t5.cost_money
        FROM (
              
              SELECT t1.dept_id
                     
                     ,SUM(t1.dir_amount + t1.dir_ass_amount +
                          t1.dir_med_amount + t1.indir_med_ass_amount +
                          DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                          INDIR_MED_MAN_AMOUNT + INDIR_ASS_MED_MAN_AMOUNT) cost_money
                FROM cost_dept_cost t1
                LEFT JOIN acc_dept_attr b
                  ON t1.group_id = b.group_id
                 AND t1.hos_id = b.hos_id
                 AND t1.dept_id = b.dept_id
               INNER JOIN hos_source tv
                  ON t1.group_id = tv.group_id
                 AND t1.hos_id = tv.hos_id
                 AND t1.source_id = tv.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                    
                 AND type_code = '01'
               GROUP BY t1.dept_id) t5
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = t5.dept_id
        
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND a.is_stop = 0
        LEFT JOIN acc_dept_attr b
          ON t5.dept_id = b.dept_id
         AND b.group_id = p_group_id
         AND b.hos_id = p_hos_id
         AND b.type_code = '01'
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '01'
                    GROUP BY dept_id) t2
          ON t5.dept_id = t2.dept_id
         
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND type_code = '01'
                    GROUP BY dept_id) t3
          ON t5.dept_id = t3.dept_id
         
        LEFT JOIN
      
       (
        
        SELECT t1.dept_id
               
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
           AND t1.dept_id = b.dept_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND copy_code = p_copy_code
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND type_code = '01'
         GROUP BY t1.dept_id) t4
          ON t5.dept_id = t4.dept_id
         
      
      ;
  
    /*
    ****************************************************************************
    *临床结余分析 医院全成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0106_proc;
  PROCEDURE cost_analysis_c0107_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *临床结余分析 自身经营收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0107
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0107
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,a.dept_code
            ,a.dept_name
            ,b.income_money
            ,b.income_money_lj
            ,b.cost_money
            ,b.cost_money_lj
            ,nvl(b.income_money, 0) - nvl(b.cost_money, 0)
            ,nvl(b.income_money_lj, 0) - nvl(b.cost_money_lj, 0)
        FROM hos_dept_dict a
      
        LEFT JOIN (SELECT dept_id
                        
                         ,SUM(cost_money) cost_money
                         ,SUM(cost_money_lj) cost_money_lj
                         ,SUM(income_money) income_money
                         ,SUM(income_money_lj) income_money_lj
                     FROM (SELECT t1.dept_id
                                 
                                 ,SUM(t1.dir_amount) cost_money
                                 ,0 cost_money_lj
                                 ,0 income_money
                                 ,0 income_money_lj
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month = p_acc_month
                              AND tv.source_attr = 1
                              AND type_code = '01'
                            GROUP BY t1.dept_id
                           UNION ALL
                           SELECT t1.dept_id
                                 ,0 cost_money
                                 ,SUM(t1.dir_amount) cost_money_lj
                                 ,0
                                 ,0
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND t1.hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month < p_acc_month
                              AND tv.source_attr = 1
                              AND type_code = '01'
                            GROUP BY t1.dept_id
                           UNION ALL
                           SELECT appl_dept_id dept_id
                                 
                                 ,0
                                 ,0
                                 ,SUM(money) income_money
                                 ,0 income_money_lj
                             FROM cost_income
                            WHERE group_id = p_group_id
                              AND hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month = p_acc_month
                              AND appl_dept_id = exec_dept_id
                              AND appl_dept_no = exec_dept_no
                            GROUP BY appl_dept_id, appl_dept_no
                           UNION ALL
                           SELECT appl_dept_id dept_id
                                
                                 ,0
                                 ,0
                                 ,0
                                 ,SUM(money) income_money_lj
                             FROM cost_income
                            WHERE group_id = p_group_id
                              AND hos_id = p_hos_id
                              AND copy_code = p_copy_code
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND appl_dept_id = exec_dept_id
                              AND appl_dept_no = exec_dept_no
                            GROUP BY appl_dept_id, appl_dept_no)
                    GROUP BY dept_id) b
          ON a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND a.dept_id = b.dept_id
       
        LEFT JOIN acc_dept_attr c
          ON a.group_id = c.group_id
         AND a.hos_id = c.hos_id
         AND a.dept_id = c.dept_id
       WHERE a.is_stop = 0
         AND c.type_code = '01';
  
    /*
    ****************************************************************************
    *临床结余分析 医疗业务成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0107_proc;
  PROCEDURE cost_analysis_c0108_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *医技结余分析 医疗业务成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0108
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0108
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,t1.dept_code
            ,t1.dept_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (
              
              SELECT t1.dept_id
                     ,SUM(t1.dir_amount + t1.dir_ass_amount +
                          t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                FROM cost_dept_cost t1
                LEFT JOIN acc_dept_attr b
                  ON t1.group_id = b.group_id
                 AND t1.hos_id = b.hos_id
                 AND t1.dept_id = b.dept_id
               INNER JOIN hos_source tv
                  ON t1.group_id = tv.group_id
                 AND t1.hos_id = tv.hos_id
                 AND t1.source_id = tv.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                 AND tv.source_attr = 1
                 AND type_code = '02'
               GROUP BY t1.dept_id) t5
        LEFT JOIN
      
       (SELECT a.dept_id
              ,a.dept_no
              ,dept_code
              ,dept_name
              ,b.type_code
              ,b.natur_code
          FROM hos_dept_dict a
          LEFT JOIN acc_dept_attr b
            ON a.group_id = b.group_id
           AND a.hos_id = b.hos_id
           AND a.dept_id = b.dept_id
         WHERE a.group_id = p_group_id
           AND a.hos_id = p_hos_id
           AND b.type_code = '02') t1
          ON t1.dept_id = t5.dept_id
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_exec_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '02'
                    GROUP BY dept_id) t2
          ON t1.dept_id = t2.dept_id
         
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_exec_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND type_code = '02'
                    GROUP BY dept_id) t3
          ON t1.dept_id = t3.dept_id
         
        LEFT JOIN
      
       (
        
        SELECT t1.dept_id
              
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
           AND t1.dept_id = b.dept_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND copy_code = p_copy_code
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr = 1
           AND type_code = '02'
         GROUP BY t1.dept_id) t4
          ON t1.dept_id = t4.dept_id
      
      ;
  
    /*
    ****************************************************************************
    *临床结余分析 医疗业务成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0108_proc;
  PROCEDURE cost_analysis_c0109_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *医技结余分析 医疗成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0109
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0109
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,t1.dept_code
            ,t1.dept_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (SELECT a.dept_id
                    ,dept_code
                    ,dept_name
                    ,b.type_code
                    ,b.natur_code
                FROM hos_dept_dict a
                LEFT JOIN acc_dept_attr b
                  ON a.group_id = b.group_id
                 AND a.hos_id = b.hos_id
                 AND a.dept_id = b.dept_id
               WHERE a.group_id = p_group_id
                 AND a.hos_id = p_hos_id
                 AND b.type_code = '02') t1
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_exec_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '02'
                    GROUP BY dept_id) t2
          ON t1.dept_id = t2.dept_id
      
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_exec_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND type_code = '02'
                    GROUP BY dept_id) t3
          ON t1.dept_id = t3.dept_id
        LEFT JOIN
      
       (
        
        SELECT t1.dept_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
           AND t1.dept_id = b.dept_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND copy_code = p_copy_code
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr = 1
           AND type_code = '02'
         GROUP BY t1.dept_id) t4
          ON t1.dept_id = t4.dept_id
        LEFT JOIN (
                   
                   SELECT t1.dept_id
                          ,SUM(t1.dir_amount + t1.dir_ass_amount +
                               t1.dir_med_amount + t1.indir_med_ass_amount +
                               DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                               INDIR_MED_MAN_AMOUNT +
                               INDIR_ASS_MED_MAN_AMOUNT) cost_money
                     FROM cost_dept_cost t1
                     LEFT JOIN acc_dept_attr b
                       ON t1.group_id = b.group_id
                      AND t1.hos_id = b.hos_id
                      AND t1.dept_id = b.dept_id
                    INNER JOIN hos_source tv
                       ON t1.group_id = tv.group_id
                      AND t1.hos_id = tv.hos_id
                      AND t1.source_id = tv.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND tv.source_attr = 1
                      AND type_code = '02'
                    GROUP BY t1.dept_id) t5
          ON t1.dept_id = t5.dept_id
      
      ;
  
    /*
    ****************************************************************************
    *医技结余分析 医疗成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0109_proc;
  PROCEDURE cost_analysis_c0110_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *医技结余分析 医疗全成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0110
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0110
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,t1.dept_code
            ,t1.dept_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (SELECT a.dept_id
                    ,dept_code
                    ,dept_name
                    ,b.type_code
                    ,b.natur_code
                FROM hos_dept_dict a
                LEFT JOIN acc_dept_attr b
                  ON a.group_id = b.group_id
                 AND a.hos_id = b.hos_id
                 AND a.dept_id = b.dept_id
               WHERE a.group_id = p_group_id
                 AND a.hos_id = p_hos_id
                 AND b.type_code = '02') t1
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_exec_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '02'
                    GROUP BY dept_id) t2
          ON t1.dept_id = t2.dept_id
      
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_exec_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND type_code = '02'
                    GROUP BY dept_id) t3
          ON t1.dept_id = t3.dept_id
        LEFT JOIN
      
       (
        
        SELECT t1.dept_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
           AND t1.dept_id = b.dept_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND copy_code = p_copy_code
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr IN (1, 2)
           AND type_code = '02'
         GROUP BY t1.dept_id) t4
          ON t1.dept_id = t4.dept_id
        LEFT JOIN (
                   
                   SELECT t1.dept_id
                          ,SUM(t1.dir_amount + t1.dir_ass_amount +
                               t1.dir_med_amount + t1.indir_med_ass_amount +
                               DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                               INDIR_MED_MAN_AMOUNT +
                               INDIR_ASS_MED_MAN_AMOUNT) cost_money
                     FROM cost_dept_cost t1
                     LEFT JOIN acc_dept_attr b
                       ON t1.group_id = b.group_id
                      AND t1.hos_id = b.hos_id
                      AND t1.dept_id = b.dept_id
                    INNER JOIN hos_source tv
                       ON t1.group_id = tv.group_id
                      AND t1.hos_id = tv.hos_id
                      AND t1.source_id = tv.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND tv.source_attr IN (1, 2)
                      AND type_code = '02'
                    GROUP BY t1.dept_id) t5
          ON t1.dept_id = t5.dept_id
      
      ;
  
    /*
    ****************************************************************************
    *医技结余分析 医疗全成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0110_proc;

  PROCEDURE cost_analysis_c0111_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *临床结余分析 医院全成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0111
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0111
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,t1.dept_code
            ,t1.dept_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (SELECT a.dept_id
                    ,dept_code
                    ,dept_name
                    ,b.type_code
                    ,b.natur_code
                FROM hos_dept_dict a
                LEFT JOIN acc_dept_attr b
                  ON a.group_id = b.group_id
                 AND a.hos_id = b.hos_id
                 AND a.dept_id = b.dept_id
               WHERE a.group_id = p_group_id
                 AND a.hos_id = p_hos_id
                 AND b.type_code = '02') t1
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_exec_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '02'
                    GROUP BY dept_id) t2
          ON t1.dept_id = t2.dept_id
      
        LEFT JOIN (SELECT dept_id, SUM(income_money) income_money
                     FROM v_cost_exec_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND type_code = '02'
                    GROUP BY dept_id) t3
          ON t1.dept_id = t3.dept_id
        LEFT JOIN
      
       (
        
        SELECT t1.dept_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
           AND t1.dept_id = b.dept_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND copy_code = p_copy_code
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND type_code = '02'
         GROUP BY t1.dept_id) t4
          ON t1.dept_id = t4.dept_id
        LEFT JOIN (
                   
                   SELECT t1.dept_id
                          ,SUM(t1.dir_amount + t1.dir_ass_amount +
                               t1.dir_med_amount + t1.indir_med_ass_amount +
                               DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                               INDIR_MED_MAN_AMOUNT +
                               INDIR_ASS_MED_MAN_AMOUNT) cost_money
                     FROM cost_dept_cost t1
                     LEFT JOIN acc_dept_attr b
                       ON t1.group_id = b.group_id
                      AND t1.hos_id = b.hos_id
                      AND t1.dept_id = b.dept_id
                    INNER JOIN hos_source tv
                       ON t1.group_id = tv.group_id
                      AND t1.hos_id = tv.hos_id
                      AND t1.source_id = tv.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                         
                      AND type_code = '02'
                    GROUP BY t1.dept_id) t5
          ON t1.dept_id = t5.dept_id
      
      ;
  
    /*
    ****************************************************************************
    *医技结余分析 医院全成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0111_proc;

  PROCEDURE cost_analysis_c0112_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *集团医疗受益总表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE NUMBER(4)                     项目编码
    ITEM_NAME VARCHAR2(50) Y                项目名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                成本_本期
    T_4       NUMBER(30,6) Y                成本_累计
    T_5       NUMBER(30,6) Y                收益_本期
    T_6       NUMBER(30,6) Y                收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0112
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0112
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6)
      SELECT p_group_id
            ,p_hos_id
            ,p_acc_year
            ,p_acc_month
            ,t1.item_code
            ,t1.item_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (SELECT 1 item_code, '医疗业务成本' item_name
                FROM dual
              UNION ALL
              SELECT 2 item_code, '门诊' item_name
                FROM dual
              UNION ALL
              SELECT 3 item_code, '住院' item_name
                FROM dual
              UNION ALL
              SELECT 4 item_code, '医疗成本' item_name
                FROM dual
              UNION ALL
              SELECT 5 item_code, '门诊' item_name
                FROM dual
              UNION ALL
              SELECT 6 item_code, '住院' item_name
                FROM dual
              UNION ALL
              SELECT 7 item_code, '医疗全成本' item_name
                FROM dual
              UNION ALL
              SELECT 8 item_code, '门诊' item_name
                FROM dual
              UNION ALL
              SELECT 9 item_code, '住院' item_name
                FROM dual
              UNION ALL
              SELECT 10 item_code, '医院全成本' item_name
                FROM dual
              UNION ALL
              SELECT 11 item_code, '门诊' item_name
                FROM dual
              UNION ALL
              SELECT 12 item_code, '住院' item_name
                FROM dual) t1
        LEFT JOIN (
                   
                   SELECT item_code, SUM(income_money) income_money
                     FROM (SELECT 1 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            
                            UNION ALL
                            SELECT 1 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 2 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 3 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 4 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 4 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 5 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 6 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 7 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 7 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 8 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 9 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 10 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 10 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 11 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 12 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month = p_acc_month
                               AND natur_code = '02'
                            
                            )
                    GROUP BY item_code) t2
          ON t1.item_code = t2.item_code
      
        LEFT JOIN (
                   
                   SELECT item_code, SUM(income_money) income_money
                     FROM (SELECT 1 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 1 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 2 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 3 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 4 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 4 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 5 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 6 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 7 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 7 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 8 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 9 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 10 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 10 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            UNION ALL
                            SELECT 11 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '01'
                            UNION ALL
                            SELECT 12 item_code, SUM(income_money) income_money
                              FROM v_cost_appl_dept_income
                             WHERE group_id = p_group_id
                               AND acc_year = p_acc_year
                               AND acc_month <= p_acc_month
                               AND natur_code = '02'
                            
                            )
                    GROUP BY item_code) t3
          ON t1.item_code = t3.item_code
        LEFT JOIN
      
       (SELECT item_code, SUM(cost_money) cost_money
          FROM (SELECT 1 item_code
                      ,SUM(t1.dir_amount + t1.dir_ass_amount +
                           t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '01'
                UNION ALL
                SELECT 1 item_code
                      ,SUM(t1.dir_amount + t1.dir_ass_amount +
                           t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '02'
                UNION ALL
                SELECT 2 item_code
                      ,SUM(t1.dir_amount + t1.dir_ass_amount +
                           t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '01'
                UNION ALL
                SELECT 3 item_code
                      ,SUM(t1.dir_amount + t1.dir_ass_amount +
                           t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '02'
                UNION ALL
                SELECT 4 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '01'
                UNION ALL
                SELECT 4 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '02'
                UNION ALL
                SELECT 5 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '01'
                UNION ALL
                SELECT 6 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr = 1
                   AND natur_code = '02'
                UNION ALL
                SELECT 7 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr IN (1, 2)
                   AND natur_code = '01'
                UNION ALL
                SELECT 7 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr IN (1, 2)
                   AND natur_code = '02'
                UNION ALL
                SELECT 8 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr IN (1, 2)
                   AND natur_code = '01'
                UNION ALL
                SELECT 9 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 INNER JOIN hos_source tv
                    ON t1.group_id = tv.group_id
                   AND t1.hos_id = tv.hos_id
                   AND t1.source_id = tv.source_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND tv.source_attr IN (1, 2)
                   AND natur_code = '02'
                UNION ALL
                SELECT 10 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND natur_code = '01'
                UNION ALL
                SELECT 10 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND natur_code = '02'
                UNION ALL
                SELECT 11 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND natur_code = '01'
                UNION ALL
                SELECT 12 item_code
                      ,SUM(dir_amount + dir_ass_amount + dir_med_amount +
                           indir_med_ass_amount + DIR_MAN_AMOUNT +
                           INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                           INDIR_ASS_MED_MAN_AMOUNT) cost_money
                  FROM cost_dept_cost t1
                  LEFT JOIN acc_dept_attr b
                    ON t1.group_id = b.group_id
                   AND t1.hos_id = b.hos_id
                   AND t1.dept_id = b.dept_id
                 WHERE t1.group_id = p_group_id
                   AND acc_year = p_acc_year
                   AND acc_month = p_acc_month
                   AND natur_code = '02')
         GROUP BY item_code) t4
          ON t1.item_code = t4.item_code
        LEFT JOIN (SELECT item_code, SUM(cost_money) cost_money
                     FROM (SELECT 1 item_code
                                 ,SUM(t1.dir_amount + t1.dir_ass_amount +
                                      t1.dir_med_amount +
                                      t1.indir_med_ass_amount) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '01'
                           
                           UNION ALL
                           SELECT 1 item_code
                                 ,SUM(t1.dir_amount + t1.dir_ass_amount +
                                      t1.dir_med_amount +
                                      t1.indir_med_ass_amount) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 2 item_code
                                 ,SUM(t1.dir_amount + t1.dir_ass_amount +
                                      t1.dir_med_amount +
                                      t1.indir_med_ass_amount) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 3 item_code
                                 ,SUM(t1.dir_amount + t1.dir_ass_amount +
                                      t1.dir_med_amount +
                                      t1.indir_med_ass_amount) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 4 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 4 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 5 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 6 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr = 1
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 7 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr IN (1, 2)
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 7 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr IN (1, 2)
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 8 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr IN (1, 2)
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 9 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            INNER JOIN hos_source tv
                               ON t1.group_id = tv.group_id
                              AND t1.hos_id = tv.hos_id
                              AND t1.source_id = tv.source_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND tv.source_attr IN (1, 2)
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 10 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 10 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND natur_code = '02'
                           UNION ALL
                           SELECT 11 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND natur_code = '01'
                           UNION ALL
                           SELECT 12 item_code
                                 ,SUM(dir_amount + dir_ass_amount +
                                      dir_med_amount + indir_med_ass_amount +
                                      DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                                      INDIR_MED_MAN_AMOUNT +
                                      INDIR_ASS_MED_MAN_AMOUNT) cost_money
                             FROM cost_dept_cost t1
                             LEFT JOIN acc_dept_attr b
                               ON t1.group_id = b.group_id
                              AND t1.hos_id = b.hos_id
                              AND t1.dept_id = b.dept_id
                            WHERE t1.group_id = p_group_id
                              AND acc_year = p_acc_year
                              AND acc_month <= p_acc_month
                              AND natur_code = '02')
                    GROUP BY item_code) t5
          ON t1.item_code = t5.item_code
      
      ;
    DELETE FROM cost_c0113
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0113
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8)
      SELECT p_group_id
            ,p_hos_id
            ,p_acc_year
            ,p_acc_month
            ,item_code
            ,item_name
            ,t_1
            ,t_2
            ,0
            ,0
            ,t_3
            ,t_4
            ,t_5
            ,t_6
        FROM cost_c0112
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
  
    /*
    ****************************************************************************
    *集团医疗受益分析           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0112_proc;

  PROCEDURE cost_analysis_c0114_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *集团结余分析 医疗业务成本收益明细表      开始
      ****************************************************************************
      GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    HOS_CODE  VARCHAR2(20)                  医院编码
    HOS_NAME  VARCHAR2(50) Y                医院名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0114
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0114
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,hos_code
      ,hos_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_acc_year
            ,p_acc_month
            ,t1.hos_code
            ,t1.hos_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (SELECT a.hos_id, hos_code, hos_name
                FROM hos_info a
               WHERE a.group_id = p_group_id
                 AND a.hos_id = p_hos_id) t1
        LEFT JOIN (SELECT hos_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY hos_id) t2
          ON t1.hos_id = t2.hos_id
      
        LEFT JOIN (SELECT hos_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                    GROUP BY hos_id) t3
          ON t1.hos_id = t3.hos_id
        LEFT JOIN
      
       (
        
        SELECT t1.hos_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount) cost_money
          FROM cost_dept_cost t1
          LEFT JOIN acc_dept_attr b
            ON t1.group_id = b.group_id
           AND t1.hos_id = b.hos_id
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr = 1
         GROUP BY t1.hos_id) t4
          ON t1.hos_id = t4.hos_id
        LEFT JOIN (
                   
                   SELECT t1.hos_id
                          ,SUM(t1.dir_amount + t1.dir_ass_amount +
                               t1.dir_med_amount + t1.indir_med_ass_amount) cost_money
                     FROM cost_dept_cost t1
                     LEFT JOIN acc_dept_attr b
                       ON t1.group_id = b.group_id
                      AND t1.hos_id = b.hos_id
                    INNER JOIN hos_source tv
                       ON t1.group_id = tv.group_id
                      AND t1.hos_id = tv.hos_id
                      AND t1.source_id = tv.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND tv.source_attr = 1
                    GROUP BY t1.hos_id) t5
          ON t1.hos_id = t5.hos_id
      
      ;
  
    /*
    ****************************************************************************
    *集团结余分析 医疗业务成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0114_proc;
  PROCEDURE cost_analysis_c0115_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *集团结余分析 医疗成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    HOS_CODE VARCHAR2(20)                  医院编码
    HOS_NAME VARCHAR2(50) Y                医院名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0115
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0115
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,hos_code
      ,hos_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_acc_year
            ,p_acc_month
            ,t1.hos_code
            ,t1.hos_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (SELECT a.hos_id, hos_code, hos_name
                FROM hos_info a
               WHERE a.group_id = p_group_id
                 AND a.hos_id = p_hos_id) t1
        LEFT JOIN (SELECT hos_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '01'
                    GROUP BY hos_id) t2
          ON t1.hos_id = t2.hos_id
      
        LEFT JOIN (SELECT hos_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                    GROUP BY hos_id) t3
          ON t1.hos_id = t3.hos_id
        LEFT JOIN
      
       (
        
        SELECT t1.hos_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr = 1
         GROUP BY t1.hos_id) t4
          ON t1.hos_id = t4.hos_id
        LEFT JOIN (
                   
                   SELECT t1.hos_id
                          ,SUM(t1.dir_amount + t1.dir_ass_amount +
                               t1.dir_med_amount + t1.indir_med_ass_amount +
                               DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                               INDIR_MED_MAN_AMOUNT +
                               INDIR_ASS_MED_MAN_AMOUNT) cost_money
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source tv
                       ON t1.group_id = tv.group_id
                      AND t1.hos_id = tv.hos_id
                      AND t1.source_id = tv.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND tv.source_attr = 1
                    GROUP BY t1.hos_id) t5
          ON t1.hos_id = t5.hos_id
      
      ;
  
    /*
    ****************************************************************************
    *集团临床结余分析 医疗成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0115_proc;
  PROCEDURE cost_analysis_c0116_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *集团结余分析 医疗全成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0116
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0116
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,hos_code
      ,hos_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_acc_year
            ,p_acc_month
            ,t1.hos_code
            ,t1.hos_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (SELECT a.hos_id, hos_code, hos_name
                FROM hos_info a
               WHERE a.group_id = p_group_id
                 AND a.hos_id = p_hos_id) t1
        LEFT JOIN (SELECT hos_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY hos_id) t2
          ON t1.hos_id = t2.hos_id
      
        LEFT JOIN (SELECT hos_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                    GROUP BY hos_id) t3
          ON t1.hos_id = t3.hos_id
        LEFT JOIN
      
       (
        
        SELECT t1.hos_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
           AND tv.source_attr IN (1, 2)
         GROUP BY t1.hos_id) t4
          ON t1.hos_id = t4.hos_id
        LEFT JOIN (
                   
                   SELECT t1.hos_id
                          ,SUM(t1.dir_amount + t1.dir_ass_amount +
                               t1.dir_med_amount + t1.indir_med_ass_amount +
                               DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                               INDIR_MED_MAN_AMOUNT +
                               INDIR_ASS_MED_MAN_AMOUNT) cost_money
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source tv
                       ON t1.group_id = tv.group_id
                      AND t1.hos_id = tv.hos_id
                      AND t1.source_id = tv.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                      AND tv.source_attr IN (1, 2)
                    GROUP BY t1.hos_id) t5
          ON t1.hos_id = t5.hos_id
      
      ;
  
    /*
    ****************************************************************************
    *集团结余分析 医疗全成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0116_proc;
  
  PROCEDURE cost_analysis_c0117_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *集团结余分析 医院全成本收益明细表      开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医疗收入_本期
    T_2       NUMBER(30,6) Y                医疗收入_累计
    T_3       NUMBER(30,6) Y                医疗业务成本_本期
    T_4       NUMBER(30,6) Y                医疗业务成本_累计
    T_5       NUMBER(30,6) Y                医疗收益_本期
    T_6       NUMBER(30,6) Y                医疗收益_累计
      ****************************************************************************
      */
    DELETE FROM cost_c0117
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0117
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,hos_code
      ,hos_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
       
       )
      SELECT p_group_id
            ,p_hos_id
            ,p_acc_year
            ,p_acc_month
            ,t1.hos_code
            ,t1.hos_name
            ,t2.income_money
            ,t3.income_money
            ,t4.cost_money
            ,t5.cost_money
            ,nvl(t2.income_money, 0) - nvl(t4.cost_money, 0)
            ,nvl(t3.income_money, 0) - nvl(t5.cost_money, 0)
        FROM (SELECT a.hos_id, hos_code, hos_name
                FROM hos_info a
               WHERE a.group_id = p_group_id
                 AND a.hos_id = p_hos_id) t1
        LEFT JOIN (SELECT hos_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY hos_id) t2
          ON t1.hos_id = t2.hos_id
      
        LEFT JOIN (SELECT hos_id, SUM(income_money) income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                    GROUP BY hos_id) t3
          ON t1.hos_id = t3.hos_id
        LEFT JOIN
      
       (
        
        SELECT t1.hos_id
               ,SUM(t1.dir_amount + t1.dir_ass_amount + t1.dir_med_amount +
                    t1.indir_med_ass_amount + DIR_MAN_AMOUNT +
                    INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                    INDIR_ASS_MED_MAN_AMOUNT) cost_money
          FROM cost_dept_cost t1
         INNER JOIN hos_source tv
            ON t1.group_id = tv.group_id
           AND t1.hos_id = tv.hos_id
           AND t1.source_id = tv.source_id
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND acc_year = p_acc_year
           AND acc_month = p_acc_month
         GROUP BY t1.hos_id) t4
          ON t1.hos_id = t4.hos_id
        LEFT JOIN (
                   
                   SELECT t1.hos_id
                          ,SUM(t1.dir_amount + t1.dir_ass_amount +
                               t1.dir_med_amount + t1.indir_med_ass_amount +
                               DIR_MAN_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                               INDIR_MED_MAN_AMOUNT +
                               INDIR_ASS_MED_MAN_AMOUNT) cost_money
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source tv
                       ON t1.group_id = tv.group_id
                      AND t1.hos_id = tv.hos_id
                      AND t1.source_id = tv.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                    GROUP BY t1.hos_id) t5
          ON t1.hos_id = t5.hos_id
      
      ;
  
    /*
    ****************************************************************************
    *集团结余分析 医院全成本收益明细表           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0117_proc;
  PROCEDURE cost_analysis_c0201_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
      ****************************************************************************
      *临床构成分析 医疗构成分析总表     开始
      ****************************************************************************
     Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ------------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    TYPE_CODE VARCHAR2(20)                  分类编码
    TYPE_NAME VARCHAR2(50) Y                分类名称
    T_1       NUMBER(30,6) Y                医疗业务成本_金额
    T_2       NUMBER(30,6) Y                医疗业务成本_比重(%)
    T_3       NUMBER(30,6) Y                医疗成本_金额
    T_4       NUMBER(30,6) Y                医疗成本_比重(%)
    T_5       NUMBER(30,6) Y                医疗全成本_金额
    T_6       NUMBER(30,6) Y                医疗全成本_比重(%)
    T_7       NUMBER(30,6) Y                医院全成本_金额
    T_8       NUMBER(30,6) Y                医院全成本_比重(%)
      ****************************************************************************
      */
    DELETE FROM cost_c0201
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0201
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,TYPE_CODE
      ,TYPE_NAME
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
       
       )
      SELECT t1.group_id
            ,t1.hos_id
            ,t1.copy_code
            ,t1.acc_year
            ,t1.acc_month
            ,t1.TYPE_CODE
            ,t1.TYPE_NAME
            ,t1
            ,t1 * 100 / t5
            ,t2
            ,t2 * 100 / t6
            ,t3
            ,t3 * 100 / t7
            ,t4
            ,t4 * 100 / t8
        FROM (SELECT group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,cost_type_code type_code
                    ,cost_type_name type_name
                    ,SUM(t1) t1
                    ,SUM(t2) t2
                    ,SUM(t3) t3
                    ,SUM(t4) t4
                FROM v_cost_dept_cost_sum
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01'
               GROUP BY group_id
                       ,hos_id
                       ,copy_code
                       ,acc_year
                       ,acc_month
                       ,cost_type_code
                       ,cost_type_name) t1
        LEFT JOIN (SELECT group_id
                         ,hos_id
                         ,copy_code
                         ,acc_year
                         ,acc_month
                         ,SUM(t1) t5
                         ,SUM(t2) t6
                         ,SUM(t3) t7
                         ,SUM(t4) t8
                     FROM v_cost_dept_cost_sum
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '01'
                    GROUP BY group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month) t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.copy_code = t2.copy_code
         AND t1.acc_year = t2.acc_year
         AND t1.acc_month = t2.acc_month
       ORDER BY t1.type_code;
  
    /*
    ****************************************************************************
    *临床构成分析 医疗构成分析总表            结束
    ****************************************************************************
    */
    /*
      ****************************************************************************
      *医技构成分析 医疗构成分析总表     开始
      ****************************************************************************
     Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ------------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    TYPE_CODE VARCHAR2(20)                  分类编码
    TYPE_NAME VARCHAR2(50) Y                分类名称
    T_1       NUMBER(30,6) Y                医疗业务成本_金额
    T_2       NUMBER(30,6) Y                医疗业务成本_比重(%)
    T_3       NUMBER(30,6) Y                医疗成本_金额
    T_4       NUMBER(30,6) Y                医疗成本_比重(%)
    T_5       NUMBER(30,6) Y                医疗全成本_金额
    T_6       NUMBER(30,6) Y                医疗全成本_比重(%)
    T_7       NUMBER(30,6) Y                医院全成本_金额
    T_8       NUMBER(30,6) Y                医院全成本_比重(%)
      ****************************************************************************
      */
    DELETE FROM cost_c0206
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0206
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,TYPE_CODE
      ,TYPE_NAME
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
       
       )
      SELECT t1.group_id
            ,t1.hos_id
            ,t1.copy_code
            ,t1.acc_year
            ,t1.acc_month
            ,t1.TYPE_CODE
            ,t1.TYPE_NAME
            ,t1
            ,t1 * 100 / t5
            ,t2
            ,t2 * 100 / t6
            ,t3
            ,t3 * 100 / t7
            ,t4
            ,t4 * 100 / t8
        FROM (SELECT group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,cost_type_code type_code
                    ,cost_type_name type_name
                    ,SUM(t1) t1
                    ,SUM(t2) t2
                    ,SUM(t3) t3
                    ,SUM(t4) t4
                FROM v_cost_dept_cost_sum
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '02'
               GROUP BY group_id
                       ,hos_id
                       ,copy_code
                       ,acc_year
                       ,acc_month
                       ,cost_type_code
                       ,cost_type_name) t1
        LEFT JOIN (SELECT group_id
                         ,hos_id
                         ,copy_code
                         ,acc_year
                         ,acc_month
                         ,SUM(t1) t5
                         ,SUM(t2) t6
                         ,SUM(t3) t7
                         ,SUM(t4) t8
                     FROM v_cost_dept_cost_sum
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '02'
                    GROUP BY group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month) t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.copy_code = t2.copy_code
         AND t1.acc_year = t2.acc_year
         AND t1.acc_month = t2.acc_month
       ORDER BY t1.type_code;
  
    /*
    ****************************************************************************
    *医技构成分析 医疗构成分析总表            结束
    ****************************************************************************
    */
    /*
      ****************************************************************************
      *医辅构成分析 医疗构成分析总表     开始
      ****************************************************************************
     Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ------------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    TYPE_CODE VARCHAR2(20)                  分类编码
    TYPE_NAME VARCHAR2(50) Y                分类名称
    T_1       NUMBER(30,6) Y                医疗业务成本_金额
    T_2       NUMBER(30,6) Y                医疗业务成本_比重(%)
    T_3       NUMBER(30,6) Y                医疗成本_金额
    T_4       NUMBER(30,6) Y                医疗成本_比重(%)
    T_5       NUMBER(30,6) Y                医疗全成本_金额
    T_6       NUMBER(30,6) Y                医疗全成本_比重(%)
    T_7       NUMBER(30,6) Y                医院全成本_金额
    T_8       NUMBER(30,6) Y                医院全成本_比重(%)
      ****************************************************************************
      */
    DELETE FROM cost_c0211
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0211
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,TYPE_CODE
      ,TYPE_NAME
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
       
       )
      SELECT t1.group_id
            ,t1.hos_id
            ,t1.copy_code
            ,t1.acc_year
            ,t1.acc_month
            ,t1.TYPE_CODE
            ,t1.TYPE_NAME
            ,t1
            ,t1 * 100 / t5
            ,t2
            ,t2 * 100 / t6
            ,t3
            ,t3 * 100 / t7
            ,t4
            ,t4 * 100 / t8
        FROM (SELECT group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,cost_type_code type_code
                    ,cost_type_name type_name
                    ,SUM(t1) t1
                    ,SUM(t2) t2
                    ,SUM(t3) t3
                    ,SUM(t4) t4
                FROM v_cost_dept_cost_sum
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '03'
               GROUP BY group_id
                       ,hos_id
                       ,copy_code
                       ,acc_year
                       ,acc_month
                       ,cost_type_code
                       ,cost_type_name) t1
        LEFT JOIN (SELECT group_id
                         ,hos_id
                         ,copy_code
                         ,acc_year
                         ,acc_month
                         ,SUM(t1) t5
                         ,SUM(t2) t6
                         ,SUM(t3) t7
                         ,SUM(t4) t8
                     FROM v_cost_dept_cost_sum
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '03'
                    GROUP BY group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month) t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.copy_code = t2.copy_code
         AND t1.acc_year = t2.acc_year
         AND t1.acc_month = t2.acc_month
       ORDER BY t1.type_code;
  
    /*
    ****************************************************************************
    *医辅构成分析 医疗构成分析总表            结束
    ****************************************************************************
    */
    /*
      ****************************************************************************
      *管理构成分析 医疗构成分析总表     开始
      ****************************************************************************
     Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ------------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    TYPE_CODE VARCHAR2(20)                  分类编码
    TYPE_NAME VARCHAR2(50) Y                分类名称
    T_1       NUMBER(30,6) Y                医疗业务成本_金额
    T_2       NUMBER(30,6) Y                医疗业务成本_比重(%)
    T_3       NUMBER(30,6) Y                医疗成本_金额
    T_4       NUMBER(30,6) Y                医疗成本_比重(%)
    T_5       NUMBER(30,6) Y                医疗全成本_金额
    T_6       NUMBER(30,6) Y                医疗全成本_比重(%)
    T_7       NUMBER(30,6) Y                医院全成本_金额
    T_8       NUMBER(30,6) Y                医院全成本_比重(%)
      ****************************************************************************
      */
    DELETE FROM cost_c0216
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0216
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,TYPE_CODE
      ,TYPE_NAME
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
       
       )
      SELECT t1.group_id
            ,t1.hos_id
            ,t1.copy_code
            ,t1.acc_year
            ,t1.acc_month
            ,t1.TYPE_CODE
            ,t1.TYPE_NAME
            ,t1
            ,t1 * 100 / t5
            ,t2
            ,t2 * 100 / t6
            ,t3
            ,t3 * 100 / t7
            ,t4
            ,t4 * 100 / t8
        FROM (SELECT group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,cost_type_code type_code
                    ,cost_type_name type_name
                    ,SUM(t1) t1
                    ,SUM(t2) t2
                    ,SUM(t3) t3
                    ,SUM(t4) t4
                FROM v_cost_dept_cost_sum
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '04'
               GROUP BY group_id
                       ,hos_id
                       ,copy_code
                       ,acc_year
                       ,acc_month
                       ,cost_type_code
                       ,cost_type_name) t1
        LEFT JOIN (SELECT group_id
                         ,hos_id
                         ,copy_code
                         ,acc_year
                         ,acc_month
                         ,SUM(t1) t5
                         ,SUM(t2) t6
                         ,SUM(t3) t7
                         ,SUM(t4) t8
                     FROM v_cost_dept_cost_sum
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND type_code = '04'
                    GROUP BY group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month) t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.copy_code = t2.copy_code
         AND t1.acc_year = t2.acc_year
         AND t1.acc_month = t2.acc_month
       ORDER BY t1.type_code;
  
    /*
    ****************************************************************************
    *管理构成分析 医疗构成分析总表            结束
    ****************************************************************************
    */
    /*
      ****************************************************************************
      *集团构成分析 医疗构成分析总表     开始
      ****************************************************************************
     Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ------------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    TYPE_CODE VARCHAR2(20)                  分类编码
    TYPE_NAME VARCHAR2(50) Y                分类名称
    T_1       NUMBER(30,6) Y                医疗业务成本_金额
    T_2       NUMBER(30,6) Y                医疗业务成本_比重(%)
    T_3       NUMBER(30,6) Y                医疗成本_金额
    T_4       NUMBER(30,6) Y                医疗成本_比重(%)
    T_5       NUMBER(30,6) Y                医疗全成本_金额
    T_6       NUMBER(30,6) Y                医疗全成本_比重(%)
    T_7       NUMBER(30,6) Y                医院全成本_金额
    T_8       NUMBER(30,6) Y                医院全成本_比重(%)
      ****************************************************************************
      */
    DELETE FROM cost_c0221
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0221
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,TYPE_CODE
      ,TYPE_NAME
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
       
       )
      SELECT t1.group_id
            ,t1.hos_id
            ,t1.acc_year
            ,t1.acc_month
            ,t1.TYPE_CODE
            ,t1.TYPE_NAME
            ,t1
            ,t1 * 100 / t5
            ,t2
            ,t2 * 100 / t6
            ,t3
            ,t3 * 100 / t7
            ,t4
            ,t4 * 100 / t8
        FROM (SELECT group_id
                    ,hos_id
                    ,acc_year
                    ,acc_month
                    ,cost_type_code type_code
                    ,cost_type_name type_name
                    ,SUM(t1) t1
                    ,SUM(t2) t2
                    ,SUM(t3) t3
                    ,SUM(t4) t4
                FROM v_cost_dept_cost_sum
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
               GROUP BY group_id
                       ,hos_id
                       ,acc_year
                       ,acc_month
                       ,cost_type_code
                       ,cost_type_name) t1
        LEFT JOIN (SELECT group_id
                         ,hos_id
                         ,acc_year
                         ,acc_month
                         ,SUM(t1) t5
                         ,SUM(t2) t6
                         ,SUM(t3) t7
                         ,SUM(t4) t8
                     FROM v_cost_dept_cost_sum
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY group_id, hos_id, acc_year, acc_month) t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.acc_year = t2.acc_year
         AND t1.acc_month = t2.acc_month
       ORDER BY t1.type_code;
  
    /*
    ****************************************************************************
    *集团构成分析 医疗构成分析总表            结束
    ****************************************************************************
    */
  END cost_analysis_c0201_proc;
  PROCEDURE cost_analysis_c0202_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
        ****************************************************************************
        *临床构成分析 医疗业务构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0202
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0202
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t1
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t1) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *临床构成分析 医疗业务构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *医技构成分析 医疗业务构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0207
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0207
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t1
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t1) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '02') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *医技构成分析 医疗业务构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *医辅构成分析 医疗业务构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0212
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0212
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t1
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t1) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '03') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *医辅构成分析 医疗业务构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *管理构成分析 医疗业务构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0217
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0217
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t1
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t1) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '04') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *管理构成分析 医疗业务构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *集团构成分析 医疗业务构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0222
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0222
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,acc_year
                            ,acc_month
                            ,type_code
                            ,t1
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t1) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01') t1
        LEFT JOIN hos_info t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id;
  
    /*
    ****************************************************************************
    *集团构成分析 医疗业务构成分析明细表            结束
    ****************************************************************************
    */
  END cost_analysis_c0202_proc;
  PROCEDURE cost_analysis_c0203_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
        ****************************************************************************
        *临床构成分析 医疗构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0203
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0203
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t2
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t2) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *临床构成分析 医疗构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *医技构成分析 医疗构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0208
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0208
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t2
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t2) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '02') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *医技构成分析 医疗构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *医辅构成分析 医疗构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0213
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0213
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t2
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t2) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '03') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *医辅构成分析 医疗构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *管理构成分析 医疗构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0218
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0218
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t2
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t2) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '04') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *管理构成分析 医疗构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *集团构成分析 医疗构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0223
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0223
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,acc_year
                            ,acc_month
                            ,type_code
                            ,t2
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t2) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01') t1
        LEFT JOIN hos_info t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id;
  
    /*
    ****************************************************************************
    *集团构成分析 医疗构成分析明细表            结束
    ****************************************************************************
    */
  END cost_analysis_c0203_proc;
  PROCEDURE cost_analysis_c0204_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
        ****************************************************************************
        *临床构成分析 医疗全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0204
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0204
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            ,type_code
                            ,natur_code
                            ,t3
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t3) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *临床构成分析 医疗全成本构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *医技构成分析 医疗全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0209
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0209
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,type_code
                            ,natur_code
                            ,t3
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t3) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '02') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *医技构成分析 医疗全成本构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *医辅构成分析 医疗全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0214
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0214
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,type_code
                            ,natur_code
                            ,t3
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t3) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '03') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *医辅构成分析 医疗全成本构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *管理构成分析 医疗全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0219
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0219
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,type_code
                            ,natur_code
                            ,t3
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t3) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '04') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *管理构成分析 医疗全成本构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *集团构成分析 医疗全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0224
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0224
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,acc_year
                            ,acc_month
                            ,type_code
                            ,t3
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t3) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01') t1
        LEFT JOIN hos_info t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id;
  
    /*
    ****************************************************************************
    *集团构成分析 医疗全成本构成分析明细表            结束
    ****************************************************************************
    */
  END cost_analysis_c0204_proc;
  PROCEDURE cost_analysis_c0205_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
  
    /*
        ****************************************************************************
        *临床构成分析 医院全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0205
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0205
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,type_code
                            ,natur_code
                            ,t4
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t4) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *临床构成分析 医院全成本构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *医技构成分析 医院全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0210
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0210
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,type_code
                            ,natur_code
                            ,t4
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t4) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '02') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *医技构成分析 医院全成本构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *医辅构成分析 医院全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0215
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0215
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,type_code
                            ,natur_code
                            ,t4
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t4) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '03') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *医辅构成分析 医院全成本构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *管理构成分析 医院全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0220
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0220
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,type_code
                            ,natur_code
                            ,t4
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t4) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '04') t1
        LEFT JOIN hos_dept t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
         AND t1.dept_id = t2.dept_id;
  
    /*
    ****************************************************************************
    *管理构成分析 医院全成本构成分析明细表            结束
    ****************************************************************************
    */
  
    /*
        ****************************************************************************
        *集团构成分析 医院全成本构成分析明细表     开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                人员经费
    T_2       NUMBER(30,6) Y                卫生材料费
    T_3       NUMBER(30,6) Y                药品费
    T_4       NUMBER(30,6) Y                固定资产折旧费
    T_5       NUMBER(30,6) Y                无形资产摊销费
    T_6       NUMBER(30,6) Y                提取医疗风险基金
    T_7       NUMBER(30,6) Y                其他费用
    T_8       NUMBER(30,6) Y                合计
    T_9       NUMBER(30,6) Y                床日成本
    T_10      NUMBER(30,6) Y                诊次成本
        ****************************************************************************
        */
    DELETE FROM cost_c0225
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0225
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,t1
            ,t2
            ,t3
            ,t4
            ,t5
            ,t6
            ,t7
            ,(nvl(t1, 0) + nvl(t2, 0) + nvl(t3, 0) + nvl(t4, 0) +
             nvl(t5, 0) + nvl(t6, 0) + nvl(t7, 0))
            ,0
            ,0
        FROM (SELECT *
                FROM (SELECT group_id
                            ,hos_id
                            ,acc_year
                            ,acc_month
                            ,type_code
                            ,t4
                            ,cost_type_code
                        FROM v_cost_dept_cost_sum) pivot(SUM(t4) FOR cost_type_code IN('01' t1
                                                                                      ,'02' t2
                                                                                      ,'03' t3
                                                                                      ,'04' t4
                                                                                      ,'05' t5
                                                                                      ,'06' t6
                                                                                      ,'07' t7))
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01') t1
        LEFT JOIN hos_info t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id;
  
    /*
    ****************************************************************************
    *集团构成分析 医院全成本构成分析明细表            结束
    ****************************************************************************
    */
  END cost_analysis_c0205_proc;
  PROCEDURE cost_analysis_c0206_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
          ****************************************************************************
          *收入构成分析 明细表     开始
          ****************************************************************************
    Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                医保收入
    T_2       NUMBER(30,6) Y                药品收入
    T_3       NUMBER(30,6) Y                其他收入
     ****************************************************************************
          */
    DELETE FROM cost_c0227
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0227
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3)
    
      SELECT *
        FROM (SELECT t3.group_id
                    ,t3.hos_id
                    ,t3.copy_code
                    ,t3.acc_year
                    ,t3.acc_month
                    ,t4.income_type_code
                    ,dept_code
                    ,dept_name
                    ,income_money
                FROM (SELECT t1.group_id
                            ,t1.hos_id
                            ,t1.copy_code
                            ,t1.acc_year
                            ,t1.acc_month
                            ,t2.income_type_id
                            ,t1.appl_dept_id dept_id
                            ,t1.appl_dept_no dept_no
                            ,SUM(t1.money) income_money
                        FROM cost_income t1
                        LEFT JOIN cost_charge_kind_arrt t2
                          ON t1.group_id = t2.group_id
                         AND t1.hos_id = t2.hos_id
                         AND t1.copy_code = t2.copy_code
                         AND t1.charge_kind_id = t2.charge_kind_id
                       WHERE t1.group_id = p_group_id
                         AND t1.hos_id = p_hos_id
                         AND t1.copy_code = p_copy_code
                         AND t1.acc_year = p_acc_year
                         AND t1.acc_month = p_acc_month
                       GROUP BY t1.group_id
                               ,t1.hos_id
                               ,t1.copy_code
                               ,t1.acc_year
                               ,t1.acc_month
                               ,t2.income_type_id
                               ,t1.appl_dept_id
                               ,t1.appl_dept_no) t3
                LEFT JOIN cost_income_type t4
                  ON t3.income_type_id = t4.income_type_id
                LEFT JOIN hos_dept t5
                  ON t3.group_id = t5.group_id
                 AND t3.hos_id = t5.hos_id
                 AND t3.dept_id = t5.dept_id) pivot(SUM(income_money) FOR income_type_code IN('01' t1
                                                                                             ,'02' t2
                                                                                             ,'03' t3));
  
    /*
          ****************************************************************************
          *收入构成分析 明细表     开始
          ****************************************************************************
       Name       Type         Nullable Default Comments
    ---------- ------------ -------- ------- --------
    GROUP_ID   NUMBER(18)                    集团ID
    HOS_ID     NUMBER(18)                    医院ID
    COPY_CODE  VARCHAR2(20)                  账套编码
    ACC_YEAR   VARCHAR2(4)                   统计年份
    ACC_MONTH  VARCHAR2(2)                   统计月份
    ITEM_CODE  VARCHAR2(20)                  项目编码
    ITEM_NAME  VARCHAR2(50) Y                项目名称
    T_1        NUMBER(30,6) Y                本期
    T_2        NUMBER(30,6) Y                累计
    NATUR_CODE VARCHAR2(20) Y                科室性质
    FLAG       NUMBER(2)    Y                排序标记
          ****************************************************************************
          */
  
    DELETE FROM cost_c0226
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0226
      (flag
      ,group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,natur_code
      ,t_1
      ,t_2)
      SELECT flag
            ,group_id
            ,hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,item_code
            ,item_name
            ,natur_code
            ,SUM(t1)
            ,SUM(t2)
        FROM (SELECT 1 flag
                    ,group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,'00' item_code
                    ,'门诊收入' item_name
                    ,natur_code
                    ,income_money t1
                    ,0 t2
                FROM (SELECT t1.group_id
                            ,t1.hos_id
                            ,t1.copy_code
                            ,t1.acc_year
                            ,t1.acc_month
                            ,t3.natur_code
                            ,SUM(t1.money) income_money
                        FROM cost_income t1
                        LEFT JOIN cost_charge_kind_arrt t2
                          ON t1.group_id = t2.group_id
                         AND t1.hos_id = t2.hos_id
                         AND t1.copy_code = t2.copy_code
                         AND t1.charge_kind_id = t2.charge_kind_id
                       INNER JOIN acc_dept_attr t3
                          ON t1.group_id = t3.group_id
                         AND t1.hos_id = t3.hos_id
                         AND t1.appl_dept_id = t3.dept_id
                         AND t3.natur_code = '01'
                         AND t1.group_id = p_group_id
                         AND t1.hos_id = p_hos_id
                         AND t1.copy_code = p_copy_code
                         AND t1.acc_year = p_acc_year
                         AND t1.acc_month = p_acc_month
                       GROUP BY t1.group_id
                               ,t1.hos_id
                               ,t1.copy_code
                               ,t1.acc_year
                               ,t1.acc_month
                               ,t3.natur_code) t3
              
              UNION ALL
              SELECT CASE
                        WHEN natur_code = '01' THEN
                         1
                        ELSE
                         2
                      END flag
                    ,group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,income_type_code
                    ,'        其中：'||income_type_name
                    ,natur_code
                    ,income_money
                    ,0
                FROM (SELECT t1.group_id
                            ,t1.hos_id
                            ,t1.copy_code
                            ,t1.acc_year
                            ,t1.acc_month
                            ,t2.income_type_id
                            ,t3.natur_code
                            ,SUM(t1.money) income_money
                        FROM cost_income t1
                        LEFT JOIN cost_charge_kind_arrt t2
                          ON t1.group_id = t2.group_id
                         AND t1.hos_id = t2.hos_id
                         AND t1.copy_code = t2.copy_code
                         AND t1.charge_kind_id = t2.charge_kind_id
                       INNER JOIN acc_dept_attr t3
                          ON t1.group_id = t3.group_id
                         AND t1.hos_id = t3.hos_id
                         AND t1.appl_dept_id = t3.dept_id
                         AND t1.group_id = p_group_id
                         AND t1.hos_id = p_hos_id
                         AND t1.copy_code = p_copy_code
                         AND t1.acc_year = p_acc_year
                         AND t1.acc_month = p_acc_month
                       GROUP BY t1.group_id
                               ,t1.hos_id
                               ,t1.copy_code
                               ,t1.acc_year
                               ,t1.acc_month
                               ,t2.income_type_id
                               ,t3.natur_code) t3
                LEFT JOIN cost_income_type t4
                  ON t3.income_type_id = t4.income_type_id
              UNION ALL
              SELECT 2 flag
                    ,group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,'00'
                    ,'住院收入'
                    ,natur_code
                    ,income_money
                    ,0
                FROM (SELECT t1.group_id
                            ,t1.hos_id
                            ,t1.copy_code
                            ,t1.acc_year
                            ,t1.acc_month
                            ,t3.natur_code
                            ,SUM(t1.money) income_money
                        FROM cost_income t1
                        LEFT JOIN cost_charge_kind_arrt t2
                          ON t1.group_id = t2.group_id
                         AND t1.hos_id = t2.hos_id
                         AND t1.copy_code = t2.copy_code
                         AND t1.charge_kind_id = t2.charge_kind_id
                       INNER JOIN acc_dept_attr t3
                          ON t1.group_id = t3.group_id
                         AND t1.hos_id = t3.hos_id
                         AND t1.appl_dept_id = t3.dept_id
                         AND t3.natur_code = '02'
                         AND t1.group_id = p_group_id
                         AND t1.hos_id = p_hos_id
                         AND t1.copy_code = p_copy_code
                         AND t1.acc_year = p_acc_year
                         AND t1.acc_month = p_acc_month
                       GROUP BY t1.group_id
                               ,t1.hos_id
                               ,t1.copy_code
                               ,t1.acc_year
                               ,t1.acc_month
                               ,t3.natur_code) t3
              
              UNION ALL
              SELECT 1 flag
                    ,group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,p_acc_month acc_month
                    ,'00' item_code
                    ,'门诊收入' item_name
                    ,natur_code
                    ,0
                    ,income_money
                FROM (SELECT t1.group_id
                            ,t1.hos_id
                            ,t1.copy_code
                            ,t1.acc_year
                            ,
                             --t1.acc_month,
                             t3.natur_code
                            ,SUM(t1.money) income_money
                        FROM cost_income t1
                        LEFT JOIN cost_charge_kind_arrt t2
                          ON t1.group_id = t2.group_id
                         AND t1.hos_id = t2.hos_id
                         AND t1.copy_code = t2.copy_code
                         AND t1.charge_kind_id = t2.charge_kind_id
                       INNER JOIN acc_dept_attr t3
                          ON t1.group_id = t3.group_id
                         AND t1.hos_id = t3.hos_id
                         AND t1.appl_dept_id = t3.dept_id
                         AND t3.natur_code = '01'
                         AND t1.group_id = p_group_id
                         AND t1.hos_id = p_hos_id
                         AND t1.copy_code = p_copy_code
                         AND t1.acc_year = p_acc_year
                         AND t1.acc_month <= p_acc_month
                       GROUP BY t1.group_id
                               ,t1.hos_id
                               ,t1.copy_code
                               ,t1.acc_year
                               ,
                                -- t1.acc_month,
                                t3.natur_code) t3
              
              UNION ALL
              SELECT CASE
                        WHEN natur_code = '01' THEN
                         1
                        ELSE
                         2
                      END flag
                    ,group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,p_acc_month acc_month
                    ,income_type_code
                    ,'        其中：'||income_type_name
                    ,natur_code
                    ,0
                    ,income_money
                FROM (SELECT t1.group_id
                            ,t1.hos_id
                            ,t1.copy_code
                            ,t1.acc_year
                            ,
                             -- t1.acc_month,
                             t2.income_type_id
                            ,t3.natur_code
                            ,SUM(t1.money) income_money
                        FROM cost_income t1
                        LEFT JOIN cost_charge_kind_arrt t2
                          ON t1.group_id = t2.group_id
                         AND t1.hos_id = t2.hos_id
                         AND t1.copy_code = t2.copy_code
                         AND t1.charge_kind_id = t2.charge_kind_id
                       INNER JOIN acc_dept_attr t3
                          ON t1.group_id = t3.group_id
                         AND t1.hos_id = t3.hos_id
                         AND t1.appl_dept_id = t3.dept_id
                         AND t1.group_id = p_group_id
                         AND t1.hos_id = p_hos_id
                         AND t1.copy_code = p_copy_code
                         AND t1.acc_year = p_acc_year
                         AND t1.acc_month <= p_acc_month
                       GROUP BY t1.group_id
                               ,t1.hos_id
                               ,t1.copy_code
                               ,t1.acc_year
                               ,
                                -- t1.acc_month,
                                t2.income_type_id
                               ,t3.natur_code) t3
                LEFT JOIN cost_income_type t4
                  ON t3.income_type_id = t4.income_type_id
              UNION ALL
              SELECT 2            flag
                    ,group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,p_acc_month  acc_month
                    ,'00'
                    ,'住院收入'
                    ,natur_code
                    ,0
                    ,income_money
                FROM (SELECT t1.group_id
                            ,t1.hos_id
                            ,t1.copy_code
                            ,t1.acc_year
                            ,
                             --t1.acc_month,
                             t3.natur_code
                            ,SUM(t1.money) income_money
                        FROM cost_income t1
                        LEFT JOIN cost_charge_kind_arrt t2
                          ON t1.group_id = t2.group_id
                         AND t1.hos_id = t2.hos_id
                         AND t1.copy_code = t2.copy_code
                         AND t1.charge_kind_id = t2.charge_kind_id
                       INNER JOIN acc_dept_attr t3
                          ON t1.group_id = t3.group_id
                         AND t1.hos_id = t3.hos_id
                         AND t1.appl_dept_id = t3.dept_id
                         AND t3.natur_code = '02'
                         AND t1.group_id = p_group_id
                         AND t1.hos_id = p_hos_id
                         AND t1.copy_code = p_copy_code
                         AND t1.acc_year = p_acc_year
                         AND t1.acc_month <= p_acc_month
                       GROUP BY t1.group_id
                               ,t1.hos_id
                               ,t1.copy_code
                               ,t1.acc_year
                               ,
                                --  t1.acc_month,
                                t3.natur_code) t3) t
       GROUP BY flag
               ,group_id
               ,hos_id
               ,copy_code
               ,acc_year
               ,acc_month
               ,item_code
               ,item_name
               ,natur_code
       ORDER BY acc_month, flag, natur_code, item_code;
  
    DELETE FROM cost_c0228
     WHERE group_id = p_group_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0228
      (group_id
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,natur_code
      ,flag
      ,t_1
      ,t_2)
      SELECT group_id
            ,acc_year
            ,acc_month
            ,item_code
            ,item_name
            ,natur_code
            ,flag
            ,SUM(t_1)
            ,SUM(t_2)
        FROM COST_C0226
       WHERE group_id = p_group_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY group_id
               ,acc_year
               ,acc_month
               ,item_code
               ,item_name
               ,natur_code
               ,flag;
  
    DELETE FROM cost_c0229
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0229
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3)
      SELECT t1.group_id
            ,t1.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,SUM(t_1)
            ,SUM(t_2)
            ,SUM(t_3)
        FROM COST_C0227 t1
        LEFT JOIN hos_info t2
          ON t1.group_id = t2.group_id
         AND t2.hos_id = t1.hos_id
       WHERE t1.group_id = p_group_id
         AND t1.hos_id = p_hos_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY t1.group_id
               ,t1.hos_id
               ,acc_year
               ,acc_month
               ,hos_code
               ,hos_name;
    /*
    ****************************************************************************
    *集团构成分析 医院全成本构成分析明细表            结束
    ****************************************************************************
    */
  END cost_analysis_c0206_proc;
  PROCEDURE cost_analysis_c0301_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
              ****************************************************************************
              *收入分类分析
              ****************************************************************************
    Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE VARCHAR2(20)                  收入项目编码
    ITEM_NAME VARCHAR2(50) Y                收入项目名称
    T_1       NUMBER(30,6) Y                医保收入
    T_2       NUMBER(30,6) Y                药品收入
    T_3       NUMBER(30,6) Y                其他收入
         ****************************************************************************
              */
    DELETE FROM cost_c0301
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0301
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3)
      SELECT group_id
            ,hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,income_item_code
            ,income_item_name
            ,SUM(nvl(t_1, 0))
            ,SUM(nvl(t_2, 0))
            ,SUM(nvl(t_3, 0))
        FROM ((SELECT group_id
                     ,hos_id
                     ,copy_code
                     ,acc_year
                     ,acc_month
                     ,income_item_code
                     ,income_item_name
                     ,income_type_code
                     ,income_type_name
                     ,SUM(money) income_money
                 FROM (SELECT t1.group_id
                             ,t1.hos_id
                             ,t1.copy_code
                             ,t1.charge_kind_id
                             ,t5.income_item_code
                             ,t5.income_item_name
                             ,t5.income_type_code
                             ,t5.income_type_name
                             ,t1.acc_year
                             ,t1.acc_month
                             ,t1.money
                         FROM cost_income t1
                        INNER JOIN (SELECT t2.group_id
                                         ,t2.hos_id
                                         ,t2.copy_code
                                         ,t2.charge_kind_id
                                         ,t3.income_item_code
                                         ,t3.income_item_name
                                         ,t4.income_type_code
                                         ,t4.income_type_name
                                     FROM cost_charge_kind_arrt t2
                                    INNER JOIN cost_income_item_arrt t3
                                       ON t2.group_id = t3.group_id
                                      AND t2.hos_id = t3.hos_id
                                      AND t2.copy_code = t3.copy_code
                                      AND t2.income_item_id_in =
                                          t3.income_item_id
                                     LEFT JOIN cost_income_type t4
                                       ON t2.income_type_id =
                                          t4.income_type_id
                                    WHERE t2.group_id = p_group_id
                                      AND t2.hos_id = p_hos_id
                                      AND t2.copy_code = p_copy_code) t5
                           ON t1.group_id = t5.group_id
                          AND t1.hos_id = t5.hos_id
                          AND t1.copy_code = t5.copy_code
                          AND t1.charge_kind_id = t5.charge_kind_id
                        WHERE t1.group_id = p_group_id
                          AND t1.hos_id = p_hos_id
                          AND t1.copy_code = p_copy_code
                          AND t1.acc_year = p_acc_year
                          AND t1.acc_month = p_acc_month
                       /* union all
                       select t1.group_id,
                              t1.hos_id,
                              t1.copy_code,
                              t1.charge_kind_id,
                              t6.income_item_code,
                              t6.income_item_name,
                              t6.income_type_code,
                              t6.income_type_name,
                              t1.acc_year,
                              t1.acc_month,
                              t1.money
                         from cost_income t1
                        inner join (select t2.group_id,
                                           t2.hos_id,
                                           t2.copy_code,
                                           t2.charge_kind_id,
                                           t3.income_item_code,
                                           t3.income_item_name,
                                           t4.income_type_code,
                                           t4.income_type_name
                                      from cost_charge_kind_arrt t2
                                     inner join cost_income_item_arrt t3
                                        on t2.group_id = t3.group_id
                                       and t2.hos_id = t3.hos_id
                                       and t2.copy_code = t3.copy_code
                                       and t2.income_item_id_out =
                                           t3.income_item_id
                                      left join cost_income_type t4
                                        on t2.income_type_id = t4.income_type_id
                                        where t2.group_id=p_group_id and t2.hos_id=p_hos_id
                                       and t2.copy_code=p_copy_code
                                        ) t6
                           on t1.group_id = t6.group_id
                          and t1.hos_id = t6.hos_id
                          and t1.copy_code = t6.copy_code
                          and t1.charge_kind_id = t6.charge_kind_id
                           where t1.group_id=p_group_id and t1.hos_id=p_hos_id
                                       and t1.copy_code=p_copy_code
                                       and t1.acc_year=p_acc_year and t1.acc_month=p_acc_month*/
                       ) t7
                GROUP BY group_id
                        ,hos_id
                        ,copy_code
                        ,charge_kind_id
                        ,income_item_code
                        ,income_item_name
                        ,income_type_code
                        ,income_type_name
                        ,acc_year
                        ,acc_month) t8
              pivot(SUM(income_money) FOR
                    income_type_code IN ('01' t_1, '02' t_2, '03' t_3)))
       GROUP BY group_id
               ,hos_id
               ,copy_code
               ,acc_year
               ,acc_month
               ,income_item_code
               ,income_item_name;
    /*
    ****************************************************************************
    *收入分类分析            结束
    ****************************************************************************
    */
  
    /*
              ****************************************************************************
              *收入分类分析明细
              ****************************************************************************
    Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE VARCHAR2(20)                  收入项目编码
    ITEM_NAME VARCHAR2(50) Y                收入项目名称
    T_1       NUMBER(30,6) Y                门诊医保收入
    T_2       NUMBER(30,6) Y                门诊药品收入
    T_3       NUMBER(30,6) Y                门诊其他收入
    T_4       NUMBER(30,6) Y                住院医保收入
    T_5       NUMBER(30,6) Y                住院药品收入
    T_6       NUMBER(30,6) Y                住院其他收入
         ****************************************************************************
              */
  
    DELETE FROM cost_c0302
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0302
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6)
      SELECT group_id
            ,hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,income_item_code
            ,income_item_name
            ,SUM(t_1) t_1
            ,SUM(t_2) t_2
            ,SUM(t_3) t_3
            ,SUM(t_4) t_4
            ,SUM(t_5) t_5
            ,SUM(t_6) t_6
        FROM (SELECT group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,income_item_code
                    ,income_item_name
                    ,t_1
                    ,t_2
                    ,t_3
                    ,0                t_4
                    ,0                t_5
                    ,0                t_6
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,income_item_code
                            ,income_item_name
                            ,t_1
                            ,t_2
                            ,t_3
                        FROM (SELECT t1.group_id
                                    ,t1.hos_id
                                    ,t1.copy_code
                                    ,t1.charge_kind_id
                                    ,t5.income_item_code
                                    ,t5.income_item_name
                                    ,t5.income_type_code
                                    ,t5.income_type_name
                                    ,t1.acc_year
                                    ,t1.acc_month
                                    ,SUM(t1.money) income_money
                                FROM cost_income t1
                               INNER JOIN (SELECT t2.group_id
                                                ,t2.hos_id
                                                ,t2.copy_code
                                                ,t2.charge_kind_id
                                                ,t3.income_item_code
                                                ,t3.income_item_name
                                                ,t4.income_type_code
                                                ,t4.income_type_name
                                            FROM cost_charge_kind_arrt t2
                                           INNER JOIN cost_income_item_arrt t3
                                              ON t2.group_id = t3.group_id
                                             AND t2.hos_id = t3.hos_id
                                             AND t2.copy_code = t3.copy_code
                                             AND t2.income_item_id_in =
                                                 t3.income_item_id
                                            LEFT JOIN cost_income_type t4
                                              ON t2.income_type_id =
                                                 t4.income_type_id) t5
                                  ON t1.group_id = t5.group_id
                                 AND t1.hos_id = t5.hos_id
                                 AND t1.copy_code = t5.copy_code
                                 AND t1.charge_kind_id = t5.charge_kind_id
                               INNER JOIN acc_dept_attr t6
                                  ON t1.group_id = t6.group_id
                                 AND t1.hos_id = t6.hos_id
                                 AND t1.appl_dept_id = t6.dept_id
                               WHERE t1.group_id = p_group_id
                                 AND t1.hos_id = p_hos_id
                                 AND t1.copy_code = p_copy_code
                                 AND t1.acc_year = p_acc_year
                                 AND t1.acc_month = p_acc_month
                                 AND t6.natur_code = '01'
                               GROUP BY t1.group_id
                                       ,t1.hos_id
                                       ,t1.copy_code
                                       ,t1.charge_kind_id
                                       ,t5.income_item_code
                                       ,t5.income_item_name
                                       ,t5.income_type_code
                                       ,t5.income_type_name
                                       ,t1.acc_year
                                       ,t1.acc_month
                              
                              ) t8 pivot(SUM(income_money) FOR income_type_code IN('01' t_1
                                                                                  ,'02' t_2
                                                                                  ,'03' t_3)))
              UNION ALL
              SELECT group_id
                    ,hos_id
                    ,copy_code
                    ,acc_year
                    ,acc_month
                    ,income_item_code
                    ,income_item_name
                    ,0
                    ,0
                    ,0
                    ,t_1
                    ,t_2
                    ,t_3
                FROM (SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,income_item_code
                            ,income_item_name
                            ,t_1
                            ,t_2
                            ,t_3
                        FROM (SELECT t1.group_id
                                    ,t1.hos_id
                                    ,t1.copy_code
                                    ,t1.charge_kind_id
                                    ,t5.income_item_code
                                    ,t5.income_item_name
                                    ,t5.income_type_code
                                    ,t5.income_type_name
                                    ,t1.acc_year
                                    ,t1.acc_month
                                    ,SUM(t1.money) income_money
                                FROM cost_income t1
                               INNER JOIN (SELECT t2.group_id
                                                ,t2.hos_id
                                                ,t2.copy_code
                                                ,t2.charge_kind_id
                                                ,t3.income_item_code
                                                ,t3.income_item_name
                                                ,t4.income_type_code
                                                ,t4.income_type_name
                                            FROM cost_charge_kind_arrt t2
                                           INNER JOIN cost_income_item_arrt t3
                                              ON t2.group_id = t3.group_id
                                             AND t2.hos_id = t3.hos_id
                                             AND t2.copy_code = t3.copy_code
                                             AND t2.income_item_id_in =
                                                 t3.income_item_id
                                            LEFT JOIN cost_income_type t4
                                              ON t2.income_type_id =
                                                 t4.income_type_id) t5
                                  ON t1.group_id = t5.group_id
                                 AND t1.hos_id = t5.hos_id
                                 AND t1.copy_code = t5.copy_code
                                 AND t1.charge_kind_id = t5.charge_kind_id
                               INNER JOIN acc_dept_attr t6
                                  ON t1.group_id = t6.group_id
                                 AND t1.hos_id = t6.hos_id
                                 AND t1.appl_dept_id = t6.dept_id
                               WHERE t1.group_id = p_group_id
                                 AND t1.hos_id = p_hos_id
                                 AND t1.copy_code = p_copy_code
                                 AND t1.acc_year = p_acc_year
                                 AND t1.acc_month = p_acc_month
                                 AND t6.natur_code = '02'
                               GROUP BY t1.group_id
                                       ,t1.hos_id
                                       ,t1.copy_code
                                       ,t1.charge_kind_id
                                       ,t5.income_item_code
                                       ,t5.income_item_name
                                       ,t5.income_type_code
                                       ,t5.income_type_name
                                       ,t1.acc_year
                                       ,t1.acc_month
                              
                              ) t8 pivot(SUM(income_money) FOR income_type_code IN('01' t_1
                                                                                  ,'02' t_2
                                                                                  ,'03' t_3)))) t7
       GROUP BY group_id
               ,hos_id
               ,copy_code
               ,acc_year
               ,acc_month
               ,income_item_code
               ,income_item_name;
  
    /*
    ****************************************************************************
    *收入分类分析明细            结束
    ****************************************************************************
    
    */
  
    /*
      ****************************************************************************
      *集团收入分类分析           开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE VARCHAR2(20)                  收入项目编码
    ITEM_NAME VARCHAR2(50) Y                收入项目名称
    T_1       NUMBER(30,6) Y                医保收入
    T_2       NUMBER(30,6) Y                药品收入
    T_3       NUMBER(30,6) Y                其他收入
      */
  
    DELETE FROM cost_c0305
     WHERE group_id = p_group_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0305
      (group_id, acc_year, acc_month, item_code, item_name, t_1, t_2, t_3)
      SELECT group_id
            ,acc_year
            ,acc_month
            ,item_code
            ,item_name
            ,SUM(t_1) t_1
            ,SUM(t_2) t_2
            ,SUM(t_3) t_3
        FROM COST_C0301
       WHERE group_id = p_group_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY group_id, acc_year, acc_month, item_code, item_name;
  
    /*
    ****************************************************************************
    *集团收入分类分析            结束
    ****************************************************************************
    */
  
    /*
      ****************************************************************************
      *集团收入分类分析明细            开始
      ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE VARCHAR2(20)                  收入项目编码
    ITEM_NAME VARCHAR2(50) Y                收入项目名称
    T_1       NUMBER(30,6) Y                门诊医保收入
    T_2       NUMBER(30,6) Y                门诊药品收入
    T_3       NUMBER(30,6) Y                门诊其他收入
    T_4       NUMBER(30,6) Y                住院医保收入
    T_5       NUMBER(30,6) Y                住院药品收入
    T_6       NUMBER(30,6) Y                住院其他收入
      */
  
    DELETE FROM cost_c0306
     WHERE group_id = p_group_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0306
      (group_id
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6)
      SELECT group_id
            ,acc_year
            ,acc_month
            ,item_code
            ,item_name
            ,SUM(t_1) t_1
            ,SUM(t_2) t_2
            ,SUM(t_3) t_3
            ,SUM(t_4) t_4
            ,SUM(t_5) t_5
            ,SUM(t_6) t_6
        FROM COST_C0302
       WHERE group_id = p_group_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY group_id, acc_year, acc_month, item_code, item_name;
  
    /*
    ****************************************************************************
    *集团收入分类分析明细            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0301_proc;
  PROCEDURE cost_analysis_c0302_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
    t5     NUMBER(18, 8); --医院本期合计
    t6     NUMBER(18, 8); --医院累计合计
    sum_t5 NUMBER(18, 8); --集团本期合计
    sum_t6 NUMBER(18, 8); --集团累计合计
  BEGIN
    /*
                ****************************************************************************
                *医疗成本构成
                ****************************************************************************
      Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE VARCHAR2(20)                  成本项目编码
    ITEM_NAME VARCHAR2(50) Y                成本项目名称
    T_1       NUMBER(30,6) Y                医疗业务成本_本期
    T_2       NUMBER(30,6) Y                医疗业务成本_累计
    T_3       NUMBER(30,6) Y                管理成本_本期
    T_4       NUMBER(30,6) Y                管理成本_累计
    T_5       NUMBER(30,6) Y                财政支出_本期
    T_6       NUMBER(30,6) Y                财政支出_累计
    T_7       NUMBER(30,6) Y                科教支出_本期
    T_8       NUMBER(30,6) Y                科教支出_累计
    T_9      NUMBER(30,6) Y                合计_本期
    T_10       NUMBER(30,6) Y                合计_累计
           ****************************************************************************
                */
    DELETE FROM cost_c0303
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0303
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,cost_item_code
            ,cost_item_name
            ,SUM(t1) t1
            ,SUM(t2) t2
            ,SUM(t3) t3
            ,SUM(t4) t4
            ,SUM(t5) t5
            ,SUM(t6) t6
            ,SUM(t7) t7
            ,SUM(t8) t8
            ,SUM(t1 + t3 + t5 + t7) t9
            ,SUM(t2 + t4 + t6 + t8) t10
        FROM (SELECT cost_item_code
                    ,cost_item_name
                    ,SUM(t1) t1
                    ,0 t2
                    ,0 t3
                    ,0 t4
                    ,0 t5
                    ,0 t6
                    ,0 t7
                    ,0 t8
                FROM v_cost_dept_cost_detail
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01'
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              SELECT cost_item_code
                    ,cost_item_name
                    ,0
                    ,SUM(t1) t2
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                FROM v_cost_dept_cost_detail
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                 AND type_code = '01'
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              
              SELECT cost_item_code
                    ,cost_item_name
                    ,0
                    ,0
                    ,SUM(t2) t3
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                FROM v_cost_dept_cost_detail
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '04'
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              SELECT cost_item_code
                    ,cost_item_name
                    ,0
                    ,0
                    ,0
                    ,SUM(t2) t4
                    ,0
                    ,0
                    ,0
                    ,0
                FROM v_cost_dept_cost_detail
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                 AND type_code = '04'
               GROUP BY cost_item_code, cost_item_name
              
              UNION ALL
              SELECT cost_item_code
                    ,cost_item_name
                    ,0
                    ,0
                    ,0
                    ,0
                    ,SUM(dir_amount) t5
                    ,0
                    ,0
                    ,0
                FROM cost_dept_cost t1
                LEFT JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
                LEFT JOIN cost_item_dict_no t3
                  ON t1.group_id = t3.group_id
                 AND t1.hos_id = t3.hos_id
                 AND t1.copy_code = t3.copy_code
                 AND t1.cost_item_id = t3.cost_item_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND t1.copy_code = p_copy_code
                 AND t1.acc_year = p_acc_year
                 AND t1.acc_month = p_acc_month
                 AND t2.source_attr = 2
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              SELECT cost_item_code
                    ,cost_item_name
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                    ,SUM(dir_amount) t6
                    ,0
                    ,0
                FROM cost_dept_cost t1
                LEFT JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
                LEFT JOIN cost_item_dict_no t3
                  ON t1.group_id = t3.group_id
                 AND t1.hos_id = t3.hos_id
                 AND t1.copy_code = t3.copy_code
                 AND t1.cost_item_id = t3.cost_item_id
                 
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND t1.copy_code = p_copy_code
                 AND t1.acc_year = p_acc_year
                 AND t1.acc_month <= p_acc_month
                 AND t2.source_attr = 2
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              SELECT cost_item_code
                    ,cost_item_name
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                    ,SUM(dir_amount) t7
                    ,0
                FROM cost_dept_cost t1
                LEFT JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
                LEFT JOIN cost_item_dict_no t3
                  ON t1.group_id = t3.group_id
                 AND t1.hos_id = t3.hos_id
                 AND t1.copy_code = t3.copy_code
                 AND t1.cost_item_id = t3.cost_item_id
                 
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND t1.copy_code = p_copy_code
                 AND t1.acc_year = p_acc_year
                 AND t1.acc_month = p_acc_month
                 AND t2.source_attr IN (3, 4)
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              SELECT cost_item_code
                    ,cost_item_name
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                    ,0
                    ,SUM(dir_amount) t6
                FROM cost_dept_cost t1
                LEFT JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
                LEFT JOIN cost_item_dict_no t3
                  ON t1.group_id = t3.group_id
                 AND t1.hos_id = t3.hos_id
                 AND t1.copy_code = t3.copy_code
                 AND t1.cost_item_id = t3.cost_item_id
                 
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND t1.copy_code = p_copy_code
                 AND t1.acc_year = p_acc_year
                 AND t1.acc_month <= p_acc_month
                 AND t2.source_attr IN (3, 4)
               GROUP BY cost_item_code, cost_item_name)
       GROUP BY cost_item_code, cost_item_name
       ORDER BY cost_item_code, cost_item_name;
    /*
    ****************************************************************************
    *医疗成本构成            结束
    ****************************************************************************
    */
  
    /*
                ****************************************************************************
                *医疗成本构成 明细
                ****************************************************************************
     Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE VARCHAR2(20)                  成本项目编码
    ITEM_NAME VARCHAR2(50) Y                成本项目名称
    T_1       NUMBER(30,6) Y                门诊成本_本期
    T_2       NUMBER(30,6) Y                门诊成本_本期比例
    T_3       NUMBER(30,6) Y                门诊成本_累计
    T_4       NUMBER(30,6) Y                门诊成本_累计比例
    T_5       NUMBER(30,6) Y                住院成本_本期
    T_6       NUMBER(30,6) Y                住院成本_本期比例
    T_7       NUMBER(30,6) Y                住院成本_累计
    T_8       NUMBER(30,6) Y                住院成本_累计比例
    T_9      NUMBER(30,6) Y                合计_本期
    T_10      NUMBER(30,6) Y                合计_本期比例
    T_11      NUMBER(30,6) Y                合计_累计
    T_12      NUMBER(30,6) Y                合计_累计比例
           ****************************************************************************
                */
  
    SELECT SUM(t4)
      INTO t5
    
      FROM v_cost_dept_cost_detail
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month
       AND type_code = '01';
  
    SELECT SUM(t4)
      INTO t6
      FROM v_cost_dept_cost_detail
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month <= p_acc_month
       AND type_code = '01';
  
    DELETE FROM cost_c0304
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0304
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10
      ,t_11
      ,t_12)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,cost_item_code
            ,cost_item_name
            ,SUM(t1) t1
            ,SUM(divide(t1, t5)) t2
            ,SUM(t2) t3
            ,SUM(divide(t2, t6)) t4
            ,SUM(t3) t5
            ,SUM(divide(t3, t5)) t6
            ,SUM(t4) t7
            ,SUM(divide(t4, t6)) t8
            ,SUM(t1 + t3) t9
            ,SUM(divide(t1 + t3, t5)) t10
            ,SUM(t2 + t4) t11
            ,SUM(divide(t2 + t4, t6)) t12
        FROM (SELECT cost_item_code
                    ,cost_item_name
                    ,SUM(t4) t1
                    ,0 t2
                    ,0 t3
                    ,0 t4
                FROM v_cost_dept_cost_detail
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01'
                 AND natur_code = '01'
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              SELECT cost_item_code, cost_item_name, 0, SUM(t4) t2, 0, 0
                FROM v_cost_dept_cost_detail
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                 AND type_code = '01'
                 AND natur_code = '01'
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              
              SELECT cost_item_code, cost_item_name, 0, 0, SUM(t4) t3, 0
                FROM v_cost_dept_cost_detail
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND type_code = '01'
                 AND natur_code = '02'
               GROUP BY cost_item_code, cost_item_name
              UNION ALL
              SELECT cost_item_code, cost_item_name, 0, 0, 0, SUM(t4) t4
                FROM v_cost_dept_cost_detail
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month <= p_acc_month
                 AND type_code = '01'
                 AND natur_code = '02'
               GROUP BY cost_item_code, cost_item_name)
       GROUP BY cost_item_code, cost_item_name
       ORDER BY cost_item_code, cost_item_name;
  
    /*
    ****************************************************************************
    *医疗成本构成明细            结束
    ****************************************************************************
    
    */
  
    /*
        ****************************************************************************
        *医疗成本构成            开始
        ****************************************************************************
       Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE VARCHAR2(20)                  成本项目编码
    ITEM_NAME VARCHAR2(50) Y                成本项目名称
    T_1       NUMBER(30,6) Y                医疗业务成本_本期
    T_2       NUMBER(30,6) Y                医疗业务成本_累计
    T_3       NUMBER(30,6) Y                管理成本_本期
    T_4       NUMBER(30,6) Y                管理成本_累计
    T_5       NUMBER(30,6) Y                财政支出_本期
    T_6       NUMBER(30,6) Y                财政支出_累计
    T_7       NUMBER(30,6) Y                科教支出_本期
    T_8       NUMBER(30,6) Y                科教支出_累计
    T_9      NUMBER(30,6) Y                合计_本期
    T_10       NUMBER(30,6) Y                合计_累计
        */
  
    DELETE FROM cost_c0307
     WHERE group_id = p_group_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0307
      (group_id
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT group_id
            ,acc_year
            ,acc_month
            ,item_code
            ,item_name
            ,SUM(t_1) t_1
            ,SUM(t_2) t_2
            ,SUM(t_3) t_3
            ,SUM(t_4) t_1
            ,SUM(t_5) t_2
            ,SUM(t_6) t_3
            ,SUM(t_7) t_1
            ,SUM(t_8) t_2
            ,SUM(t_9) t_3
            ,SUM(t_10) t_10
        FROM COST_C0303
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY group_id, acc_year, acc_month, item_code, item_name;
  
    /*
    ****************************************************************************
    *医疗成本构成             结束
    ****************************************************************************
    */
  
    /*
          ****************************************************************************
          *医疗成本构成明细            开始
          ****************************************************************************
         Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ---------
    GROUP_ID  NUMBER(18)                    集团ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    ITEM_CODE VARCHAR2(20)                  成本项目编码
    ITEM_NAME VARCHAR2(50) Y                成本项目名称
    T_1       NUMBER(30,6) Y                门诊成本_本期
    T_2       NUMBER(30,6) Y                门诊成本_本期比例
    T_3       NUMBER(30,6) Y                门诊成本_累计
    T_4       NUMBER(30,6) Y                门诊成本_累计比例
    T_5       NUMBER(30,6) Y                住院成本_本期
    T_6       NUMBER(30,6) Y                住院成本_本期比例
    T_7       NUMBER(30,6) Y                住院成本_累计
    T_8       NUMBER(30,6) Y                住院成本_累计比例
    T_9      NUMBER(30,6) Y                合计_本期
    T_10      NUMBER(30,6) Y                合计_本期比例
    T_11      NUMBER(30,6) Y                合计_累计
    T_12      NUMBER(30,6) Y                合计_累计比例
          */
  
    SELECT SUM(t_9)
      INTO sum_t5
    
      FROM cost_c0304
     WHERE group_id = p_group_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    SELECT SUM(t_10)
      INTO sum_t6
      FROM cost_c0304
     WHERE group_id = p_group_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month <= p_acc_month;
  
    DELETE FROM cost_c0308
     WHERE group_id = p_group_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0308
      (group_id
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10
      ,t_11
      ,t_12)
      SELECT group_id
            ,acc_year
            ,acc_month
            ,item_code
            ,item_name
            ,SUM(t_1) t_1
            ,SUM(divide(t_1, sum_t5)) t_2
            ,SUM(t_3) t_3
            ,SUM(divide(t_3, sum_t6)) t_4
            ,SUM(t_5) t_5
            ,SUM(divide(t_5, sum_t5)) t_6
            ,SUM(t_7) t_7
            ,SUM(divide(t_7, sum_t5)) t_8
            ,SUM(t_9) t_9
            ,SUM(divide(t_9, sum_t6)) t_10
            ,SUM(t_11) t_11
            ,SUM(divide(t_11, sum_t6)) t_12
        FROM COST_C0304
       WHERE group_id = p_group_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY group_id, acc_year, acc_month, item_code, item_name;
  
    /*
    ****************************************************************************
    *医疗成本构成明细             结束
    ****************************************************************************
    */
  
  END cost_analysis_c0302_proc;
  PROCEDURE cost_analysis_c0401_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
            ****************************************************************************
            *科室成本习性    开始
            ****************************************************************************
     Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- ----------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                合计_本期
    T_2       NUMBER(30,6) Y                合计_累计
    T_3       NUMBER(30,6) Y                固定成本_成本_本期
    T_4       NUMBER(30,6) Y                固定成本_成本_累计
    T_5       NUMBER(30,6) Y                固定成本_比重_本期
    T_6       NUMBER(30,6) Y                固定成本_比重_累计
    T_7       NUMBER(30,6) Y                变动成本_成本_本期
    T_8       NUMBER(30,6) Y                变动成本_成本_累计
    T_9       NUMBER(30,6) Y                变动成本_比重_本期
    T_10      NUMBER(30,6) Y                变动成本_比重_累计
       ****************************************************************************
            */
    DELETE FROM cost_c0401
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0401
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT group_id
            ,hos_id
            ,copy_code
            ,acc_year
            ,acc_month
            ,dept_code
            ,dept_name
            ,nvl(g_current, 0) + nvl(g_current_bd, 0) AS t1
            ,nvl(g_accumulated, 0) + nvl(g_current_bd, 0) AS t2
            ,g_current AS t3
            ,g_accumulated AS t4
            ,g_current / (nvl(g_current, 0) + nvl(g_current_bd, 0)) AS t5
            ,g_accumulated /
             (nvl(g_accumulated, 0) + nvl(g_current_bd_lj, 0)) AS t6
            ,g_current_bd AS t7
            ,g_current_bd_lj AS t8
            ,g_current_bd / (nvl(g_current, 0) + nvl(g_current_bd, 0)) AS t9
            ,g_current_bd_lj /
             (nvl(g_accumulated, 0) + nvl(g_current_bd_lj, 0)) AS t10
        FROM (
              
              SELECT group_id
                     ,hos_id
                     ,copy_code
                     ,acc_year
                     ,acc_month
                     ,dept_id
                     
                     ,dept_code
                     ,dept_name
                     ,SUM(g_current) g_current
                     ,SUM(g_accumulated) g_accumulated
                     ,SUM(g_current_bd) g_current_bd
                     ,SUM(g_current_bd_lj) g_current_bd_lj
                FROM (SELECT g.group_id
                             ,g.hos_id
                             ,g.copy_code
                             ,g.acc_year
                             ,g.acc_month
                             ,g.dept_id
                             ,g.dept_no
                             ,g.dept_code
                             ,g.dept_name
                             ,g.dir_amount AS g_current
                             ,b.dir_amount AS g_accumulated
                             ,0            AS g_current_bd
                             ,0            AS g_current_bd_lj
                         FROM (SELECT cddd.group_id
                                     ,cddd.hos_id
                                     ,cddd.copy_code
                                     ,cddd.acc_year
                                     ,cddd.acc_month
                                     ,cddd.dept_id
                                     ,cddd.dept_no
                                     ,hdd.dept_code
                                     ,hdd.dept_name
                                     ,SUM(nvl(cddd.dir_amount, 0)) AS dir_amount
                                 FROM cost_dept_dri_data cddd
                                 LEFT JOIN cost_item_dict_no cidn
                                   ON cddd.group_id = cidn.group_id
                                  AND cddd.hos_id = cidn.hos_id
                                  AND cddd.copy_code = cidn.copy_code
                                  AND cddd.cost_item_id = cidn.cost_item_id
                                  AND cddd.cost_item_no = cidn.cost_item_no
                                 LEFT JOIN cost_dept_nature cdn
                                   ON cdn.nature_id = cidn.nature_id
                                 LEFT JOIN hos_dept_dict hdd
                                   ON hdd.group_id = cddd.group_id
                                  AND hdd.hos_id = cddd.hos_id
                                  AND hdd.dept_id = cddd.dept_id
                                  AND hdd.dept_no = cddd.dept_no
                                WHERE cddd.group_id = p_group_id
                                  AND cddd.hos_id = p_hos_id
                                  AND cddd.copy_code = p_copy_code
                                  AND cddd.acc_year = p_acc_year
                                  AND cddd.acc_month = p_acc_month
                                  AND cdn.nature_code = '01'
                                  AND cidn.is_stop = '0'
                                  AND hdd.is_stop = '0'
                                  AND cddd.dir_amount != 0
                                GROUP BY cddd.group_id
                                        ,cddd.hos_id
                                        ,cddd.copy_code
                                        ,cddd.acc_year
                                        ,cddd.acc_month
                                        ,cddd.dept_id
                                        ,cddd.dept_no
                                        ,hdd.dept_code
                                        ,hdd.dept_name) g
                        INNER JOIN (SELECT cddd.group_id
                                         ,cddd.hos_id
                                         ,cddd.copy_code
                                         ,cddd.dept_id
                                         ,cddd.dept_no
                                         ,hdd.dept_code
                                         ,hdd.dept_name
                                         ,SUM(nvl(cddd.dir_amount, 0)) AS dir_amount
                                     FROM cost_dept_dri_data cddd
                                     LEFT JOIN cost_item_dict_no cidn
                                       ON cddd.group_id = cidn.group_id
                                      AND cddd.hos_id = cidn.hos_id
                                      AND cddd.copy_code = cidn.copy_code
                                      AND cddd.cost_item_id = cidn.cost_item_id
                                      AND cddd.cost_item_no = cidn.cost_item_no
                                     LEFT JOIN cost_dept_nature cdn
                                       ON cdn.nature_id = cidn.nature_id
                                     LEFT JOIN hos_dept_dict hdd
                                       ON hdd.group_id = cddd.group_id
                                      AND hdd.hos_id = cddd.hos_id
                                      AND hdd.dept_id = cddd.dept_id
                                      AND hdd.dept_no = cddd.dept_no
                                    WHERE cddd.group_id = p_group_id
                                      AND cddd.hos_id = p_hos_id
                                      AND cddd.copy_code = p_copy_code
                                      AND cddd.acc_year = p_acc_year
                                      AND cddd.acc_month <= p_acc_month
                                      AND cdn.nature_code = '01'
                                      AND cidn.is_stop = '0'
                                      AND hdd.is_stop = '0'
                                      AND cddd.dir_amount != 0
                                    GROUP BY cddd.group_id
                                            ,cddd.hos_id
                                            ,cddd.copy_code
                                            ,cddd.dept_id
                                            ,cddd.dept_no
                                            ,hdd.dept_code
                                            ,hdd.dept_name) b
                           ON g.group_id = b.group_id
                          AND g.hos_id = b.hos_id
                          AND g.copy_code = b.copy_code
                          AND g.dept_id = b.dept_id
                          AND g.dept_no = b.dept_no
                       UNION ALL
                       SELECT g.group_id
                             ,g.hos_id
                             ,g.copy_code
                             ,g.acc_year
                             ,g.acc_month
                             ,g.dept_id
                             ,g.dept_no
                             ,g.dept_code
                             ,g.dept_name
                             ,0
                             ,0
                             ,g.dir_amount AS b_current
                             ,b.dir_amount AS b_accumulated
                         FROM (SELECT cddd.group_id
                                     ,cddd.hos_id
                                     ,cddd.copy_code
                                     ,cddd.acc_year
                                     ,cddd.acc_month
                                     ,cddd.dept_id
                                     ,cddd.dept_no
                                     ,hdd.dept_code
                                     ,hdd.dept_name
                                     ,SUM(nvl(cddd.dir_amount, 0)) AS dir_amount
                                 FROM cost_dept_dri_data cddd
                                 LEFT JOIN cost_item_dict_no cidn
                                   ON cddd.group_id = cidn.group_id
                                  AND cddd.hos_id = cidn.hos_id
                                  AND cddd.copy_code = cidn.copy_code
                                  AND cddd.cost_item_id = cidn.cost_item_id
                                  AND cddd.cost_item_no = cidn.cost_item_no
                                 LEFT JOIN cost_dept_nature cdn
                                   ON cdn.nature_id = cidn.nature_id
                                 LEFT JOIN hos_dept_dict hdd
                                   ON hdd.group_id = cddd.group_id
                                  AND hdd.hos_id = cddd.hos_id
                                  AND hdd.dept_id = cddd.dept_id
                                  AND hdd.dept_no = cddd.dept_no
                                WHERE cddd.group_id = p_group_id
                                  AND cddd.hos_id = p_hos_id
                                  AND cddd.copy_code = p_copy_code
                                  AND cddd.acc_year = p_acc_year
                                  AND cddd.acc_month = p_acc_month
                                  AND cdn.nature_code = '02'
                                  AND cidn.is_stop = '0'
                                  AND hdd.is_stop = '0'
                                  AND cddd.dir_amount != 0
                                GROUP BY cdn.nature_name
                                        ,cddd.group_id
                                        ,cddd.hos_id
                                        ,cddd.copy_code
                                        ,cddd.acc_year
                                        ,cddd.acc_month
                                        ,cddd.dept_id
                                        ,cddd.dept_no
                                        ,hdd.dept_code
                                        ,hdd.dept_name) g
                         LEFT JOIN (SELECT cddd.group_id
                                          ,cddd.hos_id
                                          ,cddd.copy_code
                                          ,cddd.dept_id
                                          ,cddd.dept_no
                                          ,hdd.dept_code
                                          ,hdd.dept_name
                                          ,SUM(nvl(cddd.dir_amount, 0)) AS dir_amount
                                      FROM cost_dept_dri_data cddd
                                      LEFT JOIN cost_item_dict_no cidn
                                        ON cddd.group_id = cidn.group_id
                                       AND cddd.hos_id = cidn.hos_id
                                       AND cddd.copy_code = cidn.copy_code
                                       AND cddd.cost_item_id = cidn.cost_item_id
                                       AND cddd.cost_item_no = cidn.cost_item_no
                                      LEFT JOIN cost_dept_nature cdn
                                        ON cdn.nature_id = cidn.nature_id
                                      LEFT JOIN hos_dept_dict hdd
                                        ON hdd.group_id = cddd.group_id
                                       AND hdd.hos_id = cddd.hos_id
                                       AND hdd.dept_id = cddd.dept_id
                                       AND hdd.dept_no = cddd.dept_no
                                     WHERE cddd.group_id = p_group_id
                                       AND cddd.hos_id = p_hos_id
                                       AND cddd.copy_code = p_copy_code
                                       AND cddd.acc_year = p_acc_year
                                       AND cddd.acc_month <= p_acc_month
                                       AND cdn.nature_code = '02'
                                       AND cidn.is_stop = '0'
                                       AND hdd.is_stop = '0'
                                       AND cddd.dir_amount != 0
                                     GROUP BY cddd.group_id
                                             ,cddd.hos_id
                                             ,cddd.copy_code
                                             ,cddd.dept_id
                                             ,cddd.dept_no
                                             ,hdd.dept_code
                                             ,hdd.dept_name) b
                           ON g.group_id = b.group_id
                          AND g.hos_id = b.hos_id
                          AND g.copy_code = b.copy_code
                          AND g.dept_id = b.dept_id
                          AND g.dept_no = b.dept_no) jj
               GROUP BY group_id
                        ,hos_id
                        ,copy_code
                        ,acc_year
                        ,acc_month
                        ,dept_id
                        
                        ,dept_code
                        ,dept_name) hh
       ORDER BY hh.dept_code;
    --清除当月数据
    DELETE FROM cost_c0403
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
    --添加数据
    INSERT INTO cost_c0403
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,hos_code
      ,hos_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9
      ,t_10)
      SELECT t1.group_id
            ,t1.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,SUM(t_1)
            ,SUM(t_2)
            ,SUM(t_3)
            ,SUM(t_4)
            ,SUM(t_5)
            ,SUM(t_6)
            ,SUM(t_7)
            ,SUM(t_8)
            ,SUM(t_9)
            ,SUM(t_10)
        FROM cost_c0401 t1
        LEFT JOIN hos_info t2
          ON t1.group_id = t2.group_id
         AND t1.hos_id = t2.hos_id
       WHERE t1.group_id = p_group_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY t1.group_id
               ,t1.hos_id
               ,acc_year
               ,acc_month
               ,hos_code
               ,hos_name;
  
    /*
    ****************************************************************************
    *集团构成分析 医院全成本构成分析明细表            结束
    ****************************************************************************
    */
  END cost_analysis_c0401_proc;
  PROCEDURE cost_analysis_c0501_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
    v_acc_year  VARCHAR2(20); --上一年
    v_acc_month VARCHAR2(20); --上期
  BEGIN
    v_acc_year  := 0;
    v_acc_month := 0;
  
    BEGIN
      SELECT to_char(add_months(to_date(p_acc_year || p_acc_month || '01'
                                       ,'yyyy-mm-dd ')
                               ,-12)
                    ,'yyyy')
        INTO v_acc_year
        FROM dual;
      SELECT to_char(add_months(to_date(p_acc_year || p_acc_month || '01'
                                       ,'yyyy-mm-dd ')
                               ,-1)
                    ,'mm')
        INTO v_acc_month
        FROM dual;
      /*
                ****************************************************************************
                *医疗业务成本对比分析     开始
                ****************************************************************************
         Name      Type         Nullable Default Comments
      --------- ------------ -------- ------- --------
      GROUP_ID  NUMBER(18)                    集团ID
      HOS_ID    NUMBER(18)                    医院ID
      COPY_CODE VARCHAR2(20)                  账套编码
      ACC_YEAR  VARCHAR2(4)                   统计年份
      ACC_MONTH VARCHAR2(2)                   统计月份
      ITEM_CODE VARCHAR2(20)                  成本项目编码
      ITEM_NAME VARCHAR2(50) Y                成本项目名称
      T_1       NUMBER(30,6) Y                本期
      T_2       NUMBER(30,6) Y                上年同期
      T_3       NUMBER(30,6) Y                上年同期差异
      T_4       NUMBER(30,6) Y                上年同期差异率
      T_5       NUMBER(30,6) Y                上期
      T_6       NUMBER(30,6) Y                上期差异
      T_7       NUMBER(30,6) Y                上期差异率
      T_8       NUMBER(30,6) Y                预算
      T_9       NUMBER(30,6) Y                预算差异
      T_10      NUMBER(30,6) Y                预算差异率
      T_11      NUMBER(30,6) Y                平均
      T_12      NUMBER(30,6) Y                平均差异
      T_13      NUMBER(30,6) Y                平均差异率
           ****************************************************************************
                */
      DELETE FROM cost_c0501
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
    
      --预算和平均未加
    
      INSERT INTO cost_c0501
        (group_id
        ,hos_id
        ,copy_code
        ,acc_year
        ,acc_month
        ,item_code
        ,item_name
        ,t_1
        ,t_2
        ,t_3
        ,t_4
        ,t_5
        ,t_6
        ,t_7)
        SELECT t1.group_id
              ,t1.hos_id
              ,t1.copy_code
              ,p_acc_year
              ,p_acc_month
              ,t1.cost_item_code
              ,t1.cost_item_name
              ,nvl(t2.t_1, 0)
              ,nvl(t3.t_2, 0)
              ,nvl(t2.t_1, 0) - nvl(t3.t_2, 0)
              ,t2.t_1 * 100 / t3.t_2
              ,nvl(t4.t_5, 0)
              ,nvl(t2.t_1, 0) - nvl(t4.t_5, 0)
              ,t2.t_1 * 100 / t4.t_5
          FROM cost_item_dict_no t1
          LEFT JOIN (
                     --本期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t1) t_1
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t2
            ON t1.group_id = t2.group_id
           AND t1.hos_id = t2.hos_id
           AND t1.copy_code = t2.copy_code
           AND t1.cost_item_id = t2.cost_item_id
           
          LEFT JOIN (
                     --上年同期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t1) t_2
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = v_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t3
            ON t1.group_id = t3.group_id
           AND t1.hos_id = t3.hos_id
           AND t1.copy_code = t3.copy_code
           AND t1.cost_item_id = t3.cost_item_id
           
           AND nvl(t3.t_2, 0) <> 0
          LEFT JOIN (
                     --上期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t1) t_5
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = v_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t4
            ON t1.group_id = t4.group_id
           AND t1.hos_id = t4.hos_id
           AND t1.copy_code = t4.copy_code
           AND t1.cost_item_id = t4.cost_item_id
           
           AND nvl(t4.t_5, 0) <> 0
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND t1.copy_code = p_copy_code
           AND t1.is_last = 1
           AND t1.is_stop = 0
        
        ;
    
      /*
      ****************************************************************************
      *医疗业务成本对比分析           结束
      ****************************************************************************
      */
    
      /*
                ****************************************************************************
                *医疗成本对比分析     开始
                ****************************************************************************
         Name      Type         Nullable Default Comments
      --------- ------------ -------- ------- --------
      GROUP_ID  NUMBER(18)                    集团ID
      HOS_ID    NUMBER(18)                    医院ID
      COPY_CODE VARCHAR2(20)                  账套编码
      ACC_YEAR  VARCHAR2(4)                   统计年份
      ACC_MONTH VARCHAR2(2)                   统计月份
      ITEM_CODE VARCHAR2(20)                  成本项目编码
      ITEM_NAME VARCHAR2(50) Y                成本项目名称
      T_1       NUMBER(30,6) Y                本期
      T_2       NUMBER(30,6) Y                上年同期
      T_3       NUMBER(30,6) Y                上年同期差异
      T_4       NUMBER(30,6) Y                上年同期差异率
      T_5       NUMBER(30,6) Y                上期
      T_6       NUMBER(30,6) Y                上期差异
      T_7       NUMBER(30,6) Y                上期差异率
      T_8       NUMBER(30,6) Y                预算
      T_9       NUMBER(30,6) Y                预算差异
      T_10      NUMBER(30,6) Y                预算差异率
      T_11      NUMBER(30,6) Y                平均
      T_12      NUMBER(30,6) Y                平均差异
      T_13      NUMBER(30,6) Y                平均差异率
           ****************************************************************************
                */
      DELETE FROM cost_c0502
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
    
      --预算和平均未加
    
      INSERT INTO cost_c0502
        (group_id
        ,hos_id
        ,copy_code
        ,acc_year
        ,acc_month
        ,item_code
        ,item_name
        ,t_1
        ,t_2
        ,t_3
        ,t_4
        ,t_5
        ,t_6
        ,t_7)
        SELECT t1.group_id
              ,t1.hos_id
              ,t1.copy_code
              ,p_acc_year
              ,p_acc_month
              ,t1.cost_item_code
              ,t1.cost_item_name
              ,nvl(t2.t_1, 0)
              ,nvl(t3.t_2, 0)
              ,nvl(t2.t_1, 0) - nvl(t3.t_2, 0)
              ,t2.t_1 * 100 / t3.t_2
              ,nvl(t4.t_5, 0)
              ,nvl(t2.t_1, 0) - nvl(t4.t_5, 0)
              ,t2.t_1 * 100 / t4.t_5
          FROM cost_item_dict_no t1
          LEFT JOIN (
                     --本期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t2) t_1
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t2
            ON t1.group_id = t2.group_id
           AND t1.hos_id = t2.hos_id
           AND t1.copy_code = t2.copy_code
           AND t1.cost_item_id = t2.cost_item_id
           
          LEFT JOIN (
                     --上年同期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t2) t_2
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = v_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t3
            ON t1.group_id = t3.group_id
           AND t1.hos_id = t3.hos_id
           AND t1.copy_code = t3.copy_code
           AND t1.cost_item_id = t3.cost_item_id
           
           AND nvl(t3.t_2, 0) <> 0
          LEFT JOIN (
                     --上期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t2) t_5
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = v_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t4
            ON t1.group_id = t4.group_id
           AND t1.hos_id = t4.hos_id
           AND t1.copy_code = t4.copy_code
           AND t1.cost_item_id = t4.cost_item_id
           
           AND nvl(t4.t_5, 0) <> 0
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND t1.copy_code = p_copy_code
           AND t1.is_last = 1
           AND t1.is_stop = 0
        
        ;
    
      /*
      ****************************************************************************
      *医疗成本对比分析           结束
      ****************************************************************************
      */
    
      /*
       ****************************************************************************
       *医疗全成本对比分析     开始
       ****************************************************************************
         Name      Type         Nullable Default Comments
      --------- ------------ -------- ------- --------
      GROUP_ID  NUMBER(18)                    集团ID
      HOS_ID    NUMBER(18)                    医院ID
      COPY_CODE VARCHAR2(20)                  账套编码
      ACC_YEAR  VARCHAR2(4)                   统计年份
      ACC_MONTH VARCHAR2(2)                   统计月份
      ITEM_CODE VARCHAR2(20)                  成本项目编码
      ITEM_NAME VARCHAR2(50) Y                成本项目名称
      T_1       NUMBER(30,6) Y                本期
      T_2       NUMBER(30,6) Y                上年同期
      T_3       NUMBER(30,6) Y                上年同期差异
      T_4       NUMBER(30,6) Y                上年同期差异率
      T_5       NUMBER(30,6) Y                上期
      T_6       NUMBER(30,6) Y                上期差异
      T_7       NUMBER(30,6) Y                上期差异率
      T_8       NUMBER(30,6) Y                预算
      T_9       NUMBER(30,6) Y                预算差异
      T_10      NUMBER(30,6) Y                预算差异率
      T_11      NUMBER(30,6) Y                平均
      T_12      NUMBER(30,6) Y                平均差异
      T_13      NUMBER(30,6) Y                平均差异率
           ****************************************************************************
                */
      DELETE FROM cost_c0503
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
    
      --预算和平均未加
    
      INSERT INTO cost_c0503
        (group_id
        ,hos_id
        ,copy_code
        ,acc_year
        ,acc_month
        ,item_code
        ,item_name
        ,t_1
        ,t_2
        ,t_3
        ,t_4
        ,t_5
        ,t_6
        ,t_7)
        SELECT t1.group_id
              ,t1.hos_id
              ,t1.copy_code
              ,p_acc_year
              ,p_acc_month
              ,t1.cost_item_code
              ,t1.cost_item_name
              ,nvl(t2.t_1, 0)
              ,nvl(t3.t_2, 0)
              ,nvl(t2.t_1, 0) - nvl(t3.t_2, 0)
              ,t2.t_1 * 100 / t3.t_2
              ,nvl(t4.t_5, 0)
              ,nvl(t2.t_1, 0) - nvl(t4.t_5, 0)
              ,t2.t_1 * 100 / t4.t_5
          FROM cost_item_dict_no t1
          LEFT JOIN (
                     --本期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t3) t_1
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t2
            ON t1.group_id = t2.group_id
           AND t1.hos_id = t2.hos_id
           AND t1.copy_code = t2.copy_code
           AND t1.cost_item_id = t2.cost_item_id
           
          LEFT JOIN (
                     --上年同期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t3) t_2
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = v_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t3
            ON t1.group_id = t3.group_id
           AND t1.hos_id = t3.hos_id
           AND t1.copy_code = t3.copy_code
           AND t1.cost_item_id = t3.cost_item_id
           
           AND nvl(t3.t_2, 0) <> 0
          LEFT JOIN (
                     --上期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t3) t_5
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = v_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t4
            ON t1.group_id = t4.group_id
           AND t1.hos_id = t4.hos_id
           AND t1.copy_code = t4.copy_code
           AND t1.cost_item_id = t4.cost_item_id
           
           AND nvl(t4.t_5, 0) <> 0
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND t1.copy_code = p_copy_code
           AND t1.is_last = 1
           AND t1.is_stop = 0
        
        ;
    
      /*
      ****************************************************************************
      *医疗全成本对比分析           结束
      ****************************************************************************
      */
    
      /*
       ****************************************************************************
       *医院成本对比分析     开始
      ****************************************************************************
           Name      Type         Nullable Default Comments
        --------- ------------ -------- ------- --------
        GROUP_ID  NUMBER(18)                    集团ID
        HOS_ID    NUMBER(18)                    医院ID
        COPY_CODE VARCHAR2(20)                  账套编码
        ACC_YEAR  VARCHAR2(4)                   统计年份
        ACC_MONTH VARCHAR2(2)                   统计月份
        ITEM_CODE VARCHAR2(20)                  成本项目编码
        ITEM_NAME VARCHAR2(50) Y                成本项目名称
        T_1       NUMBER(30,6) Y                本期
        T_2       NUMBER(30,6) Y                上年同期
        T_3       NUMBER(30,6) Y                上年同期差异
        T_4       NUMBER(30,6) Y                上年同期差异率
        T_5       NUMBER(30,6) Y                上期
        T_6       NUMBER(30,6) Y                上期差异
        T_7       NUMBER(30,6) Y                上期差异率
        T_8       NUMBER(30,6) Y                预算
        T_9       NUMBER(30,6) Y                预算差异
        T_10      NUMBER(30,6) Y                预算差异率
        T_11      NUMBER(30,6) Y                平均
        T_12      NUMBER(30,6) Y                平均差异
        T_13      NUMBER(30,6) Y                平均差异率
             ****************************************************************************
                  */
      DELETE FROM cost_c0504
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
    
      --预算和平均未加
    
      INSERT INTO cost_c0504
        (group_id
        ,hos_id
        ,copy_code
        ,acc_year
        ,acc_month
        ,item_code
        ,item_name
        ,t_1
        ,t_2
        ,t_3
        ,t_4
        ,t_5
        ,t_6
        ,t_7)
        SELECT t1.group_id
              ,t1.hos_id
              ,t1.copy_code
              ,p_acc_year
              ,p_acc_month
              ,t1.cost_item_code
              ,t1.cost_item_name
              ,nvl(t2.t_1, 0)
              ,nvl(t3.t_2, 0)
              ,nvl(t2.t_1, 0) - nvl(t3.t_2, 0)
              ,t2.t_1 * 100 / t3.t_2
              ,nvl(t4.t_5, 0)
              ,nvl(t2.t_1, 0) - nvl(t4.t_5, 0)
              ,t2.t_1 * 100 / t4.t_5
          FROM cost_item_dict_no t1
          LEFT JOIN (
                     --本期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t4) t_1
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t2
            ON t1.group_id = t2.group_id
           AND t1.hos_id = t2.hos_id
           AND t1.copy_code = t2.copy_code
           AND t1.cost_item_id = t2.cost_item_id
           
          LEFT JOIN (
                     --上年同期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t4) t_2
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = v_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t3
            ON t1.group_id = t3.group_id
           AND t1.hos_id = t3.hos_id
           AND t1.copy_code = t3.copy_code
           AND t1.cost_item_id = t3.cost_item_id
           
           AND nvl(t3.t_2, 0) <> 0
          LEFT JOIN (
                     --上期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,cost_item_id
                            
                            ,SUM(t4) t_5
                       FROM v_cost_dept_cost_detail
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = v_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,cost_item_id
                               ) t4
            ON t1.group_id = t4.group_id
           AND t1.hos_id = t4.hos_id
           AND t1.copy_code = t4.copy_code
           AND t1.cost_item_id = t4.cost_item_id
           
           AND nvl(t4.t_5, 0) <> 0
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND t1.copy_code = p_copy_code
           AND t1.is_last = 1
           AND t1.is_stop = 0
        
        ;
    END;
  
    /*
    ****************************************************************************
    *医院成本对比分析           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0501_proc;
  PROCEDURE cost_analysis_c0502_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
    v_acc_year  VARCHAR2(20); --上一年
    v_acc_month VARCHAR2(20); --上期
  BEGIN
    v_acc_year  := 0;
    v_acc_month := 0;
  
    BEGIN
      SELECT to_char(add_months(to_date(p_acc_year || p_acc_month || '01'
                                       ,'yyyy-mm-dd ')
                               ,-12)
                    ,'yyyy')
        INTO v_acc_year
        FROM dual;
      SELECT to_char(add_months(to_date(p_acc_year || p_acc_month || '01'
                                       ,'yyyy-mm-dd ')
                               ,-1)
                    ,'mm')
        INTO v_acc_month
        FROM dual;
    
      /*
                ****************************************************************************
                *科室医疗业务成本对比分析     开始
                ****************************************************************************
         Name      Type         Nullable Default Comments
      --------- ------------ -------- ------- --------
      GROUP_ID  NUMBER(18)                    集团ID
      HOS_ID    NUMBER(18)                    医院ID
      COPY_CODE VARCHAR2(20)                  账套编码
      ACC_YEAR  VARCHAR2(4)                   统计年份
      ACC_MONTH VARCHAR2(2)                   统计月份
      ITEM_CODE VARCHAR2(20)                  成本项目编码
      ITEM_NAME VARCHAR2(50) Y                成本项目名称
      T_1       NUMBER(30,6) Y                本期
      T_2       NUMBER(30,6) Y                上年同期
      T_3       NUMBER(30,6) Y                上年同期差异
      T_4       NUMBER(30,6) Y                上年同期差异率
      T_5       NUMBER(30,6) Y                上期
      T_6       NUMBER(30,6) Y                上期差异
      T_7       NUMBER(30,6) Y                上期差异率
      T_8       NUMBER(30,6) Y                预算
      T_9       NUMBER(30,6) Y                预算差异
      T_10      NUMBER(30,6) Y                预算差异率
      T_11      NUMBER(30,6) Y                平均
      T_12      NUMBER(30,6) Y                平均差异
      T_13      NUMBER(30,6) Y                平均差异率
           ****************************************************************************
                */
      DELETE FROM cost_c0505
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
    
      --预算和平均未加
    
      INSERT INTO cost_c0505
        (group_id
        ,hos_id
        ,copy_code
        ,acc_year
        ,acc_month
        ,dept_code
        ,dept_name
        ,t_1
        ,t_2
        ,t_3
        ,t_4
        ,t_5
        ,t_6
        ,t_7)
        SELECT t1.group_id
              ,t1.hos_id
              ,p_copy_code
              ,p_acc_year
              ,p_acc_month
              ,t1.dept_code
              ,t1.dept_name
              ,nvl(t2.t_1, 0)
              ,nvl(t3.t_2, 0)
              ,nvl(t2.t_1, 0) - nvl(t3.t_2, 0)
              ,t2.t_1 * 100 / t3.t_2
              ,nvl(t4.t_5, 0)
              ,nvl(t2.t_1, 0) - nvl(t4.t_5, 0)
              ,t2.t_1 * 100 / t4.t_5
          FROM hos_dept_dict t1
          LEFT JOIN acc_dept_attr t6
            ON t1.group_id = t6.group_id
           AND t1.hos_id = t6.hos_id
           AND t1.dept_id = t6.dept_id
          LEFT JOIN (
                     --本期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t1) t_1
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = p_acc_month
                        AND type_code != '04'
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t2
            ON t1.group_id = t2.group_id
           AND t1.hos_id = t2.hos_id
           AND t1.dept_id = t2.dept_id
           
          LEFT JOIN (
                     --上年同期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t1) t_2
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = v_acc_year
                        AND acc_month = p_acc_month
                        AND type_code != '04'
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t3
            ON t1.group_id = t3.group_id
           AND t1.hos_id = t3.hos_id
           AND t1.dept_id = t3.dept_id
           
           AND nvl(t3.t_2, 0) <> 0
          LEFT JOIN (
                     --上期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t1) t_5
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = v_acc_month
                        AND type_code != '04'
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t4
            ON t1.group_id = t4.group_id
           AND t1.hos_id = t4.hos_id
           AND t1.dept_id = t4.dept_id
           
           AND nvl(t4.t_5, 0) <> 0
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND t1.is_last = 1
           AND t1.is_stop = 0
           AND t6.type_code = '01';
    
      /*
      ****************************************************************************
      *科室医疗业务成本对比分析           结束
      ****************************************************************************
      */
    
      /*
       ****************************************************************************
      *科室医疗成本对比分析     开始
      ****************************************************************************
           Name      Type         Nullable Default Comments
        --------- ------------ -------- ------- --------
        GROUP_ID  NUMBER(18)                    集团ID
        HOS_ID    NUMBER(18)                    医院ID
        COPY_CODE VARCHAR2(20)                  账套编码
        ACC_YEAR  VARCHAR2(4)                   统计年份
        ACC_MONTH VARCHAR2(2)                   统计月份
        ITEM_CODE VARCHAR2(20)                  成本项目编码
        ITEM_NAME VARCHAR2(50) Y                成本项目名称
        T_1       NUMBER(30,6) Y                本期
        T_2       NUMBER(30,6) Y                上年同期
        T_3       NUMBER(30,6) Y                上年同期差异
        T_4       NUMBER(30,6) Y                上年同期差异率
        T_5       NUMBER(30,6) Y                上期
        T_6       NUMBER(30,6) Y                上期差异
        T_7       NUMBER(30,6) Y                上期差异率
        T_8       NUMBER(30,6) Y                预算
        T_9       NUMBER(30,6) Y                预算差异
        T_10      NUMBER(30,6) Y                预算差异率
        T_11      NUMBER(30,6) Y                平均
        T_12      NUMBER(30,6) Y                平均差异
        T_13      NUMBER(30,6) Y                平均差异率
             ****************************************************************************
                  */
      DELETE FROM cost_c0506
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
    
      --预算和平均未加
    
      INSERT INTO cost_c0506
        (group_id
        ,hos_id
        ,copy_code
        ,acc_year
        ,acc_month
        ,dept_code
        ,dept_name
        ,t_1
        ,t_2
        ,t_3
        ,t_4
        ,t_5
        ,t_6
        ,t_7)
        SELECT t1.group_id
              ,t1.hos_id
              ,p_copy_code
              ,p_acc_year
              ,p_acc_month
              ,t1.dept_code
              ,t1.dept_name
              ,nvl(t2.t_1, 0)
              ,nvl(t3.t_2, 0)
              ,nvl(t2.t_1, 0) - nvl(t3.t_2, 0)
              ,t2.t_1 * 100 / t3.t_2
              ,nvl(t4.t_5, 0)
              ,nvl(t2.t_1, 0) - nvl(t4.t_5, 0)
              ,t2.t_1 * 100 / t4.t_5
          FROM hos_dept_dict t1
          LEFT JOIN acc_dept_attr t6
            ON t1.group_id = t6.group_id
           AND t1.hos_id = t6.hos_id
           AND t1.dept_id = t6.dept_id
          LEFT JOIN (
                     --本期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t2) t_1
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t2
            ON t1.group_id = t2.group_id
           AND t1.hos_id = t2.hos_id
           AND t1.dept_id = t2.dept_id
           
          LEFT JOIN (
                     --上年同期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t2) t_2
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = v_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t3
            ON t1.group_id = t3.group_id
           AND t1.hos_id = t3.hos_id
           AND t1.dept_id = t3.dept_id
           
           AND nvl(t3.t_2, 0) <> 0
          LEFT JOIN (
                     --上期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t2) t_5
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = v_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t4
            ON t1.group_id = t4.group_id
           AND t1.hos_id = t4.hos_id
           AND t1.dept_id = t4.dept_id
           
           AND nvl(t4.t_5, 0) <> 0
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND t1.is_last = 1
           AND t1.is_stop = 0
           AND t6.type_code = '01';
    
      /*
      ****************************************************************************
      *科室医疗成本对比分析           结束
      ****************************************************************************
      */
    
      /*
       ****************************************************************************
       *科室医疗全成本对比分析     开始
       ****************************************************************************
         Name      Type         Nullable Default Comments
      --------- ------------ -------- ------- --------
      GROUP_ID  NUMBER(18)                    集团ID
      HOS_ID    NUMBER(18)                    医院ID
      COPY_CODE VARCHAR2(20)                  账套编码
      ACC_YEAR  VARCHAR2(4)                   统计年份
      ACC_MONTH VARCHAR2(2)                   统计月份
      ITEM_CODE VARCHAR2(20)                  成本项目编码
      ITEM_NAME VARCHAR2(50) Y                成本项目名称
      T_1       NUMBER(30,6) Y                本期
      T_2       NUMBER(30,6) Y                上年同期
      T_3       NUMBER(30,6) Y                上年同期差异
      T_4       NUMBER(30,6) Y                上年同期差异率
      T_5       NUMBER(30,6) Y                上期
      T_6       NUMBER(30,6) Y                上期差异
      T_7       NUMBER(30,6) Y                上期差异率
      T_8       NUMBER(30,6) Y                预算
      T_9       NUMBER(30,6) Y                预算差异
      T_10      NUMBER(30,6) Y                预算差异率
      T_11      NUMBER(30,6) Y                平均
      T_12      NUMBER(30,6) Y                平均差异
      T_13      NUMBER(30,6) Y                平均差异率
           ****************************************************************************
                */
      DELETE FROM cost_c0507
       WHERE group_id = p_group_id
         AND hos_id = p_hos_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
    
      --预算和平均未加
    
      INSERT INTO cost_c0507
        (group_id
        ,hos_id
        ,copy_code
        ,acc_year
        ,acc_month
        ,dept_code
        ,dept_name
        ,t_1
        ,t_2
        ,t_3
        ,t_4
        ,t_5
        ,t_6
        ,t_7)
        SELECT t1.group_id
              ,t1.hos_id
              ,p_copy_code
              ,p_acc_year
              ,p_acc_month
              ,t1.dept_code
              ,t1.dept_name
              ,nvl(t2.t_1, 0)
              ,nvl(t3.t_2, 0)
              ,nvl(t2.t_1, 0) - nvl(t3.t_2, 0)
              ,t2.t_1 * 100 / t3.t_2
              ,nvl(t4.t_5, 0)
              ,nvl(t2.t_1, 0) - nvl(t4.t_5, 0)
              ,t2.t_1 * 100 / t4.t_5
          FROM hos_dept_dict t1
          LEFT JOIN acc_dept_attr t6
            ON t1.group_id = t6.group_id
           AND t1.hos_id = t6.hos_id
           AND t1.dept_id = t6.dept_id
        
          LEFT JOIN (
                     --本期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t3) t_1
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t2
            ON t1.group_id = t2.group_id
           AND t1.hos_id = t2.hos_id
           AND t1.dept_id = t2.dept_id
           
          LEFT JOIN (
                     --上年同期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t3) t_2
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = v_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t3
            ON t1.group_id = t3.group_id
           AND t1.hos_id = t3.hos_id
           AND t1.dept_id = t3.dept_id
           
           AND nvl(t3.t_2, 0) <> 0
          LEFT JOIN (
                     --上期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t3) t_5
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = v_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t4
            ON t1.group_id = t4.group_id
           AND t1.hos_id = t4.hos_id
           AND t1.dept_id = t4.dept_id
           
           AND nvl(t4.t_5, 0) <> 0
         WHERE t1.group_id = p_group_id
           AND t1.hos_id = p_hos_id
           AND t1.is_last = 1
           AND t1.is_stop = 0
           AND t6.type_code = '01'
        
        ;
    
      /*
      ****************************************************************************
      *科室医疗全成本对比分析           结束
      ****************************************************************************
      */
    
      /*
       ****************************************************************************
       *科室医院成本对比分析     开始
      ****************************************************************************
           Name      Type         Nullable Default Comments
        --------- ------------ -------- ------- --------
        GROUP_ID  NUMBER(18)                    集团ID
        HOS_ID    NUMBER(18)                    医院ID
        COPY_CODE VARCHAR2(20)                  账套编码
        ACC_YEAR  VARCHAR2(4)                   统计年份
        ACC_MONTH VARCHAR2(2)                   统计月份
        ITEM_CODE VARCHAR2(20)                  成本项目编码
        ITEM_NAME VARCHAR2(50) Y                成本项目名称
        T_1       NUMBER(30,6) Y                本期
        T_2       NUMBER(30,6) Y                上年同期
        T_3       NUMBER(30,6) Y                上年同期差异
        T_4       NUMBER(30,6) Y                上年同期差异率
        T_5       NUMBER(30,6) Y                上期
        T_6       NUMBER(30,6) Y                上期差异
        T_7       NUMBER(30,6) Y                上期差异率
        T_8       NUMBER(30,6) Y                预算
        T_9       NUMBER(30,6) Y                预算差异
        T_10      NUMBER(30,6) Y                预算差异率
        T_11      NUMBER(30,6) Y                平均
        T_12      NUMBER(30,6) Y                平均差异
        T_13      NUMBER(30,6) Y                平均差异率
             ****************************************************************************
                  */
      DELETE FROM cost_c0508
       WHERE group_id = p_group_id
         AND copy_code = p_copy_code
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month;
    
      --预算和平均未加
    
      INSERT INTO cost_c0508
        (group_id
        ,hos_id
        ,copy_code
        ,acc_year
        ,acc_month
        ,dept_code
        ,dept_name
        ,t_1
        ,t_2
        ,t_3
        ,t_4
        ,t_5
        ,t_6
        ,t_7)
        SELECT t1.group_id
              ,t1.hos_id
              ,p_copy_code
              ,p_acc_year
              ,p_acc_month
              ,t1.dept_code
              ,t1.dept_name
              ,nvl(t2.t_1, 0)
              ,nvl(t3.t_2, 0)
              ,nvl(t2.t_1, 0) - nvl(t3.t_2, 0)
              ,t2.t_1 * 100 / t3.t_2
              ,nvl(t4.t_5, 0)
              ,nvl(t2.t_1, 0) - nvl(t4.t_5, 0)
              ,t2.t_1 * 100 / t4.t_5
          FROM hos_dept_dict t1
          LEFT JOIN acc_dept_attr t6
            ON t1.group_id = t6.group_id
           AND t1.hos_id = t6.hos_id
           AND t1.dept_id = t6.dept_id
          LEFT JOIN (
                     --本期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t4) t_1
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t2
            ON t1.group_id = t2.group_id
           AND t1.hos_id = t2.hos_id
           AND t1.dept_id = t2.dept_id
           
          LEFT JOIN (
                     --上年同期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t4) t_2
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = v_acc_year
                        AND acc_month = p_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t3
            ON t1.group_id = t3.group_id
           AND t1.hos_id = t3.hos_id
           AND t1.dept_id = t3.dept_id
           
           AND nvl(t3.t_2, 0) <> 0
          LEFT JOIN (
                     --上期
                     SELECT group_id
                            ,hos_id
                            ,copy_code
                            ,acc_year
                            ,acc_month
                            ,dept_id
                            
                            ,SUM(t4) t_5
                       FROM v_cost_dept_cost_sum
                      WHERE group_id = p_group_id
                        AND hos_id = p_hos_id
                        AND copy_code = p_copy_code
                        AND acc_year = p_acc_year
                        AND acc_month = v_acc_month
                      GROUP BY group_id
                               ,hos_id
                               ,copy_code
                               ,acc_year
                               ,acc_month
                               ,dept_id
                               ) t4
            ON t1.group_id = t4.group_id
           AND t1.hos_id = t4.hos_id
           AND t1.dept_id = t4.dept_id
           
           AND nvl(t4.t_5, 0) <> 0
         WHERE t1.group_id = p_group_id
           AND t1.is_last = 1
           AND t1.is_stop = 0
           AND t6.type_code = '01';
    END;
    /*
    ****************************************************************************
    *科室医院成本对比分析           结束
    ****************************************************************************
    */
  
  END cost_analysis_c0502_proc;
  PROCEDURE cost_analysis_c0601_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
       ****************************************************************************
    *门诊住院收入排序    开始
    ****************************************************************************
         Name       Type         Nullable Default Comments
      ---------- ------------ -------- ------- --------
      GROUP_ID   NUMBER(18)                    集团ID
      HOS_ID     NUMBER(18)                    医院ID
      COPY_CODE  VARCHAR2(20)                  账套编码
      ACC_YEAR   VARCHAR2(4)                   统计年份
      ACC_MONTH  VARCHAR2(2)                   统计月份
      SORT_CODE  VARCHAR2(20)                  排序类型
      DEPT_CODE  VARCHAR2(20)                  科室编码
      DEPT_NAME  VARCHAR2(50) Y                科室名称
      TYPE_CODE  VARCHAR2(20)                  科室类型
      NATUR_CODE VARCHAR2(20)                  科室性质
      T_1        NUMBER(30,6) Y                本期
      T_2        NUMBER(30,6) Y                上年同期/上期
      T_3        NUMBER(30,6) Y                增长率
             ****************************************************************************
                  */
    DELETE FROM cost_c0601
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0601
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,sort_code
      ,dept_code
      ,dept_name
      ,type_code
      ,natur_code
      ,t_1
      ,t_2
      ,t_3)
    
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'1' AS sort_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.income_money, 0) AS t_1
            ,nvl(c.income_money, 0) AS t_2
            , CASE
                WHEN nvl(c.income_money, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.income_money, 0) - nvl(c.income_money, 0)) /
                 nvl(c.income_money, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,type_code
                    ,natur_code
                    ,SUM(income_money) AS income_money
                FROM v_cost_appl_dept_income
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
               GROUP BY dept_id, type_code, natur_code) b
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
         AND a.is_stop = 0
        LEFT JOIN (SELECT dept_id
                         
                         ,type_code
                         ,natur_code
                         ,SUM(income_money) AS income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year - 1
                      AND acc_month = p_acc_month
                    GROUP BY dept_id, type_code, natur_code) c
          ON a.dept_id = c.dept_id
         
         AND a.is_stop = 0
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND t3.type_code = '01'
         AND a.is_stop = 0
      UNION ALL
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'2' AS type_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.income_money, 0) AS t_1
            ,nvl(c.income_money, 0) AS t_2
            , CASE
                WHEN nvl(c.income_money, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.income_money, 0) - nvl(c.income_money, 0)) /
                 nvl(c.income_money, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,type_code
                    ,natur_code
                    ,SUM(income_money) AS income_money
                FROM v_cost_appl_dept_income
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
               GROUP BY dept_id, type_code, natur_code) b
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
         AND a.is_stop = 0
        LEFT JOIN (SELECT dept_id
                         
                         ,type_code
                         ,natur_code
                         ,SUM(income_money) AS income_money
                     FROM v_cost_appl_dept_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month - 1
                    GROUP BY dept_id, type_code, natur_code) c
          ON a.dept_id = c.dept_id
         
         AND a.is_stop = 0
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND t3.type_code = '01';
  
    /*
    ****************************************************************************
    *门诊住院收入排序            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0601_proc;
  PROCEDURE cost_analysis_c0602_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
       ****************************************************************************
    *门诊住院收入排序    开始
    ****************************************************************************
         Name       Type         Nullable Default Comments
      ---------- ------------ -------- ------- --------
      GROUP_ID   NUMBER(18)                    集团ID
      HOS_ID     NUMBER(18)                    医院ID
      COPY_CODE  VARCHAR2(20)                  账套编码
      ACC_YEAR   VARCHAR2(4)                   统计年份
      ACC_MONTH  VARCHAR2(2)                   统计月份
      SORT_CODE  VARCHAR2(20)                  排序类型
      DEPT_CODE  VARCHAR2(20)                  科室编码
      DEPT_NAME  VARCHAR2(50) Y                科室名称
      TYPE_CODE  VARCHAR2(20)                  科室类型
      NATUR_CODE VARCHAR2(20)                  科室性质
      T_1        NUMBER(30,6) Y                本期
      T_2        NUMBER(30,6) Y                上年同期/上期
      T_3        NUMBER(30,6) Y                增长率
             ****************************************************************************
                  */
    DELETE FROM cost_c0602
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0602
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,sort_code
      ,dept_code
      ,dept_name
      ,type_code
      ,natur_code
      ,t_1
      ,t_2
      ,t_3)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'1' AS sort_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id, SUM(dir_amount) AS amount
                FROM cost_dept_cost
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
               GROUP BY dept_id) b
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                     FROM cost_dept_cost
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year - 1
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
      UNION ALL
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'2' AS type_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id, SUM(dir_amount) AS amount
                FROM cost_dept_cost
               WHERE group_id = p_group_id
                 AND hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
               GROUP BY dept_id) b
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id, SUM(dir_amount) AS amount
                     FROM cost_dept_cost
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month - 1
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id;
  
    /*
    ****************************************************************************
    *门诊住院收入排序            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0602_proc;
  PROCEDURE cost_analysis_c0603_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
       ****************************************************************************
    *门诊住院收入排序    开始
    ****************************************************************************
         Name       Type         Nullable Default Comments
      ---------- ------------ -------- ------- --------
      GROUP_ID   NUMBER(18)                    集团ID
      HOS_ID     NUMBER(18)                    医院ID
      COPY_CODE  VARCHAR2(20)                  账套编码
      ACC_YEAR   VARCHAR2(4)                   统计年份
      ACC_MONTH  VARCHAR2(2)                   统计月份
      SORT_CODE  VARCHAR2(20)                  排序类型
      DEPT_CODE  VARCHAR2(20)                  科室编码
      DEPT_NAME  VARCHAR2(50) Y                科室名称
      TYPE_CODE  VARCHAR2(20)                  科室类型
      NATUR_CODE VARCHAR2(20)                  科室性质
      T_1        NUMBER(30,6) Y                本期
      T_2        NUMBER(30,6) Y                上年同期/上期
      T_3        NUMBER(30,6) Y                增长率
             ****************************************************************************
                  */
    DELETE FROM cost_c0603
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0603
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,sort_code
      ,dept_code
      ,dept_name
      ,type_code
      ,natur_code
      ,t_1
      ,t_2
      ,t_3)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'1' AS sort_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                         INDIR_MED_ASS_AMOUNT) AS amount
                FROM cost_dept_cost t1
               INNER JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND t2.source_attr = 1
               GROUP BY dept_id) b
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.source_id = t2.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year - 1
                      AND acc_month = p_acc_month
                      AND t2.source_attr = 1
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
      UNION ALL
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'2' AS type_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                         INDIR_MED_ASS_AMOUNT) AS amount
                FROM cost_dept_cost t1
               INNER JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND t2.source_attr = 1
               GROUP BY dept_id) b
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.source_id = t2.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month - 1
                      AND t2.source_attr = 1
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id;
  
    /*
    ****************************************************************************
    *门诊住院收入排序            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0603_proc;
  PROCEDURE cost_analysis_c0604_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
       ****************************************************************************
    *门诊住院收入排序    开始
    ****************************************************************************
         Name       Type         Nullable Default Comments
      ---------- ------------ -------- ------- --------
      GROUP_ID   NUMBER(18)                    集团ID
      HOS_ID     NUMBER(18)                    医院ID
      COPY_CODE  VARCHAR2(20)                  账套编码
      ACC_YEAR   VARCHAR2(4)                   统计年份
      ACC_MONTH  VARCHAR2(2)                   统计月份
      SORT_CODE  VARCHAR2(20)                  排序类型
      DEPT_CODE  VARCHAR2(20)                  科室编码
      DEPT_NAME  VARCHAR2(50) Y                科室名称
      TYPE_CODE  VARCHAR2(20)                  科室类型
      NATUR_CODE VARCHAR2(20)                  科室性质
      T_1        NUMBER(30,6) Y                本期
      T_2        NUMBER(30,6) Y                上年同期/上期
      T_3        NUMBER(30,6) Y                增长率
             ****************************************************************************
                  */
    DELETE FROM cost_c0604
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0604
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,sort_code
      ,dept_code
      ,dept_name
      ,type_code
      ,natur_code
      ,t_1
      ,t_2
      ,t_3)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'1' AS sort_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                         INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                         INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                         INDIR_ASS_MED_MAN_AMOUNT) AS amount
                FROM cost_dept_cost t1
               INNER JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND t2.source_attr = 1
               GROUP BY dept_id) b
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.source_id = t2.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year - 1
                      AND acc_month = p_acc_month
                      AND t2.source_attr = 1
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
      UNION ALL
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'2' AS type_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                         INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                         INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                         INDIR_ASS_MED_MAN_AMOUNT) AS amount
                FROM cost_dept_cost t1
               INNER JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND t2.source_attr = 1
               GROUP BY dept_id) b
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.source_id = t2.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month - 1
                      AND t2.source_attr = 1
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id;
  
    /*
    ****************************************************************************
    *门诊住院收入排序            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0604_proc;
  PROCEDURE cost_analysis_c0605_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
       ****************************************************************************
    *门诊住院收入排序    开始
    ****************************************************************************
         Name       Type         Nullable Default Comments
      ---------- ------------ -------- ------- --------
      GROUP_ID   NUMBER(18)                    集团ID
      HOS_ID     NUMBER(18)                    医院ID
      COPY_CODE  VARCHAR2(20)                  账套编码
      ACC_YEAR   VARCHAR2(4)                   统计年份
      ACC_MONTH  VARCHAR2(2)                   统计月份
      SORT_CODE  VARCHAR2(20)                  排序类型
      DEPT_CODE  VARCHAR2(20)                  科室编码
      DEPT_NAME  VARCHAR2(50) Y                科室名称
      TYPE_CODE  VARCHAR2(20)                  科室类型
      NATUR_CODE VARCHAR2(20)                  科室性质
      T_1        NUMBER(30,6) Y                本期
      T_2        NUMBER(30,6) Y                上年同期/上期
      T_3        NUMBER(30,6) Y                增长率
             ****************************************************************************
                  */
    DELETE FROM cost_c0605
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0605
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,sort_code
      ,dept_code
      ,dept_name
      ,type_code
      ,natur_code
      ,t_1
      ,t_2
      ,t_3)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'1' AS sort_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                         INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                         INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                         INDIR_ASS_MED_MAN_AMOUNT) AS amount
                FROM cost_dept_cost t1
               INNER JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND t2.source_attr IN (1, 2)
               GROUP BY dept_id) b
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.source_id = t2.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year - 1
                      AND acc_month = p_acc_month
                      AND t2.source_attr IN (1, 2)
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
      UNION ALL
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'2' AS type_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                         INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                         INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                         INDIR_ASS_MED_MAN_AMOUNT) AS amount
                FROM cost_dept_cost t1
               INNER JOIN hos_source t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.source_id = t2.source_id
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND t2.source_attr IN (1, 2)
               GROUP BY dept_id) b
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    INNER JOIN hos_source t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.source_id = t2.source_id
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month - 1
                      AND t2.source_attr IN (1, 2)
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id;
  
    /*
    ****************************************************************************
    *门诊住院收入排序            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0605_proc;
  PROCEDURE cost_analysis_c0606_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
       ****************************************************************************
    *门诊住院收入排序    开始
    ****************************************************************************
         Name       Type         Nullable Default Comments
      ---------- ------------ -------- ------- --------
      GROUP_ID   NUMBER(18)                    集团ID
      HOS_ID     NUMBER(18)                    医院ID
      COPY_CODE  VARCHAR2(20)                  账套编码
      ACC_YEAR   VARCHAR2(4)                   统计年份
      ACC_MONTH  VARCHAR2(2)                   统计月份
      SORT_CODE  VARCHAR2(20)                  排序类型
      DEPT_CODE  VARCHAR2(20)                  科室编码
      DEPT_NAME  VARCHAR2(50) Y                科室名称
      TYPE_CODE  VARCHAR2(20)                  科室类型
      NATUR_CODE VARCHAR2(20)                  科室性质
      T_1        NUMBER(30,6) Y                本期
      T_2        NUMBER(30,6) Y                上年同期/上期
      T_3        NUMBER(30,6) Y                增长率
             ****************************************************************************
                  */
    DELETE FROM cost_c0606
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0606
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,sort_code
      ,dept_code
      ,dept_name
      ,type_code
      ,natur_code
      ,t_1
      ,t_2
      ,t_3)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'1' AS sort_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                         INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                         INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                         INDIR_ASS_MED_MAN_AMOUNT) AS amount
                FROM cost_dept_cost t1
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
               GROUP BY dept_id) b
      
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year - 1
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
      UNION ALL
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'2' AS type_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0)) / nvl(c.amount, 0) * 100
              END AS t_3
        FROM (SELECT dept_id
                    
                    ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                         INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                         INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                         INDIR_ASS_MED_MAN_AMOUNT) AS amount
                FROM cost_dept_cost t1
               WHERE t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND acc_year = p_acc_year
                 AND acc_month = p_acc_month
               GROUP BY dept_id) b
        LEFT JOIN hos_dept_dict a
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month - 1
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id;
  
    /*
    ****************************************************************************
    *门诊住院收入排序            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0606_proc;
  PROCEDURE cost_analysis_c0607_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
       ****************************************************************************
    *医院收临床益排序表C0607    开始
    ****************************************************************************
         Name       Type         Nullable Default Comments 
      ---------- ------------ -------- ------- -------- 
      GROUP_ID   NUMBER(18)                    集团ID   
      HOS_ID     NUMBER(18)                    医院ID   
      COPY_CODE  VARCHAR2(20)                  账套编码 
      ACC_YEAR   VARCHAR2(4)                   统计年份 
      ACC_MONTH  VARCHAR2(2)                   统计月份 
      SORT_CODE  VARCHAR2(20)                  排序类型 
      DEPT_CODE  VARCHAR2(20)                  科室编码 
      DEPT_NAME  VARCHAR2(50) Y                科室名称 
      TYPE_CODE  VARCHAR2(20)                  科室类型 
      NATUR_CODE VARCHAR2(20)                  科室性质 
      T_1        NUMBER(30,6) Y                本期     
      T_2        NUMBER(30,6) Y                上年同期/上期 
      T_3        NUMBER(30,6) Y                增长率   
             ****************************************************************************
                  */
    DELETE FROM cost_c0607
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0607
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,sort_code
      ,dept_code
      ,dept_name
      ,type_code
      ,natur_code
      ,t_1
      ,t_2
      ,t_3)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'1' AS sort_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0))
              END AS t_3
        FROM hos_dept_dict a
        LEFT JOIN (SELECT dept_id, SUM(income_money) AS amount
                     FROM v_cost_appl_dept_income t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) b
          ON a.dept_id = b.dept_id
         
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND t3.type_code = '01'
         AND a.is_stop = 0
      UNION ALL
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'2' AS type_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0))
              END AS t_3
        FROM hos_dept_dict a
        LEFT JOIN (SELECT dept_id, SUM(income_money) AS amount
                     FROM v_cost_appl_dept_income t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) b
          ON a.dept_id = b.dept_id
         
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND a.is_stop = 0
         AND t3.type_code = '01';
  
    /*
    ****************************************************************************
    *医院收临床益排序表C0607            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0607_proc;
  PROCEDURE cost_analysis_c0608_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
       ****************************************************************************
    *医技收益排序    开始
    ****************************************************************************
         Name       Type         Nullable Default Comments
      ---------- ------------ -------- ------- --------
      GROUP_ID   NUMBER(18)                    集团ID
      HOS_ID     NUMBER(18)                    医院ID
      COPY_CODE  VARCHAR2(20)                  账套编码
      ACC_YEAR   VARCHAR2(4)                   统计年份
      ACC_MONTH  VARCHAR2(2)                   统计月份
      SORT_CODE  VARCHAR2(20)                  排序类型
      DEPT_CODE  VARCHAR2(20)                  科室编码
      DEPT_NAME  VARCHAR2(50) Y                科室名称
      TYPE_CODE  VARCHAR2(20)                  科室类型
      NATUR_CODE VARCHAR2(20)                  科室性质
      T_1        NUMBER(30,6) Y                本期
      T_2        NUMBER(30,6) Y                上年同期/上期
      T_3        NUMBER(30,6) Y                增长率
             ****************************************************************************
                  */
    DELETE FROM cost_c0608
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0608
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,sort_code
      ,dept_code
      ,dept_name
      ,type_code
      ,natur_code
      ,t_1
      ,t_2
      ,t_3)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'1' AS sort_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0))
              END AS t_3
        FROM hos_dept_dict a
        LEFT JOIN (SELECT dept_id, SUM(income_money) AS amount
                     FROM v_cost_exec_dept_income t1
                    GROUP BY dept_id) b
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND t3.type_code = '02'
         AND a.is_stop = 0
      UNION ALL
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,'2' AS type_code
            ,a.dept_code
            ,a.dept_name
            ,t3.type_code
            ,t3.natur_code
            ,nvl(b.amount, 0) AS t_1
            ,nvl(c.amount, 0) AS t_2
            , CASE
                WHEN nvl(c.amount, 0) = 0 THEN
                 0
                ELSE
                 (nvl(b.amount, 0) - nvl(c.amount, 0))
              END AS t_3
        FROM hos_dept_dict a
      
        LEFT JOIN (SELECT dept_id, SUM(income_money) AS amount
                     FROM v_cost_exec_dept_income t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) b
          ON a.dept_id = b.dept_id
         
      
        LEFT JOIN (SELECT dept_id
                         
                         ,SUM(dir_amount + DIR_ASS_AMOUNT + DIR_MED_AMOUNT +
                              INDIR_MED_ASS_AMOUNT + DIR_MAN_AMOUNT +
                              INDIR_ASS_MAN_AMOUNT + INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT) AS amount
                     FROM cost_dept_cost t1
                    WHERE t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month <= p_acc_month
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
       INNER JOIN acc_dept_attr t3
          ON a.group_id = t3.group_id
         AND a.hos_id = t3.hos_id
         AND a.dept_id = t3.dept_id
       WHERE a.is_last = '1'
         AND a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND a.is_stop = 0
         AND t3.type_code = '02';
  
    /*
    ****************************************************************************
    *医技收益排序            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0608_proc;
  PROCEDURE cost_analysis_c0701_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --分析年度
                                     p_acc_month VARCHAR2 --分析月份
                                     ) IS
  BEGIN
    /*
         ****************************************************************************
      *诊次成本分析    开始
      ****************************************************************************
         Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                总收益_收入
    T_2       NUMBER(30,6) Y                总收益_成本
    T_3       NUMBER(30,6) Y                总收益_收益
    T_4       NUMBER(30,6) Y                诊次数
    T_5       NUMBER(30,6) Y                单位收益_收入
    T_6       NUMBER(30,6) Y                单位收益_成本
    T_7       NUMBER(30,6) Y                单位收益_收益
               ****************************************************************************
                    */
    DELETE FROM cost_c0701
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO COST_C0701
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7)
    
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,dept_table.dept_code
            ,dept_table.dept_name
            ,income_table.all_income
            ,cost_table.all_cost
            ,nvl(income_table.all_income, 0) - nvl(cost_table.all_cost, 0)
            ,workload_table.workload
            ,income_table.all_income / workload_table.workload
            ,cost_table.all_cost / workload_table.workload
            ,(nvl(income_table.all_income, 0) -
             nvl(cost_table.all_cost, 0)) / workload_table.workload
        FROM (SELECT hdd.group_id
                    ,hdd.hos_id
                    ,hdd.dept_id
                    ,hdd.dept_no
                    ,hdd.dept_code
                    ,hdd.dept_name
                FROM hos_dept_dict hdd
                LEFT JOIN acc_dept_attr ada
                  ON hdd.group_id = ada.group_id
                 AND hdd.hos_id = ada.hos_id
                 AND hdd.dept_id = ada.dept_id
               WHERE hdd.is_stop = 0
                 AND hdd.is_last = '1'
                 AND hdd.group_id = p_group_id
                 AND hdd.hos_id = p_hos_id
                 AND ada.natur_code = '01') dept_table
      
        LEFT JOIN (SELECT t1.group_id
                         ,t1.hos_id
                         ,copy_code
                         ,t1.dept_id
                         
                         ,SUM(dir_amount + DIR_MAN_AMOUNT + DIR_ASS_AMOUNT +
                              DIR_MED_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                              INDIR_MED_MAN_AMOUNT +
                              INDIR_ASS_MED_MAN_AMOUNT +
                              INDIR_MED_ASS_AMOUNT) AS all_cost
                     FROM cost_dept_cost t1
                     LEFT JOIN acc_dept_attr t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.dept_id = t2.dept_id
                   
                    WHERE acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND t2.natur_code = '01'
                    GROUP BY t1.group_id
                            ,t1.hos_id
                            ,copy_code
                            ,t1.dept_id
                            ) cost_table
      
          ON cost_table.group_id = dept_table.group_id
         AND cost_table.hos_id = dept_table.hos_id
         AND cost_table.dept_id = dept_table.dept_id
         
        LEFT JOIN (SELECT t1.group_id
                         ,t1.hos_id
                         ,copy_code
                         ,t1.dept_id
                         
                         ,SUM(CLINIC_NUM) AS workload
                     FROM cost_clinic_work t1
                     LEFT JOIN acc_dept_attr t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.dept_id = t2.dept_id
                    WHERE acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND t2.natur_code = '01'
                    GROUP BY t1.group_id
                            ,t1.hos_id
                            ,copy_code
                            ,t1.dept_id
                            ) workload_table
          ON workload_table.group_id = dept_table.group_id
         AND workload_table.hos_id = dept_table.hos_id
         AND workload_table.dept_id = dept_table.dept_id
         
        LEFT JOIN (SELECT group_id
                         ,hos_id
                         ,copy_code
                         ,dept_id
                         
                         ,SUM(income_money) AS all_income
                     FROM v_cost_appl_dept_income
                    WHERE acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND natur_code = '01'
                    GROUP BY group_id, hos_id, copy_code, dept_id) income_table
          ON income_table.group_id = dept_table.group_id
         AND income_table.hos_id = dept_table.hos_id
         AND income_table.dept_id = dept_table.dept_id
         ;
  
    /*
    ****************************************************************************
    *诊次成本分析            结束
    ****************************************************************************
    */
  
    /*
         ****************************************************************************
      *床位成本分析    开始
      ****************************************************************************
         Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       NUMBER(30,6) Y                总收益_收入
    T_2       NUMBER(30,6) Y                总收益_成本
    T_3       NUMBER(30,6) Y                总收益_收益
    T_4       NUMBER(30,6) Y                诊次数
    T_5       NUMBER(30,6) Y                单位收益_收入
    T_6       NUMBER(30,6) Y                单位收益_成本
    T_7       NUMBER(30,6) Y                单位收益_收益
               ****************************************************************************
                    */
    DELETE FROM cost_c0702
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO COST_C0702
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7)
    
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,dept_table.dept_code
            ,dept_table.dept_name
            ,income_table.all_income
            ,cost_table.all_cost
            ,nvl(income_table.all_income, 0) - nvl(cost_table.all_cost, 0)
            ,workload_table.workload
            ,income_table.all_income / workload_table.workload
            ,cost_table.all_cost / workload_table.workload
            ,(nvl(income_table.all_income, 0) -
             nvl(cost_table.all_cost, 0)) / workload_table.workload
        FROM (SELECT t1.group_id
                    ,t1.hos_id
                    ,copy_code
                    ,t1.dept_id
                    
                    ,SUM(dir_amount + DIR_MAN_AMOUNT + DIR_ASS_AMOUNT +
                         DIR_MED_AMOUNT + INDIR_ASS_MAN_AMOUNT +
                         INDIR_MED_MAN_AMOUNT + INDIR_ASS_MED_MAN_AMOUNT +
                         INDIR_MED_ASS_AMOUNT) AS all_cost
                FROM cost_dept_cost t1
                LEFT JOIN acc_dept_attr t2
                  ON t1.group_id = t2.group_id
                 AND t1.hos_id = t2.hos_id
                 AND t1.dept_id = t2.dept_id
              
               WHERE acc_year = p_acc_year
                 AND acc_month = p_acc_month
                 AND t1.group_id = p_group_id
                 AND t1.hos_id = p_hos_id
                 AND copy_code = p_copy_code
                 AND t2.natur_code = '02'
               GROUP BY t1.group_id
                       ,t1.hos_id
                       ,copy_code
                       ,t1.dept_id
                       ) cost_table
      
        LEFT JOIN (SELECT hdd.group_id
                         ,hdd.hos_id
                         ,hdd.dept_id
                         ,hdd.dept_no
                         ,hdd.dept_code
                         ,hdd.dept_name
                     FROM hos_dept_dict hdd
                     LEFT JOIN acc_dept_attr ada
                       ON hdd.group_id = ada.group_id
                      AND hdd.hos_id = ada.hos_id
                      AND hdd.dept_id = ada.dept_id
                    WHERE hdd.is_stop = 0
                      AND hdd.is_last = '1'
                      AND hdd.group_id = p_group_id
                      AND hdd.hos_id = p_hos_id
                      AND ada.natur_code = '02') dept_table
      
          ON cost_table.group_id = dept_table.group_id
         AND cost_table.hos_id = dept_table.hos_id
         AND cost_table.dept_id = dept_table.dept_id
         
        LEFT JOIN (SELECT t1.group_id
                         ,t1.hos_id
                         ,copy_code
                         ,t1.dept_id
                         
                         ,SUM(t1.bed_use_day_num) AS workload
                     FROM cost_inhos_work t1
                     LEFT JOIN acc_dept_attr t2
                       ON t1.group_id = t2.group_id
                      AND t1.hos_id = t2.hos_id
                      AND t1.dept_id = t2.dept_id
                    WHERE acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND t1.group_id = p_group_id
                      AND t1.hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND t2.natur_code = '02'
                    GROUP BY t1.group_id
                            ,t1.hos_id
                            ,copy_code
                            ,t1.dept_id
                            ) workload_table
          ON workload_table.group_id = dept_table.group_id
         AND workload_table.hos_id = dept_table.hos_id
         AND workload_table.dept_id = dept_table.dept_id
         
        LEFT JOIN (SELECT group_id
                         ,hos_id
                         ,copy_code
                         ,dept_id
                         
                         ,SUM(income_money) AS all_income
                     FROM v_cost_appl_dept_income
                    WHERE acc_year = p_acc_year
                      AND acc_month = p_acc_month
                      AND group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND natur_code = '02'
                    GROUP BY group_id, hos_id, copy_code, dept_id) income_table
          ON income_table.group_id = dept_table.group_id
         AND income_table.hos_id = dept_table.hos_id
         AND income_table.dept_id = dept_table.dept_id
         ;
  
    /*
    ****************************************************************************
    *床位成本分析            结束
    ****************************************************************************
    */
  
  END cost_analysis_c0701_proc;
  PROCEDURE cost_analysis_c0801_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_hos_id    NUMBER
                                    , --医院ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --年
                                     p_acc_month VARCHAR2 --月
                                     ) IS
  BEGIN
    /*
    ****************************************************************************
    *医院成本指标分析                                   开始
    ****************************************************************************
    Name      Type         Nullable Default Comments 
    --------- ------------ -------- ------- -------- 
    GROUP_ID  NUMBER(18)                    集团ID   
    HOS_ID    NUMBER(18)                    医院ID   
    COPY_CODE VARCHAR2(20)                  账套编码 
    ACC_YEAR  VARCHAR2(4)                   统计年份 
    ACC_MONTH VARCHAR2(2)                   统计月份 
    ITEM_CODE VARCHAR2(20)                  指标编码 
    ITEM_NAME VARCHAR2(50) Y                指标名称 
    UNIT_NAME VARCHAR2(50) Y              单位
    T_2       NUMBER(30,6) Y                期初 
    T_3       NUMBER(30,6) Y                期末
    ****************************************************************************
    */
  
    DELETE FROM cost_c0801
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '001', '    资产总额', '元', 0, 0);
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '002', '    固定资产原值', '元', 0, 0);
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '003', '    流动资产总额', '元', 0, 0);
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '004', '    净资产总额', '元', 0, 0);
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '005', '    在职职工人数', '人', 0, 0);
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'006'
      ,'    门（急）诊人次'
      ,'人次'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'007'
      ,'    实际占用床日'
      ,'床日'
      ,''
      ,'');
  
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '008', '    分析指标', '单位', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '009', '    财务指标', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0010'
      ,'    净资产收益率（不含财政）'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0011'
      ,'    资产收益率（不含财政）'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0012', '    人力资源指标', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0013'
      ,'    每职工平均医疗收入'
      ,'元'
      ,0
      ,0);
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0014', '    每职工平均成本', '元', 0, 0);
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0015'
      ,'    每职工平均收益'
      ,'元'
      ,'0'
      ,'0');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0016', '    物力资源', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0017'
      ,'    固定资产占总资产的比例'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0018'
      ,'    流动资产占总资产的比例'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0019', '    财力资源配置', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0020'
      ,'    每职工平均净资产'
      ,'元'
      ,'0'
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0021'
      ,'    药品收入占医疗收入比重'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0022', '    成本构成', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0023', '    按成本习性', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0024', '    固定成本率', '%', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0025', '    变动成本率', '%', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0026', '    按成本分类', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0027'
      ,'    人员经费成本率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0028'
      ,'    卫生材料成本率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0029', '    药品成本率', '%', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0030'
      ,'    固定资产折旧成本率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0031', '    收入收益分析', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0032'
      ,'    医疗收入收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0033'
      ,'    门诊收入收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0034'
      ,'    住院收入收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0035'
      ,'    药品收入收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0036', '    成本构成', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0037', '    成本收益分析', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0038'
      ,'    医疗成本收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0039'
      ,'    门诊成本收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0040'
      ,'    住院成本收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0041'
      ,'    药品成本收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0042'
      ,'    次均收入成本分析'
      ,''
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0043'
      ,'    每门（急）诊人次平均收益'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0044'
      ,'    每门（急）诊人次平均收费水平'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0045'
      ,'    每门（急）诊人次平均医疗成本'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0046'
      ,'    每床日平均收益'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0047'
      ,'    每床日平均收费水平'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0048'
      ,'    每床日平均医疗成本'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0049', '    运营能力分析', '', '', '');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0050'
      ,'    医疗收益增长率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0051'
      ,'    百元门诊收入消耗成本'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0052'
      ,'    百元住院收入消耗成本'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0053'
      ,'    百元医疗收入消耗药品'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0801
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0054'
      ,'    百元医疗收入消耗卫生材料'
      ,'元'
      ,''
      ,'');
  
  END cost_analysis_c0801_proc;
  
  PROCEDURE cost_analysis_c0802_proc(p_group_id  NUMBER
                                    , --集团ID
                                     p_copy_code VARCHAR2
                                    , --帐套编码
                                     p_acc_year  VARCHAR2
                                    , --年
                                     p_acc_month VARCHAR2 --月
                                     ) IS
  BEGIN
    /*
    ****************************************************************************
    *集团成本指标分析                                    开始
    ****************************************************************************
    Name      Type         Nullable Default Comments 
    --------- ------------ -------- ------- -------- 
    GROUP_ID  NUMBER(18)                    集团ID   
    HOS_ID    NUMBER(18)                    医院ID   
    COPY_CODE VARCHAR2(20)                  账套编码 
    ACC_YEAR  VARCHAR2(4)                   统计年份 
    ACC_MONTH VARCHAR2(2)                   统计月份 
    ITEM_CODE VARCHAR2(20)                  指标编码 
    ITEM_NAME VARCHAR2(50) Y                指标名称 
    UNIT_NAME VARCHAR2(50) Y              单位
    T_2       NUMBER(30,6) Y                期初 
    T_3       NUMBER(30,6) Y                期末
    ****************************************************************************
    */
  
    DELETE FROM cost_c0802
     WHERE group_id = p_group_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '001', '    资产总额', '元', 0, 0);
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '002', '    固定资产原值', '元', 0, 0);
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '003', '    流动资产总额', '元', 0, 0);
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '004', '    净资产总额', '元', 0, 0);
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '005', '    在职职工人数', '人', 0, 0);
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'006'
      ,'    门（急）诊人次'
      ,'人次'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'007'
      ,'    实际占用床日'
      ,'床日'
      ,''
      ,'');
  
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '008', '    分析指标', '单位', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '009', '    财务指标', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0010'
      ,'    净资产收益率（不含财政）'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0011'
      ,'    资产收益率（不含财政）'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0012', '    人力资源指标', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0013'
      ,'    每职工平均医疗收入'
      ,'元'
      ,0
      ,0);
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0014', '    每职工平均成本', '元', 0, 0);
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0015'
      ,'    每职工平均收益'
      ,'元'
      ,'0'
      ,'0');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0016', '    物力资源', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0017'
      ,'    固定资产占总资产的比例'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0018'
      ,'    流动资产占总资产的比例'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0019', '    财力资源配置', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0020'
      ,'    每职工平均净资产'
      ,'元'
      ,'0'
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0021'
      ,'    药品收入占医疗收入比重'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0022', '    成本构成', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0023', '    按成本习性', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0024', '    固定成本率', '%', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0025', '    变动成本率', '%', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0026', '    按成本分类', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0027'
      ,'    人员经费成本率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0028'
      ,'    卫生材料成本率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0029', '    药品成本率', '%', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0030'
      ,'    固定资产折旧成本率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0031', '    收入收益分析', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0032'
      ,'    医疗收入收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0033'
      ,'    门诊收入收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0034'
      ,'    住院收入收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0035'
      ,'    药品收入收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0036', '    成本构成', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0037', '    成本收益分析', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0038'
      ,'    医疗成本收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0039'
      ,'    门诊成本收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0040'
      ,'    住院成本收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0041'
      ,'    药品成本收益率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0042'
      ,'    次均收入成本分析'
      ,''
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0043'
      ,'    每门（急）诊人次平均收益'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0044'
      ,'    每门（急）诊人次平均收费水平'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0045'
      ,'    每门（急）诊人次平均医疗成本'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0046'
      ,'    每床日平均收益'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0047'
      ,'    每床日平均收费水平'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0048'
      ,'    每床日平均医疗成本'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2, 1, '001', '2016', '12', '0049', '    运营能力分析', '', '', '');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0050'
      ,'    医疗收益增长率'
      ,'%'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0051'
      ,'    百元门诊收入消耗成本'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0052'
      ,'    百元住院收入消耗成本'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0053'
      ,'    百元医疗收入消耗药品'
      ,'元'
      ,''
      ,'');
    INSERT INTO cost_c0802
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,item_code
      ,item_name
      ,uint_name
      ,t_2
      ,t_3)
    VALUES
      (2
      ,1
      ,'001'
      ,'2016'
      ,'12'
      ,'0054'
      ,'    百元医疗收入消耗卫生材料'
      ,'元'
      ,''
      ,'');
  
  END cost_analysis_c0802_proc;
  PROCEDURE cost_analysis_c09_proc(p_group_id  NUMBER
                                  , --集团ID
                                   p_hos_id    NUMBER
                                  , --医院ID
                                   p_copy_code VARCHAR2
                                  , --帐套编码
                                   p_acc_year  VARCHAR2
                                  , --分析年度
                                   p_acc_month VARCHAR2 --分析月份
                                   ) IS
  BEGIN
  
    /*
    ****************************************************************************
    *门诊盈亏分析       开始
    ****************************************************************************
    Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       VARCHAR2(50) Y                门诊人次
    T_2       NUMBER(30,6) Y                单位收入
    T_3       NUMBER(30,6) Y                单位变动成本
    T_4       NUMBER(30,6) Y                单位收益
    T_5       NUMBER(30,6) Y                医疗收入
    T_6       NUMBER(30,6) Y                固定成本
    T_7       NUMBER(30,6) Y                变动成本
    T_8       NUMBER(30,6) Y                保本诊次
    T_9       NUMBER(30,6) Y                保本收入
    ****************************************************************************
    */
  
    DELETE FROM cost_c0901
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0901
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,a.dept_code
            ,a.dept_name
            ,c.workload
            ,d.all_income / c.workload
            ,b.change_cost / c.workload
            ,(d.all_income - b.all_cost) / c.workload
            ,d.all_income
            ,b.fixed_cost
            ,b.change_cost
            ,b.fixed_cost / ((d.all_income - b.change_cost) / c.workload)
            ,(b.fixed_cost / ((d.all_income - b.change_cost) / c.workload)) *
             (d.all_income / c.workload)
        FROM (SELECT dat.dept_id
                    
                    ,SUM(CASE cost_dic.nature_id
                           WHEN 1 THEN
                            dir_amount + dat.dir_man_amount +
                            dat.dir_ass_amount + dat.dir_med_amount +
                            dat.indir_ass_man_amount +
                            dat.indir_med_man_amount +
                            dat.indir_ass_med_man_amount +
                            dat.indir_med_ass_amount
                           ELSE
                            0
                         END) fixed_cost
                    ,SUM(CASE cost_dic.nature_id
                           WHEN 2 THEN
                            dir_amount + dat.dir_man_amount +
                            dat.dir_ass_amount + dat.dir_med_amount +
                            dat.indir_ass_man_amount +
                            dat.indir_med_man_amount +
                            dat.indir_ass_med_man_amount +
                            dat.indir_med_ass_amount
                           ELSE
                            0
                         END) change_cost
                    ,SUM(dir_amount + dat.dir_man_amount +
                         dat.dir_ass_amount + dat.dir_med_amount +
                         dat.indir_ass_man_amount +
                         dat.indir_med_man_amount +
                         dat.indir_ass_med_man_amount +
                         dat.indir_med_ass_amount) all_cost
                FROM COST_DEPT_COST dat
                LEFT JOIN COST_ITEM_DICT cost_dic
                  ON dat.cost_item_id = cost_dic.cost_item_id
                 AND cost_dic.group_id = p_group_id
                 AND cost_dic.hos_id = p_hos_id
                 AND cost_dic.copy_code = p_copy_code
               WHERE dat.group_id = p_group_id
                 AND dat.hos_id = p_hos_id
                 AND dat.copy_code = p_copy_code
                 AND dat.acc_year = p_acc_year
                 AND dat.acc_month = p_acc_month
               GROUP BY dat.dept_id) b
      
       INNER JOIN (SELECT dept_id, dept_code, dept_name
                     FROM Hos_Dept_Dict
                    WHERE dept_id IN (SELECT dept_id
                                        FROM acc_dept_attr
                                       WHERE natur_code = '01'
                                         AND group_id = p_group_id
                                         AND hos_id = p_hos_id)
                         
                      AND group_id = p_group_id
                      AND hos_id = p_hos_id) a
      
          ON a.dept_id = b.dept_id
         
        LEFT JOIN (SELECT dept_id, SUM(clinic_num) workload
                     FROM COST_CLINIC_WORK
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
        LEFT JOIN (SELECT appl_dept_id dept_id
                         ,appl_dept_no dept_no
                         ,SUM(money) all_income
                     FROM cost_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY appl_dept_id, appl_dept_no) d
          ON a.dept_id = d.dept_id
         ;
  
    /*
    ****************************************************************************
    *门诊盈亏分析           结束
    ****************************************************************************
    */
  
    /*
    ****************************************************************************
    *住院盈亏分析       开始
    ****************************************************************************
    Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       VARCHAR2(50) Y                实际床日数
    T_2       NUMBER(30,6) Y                单位收入
    T_3       NUMBER(30,6) Y                单位变动成本
    T_4       NUMBER(30,6) Y                单位收益
    T_5       NUMBER(30,6) Y                医疗收入
    T_6       NUMBER(30,6) Y                固定成本
    T_7       NUMBER(30,6) Y                变动成本
    T_8       NUMBER(30,6) Y                保本诊次
    T_9       NUMBER(30,6) Y                保本收入
    ****************************************************************************
    */
  
    DELETE FROM cost_c0902
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0902
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,a.dept_code
            ,a.dept_name
            ,c.workload
            ,d.all_income / c.workload
            ,b.change_cost / c.workload
            ,(d.all_income - b.all_cost) / c.workload
            ,d.all_income
            ,b.fixed_cost
            ,b.change_cost
            ,b.fixed_cost / ((d.all_income - b.change_cost) / c.workload)
            ,(b.fixed_cost / ((d.all_income - b.change_cost) / c.workload)) *
             (d.all_income / c.workload)
        FROM (SELECT dat.dept_id
                    
                    ,SUM(CASE cost_dic.nature_id
                           WHEN 1 THEN
                            dir_amount + dat.dir_man_amount +
                            dat.dir_ass_amount + dat.dir_med_amount +
                            dat.indir_ass_man_amount +
                            dat.indir_med_man_amount +
                            dat.indir_ass_med_man_amount +
                            dat.indir_med_ass_amount
                           ELSE
                            0
                         END) fixed_cost
                    ,SUM(CASE cost_dic.nature_id
                           WHEN 2 THEN
                            dir_amount + dat.dir_man_amount +
                            dat.dir_ass_amount + dat.dir_med_amount +
                            dat.indir_ass_man_amount +
                            dat.indir_med_man_amount +
                            dat.indir_ass_med_man_amount +
                            dat.indir_med_ass_amount
                           ELSE
                            0
                         END) change_cost
                    ,SUM(dir_amount + dat.dir_man_amount +
                         dat.dir_ass_amount + dat.dir_med_amount +
                         dat.indir_ass_man_amount +
                         dat.indir_med_man_amount +
                         dat.indir_ass_med_man_amount +
                         dat.indir_med_ass_amount) all_cost
                FROM COST_DEPT_COST dat
                LEFT JOIN COST_ITEM_DICT cost_dic
                  ON dat.cost_item_id = cost_dic.cost_item_id
                 AND cost_dic.group_id = p_group_id
                 AND cost_dic.hos_id = p_hos_id
                 AND cost_dic.copy_code = p_copy_code
               WHERE dat.group_id = p_group_id
                 AND dat.hos_id = p_hos_id
                 AND dat.copy_code = p_copy_code
                 AND dat.acc_year = p_acc_year
                 AND dat.acc_month = p_acc_month
               GROUP BY dat.dept_id) b
       INNER JOIN (SELECT dept_id, dept_code, dept_name
                     FROM Hos_Dept_Dict
                    WHERE dept_id IN (SELECT dept_id
                                        FROM acc_dept_attr
                                       WHERE natur_code = '02'
                                         AND group_id = p_group_id
                                         AND hos_id = p_hos_id)
                         
                      AND group_id = p_group_id
                      AND hos_id = p_hos_id) a
      
          ON a.dept_id = b.dept_id
         
        LEFT JOIN (SELECT dept_id, SUM(bed_use_day_num) workload
                     FROM cost_inhos_work
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY dept_id) c
          ON a.dept_id = c.dept_id
         
        LEFT JOIN (SELECT appl_dept_id dept_id
                         ,appl_dept_no dept_no
                         ,SUM(money) all_income
                     FROM cost_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY appl_dept_id, appl_dept_no) d
          ON a.dept_id = d.dept_id
         ;
  
    /*
    ****************************************************************************
    *住院盈亏分析           结束
    ****************************************************************************
    */
  
    /****************************************************************************
    *医技盈亏分析       开始
    ****************************************************************************
    Name      Type         Nullable Default Comments
    --------- ------------ -------- ------- --------
    GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    COPY_CODE VARCHAR2(20)                  账套编码
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    DEPT_CODE VARCHAR2(20)                  科室编码
    DEPT_NAME VARCHAR2(50) Y                科室名称
    T_1       VARCHAR2(50) Y                服务量
    T_2       NUMBER(30,6) Y                单位收入
    T_3       NUMBER(30,6) Y                单位变动成本
    T_4       NUMBER(30,6) Y                单位收益
    T_5       NUMBER(30,6) Y                医疗收入
    T_6       NUMBER(30,6) Y                固定成本
    T_7       NUMBER(30,6) Y                变动成本
    T_8       NUMBER(30,6) Y                保本诊次
    T_9       NUMBER(30,6) Y                保本收入
    ****************************************************************************
    */
  
    DELETE FROM cost_c0903
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND copy_code = p_copy_code
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0903
      (group_id
      ,hos_id
      ,copy_code
      ,acc_year
      ,acc_month
      ,dept_code
      ,dept_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9)
      SELECT p_group_id
            ,p_hos_id
            ,p_copy_code
            ,p_acc_year
            ,p_acc_month
            ,a.dept_code
            ,a.dept_name
            ,c.workload
            ,d.all_income / c.workload
            ,b.change_cost / c.workload
            ,(d.all_income - b.all_cost) / c.workload
            ,d.all_income
            ,b.fixed_cost
            ,b.change_cost
            ,b.fixed_cost / ((d.all_income - b.change_cost) / c.workload)
            ,(b.fixed_cost / ((d.all_income - b.change_cost) / c.workload)) *
             (d.all_income / c.workload)
        FROM (SELECT dat.dept_id
                    
                    ,SUM(CASE cost_dic.nature_id
                           WHEN 1 THEN
                            dir_amount + dat.dir_man_amount +
                            dat.dir_ass_amount + dat.dir_med_amount +
                            dat.indir_ass_man_amount +
                            dat.indir_med_man_amount +
                            dat.indir_ass_med_man_amount +
                            dat.indir_med_ass_amount
                           ELSE
                            0
                         END) fixed_cost
                    ,SUM(CASE cost_dic.nature_id
                           WHEN 2 THEN
                            dir_amount + dat.dir_man_amount +
                            dat.dir_ass_amount + dat.dir_med_amount +
                            dat.indir_ass_man_amount +
                            dat.indir_med_man_amount +
                            dat.indir_ass_med_man_amount +
                            dat.indir_med_ass_amount
                           ELSE
                            0
                         END) change_cost
                    ,SUM(dir_amount + dat.dir_man_amount +
                         dat.dir_ass_amount + dat.dir_med_amount +
                         dat.indir_ass_man_amount +
                         dat.indir_med_man_amount +
                         dat.indir_ass_med_man_amount +
                         dat.indir_med_ass_amount) all_cost
                FROM COST_DEPT_COST dat
                LEFT JOIN COST_ITEM_DICT cost_dic
                  ON dat.cost_item_id = cost_dic.cost_item_id
                 AND cost_dic.group_id = p_group_id
                 AND cost_dic.hos_id = p_hos_id
                 AND cost_dic.copy_code = p_copy_code
               WHERE dat.group_id = p_group_id
                 AND dat.hos_id = p_hos_id
                 AND dat.copy_code = p_copy_code
                 AND dat.acc_year = p_acc_year
                 AND dat.acc_month = p_acc_month
               GROUP BY dat.dept_id) b
       INNER JOIN (SELECT dept_id, dept_code, dept_name
                     FROM Hos_Dept_Dict
                    WHERE dept_id IN (SELECT dept_id
                                        FROM acc_dept_attr
                                       WHERE type_code = '02'
                                         AND group_id = p_group_id
                                         AND hos_id = p_hos_id)
                      AND is_stop = '0'
                      AND is_last = '1'
                      AND group_id = p_group_id
                      AND hos_id = p_hos_id) a
      
          ON a.dept_id = b.dept_id
         
        LEFT JOIN (select dept_id, 
        				  sum(medical_num)  workload
        				  from cost_medical_technology_work 
        				  where group_id = p_group_id
        				  and hos_id = p_hos_id
        				  and copy_code  = p_copy_code
        				  and acc_year = p_acc_year
        				  and acc_month = p_acc_month
        				  group by dept_id) c
          ON a.dept_id = c.dept_id
        LEFT JOIN (SELECT exec_dept_id dept_id
                         
                         ,SUM(money) all_income
                     FROM cost_income
                    WHERE group_id = p_group_id
                      AND hos_id = p_hos_id
                      AND copy_code = p_copy_code
                      AND acc_year = p_acc_year
                      AND acc_month = p_acc_month
                    GROUP BY exec_dept_id) d
          ON a.dept_id = d.dept_id
         ;
  
    /*
    ****************************************************************************
    *医技盈亏分析           结束
    ****************************************************************************
    */
  
    /*
      ****************************************************************************
      *集团门诊盈亏分析           开始
      GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    HOS_CODE  VARCHAR2(20)                  医院编码
    HOS_NAME  VARCHAR2(50) Y                医院名称
    T_1       VARCHAR2(50) Y                门诊人次
    T_2       NUMBER(30,6) Y                单位收入
    T_3       NUMBER(30,6) Y                单位变动成本
    T_4       NUMBER(30,6) Y                单位收益
    T_5       NUMBER(30,6) Y                医疗收入
    T_6       NUMBER(30,6) Y                固定成本
    T_7       NUMBER(30,6) Y                变动成本
    T_8       NUMBER(30,6) Y                保本诊次
    T_9       NUMBER(30,6) Y                保本收入
      ****************************************************************************
      */
  
    DELETE FROM cost_c0904
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0904
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,hos_code
      ,hos_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9)
      SELECT a.group_id
            ,a.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,SUM(t_1) t_1
            ,SUM(t_2) t_2
            ,SUM(t_3) t_3
            ,SUM(t_4) t_4
            ,SUM(t_5) t_5
            ,SUM(t_6) t_6
            ,SUM(t_7) t_7
            ,SUM(t_8) t_8
            ,SUM(t_9) t_9
        FROM cost_c0901 a
        LEFT JOIN hos_info_dict b
          ON a.group_id = b.group_id
         AND a.hos_id = b.hos_id
       WHERE a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY a.group_id
               ,a.hos_id
               ,copy_code
               ,acc_year
               ,acc_month
               ,hos_code
               ,hos_name;
    /*
    ****************************************************************************
    *集团门诊盈亏分析           开始
    ****************************************************************************
    */
  
    /*
      ****************************************************************************
      *集团住院盈亏分析           开始
       GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    HOS_CODE  VARCHAR2(20)                  医院编码
    HOS_NAME  VARCHAR2(50) Y                医院名称
    T_1       VARCHAR2(50) Y                实际床日数
    T_2       NUMBER(30,6) Y                单位收入
    T_3       NUMBER(30,6) Y                单位变动成本
    T_4       NUMBER(30,6) Y                单位收益
    T_5       NUMBER(30,6) Y                医疗收入
    T_6       NUMBER(30,6) Y                固定成本
    T_7       NUMBER(30,6) Y                变动成本
    T_8       NUMBER(30,6) Y                保本诊次
    T_9       NUMBER(30,6) Y                保本收入
      ****************************************************************************
      */
  
    DELETE FROM cost_c0905
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0905
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,hos_code
      ,hos_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9)
      SELECT a.group_id
            ,a.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,SUM(t_1) t_1
            ,SUM(t_2) t_2
            ,SUM(t_3) t_3
            ,SUM(t_4) t_4
            ,SUM(t_5) t_5
            ,SUM(t_6) t_6
            ,SUM(t_7) t_7
            ,SUM(t_8) t_8
            ,SUM(t_9) t_9
        FROM cost_c0902 a
        LEFT JOIN hos_info_dict b
          ON a.group_id = b.group_id
         AND a.hos_id = b.hos_id
       WHERE a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY a.group_id
               ,a.hos_id
               ,copy_code
               ,acc_year
               ,acc_month
               ,hos_code
               ,hos_name;
    /*
    ****************************************************************************
    *集团住院盈亏分析           结束
    ****************************************************************************
    */
  
    /*
      ****************************************************************************
      *集团医技盈亏分析           开始
       GROUP_ID  NUMBER(18)                    集团ID
    HOS_ID    NUMBER(18)                    医院ID
    ACC_YEAR  VARCHAR2(4)                   统计年份
    ACC_MONTH VARCHAR2(2)                   统计月份
    HOS_CODE  VARCHAR2(20)                  医院编码
    HOS_NAME  VARCHAR2(50) Y                医院名称
    T_1       VARCHAR2(50) Y                服务量
    T_2       NUMBER(30,6) Y                单位收入
    T_3       NUMBER(30,6) Y                单位变动成本
    T_4       NUMBER(30,6) Y                单位收益
    T_5       NUMBER(30,6) Y                医疗收入
    T_6       NUMBER(30,6) Y                固定成本
    T_7       NUMBER(30,6) Y                变动成本
    T_8       NUMBER(30,6) Y                保本诊次
    T_9       NUMBER(30,6) Y                保本收入
      ****************************************************************************
      */
  
    DELETE FROM cost_c0906
     WHERE group_id = p_group_id
       AND hos_id = p_hos_id
       AND acc_year = p_acc_year
       AND acc_month = p_acc_month;
  
    INSERT INTO cost_c0906
      (group_id
      ,hos_id
      ,acc_year
      ,acc_month
      ,hos_code
      ,hos_name
      ,t_1
      ,t_2
      ,t_3
      ,t_4
      ,t_5
      ,t_6
      ,t_7
      ,t_8
      ,t_9)
      SELECT a.group_id
            ,a.hos_id
            ,acc_year
            ,acc_month
            ,hos_code
            ,hos_name
            ,SUM(t_1) t_1
            ,SUM(t_2) t_2
            ,SUM(t_3) t_3
            ,SUM(t_4) t_4
            ,SUM(t_5) t_5
            ,SUM(t_6) t_6
            ,SUM(t_7) t_7
            ,SUM(t_8) t_8
            ,SUM(t_9) t_9
        FROM cost_c0903 a
        LEFT JOIN hos_info_dict b
          ON a.group_id = b.group_id
         AND a.hos_id = b.hos_id
       WHERE a.group_id = p_group_id
         AND a.hos_id = p_hos_id
         AND acc_year = p_acc_year
         AND acc_month = p_acc_month
       GROUP BY a.group_id
               ,a.hos_id
               ,copy_code
               ,acc_year
               ,acc_month
               ,hos_code
               ,hos_name;
    /*
    ****************************************************************************
    *集团医技盈亏分析           结束
    ****************************************************************************
    */
  
  END cost_analysis_c09_proc;
  
                           
  PROCEDURE cost_analysis_proc(p_group_id  NUMBER
                              , --集团ID
                               p_hos_id    NUMBER
                              , --医院ID
                               p_copy_code VARCHAR2
                              , --帐套编码
                               p_acc_year  VARCHAR2
                              , --分析年度
                               p_acc_month VARCHAR2 --分析月份
                               ) IS
  BEGIN
  
    cost_analysis_c0101_proc(p_group_id
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0103_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0104_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0105_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0106_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0107_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0108_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0109_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0110_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0111_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0112_proc(p_group_id 
                            ,p_hos_id 
                            ,p_acc_year 
                            ,p_acc_month );
    cost_analysis_c0114_proc(p_group_id
                            ,p_hos_id 
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0115_proc(p_group_id 
                            ,p_hos_id 
                            ,p_acc_year
                            ,p_acc_month );
    cost_analysis_c0116_proc(p_group_id 
                            ,p_hos_id 
                            ,p_acc_year 
                            ,p_acc_month );
    cost_analysis_c0117_proc(p_group_id 
                            ,p_hos_id 
                            ,p_acc_year 
                            ,p_acc_month );
    cost_analysis_c0201_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0202_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0203_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0204_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0205_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0206_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0301_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0302_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0401_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0501_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0502_proc (p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  
    cost_analysis_c0601_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0602_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0603_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0604_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0605_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0606_proc(p_group_id 
                            ,p_hos_id 
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0607_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0608_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c0701_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
    cost_analysis_c09_proc(p_group_id 
                            ,p_hos_id
                            ,p_copy_code
                            ,p_acc_year
                            ,p_acc_month);
  END cost_analysis_proc;
END pkg_cost_analysis;

					
	

					
	]]></sql>

</root>

