<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chd.hrp.mat.dao.advice.MatAdviceMapper">
	
	<resultMap id="advice" type="com.chd.hrp.mat.entity.MatAdvice">
		<result property="group_id" column="group_id"/>
		<result property="hos_id" column="hos_id"/>
		<result property="copy_code" column="copy_code"/>
		<result property="receive_id" column="receive_id"/>
		<result property="charge_date" column="charge_date"/>
		<result property="advice_no" column="advice_no"/>
		<result property="charge_item_id" column="charge_item_id"/>
		<result property="charge_item_name" column="charge_item_name"/>
		<result property="charge_detail_code" column="charge_detail_code"/>
		<result property="inv_no" column="inv_no"/>
		<result property="inv_id" column="inv_id"/>
		<result property="inv_code" column="inv_code"/>
		<result property="inv_name" column="inv_name"/>
		<result property="inv_model" column="inv_model"/>
		<result property="unit_name" column="unit_name"/>
		<result property="batch_no" column="batch_no"/>
		<result property="bar_code" column="bar_code"/>
		<result property="charge_num" column="charge_num"/>
		<result property="out_num" column="out_num"/>
		<result property="charge_price" column="charge_price"/>
		<result property="order_dept_id" column="order_dept_id"/>
		<result property="order_dept_no" column="order_dept_no"/>
		<result property="order_dept_code" column="order_dept_code"/>
		<result property="order_dept_name" column="order_dept_name"/>
		<result property="exec_dept_id" column="exec_dept_id"/>
		<result property="exec_dept_no" column="exec_dept_no"/>
		<result property="exec_dept_code" column="exec_dept_code"/>
		<result property="exec_dept_name" column="exec_dept_name"/>
		<result property="charge_code" column="charge_code"/>
		<result property="charge_name" column="charge_name"/>
		<result property="doctor_code" column="doctor_code"/>
		<result property="doctor_name" column="doctor_name"/>
		<result property="patient_name" column="patient_name"/>
		<result property="hospital_no" column="hospital_no"/>
		<result property="bed_no" column="bed_no"/>
		<result property="doc_type" column="doc_type"/>
		<result property="message" column="message"/>
		<result property="hx_flag" column="hx_flag"/>
		<result property="out_no" column="out_no"/>
		<result property="dept_id" column="dept_id"/>
		<result property="dept_no" column="dept_no"/>
		<result property="dept_code" column="dept_code"/>
		<result property="dept_name" column="dept_name"/>
		<result property="store_id" column="store_id"/>
		<result property="store_no" column="store_no"/>
		<result property="busi_code" column="busi_code"/>
		<result property="sup_code" column="sup_code"/>
		<result property="sup_name" column="sup_name"/>
	</resultMap>
	
	 <select id="queryMatOutDetailNextval"  parameterType="java.util.Map"  resultType="java.lang.Integer">	
		select MAT_OUT_DETAIL_SEQ.nextval from dual
	</select>
	
	<insert id="addMatOutBatch" parameterType="java.util.List" >
	
		INSERT INTO MAT_OUT_DETAIL (
		out_detail_id
		,
		group_id
		,
		hos_id
		,
		copy_code
		,
		out_id
		,
		out_no
		,
		inv_id
		,
		inv_no
		,
		batch_sn
		,
		batch_no
		,
		price
		,
		amount
		,
		sale_price
		,
		sale_money
		,
		sell_price
		,
		sell_money
		,
		allot_price
		,
		allot_money
		,
		amount_money
		,
		num_exchange
		,
		pack_price
		,
		num
		,
		bar_code
		,
		inva_date
		,
		disinfect_date
		,
		location_id
		,
		note
		,
		pack_code
		) select t.* from(
		<foreach collection="list" item="item" index="index" separator=" union all " >
			select 		
			#{item.out_detail_id,jdbcType=INTEGER}
			,
			#{item.group_id,jdbcType=INTEGER}
			,
			#{item.hos_id,jdbcType=INTEGER}
			,
			#{item.copy_code,jdbcType=VARCHAR}
			,
			#{item.out_id,jdbcType=INTEGER}
			,
			#{item.out_no,jdbcType=VARCHAR}
			,
			#{item.inv_id,jdbcType=INTEGER}
			,
			#{item.inv_no,jdbcType=INTEGER}
			,
			#{item.batch_sn,jdbcType=INTEGER}
			,
			#{item.batch_no,jdbcType=VARCHAR}
			,
			#{item.price,jdbcType=INTEGER}
			,
			#{item.amount,jdbcType=INTEGER}
			,
			#{item.sale_price,jdbcType=INTEGER}
			,
			#{item.sale_money,jdbcType=INTEGER}
			,
			#{item.sell_price,jdbcType=INTEGER}
			,
			#{item.sell_money,jdbcType=INTEGER}
			,
			#{item.allot_price,jdbcType=INTEGER}
			,
			#{item.allot_money,jdbcType=INTEGER}
			,
			#{item.amount_money,jdbcType=INTEGER}
			,
			#{item.num_exchange,jdbcType=INTEGER}
			,
			#{item.pack_price,jdbcType=INTEGER}
			,
			#{item.num,jdbcType=INTEGER}
			,
			#{item.bar_code,jdbcType=VARCHAR}
			,
			to_date(#{item.inva_date,jdbcType=VARCHAR},'yyyy/MM/dd')
			,
			to_date(#{item.disinfect_date,jdbcType=VARCHAR},'yyyy/MM/dd')
			,
			#{item.location_id,jdbcType=INTEGER}
			,
			#{item.note,jdbcType=VARCHAR}
			,
			#{item.pack_code,jdbcType=VARCHAR}
		    from dual
		</foreach>
		)t
	</insert>
	
	<insert id="addMatAdvice" useGeneratedKeys="true" >
	
		INSERT INTO MAT_ADVICE (
		group_id,
		hos_id,
		copy_code,
		receive_id,
		charge_date,
		advice_no,
		charge_item_id,
		charge_detail_code,
		inv_no,
		inv_id,
		inv_code,
		batch_no,
		bar_code,
		charge_num,
		out_num,
		charge_price,
		order_dept_id,
		order_dept_no,
		order_dept_code,
		exec_dept_id,
		exec_dept_no,
		exec_dept_code,
		charge_code,
		charge_name,
		doctor_code,  
		doctor_name,  
		patient_name, 
		hospital_no,  
		bed_no,	    
		doc_type,	    
		message,	    
		hx_flag,
		busi_code
		
		) VALUES (
		#{group_id,jdbcType=INTEGER}
		,
		#{hos_id,jdbcType=INTEGER}
		,
		#{copy_code,jdbcType=VARCHAR}
		,
		#{receive_id,jdbcType=VARCHAR}
		,
		#{charge_date,jdbcType=DATE},
		#{advice_no,jdbcType=VARCHAR},
		#{charge_item_id,jdbcType=INTEGER},
		#{charge_detail_code,jdbcType=VARCHAR},
		#{inv_no,jdbcType=INTEGER},
		#{inv_id,jdbcType=INTEGER},
		#{inv_code,jdbcType=VARCHAR},
		#{batch_no,jdbcType=VARCHAR},
		#{bar_code,jdbcType=VARCHAR},
		#{charge_num,jdbcType=INTEGER},
		#{out_num,jdbcType=INTEGER},
		#{charge_price,jdbcType=INTEGER},
		#{order_dept_id,jdbcType=INTEGER},
		#{order_dept_no,jdbcType=INTEGER},
		#{order_dept_code,jdbcType=VARCHAR},
		#{exec_dept_id,jdbcType=INTEGER},
		#{exec_dept_no,jdbcType=INTEGER},
		#{exec_dept_code,jdbcType=VARCHAR},
		#{charge_code,jdbcType=VARCHAR},
		#{charge_name,jdbcType=VARCHAR},
		#{doctor_code,jdbcType=VARCHAR},  
		#{doctor_name,jdbcType=VARCHAR},  
		#{patient_name,jdbcType=VARCHAR}, 
		#{hospital_no,jdbcType=VARCHAR},  
		#{bed_no,jdbcType=VARCHAR},	    
		#{doc_type,jdbcType=INTEGER},	    
		#{message,jdbcType=VARCHAR},	    
		#{hx_flag,jdbcType=INTEGER},
		#{busi_code,jdbcType=VARCHAR}
		)
	
	</insert>
	<insert id="addBatchMatAdvice" parameterType="java.util.List" >
	
		INSERT INTO MAT_ADVICE (
		group_id,
		hos_id,
		copy_code,
		receive_id,
		charge_date,
		advice_no,
		charge_item_id,
		charge_detail_code,
		inv_no,
		inv_id,
		inv_code,
		batch_no,
		bar_code,
		charge_num,
		out_num,
		charge_price,
		order_dept_id,
		order_dept_no,
		order_dept_code,
		exec_dept_id,
		exec_dept_no,
		exec_dept_code,
		charge_code,
		charge_name,
		doctor_code,  
		doctor_name,  
		patient_name, 
		hospital_no,  
		bed_no,	    
		doc_type,	    
		message,	    
		hx_flag,
		busi_code
		) select t.* from(
		<foreach collection="list" item="item" index="index" separator=" union all " >
			select 		
			#{item.group_id,jdbcType=INTEGER}
		,
		#{item.hos_id,jdbcType=INTEGER}
		,
		#{item.copy_code,jdbcType=VARCHAR}
		,
		#{item.receive_id,jdbcType=VARCHAR}
		,
		#{item.charge_date,jdbcType=DATE},
		#{item.advice_no,jdbcType=VARCHAR},
		#{item.charge_item_id,jdbcType=INTEGER},
		#{item.charge_detail_code,jdbcType=VARCHAR},
		#{item.inv_no,jdbcType=INTEGER},
		#{item.inv_id,jdbcType=INTEGER},
		#{item.inv_code,jdbcType=VARCHAR},
		#{item.batch_no,jdbcType=VARCHAR},
		#{item.bar_code,jdbcType=VARCHAR},
		#{item.charge_num,jdbcType=INTEGER},
		#{item.out_num,jdbcType=INTEGER},
		#{item.charge_price,jdbcType=INTEGER},
		#{item.order_dept_id,jdbcType=INTEGER},
		#{item.order_dept_no,jdbcType=INTEGER},
		#{item.order_dept_code,jdbcType=VARCHAR},
		#{item.exec_dept_id,jdbcType=INTEGER},
		#{item.exec_dept_no,jdbcType=INTEGER},
		#{item.exec_dept_code,jdbcType=VARCHAR},
		#{item.charge_code,jdbcType=VARCHAR},
		#{item.charge_name,jdbcType=VARCHAR},
		#{item.doctor_code,jdbcType=VARCHAR},  
		#{item.doctor_name,jdbcType=VARCHAR},  
		#{item.patient_name,jdbcType=VARCHAR}, 
		#{item.hospital_no,jdbcType=VARCHAR},  
		#{item.bed_no,jdbcType=VARCHAR},	    
		#{item.doc_type,jdbcType=INTEGER},	    
		#{item.message,jdbcType=VARCHAR},	    
		#{item.hx_flag,jdbcType=INTEGER},
		#{item.busi_code,jdbcType=VARCHAR}
		</foreach>
		)t
	</insert>
	
	<update id="updateMatAdvice" parameterType="java.util.Map">
	
		UPDATE MAT_ADVICE SET
		charge_date = #{charge_date,jdbcType=DATE},
		advice_no = #{advice_no,jdbcType=VARCHAR},
		charge_item_id = #{charge_item_id,jdbcType=INTEGER},
		charge_detail_code = #{charge_detail_code,jdbcType=VARCHAR},
		inv_no = #{inv_no,jdbcType=INTEGER},
		inv_id = #{inv_id,jdbcType=INTEGER},
		inv_code = #{inv_code,jdbcType=VARCHAR},
		batch_no = #{batch_no,jdbcType=VARCHAR},
		bar_code = #{bar_code,jdbcType=VARCHAR},
		charge_num = #{charge_num,jdbcType=INTEGER},
		out_num = #{out_num,jdbcType=INTEGER},
		charge_price = #{charge_price,jdbcType=INTEGER},
		order_dept_id = #{order_dept_id,jdbcType=INTEGER},
		order_dept_no = #{order_dept_no,jdbcType=INTEGER},
		order_dept_code = #{order_dept_code,jdbcType=VARCHAR},
		exec_dept_id = #{exec_dept_id,jdbcType=INTEGER},
		exec_dept_no = #{exec_dept_no,jdbcType=INTEGER},
		exec_dept_code = #{exec_dept_code,jdbcType=VARCHAR},
		charge_code = #{charge_code,jdbcType=VARCHAR},
		charge_name = #{charge_name,jdbcType=VARCHAR},
		doctor_code = #{doctor_code,jdbcType=VARCHAR},  
		doctor_name = #{doctor_name,jdbcType=VARCHAR},  
		patient_name = #{patient_name,jdbcType=VARCHAR}, 
		hospital_no = #{hospital_no,jdbcType=VARCHAR},  
		bed_no = #{bed_no,jdbcType=VARCHAR},	    
		doc_type = #{doc_type,jdbcType=INTEGER},	    
		message = #{message,jdbcType=VARCHAR},	    
		hx_flag = #{hx_flag,jdbcType=INTEGER}
		
		WHERE 
		group_id =#{group_id,jdbcType=INTEGER}
		 and 
hos_id =#{hos_id,jdbcType=INTEGER}
		 and 
copy_code =#{copy_code,jdbcType=VARCHAR}
		 and 
receive_id =#{receive_id,jdbcType=VARCHAR}
	
	</update>
	
	<update id="updateMatAdviceByHxFlag" parameterType="java.util.Map">
	
		UPDATE MAT_ADVICE SET
		message = #{message,jdbcType=VARCHAR},	    
		hx_flag = #{hx_flag,jdbcType=INTEGER}
		
		WHERE 
		group_id =#{group_id,jdbcType=INTEGER}
		 and 
hos_id =#{hos_id,jdbcType=INTEGER}
		 and 
copy_code =#{copy_code,jdbcType=VARCHAR}
		 and 
receive_id =#{receive_id,jdbcType=VARCHAR}
	
	</update>
	
	
	
	<update id="updateBatchMatAdvice" parameterType="java.util.List">
	
		<foreach collection="list" item="item" index="index" open="begin" close="end;" separator=";" >
			UPDATE MAT_ADVICE SET
			charge_date = #{item.charge_date,jdbcType=DATE},
		advice_no = #{item.advice_no,jdbcType=VARCHAR},
		charge_item_id = #{item.charge_item_id,jdbcType=INTEGER},
		charge_detail_code = #{item.charge_detail_code,jdbcType=VARCHAR},
		inv_no = #{item.inv_no,jdbcType=INTEGER},
		inv_id = #{item.inv_id,jdbcType=INTEGER},
		inv_code = #{item.inv_code,jdbcType=VARCHAR},
		batch_no = #{item.batch_no,jdbcType=VARCHAR},
		bar_code = #{item.bar_code,jdbcType=VARCHAR},
		charge_num = #{item.charge_num,jdbcType=INTEGER},
		out_num = #{item.out_num,jdbcType=INTEGER},
		charge_price = #{item.charge_price,jdbcType=INTEGER},
		order_dept_id = #{item.order_dept_id,jdbcType=INTEGER},
		order_dept_no = #{item.order_dept_no,jdbcType=INTEGER},
		order_dept_code = #{item.order_dept_code,jdbcType=VARCHAR},
		exec_dept_id = #{item.exec_dept_id,jdbcType=INTEGER},
		exec_dept_no = #{item.exec_dept_no,jdbcType=INTEGER},
		exec_dept_code = #{item.exec_dept_code,jdbcType=VARCHAR},
		charge_code = #{item.charge_code,jdbcType=VARCHAR},
		charge_name = #{item.charge_name,jdbcType=VARCHAR},
		doctor_code = #{item.doctor_code,jdbcType=VARCHAR},  
		doctor_name = #{item.doctor_name,jdbcType=VARCHAR},  
		patient_name = #{item.patient_name,jdbcType=VARCHAR}, 
		hospital_no = #{item.hospital_no,jdbcType=VARCHAR},  
		bed_no = #{item.bed_no,jdbcType=VARCHAR},	    
		doc_type = #{item.doc_type,jdbcType=INTEGER},	    
		message = #{item.message,jdbcType=VARCHAR},	    
		hx_flag = #{item.hx_flag,jdbcType=INTEGER}
			
			WHERE 
			group_id = #{item.group_id,jdbcType=INTEGER}
			 and 
			hos_id = #{item.hos_id,jdbcType=INTEGER}
			 and 
			copy_code = #{item.copy_code,jdbcType=VARCHAR}
			 and 
			receive_id = #{item.receive_id,jdbcType=INTEGER}
			
		</foreach>
	</update>
	
	<update id="updateBatchMatAdviceByHxFlag" parameterType="java.util.List">
	
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";">
			UPDATE MAT_ADVICE SET
		message = #{item.message,jdbcType=VARCHAR},	    
		hx_flag = #{item.hx_flag,jdbcType=INTEGER}
			
			WHERE 
			group_id = #{item.group_id,jdbcType=INTEGER}
			 and 
			hos_id = #{item.hos_id,jdbcType=INTEGER}
			 and 
			copy_code = #{item.copy_code,jdbcType=VARCHAR}
			 and 
			receive_id = #{item.receive_id,jdbcType=INTEGER}
			
		</foreach>
	</update>
	
	<delete id="deleteMatAdvice" parameterType="java.util.Map">
	
		DELETE FROM MAT_ADVICE WHERE
		group_id = #{group_id,jdbcType=INTEGER}   and 
		hos_id = #{hos_id,jdbcType=INTEGER}   and 
		copy_code = #{copy_code,jdbcType=VARCHAR}   and 
		receive_id = #{receive_id,jdbcType=VARCHAR}
	</delete>
	<delete id="deleteBatchMatAdvice" parameterType="java.util.List">
		DELETE FROM MAT_ADVICE WHERE
			<foreach collection="list" index="index" item="item" open="(" separator="or" close=")">
				group_id = #{item.group_id,jdbcType=INTEGER}
				 and 
				hos_id = #{item.hos_id,jdbcType=INTEGER}
				 and 
				copy_code = #{item.copy_code,jdbcType=VARCHAR}
				 and 
				receive_id = #{item.receive_id,jdbcType=VARCHAR}
			</foreach>
	
	</delete>
	<select id="queryMatAdvice" parameterType="java.util.Map" resultMap="advice" >
	
		SELECT 
			ma.group_id,
			ma.hos_id,
			ma.copy_code,
			ma.receive_id,
			ma.charge_date,
			ma.advice_no,
			ma.charge_item_id,
			ccia.charge_item_name,
			ma.charge_detail_code,
			ma.inv_no,
			ma.inv_id,
			ma.inv_code,
			mid.inv_name,
			mid.inv_model,
			hu.unit_name,
			ma.batch_no,
			ma.bar_code,
			ma.charge_num,
			ma.out_num,
			ma.charge_price,
			ma.order_dept_id,
			ma.order_dept_no,
			ma.order_dept_code,
			hdd1.dept_name order_dept_name,
			ma.exec_dept_id,
			ma.exec_dept_no,
			ma.exec_dept_code,
			hdd2.dept_name exec_dept_name,
			ma.charge_code,
			ma.charge_name,
			ma.doctor_code,  
			ma.doctor_name,  
			ma.patient_name, 
			ma.hospital_no,  
			ma.bed_no,	    
			ma.doc_type,	    
			ma.message,	    
			ma.hx_flag,
			<if test="busi_code == '01'">
			hsd.sup_code,
			hsd.sup_name,
			</if>
			<!--  mom.out_no,-->
			ma.busi_code
		FROM MAT_ADVICE ma
		left join mat_inv_dict mid on
		ma.group_id = mid.group_id
		and ma.hos_id = mid.hos_id
		and ma.copy_code = mid.copy_code
		and ma.inv_id = mid.inv_id 
		and mid.is_stop='0' 
		left join hos_unit hu on
		mid.group_id = hu.group_id 
		and mid.hos_id = hu.hos_id 
		and mid.unit_code = hu.unit_code 
		left join hos_dept_dict hdd1 on
		ma.group_id = hdd1.group_id
		and ma.hos_id = hdd1.hos_id
		and ma.order_dept_id = hdd1.dept_id
		left join hos_dept_dict hdd2 on
		ma.group_id = hdd2.group_id
		and ma.hos_id = hdd2.hos_id
		and ma.exec_dept_id = hdd2.dept_id
		left join COST_CHARGE_ITEM_ARRT ccia on
		ma.group_id = ccia.group_id
		and ma.hos_id = ccia.hos_id
		and ma.copy_code = ccia.copy_code
		and ma.charge_item_id = ccia.charge_item_id
		
		<if test="busi_code == '02'">
			left join MAT_ADVICE_REF_OUT maro on
			ma.group_id = maro.group_id
			and ma.hos_id = maro.hos_id
			and ma.copy_code = maro.copy_code
			and ma.receive_id = maro.receive_id
			left join MAT_OUT_MAIN mom on 
			maro.group_id = mom.group_id
			and maro.hos_id = mom.hos_id
			and maro.copy_code = mom.copy_code
			and maro.out_id = mom.out_id
		</if>
		
		<if test="busi_code == '01'">
			left join MAT_ADVICE_REF_AFFI_OUT marao on
			ma.group_id = marao.group_id
			and ma.hos_id = marao.hos_id
			and ma.copy_code = marao.copy_code
			and ma.receive_id = marao.receive_id
			left join MAT_AFFI_OUT mom on 
			marao.group_id = mom.group_id
			and marao.hos_id = mom.hos_id
			and marao.copy_code = mom.copy_code
			and marao.out_id = mom.out_id
			left join mat_affi_out_detail maod on 
			marao.group_id = maod.group_id
			and marao.hos_id = maod.hos_id
			and marao.copy_code = maod.copy_code
			and marao.out_id = maod.out_id
			and marao.out_detail_id = maod.detail_id
			left join hos_sup_dict hsd on 
			maod.group_id = hsd.group_id
			and maod.hos_id = hsd.hos_id
			and maod.sup_id = hsd.sup_id
			and maod.sup_no = hsd.sup_no
		</if>
		
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND ma.group_id = #{group_id,jdbcType=INTEGER}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND ma.hos_id = #{hos_id,jdbcType=INTEGER}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND ma.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="receive_id != null and receive_id != ''">
		AND ma.receive_id = #{receive_id,jdbcType=VARCHAR}
		</if>
		<if test="charge_date_b != null and charge_date_b != '' and charge_date_e != null and charge_date_e != ''">
		AND ma.charge_date between to_date(#{charge_date_b},'yyyy/MM/dd') and to_date(#{charge_date_e},'yyyy/MM/dd')
		</if>
		<if test="advice_no != null and advice_no != ''">
		AND ma.advice_no = #{advice_no,jdbcType=VARCHAR}
		</if>
		<if test="charge_item_id != null and charge_item_id != ''">
		AND ma.charge_item_id = #{charge_item_id,jdbcType=INTEGER}
		</if>
		<if test="charge_detail_code != null and charge_detail_code != ''">
		AND ma.charge_detail_code = #{charge_detail_code,jdbcType=VARCHAR}
		</if>
		<if test="inv_no != null and inv_no != ''">
		AND ma.inv_no = #{inv_no,jdbcType=INTEGER}
		</if>
		<if test="inv_id != null and inv_id != ''">
		AND ma.inv_id = #{inv_id,jdbcType=INTEGER}
		</if>
		<if test="inv_code != null and inv_code != ''">
		AND ma.inv_code = #{inv_code,jdbcType=VARCHAR}
		</if>
		<if test="batch_no != null and batch_no != ''">
		AND ma.batch_no = #{batch_no,jdbcType=VARCHAR}
		</if>
		<if test="bar_code != null and bar_code != ''">
		AND ma.bar_code = #{bar_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_num != null and charge_num != ''">
		AND ma.charge_num = #{charge_num,jdbcType=INTEGER}
		</if>
		<if test="out_num != null and out_num != ''">
		AND ma.out_num = #{out_num,jdbcType=INTEGER}
		</if>
		<if test="charge_price != null and charge_price != ''">
		AND ma.charge_price = #{charge_price,jdbcType=INTEGER}
		</if>
		<if test="order_dept_id != null and order_dept_id != ''">
		AND ma.order_dept_id = #{order_dept_id,jdbcType=INTEGER}
		</if>
		<if test="order_dept_no != null and order_dept_no != ''">
		AND ma.order_dept_no = #{order_dept_no,jdbcType=INTEGER}
		</if>
		<if test="order_dept_code != null and order_dept_code != ''">
		AND ma.order_dept_code = #{order_dept_code,jdbcType=VARCHAR}
		</if>
		<if test="exec_dept_id != null and exec_dept_id != ''">
		AND ma.exec_dept_id = #{exec_dept_id,jdbcType=INTEGER}
		</if>
		<if test="exec_dept_no != null and exec_dept_no != ''">
		AND ma.exec_dept_no = #{exec_dept_no,jdbcType=INTEGER}
		</if>
		<if test="exec_dept_code != null and exec_dept_code != ''">
		AND ma.exec_dept_code = #{exec_dept_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_code != null and charge_code != ''">
		AND ma.charge_code = #{charge_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_name != null and charge_name != ''">
		AND ma.charge_name = #{charge_name,jdbcType=VARCHAR}
		</if>
		<if test="doctor_code != null and doctor_code != ''">
		AND ma.doctor_code = #{doctor_code,jdbcType=VARCHAR}
		</if>
		<if test="doctor_name != null and doctor_name != ''">
		AND ma.doctor_name = #{doctor_name,jdbcType=VARCHAR}
		</if>
		<if test="patient_name != null and patient_name != ''">
		AND ma.patient_name = #{patient_name,jdbcType=VARCHAR}
		</if>
		<if test="hospital_no != null and hospital_no != ''">
		AND ma.hospital_no = #{hospital_no,jdbcType=VARCHAR}
		</if>
		<if test="bed_no != null and bed_no != ''">
		AND ma.bed_no = #{bed_no,jdbcType=VARCHAR}
		</if>
		<if test="doc_type != null and doc_type != ''">
		AND ma.doc_type = #{doc_type,jdbcType=INTEGER}
		</if>
		<if test="message != null and message != ''">
		AND ma.message = #{message,jdbcType=VARCHAR}
		</if>
		<if test="hx_flag != null and hx_flag != ''">
		AND ma.hx_flag = #{hx_flag,jdbcType=INTEGER}
		</if>
		<if test="inv_model != null and inv_model != ''">
					and (mid.inv_model like '%${inv_model}%'
					     or upper(mid.spell_code) like '%${inv_model}%'
					     or upper(mid.wbx_code) like '%${inv_model}%'
					     or lower(mid.spell_code) like '%${inv_model}%'
					     or lower(mid.wbx_code) like '%${inv_model}%'
					     )
			</if>  
		<!-- <if test="busi_code != null and busi_code != ''">
		AND ma.busi_code = #{busi_code,jdbcType=VARCHAR}
		</if> -->
		</where>   
		order by ma.group_id asc
	</select>
	
	<select id="queryMatAdviceByInitDetail" parameterType="java.util.Map" resultMap="advice" >
	
		SELECT 
			  ma.receive_id,
		      hsd.store_id,
		      hsd.store_no,
		      ma.charge_date,
		      ma.advice_no,
		      <if test="is_order_dept == 0">
			      ma.order_dept_id dept_id,
			      ma.order_dept_no dept_no,
			      ma.order_dept_code dept_code,
			      hdd1.dept_name dept_name,
			      hsd.store_id,
			      hsd.store_no,
		      </if>
		      <if test="is_order_dept == 1">
			      ma.exec_dept_id dept_id,
			      ma.exec_dept_no dept_no,
			      ma.exec_dept_code dept_code,
			      hdd2.dept_name dept_name,
			      hsd.store_id,
			      hsd.store_no,
		      </if>
		      ma.charge_code,
		      ma.charge_name,
		      ma.doctor_code,  
		      ma.doctor_name,  
		      ma.patient_name, 
		      ma.hospital_no,  
		      ma.bed_no,      
		      ma.doc_type,
		      ma.charge_item_id,
		      ma.charge_detail_code,
		      ma.inv_id,
		      ma.inv_no,
		      ma.inv_code,
		      ma.batch_no,
		      ma.bar_code,
		      sum(ma.charge_num) charge_num,
		      sum(ma.out_num) out_num,
		      sum(ma.charge_price) charge_price,
		       ma.busi_code
		FROM MAT_ADVICE ma
		left join mat_inv_dict mid on
		ma.group_id = mid.group_id
		and ma.hos_id = mid.hos_id
		and ma.copy_code = mid.copy_code
		and ma.inv_id = mid.inv_id
			left join hos_unit hu on
			mid.group_id = hu.group_id
			and mid.hos_id = hu.hos_id
			and mid.unit_code = hu.unit_code
		left join hos_dept_dict hdd1 on
		ma.group_id = hdd1.group_id
		and ma.hos_id = hdd1.hos_id
		and ma.order_dept_id = hdd1.dept_id
		left join hos_dept_dict hdd2 on
		ma.group_id = hdd2.group_id
		and ma.hos_id = hdd2.hos_id
		and ma.exec_dept_id = hdd2.dept_id
		left join COST_CHARGE_ITEM_ARRT ccia on
		ma.group_id = ccia.group_id
		and ma.hos_id = ccia.hos_id
		and ma.copy_code = ccia.copy_code
		and ma.charge_item_id = ccia.charge_item_id
		
		<if test="is_order_dept == 0">
			left join MAT_REF_STORE_DEPT mrsd on
	    ma.group_id = mrsd.group_id
	    and ma.hos_id = mrsd.hos_id
	    and ma.copy_code = mrsd.copy_code
	    and ma.order_dept_id = mrsd.dept_id
	      	left join hos_store_dict hsd on
	      	mrsd.group_id = hsd.group_id
	      	and mrsd.hos_id = hsd.hos_id
	      	and mrsd.store_id = hsd.store_id
		</if>
		<if test="is_order_dept == 1">
			left join MAT_REF_STORE_DEPT mrsd on
	    ma.group_id = mrsd.group_id
	    and ma.hos_id = mrsd.hos_id
	    and ma.copy_code = mrsd.copy_code
	    and ma.exec_dept_id = mrsd.dept_id
	      	left join hos_store_dict hsd on
	      	mrsd.group_id = hsd.group_id
	      	and mrsd.hos_id = hsd.hos_id
	      	and mrsd.store_id = hsd.store_id
		</if>
	      	
		<if test="busi_code == '02'">
			left join MAT_ADVICE_REF_OUT maro on
			ma.group_id = maro.group_id
			and ma.hos_id = maro.hos_id
			and ma.copy_code = maro.copy_code
			and ma.receive_id = maro.receive_id
			left join MAT_OUT_MAIN mom on 
			maro.group_id = mom.group_id
			and maro.hos_id = mom.hos_id
			and maro.copy_code = mom.copy_code
			and maro.out_id = mom.out_id
		</if>
		
		<if test="busi_code == '01'">
			left join MAT_ADVICE_REF_AFFI_OUT marao on
			ma.group_id = marao.group_id
			and ma.hos_id = marao.hos_id
			and ma.copy_code = marao.copy_code
			and ma.receive_id = marao.receive_id
			left join MAT_AFFI_OUT mom on 
			marao.group_id = mom.group_id
			and marao.hos_id = mom.hos_id
			and marao.copy_code = mom.copy_code
			and marao.out_id = mom.out_id
		</if>
		
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND ma.group_id = #{group_id,jdbcType=INTEGER}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND ma.hos_id = #{hos_id,jdbcType=INTEGER}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND ma.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="receive_id != null and receive_id != ''">
		AND ma.receive_id = #{receive_id,jdbcType=VARCHAR}
		</if>
		<if test="charge_date_b != null and charge_date_b != '' and charge_date_e != null and charge_date_e != ''">
		AND ma.charge_date between to_date(#{charge_date_b},'yyyy/MM/dd') and to_date(#{charge_date_e},'yyyy/MM/dd')
		</if>
		<if test="advice_no != null and advice_no != ''">
		AND ma.advice_no = #{advice_no,jdbcType=VARCHAR}
		</if>
		<if test="charge_item_id != null and charge_item_id != ''">
		AND ma.charge_item_id = #{charge_item_id,jdbcType=INTEGER}
		</if>
		<if test="charge_detail_code != null and charge_detail_code != ''">
		AND ma.charge_detail_code = #{charge_detail_code,jdbcType=VARCHAR}
		</if>
		<if test="inv_no != null and inv_no != ''">
		AND ma.inv_no = #{inv_no,jdbcType=INTEGER}
		</if>
		<if test="inv_id != null and inv_id != ''">
		AND ma.inv_id = #{inv_id,jdbcType=INTEGER}
		</if>
		<if test="inv_code != null and inv_code != ''">
		AND ma.inv_code = #{inv_code,jdbcType=VARCHAR}
		</if>
		<if test="batch_no != null and batch_no != ''">
		AND ma.batch_no = #{batch_no,jdbcType=VARCHAR}
		</if>
		<if test="bar_code != null and bar_code != ''">
		AND ma.bar_code = #{bar_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_num != null and charge_num != ''">
		AND ma.charge_num = #{charge_num,jdbcType=INTEGER}
		</if>
		<if test="out_num != null and out_num != ''">
		AND ma.out_num = #{out_num,jdbcType=INTEGER}
		</if>
		<if test="charge_price != null and charge_price != ''">
		AND ma.charge_price = #{charge_price,jdbcType=INTEGER}
		</if>
		<if test="order_dept_id != null and order_dept_id != ''">
		AND ma.order_dept_id = #{order_dept_id,jdbcType=INTEGER}
		</if>
		<if test="order_dept_no != null and order_dept_no != ''">
		AND ma.order_dept_no = #{order_dept_no,jdbcType=INTEGER}
		</if>
		<if test="order_dept_code != null and order_dept_code != ''">
		AND ma.order_dept_code = #{order_dept_code,jdbcType=VARCHAR}
		</if>
		<if test="exec_dept_id != null and exec_dept_id != ''">
		AND ma.exec_dept_id = #{exec_dept_id,jdbcType=INTEGER}
		</if>
		<if test="exec_dept_no != null and exec_dept_no != ''">
		AND ma.exec_dept_no = #{exec_dept_no,jdbcType=INTEGER}
		</if>
		<if test="exec_dept_code != null and exec_dept_code != ''">
		AND ma.exec_dept_code = #{exec_dept_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_code != null and charge_code != ''">
		AND ma.charge_code = #{charge_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_name != null and charge_name != ''">
		AND ma.charge_name = #{charge_name,jdbcType=VARCHAR}
		</if>
		<if test="doctor_code != null and doctor_code != ''">
		AND ma.doctor_code = #{doctor_code,jdbcType=VARCHAR}
		</if>
		<if test="doctor_name != null and doctor_name != ''">
		AND ma.doctor_name = #{doctor_name,jdbcType=VARCHAR}
		</if>
		<if test="patient_name != null and patient_name != ''">
		AND ma.patient_name = #{patient_name,jdbcType=VARCHAR}
		</if>
		<if test="hospital_no != null and hospital_no != ''">
		AND ma.hospital_no = #{hospital_no,jdbcType=VARCHAR}
		</if>
		<if test="bed_no != null and bed_no != ''">
		AND ma.bed_no = #{bed_no,jdbcType=VARCHAR}
		</if>
		<if test="doc_type != null and doc_type != ''">
		AND ma.doc_type = #{doc_type,jdbcType=INTEGER}
		</if>
		<if test="message != null and message != ''">
		AND ma.message = #{message,jdbcType=VARCHAR}
		</if>
		<if test="hx_flag != null and hx_flag != ''">
		AND ma.hx_flag = #{hx_flag,jdbcType=INTEGER}
		</if>
		<if test="busi_code != null and busi_code != ''">
		AND ma.busi_code = #{busi_code,jdbcType=VARCHAR}
		</if>
		<if test="receive_ids != null and receive_ids != ''">
		AND ma.receive_id in (${receive_ids})
		</if>
		</where> 
		 group by ma.receive_id,hsd.store_id,hsd.store_no,ma.charge_date,ma.advice_no,
		  
		  <if test="is_order_dept == 0">
		  ma.order_dept_id,ma.order_dept_no,ma.order_dept_code,hdd1.dept_name,
		  </if>
		  <if test="is_order_dept == 1">  
		  ma.exec_dept_id,ma.exec_dept_no,ma.exec_dept_code,hdd2.dept_name,
		  </if>
		  
		  ma.charge_code,ma.charge_name,ma.doctor_code,ma.doctor_name,ma.patient_name,     
		  ma.hospital_no,ma.bed_no,ma.doc_type,ma.charge_item_id,ma.charge_detail_code,
		  ma.inv_id,ma.inv_no,ma.inv_code,ma.batch_no,ma.bar_code,ma.busi_code
		      
		order by ma.charge_code asc
	</select>
	
	
	
	<select id="queryMatAdviceByInit" parameterType="java.util.Map" resultMap="advice" >
	
		SELECT 
		      hsd.store_id,
		      hsd.store_no,
		      ma.charge_date,
		      ma.advice_no,
		      <if test="is_order_dept == 0">
			      ma.order_dept_id dept_id,
			      ma.order_dept_no dept_no,
			      ma.order_dept_code dept_code,
			      hdd1.dept_name dept_name,
			      hsd.store_id,
			      hsd.store_no,
		      </if>
		      <if test="is_order_dept == 1">
			      ma.exec_dept_id dept_id,
			      ma.exec_dept_no dept_no,
			      ma.exec_dept_code dept_code,
			      hdd2.dept_name dept_name,
			      hsd.store_id,
			      hsd.store_no,
		      </if>
		      ma.charge_code,
		      ma.charge_name,
		      ma.doctor_code,  
		      ma.doctor_name,  
		      ma.patient_name, 
		      ma.hospital_no,  
		      ma.bed_no,      
		      ma.doc_type,
		      ma.busi_code
		FROM MAT_ADVICE ma
		left join mat_inv_dict mid on
		ma.group_id = mid.group_id
		and ma.hos_id = mid.hos_id
		and ma.copy_code = mid.copy_code
		and ma.inv_id = mid.inv_id
			left join hos_unit hu on
			mid.group_id = hu.group_id
			and mid.hos_id = hu.hos_id
			and mid.unit_code = hu.unit_code
		left join hos_dept_dict hdd1 on
		ma.group_id = hdd1.group_id
		and ma.hos_id = hdd1.hos_id
		and ma.order_dept_id = hdd1.dept_id
		left join hos_dept_dict hdd2 on
		ma.group_id = hdd2.group_id
		and ma.hos_id = hdd2.hos_id
		and ma.exec_dept_id = hdd2.dept_id
		left join COST_CHARGE_ITEM_ARRT ccia on
		ma.group_id = ccia.group_id
		and ma.hos_id = ccia.hos_id
		and ma.copy_code = ccia.copy_code
		and ma.charge_item_id = ccia.charge_item_id
		
		<if test="is_order_dept == 0">
			left join MAT_REF_STORE_DEPT mrsd on
	    ma.group_id = mrsd.group_id
	    and ma.hos_id = mrsd.hos_id
	    and ma.copy_code = mrsd.copy_code
	    and ma.order_dept_id = mrsd.dept_id
	      	left join hos_store_dict hsd on
	      	mrsd.group_id = hsd.group_id
	      	and mrsd.hos_id = hsd.hos_id
	      	and mrsd.store_id = hsd.store_id
		</if>
		<if test="is_order_dept == 1">
			left join MAT_REF_STORE_DEPT mrsd on
	    ma.group_id = mrsd.group_id
	    and ma.hos_id = mrsd.hos_id
	    and ma.copy_code = mrsd.copy_code
	    and ma.exec_dept_id = mrsd.dept_id
	      	left join hos_store_dict hsd on
	      	mrsd.group_id = hsd.group_id
	      	and mrsd.hos_id = hsd.hos_id
	      	and mrsd.store_id = hsd.store_id
		</if>
	      	
		<if test="busi_code == '02'">
			left join MAT_ADVICE_REF_OUT maro on
			ma.group_id = maro.group_id
			and ma.hos_id = maro.hos_id
			and ma.copy_code = maro.copy_code
			and ma.receive_id = maro.receive_id
			left join MAT_OUT_MAIN mom on 
			maro.group_id = mom.group_id
			and maro.hos_id = mom.hos_id
			and maro.copy_code = mom.copy_code
			and maro.out_id = mom.out_id
		</if>
		
		<if test="busi_code == '01'">
			left join MAT_ADVICE_REF_AFFI_OUT marao on
			ma.group_id = marao.group_id
			and ma.hos_id = marao.hos_id
			and ma.copy_code = marao.copy_code
			and ma.receive_id = marao.receive_id
			left join MAT_AFFI_OUT mom on 
			marao.group_id = mom.group_id
			and marao.hos_id = mom.hos_id
			and marao.copy_code = mom.copy_code
			and marao.out_id = mom.out_id
		</if>
		
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND ma.group_id = #{group_id,jdbcType=INTEGER}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND ma.hos_id = #{hos_id,jdbcType=INTEGER}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND ma.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="receive_id != null and receive_id != ''">
		AND ma.receive_id = #{receive_id,jdbcType=VARCHAR}
		</if>
		<if test="charge_date_b != null and charge_date_b != '' and charge_date_e != null and charge_date_e != ''">
		AND ma.charge_date between to_date(#{charge_date_b},'yyyy/MM/dd') and to_date(#{charge_date_e},'yyyy/MM/dd')
		</if>
		<if test="advice_no != null and advice_no != ''">
		AND ma.advice_no = #{advice_no,jdbcType=VARCHAR}
		</if>
		<if test="charge_item_id != null and charge_item_id != ''">
		AND ma.charge_item_id = #{charge_item_id,jdbcType=INTEGER}
		</if>
		<if test="charge_detail_code != null and charge_detail_code != ''">
		AND ma.charge_detail_code = #{charge_detail_code,jdbcType=VARCHAR}
		</if>
		<if test="inv_no != null and inv_no != ''">
		AND ma.inv_no = #{inv_no,jdbcType=INTEGER}
		</if>
		<if test="inv_id != null and inv_id != ''">
		AND ma.inv_id = #{inv_id,jdbcType=INTEGER}
		</if>
		<if test="inv_code != null and inv_code != ''">
		AND ma.inv_code = #{inv_code,jdbcType=VARCHAR}
		</if>
		<if test="batch_no != null and batch_no != ''">
		AND ma.batch_no = #{batch_no,jdbcType=VARCHAR}
		</if>
		<if test="bar_code != null and bar_code != ''">
		AND ma.bar_code = #{bar_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_num != null and charge_num != ''">
		AND ma.charge_num = #{charge_num,jdbcType=INTEGER}
		</if>
		<if test="out_num != null and out_num != ''">
		AND ma.out_num = #{out_num,jdbcType=INTEGER}
		</if>
		<if test="charge_price != null and charge_price != ''">
		AND ma.charge_price = #{charge_price,jdbcType=INTEGER}
		</if>
		<if test="order_dept_id != null and order_dept_id != ''">
		AND ma.order_dept_id = #{order_dept_id,jdbcType=INTEGER}
		</if>
		<if test="order_dept_no != null and order_dept_no != ''">
		AND ma.order_dept_no = #{order_dept_no,jdbcType=INTEGER}
		</if>
		<if test="order_dept_code != null and order_dept_code != ''">
		AND ma.order_dept_code = #{order_dept_code,jdbcType=VARCHAR}
		</if>
		<if test="exec_dept_id != null and exec_dept_id != ''">
		AND ma.exec_dept_id = #{exec_dept_id,jdbcType=INTEGER}
		</if>
		<if test="exec_dept_no != null and exec_dept_no != ''">
		AND ma.exec_dept_no = #{exec_dept_no,jdbcType=INTEGER}
		</if>
		<if test="exec_dept_code != null and exec_dept_code != ''">
		AND ma.exec_dept_code = #{exec_dept_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_code != null and charge_code != ''">
		AND ma.charge_code = #{charge_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_name != null and charge_name != ''">
		AND ma.charge_name = #{charge_name,jdbcType=VARCHAR}
		</if>
		<if test="doctor_code != null and doctor_code != ''">
		AND ma.doctor_code = #{doctor_code,jdbcType=VARCHAR}
		</if>
		<if test="doctor_name != null and doctor_name != ''">
		AND ma.doctor_name = #{doctor_name,jdbcType=VARCHAR}
		</if>
		<if test="patient_name != null and patient_name != ''">
		AND ma.patient_name = #{patient_name,jdbcType=VARCHAR}
		</if>
		<if test="hospital_no != null and hospital_no != ''">
		AND ma.hospital_no = #{hospital_no,jdbcType=VARCHAR}
		</if>
		<if test="bed_no != null and bed_no != ''">
		AND ma.bed_no = #{bed_no,jdbcType=VARCHAR}
		</if>
		<if test="doc_type != null and doc_type != ''">
		AND ma.doc_type = #{doc_type,jdbcType=INTEGER}
		</if>
		<if test="message != null and message != ''">
		AND ma.message = #{message,jdbcType=VARCHAR}
		</if>
		<if test="hx_flag != null and hx_flag != ''">
		AND ma.hx_flag = #{hx_flag,jdbcType=INTEGER}
		</if>
		<if test="busi_code != null and busi_code != ''">
		AND ma.busi_code = #{busi_code,jdbcType=VARCHAR}
		</if>
		<if test="receive_ids != null and receive_ids != ''">
		AND ma.receive_id in (${receive_ids})
		</if>
		</where> 
		 group by hsd.store_id,hsd.store_no,ma.charge_date,ma.advice_no,
		  
		  <if test="is_order_dept == 0">
		  ma.order_dept_id,ma.order_dept_no,ma.order_dept_code,hdd1.dept_name,
		  </if>
		  <if test="is_order_dept == 1">  
		  ma.exec_dept_id,ma.exec_dept_no,ma.exec_dept_code,hdd2.dept_name,
		  </if>
		  
		  ma.charge_code,ma.charge_name,ma.doctor_code,ma.doctor_name,ma.patient_name,     
		  ma.hospital_no,ma.bed_no,ma.doc_type,ma.busi_code
		order by ma.charge_code asc
	</select>
	
	
	
	<select id="queryMatAdviceByCode" resultType="com.chd.hrp.mat.entity.MatAdvice" parameterType="java.util.Map" >
	
		SELECT 
		group_id,
		hos_id,
		copy_code,
		receive_id,
		charge_date,
		advice_no,
		charge_item_id,
		charge_detail_code,
		inv_no,
		inv_id,
		inv_code,
		batch_no,
		bar_code,
		charge_num,
		out_num,
		charge_price,
		order_dept_id,
		order_dept_no,
		order_dept_code,
		exec_dept_id,
		exec_dept_no,
		exec_dept_code,
		charge_code,
		charge_name,
		doctor_code,  
		doctor_name,  
		patient_name, 
		hospital_no,  
		bed_no,	    
		doc_type,	    
		message,	    
		hx_flag,
		busi_code
		FROM MAT_ADVICE 
		WHERE 
		group_id = #{group_id,jdbcType=INTEGER}   and 
		hos_id = #{hos_id,jdbcType=INTEGER}   and 
		copy_code = #{copy_code,jdbcType=VARCHAR}   and 
		receive_id = #{receive_id,jdbcType=VARCHAR}
	
	</select>
	<select id="queryMatAdviceByUniqueness" resultType="com.chd.hrp.mat.entity.MatAdvice" parameterType="java.util.Map" >
	
		SELECT 
		group_id,
		hos_id,
		copy_code,
		receive_id,
		charge_date,
		advice_no,
		charge_item_id,
		charge_detail_code,
		inv_no,
		inv_id,
		inv_code,
		batch_no,
		bar_code,
		charge_num,
		out_num,
		charge_price,
		order_dept_id,
		order_dept_no,
		order_dept_code,
		exec_dept_id,
		exec_dept_no,
		exec_dept_code,
		charge_code,
		charge_name,
		doctor_code,  
		doctor_name,  
		patient_name, 
		hospital_no,  
		bed_no,	    
		doc_type,	    
		message,	    
		hx_flag,
		busi_code
		FROM MAT_ADVICE 
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND group_id = #{group_id,jdbcType=INTEGER}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND hos_id = #{hos_id,jdbcType=INTEGER}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="receive_id != null and receive_id != ''">
		AND receive_id = #{receive_id,jdbcType=VARCHAR}
		</if>
		<if test="charge_date != null and charge_date != ''">
		AND charge_date = #{charge_date,jdbcType=DATE}
		</if>
		<if test="advice_no != null and advice_no != ''">
		AND advice_no = #{advice_no,jdbcType=VARCHAR}
		</if>
		<if test="charge_item_id != null and charge_item_id != ''">
		AND charge_item_id = #{charge_item_id,jdbcType=INTEGER}
		</if>
		<if test="charge_detail_code != null and charge_detail_code != ''">
		AND charge_detail_code = #{charge_detail_code,jdbcType=VARCHAR}
		</if>
		<if test="inv_no != null and inv_no != ''">
		AND inv_no = #{inv_no,jdbcType=INTEGER}
		</if>
		<if test="inv_id != null and inv_id != ''">
		AND inv_id = #{inv_id,jdbcType=INTEGER}
		</if>
		<if test="inv_code != null and inv_code != ''">
		AND inv_code = #{inv_code,jdbcType=VARCHAR}
		</if>
		<if test="batch_no != null and batch_no != ''">
		AND batch_no = #{batch_no,jdbcType=VARCHAR}
		</if>
		<if test="bar_code != null and bar_code != ''">
		AND bar_code = #{bar_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_num != null and charge_num != ''">
		AND charge_num = #{charge_num,jdbcType=INTEGER}
		</if>
		<if test="out_num != null and out_num != ''">
		AND out_num = #{out_num,jdbcType=INTEGER}
		</if>
		<if test="charge_price != null and charge_price != ''">
		AND charge_price = #{charge_price,jdbcType=INTEGER}
		</if>
		<if test="order_dept_id != null and order_dept_id != ''">
		AND order_dept_id = #{order_dept_id,jdbcType=INTEGER}
		</if>
		<if test="order_dept_no != null and order_dept_no != ''">
		AND order_dept_no = #{order_dept_no,jdbcType=INTEGER}
		</if>
		<if test="order_dept_code != null and order_dept_code != ''">
		AND order_dept_code = #{order_dept_code,jdbcType=VARCHAR}
		</if>
		<if test="exec_dept_id != null and exec_dept_id != ''">
		AND exec_dept_id = #{exec_dept_id,jdbcType=INTEGER}
		</if>
		<if test="exec_dept_no != null and exec_dept_no != ''">
		AND exec_dept_no = #{exec_dept_no,jdbcType=INTEGER}
		</if>
		<if test="exec_dept_code != null and exec_dept_code != ''">
		AND exec_dept_code = #{exec_dept_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_code != null and charge_code != ''">
		AND charge_code = #{charge_code,jdbcType=VARCHAR}
		</if>
		<if test="charge_name != null and charge_name != ''">
		AND charge_name = #{charge_name,jdbcType=VARCHAR}
		</if>
		<if test="doctor_code != null and doctor_code != ''">
		AND doctor_code = #{doctor_code,jdbcType=VARCHAR}
		</if>
		<if test="doctor_name != null and doctor_name != ''">
		AND doctor_name = #{doctor_name,jdbcType=VARCHAR}
		</if>
		<if test="patient_name != null and patient_name != ''">
		AND patient_name = #{patient_name,jdbcType=VARCHAR}
		</if>
		<if test="hospital_no != null and hospital_no != ''">
		AND hospital_no = #{hospital_no,jdbcType=VARCHAR}
		</if>
		<if test="bed_no != null and bed_no != ''">
		AND bed_no = #{bed_no,jdbcType=VARCHAR}
		</if>
		<if test="doc_type != null and doc_type != ''">
		AND doc_type = #{doc_type,jdbcType=INTEGER}
		</if>
		<if test="message != null and message != ''">
		AND message = #{message,jdbcType=VARCHAR}
		</if>
		<if test="hx_flag != null and hx_flag != ''">
		AND hx_flag = #{hx_flag,jdbcType=INTEGER}
		</if>
		<if test="busi_code != null and busi_code != ''">
		AND busi_code = #{busi_code,jdbcType=VARCHAR}
		</if>
		</where>   
		order by group_id asc
	</select>

</mapper>

