<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chd.hrp.ass.dao.card.AssCardLandMapper">
	 
	<resultMap id="assCardLand" type="com.chd.hrp.ass.entity.card.AssCardLand">      
		<result property="group_id" column="group_id"/>
		<result property="hos_id" column="hos_id"/>
		<result property="copy_code" column="copy_code"/>
		<result property="ass_card_no" column="ass_card_no"/> 
		<result property="ass_ori_card_no" column="ass_ori_card_no"/>
		<result property="ass_id" column="ass_id"/>
		<result property="ass_no" column="ass_no"/>
		<result property="gb_code" column="gb_code"/>
		<result property="ass_amount" column="ass_amount"/>
		<result property="price" column="price"/>
		<result property="depre_money" column="depre_money"/>
		<result property="manage_depre_money" column="manage_depre_money"/>
		<result property="cur_money" column="cur_money"/>
		<result property="fore_money" column="fore_money"/>
		<result property="buy_type" column="buy_type"/>
		<result property="unit_code" column="unit_code"/>
		<result property="use_state" column="use_state"/>
		<result property="is_depr" column="is_depr"/>
		<result property="depr_method" column="depr_method"/>
		<result property="acc_depre_amount" column="acc_depre_amount"/>
		<result property="is_manage_depre" column="is_manage_depre"/>
		<result property="manage_depr_method" column="manage_depr_method"/>
		<result property="manage_depre_amount" column="manage_depre_amount"/>
		<result property="ven_id" column="ven_id"/>
		<result property="ven_no" column="ven_no"/>
		<result property="pact_code" column="pact_code"/>
		<result property="land_area" column="land_area"/>
		<result property="cert_name" column="cert_name"/>
		<result property="cert_code" column="cert_code"/>
		<result property="cert_date" column="cert_date"/>
		<result property="prop_code" column="prop_code"/>
		<result property="land_no" column="land_no"/>
		<result property="gain_date" column="gain_date"/>
		<result property="run_date" column="run_date"/>
		<result property="location" column="location"/>
		<result property="dept_id" column="dept_id"/>
		<result property="dept_no" column="dept_no"/>
		<result property="land_source_code" column="land_source_code"/>
		<result property="note" column="note"/>
		<result property="ass_in_no" column="ass_in_no"/>
		<result property="in_date" column="in_date"/>
		<result property="is_init" column="is_init"/>
		<result property="dispose_type" column="dispose_type" />
		<result property="dispose_cost" column="dispose_cost" />
		<result property="dispose_income" column="dispose_income" />
		<result property="dispose_tax" column="dispose_tax" />
		<result property="simple_name" column="simple_name" />
		<result property="common_name" column="common_name" />
	</resultMap>
		
	<resultMap id="assCardLandMap" type="java.util.Map">
		<result property="id" column="id"/>
		<result property="group_id" column="group_id"/>
		<result property="hos_id" column="hos_id"/>
		<result property="copy_code" column="copy_code"/>
		<result property="ass_card_no" column="ass_card_no"/>
		<result property="ass_ori_card_no" column="ass_ori_card_no"/>
		<result property="ass_id" column="ass_id"/>
		<result property="ass_no" column="ass_no"/>
		<result property="gb_code" column="gb_code"/>
		<result property="ass_amount" column="ass_amount"/>
		<result property="price" column="price"/>
		<result property="depre_money" column="depre_money"/>
		<result property="manage_depre_money" column="manage_depre_money"/>
		<result property="cur_money" column="cur_money"/>
		<result property="fore_money" column="fore_money"/>
		<result property="buy_type" column="buy_type"/>
		<result property="unit_code" column="unit_code"/>
		<result property="use_state" column="use_state"/>
		<result property="is_depr" column="is_depr"/>
		<result property="depr_method" column="depr_method"/>
		<result property="acc_depre_amount" column="acc_depre_amount"/>
		<result property="is_manage_depre" column="is_manage_depre"/>
		<result property="manage_depr_method" column="manage_depr_method"/>
		<result property="manage_depre_amount" column="manage_depre_amount"/>
		<result property="ven_id" column="ven_id"/>
		<result property="ven_no" column="ven_no"/>
		<result property="pact_code" column="pact_code"/>
		<result property="land_area" column="land_area"/>
		<result property="cert_name" column="cert_name"/>
		<result property="cert_code" column="cert_code"/>
		<result property="cert_date" column="cert_date"/>
		<result property="prop_code" column="prop_code"/>
		<result property="land_no" column="land_no"/>
		<result property="gain_date" column="gain_date"/>
		<result property="run_date" column="run_date"/>
		<result property="location" column="location"/>
		<result property="dept_id" column="dept_id"/>
		<result property="dept_no" column="dept_no"/>
		<result property="land_source_code" column="land_source_code"/>
		<result property="note" column="note"/>
		<result property="ass_in_no" column="ass_in_no"/>
		<result property="in_date" column="in_date"/>
		<result property="is_init" column="is_init"/>
		<result property="dispose_type" column="dispose_type" />
		<result property="dispose_cost" column="dispose_cost" />
		<result property="dispose_income" column="dispose_income" />
		<result property="dispose_tax" column="dispose_tax" />
		<result property="dispose_date" column="dispose_date" />
		<result property="apply_date" column="apply_date" />
		<result property="add_depre_month" column="add_depre_month" />
		<result property="add_manage_month" column="add_manage_month" />
		<result property="simple_name" column="simple_name" />
		<result property="common_name" column="common_name" />
	</resultMap>
	
	<insert id="add" useGeneratedKeys="true" >
	
		INSERT INTO ASS_CARD_LAND (
		<trim suffix="" suffixOverrides=",">
		<if test="group_id != null and group_id != ''">
		group_id
		,
		</if>
		<if test="hos_id != null and hos_id != ''">
		hos_id
		,
		</if>
		<if test="copy_code != null and copy_code != ''">
		copy_code
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		ass_card_no
		,
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		ass_ori_card_no
		,
		</if>
		<if test="ass_id != null and ass_id != ''">
		ass_id
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		ass_no
		,
		</if>
		<if test="gb_code != null and gb_code != ''">
		gb_code
		,
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		ass_amount
		,
		</if>
		<if test="price != null and price != ''">
		price
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		depre_money
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		manage_depre_money
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		cur_money
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		fore_money
		,
		</if>
		<if test="buy_type != null and buy_type != ''">
		buy_type
		,
		</if>
		<if test="unit_code != null and unit_code != ''">
		unit_code
		,
		</if>
		<if test="use_state != null and use_state != ''">
		use_state
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		is_depr
		,
		</if>
		<if test="depr_method != null and depr_method != ''">
		depr_method
		,
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		acc_depre_amount
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		is_manage_depre
		,
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		manage_depr_method
		,
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		manage_depre_amount
		,
		</if>
		<if test="ven_id != null and ven_id != '' ">
		ven_id
		,
		</if>
		<if test="ven_no != null and ven_no != '' ">
		ven_no
		,
		</if>
		<if test="pact_code != null and pact_code != ''">
		pact_code
		,
		</if>
		<if test="land_area != null and land_area != ''">
		land_area
		,
		</if>
		<if test="cert_name != null and cert_name != ''">
		cert_name
		,
		</if>
		<if test="cert_code != null and cert_code != ''">
		cert_code
		,
		</if>
		<if test="cert_date != null and cert_date != ''">
		cert_date
		,
		</if>
		<if test="prop_code != null and prop_code != ''">
		prop_code
		,
		</if>
		<if test="land_no != null and land_no != ''">
		land_no
		,
		</if>
		<if test="gain_date != null and gain_date != ''">
		gain_date
		,
		</if>
		<if test="run_date != null and run_date != ''">
		run_date
		,
		</if>
		<if test="location != null and location != ''">
		location
		,
		</if>
		<if test="dept_id != null and dept_id != ''">
		dept_id
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		dept_no
		,
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		land_source_code
		,
		</if>
		<if test="note != null and note != ''">
		note
		,
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		ass_in_no
		,
		</if>
		<if test="in_date != null and in_date != ''">
		in_date
		,
		</if>
		<if test="is_init != null and is_init != ''">
		is_init
		,
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		dispose_type
		,
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		dispose_cost
		,
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		dispose_income
		,
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		dispose_tax
		,
		</if>
		<if test="reg_no != null and reg_no != ''">
		reg_no
		,
		</if>
		<if test="simple_name != null and simple_name != ''">
		simple_name
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		proc_store_id
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		proc_store_no
		,
		</if>
		<if test="common_name != null and common_name != ''">
		common_name
		,
		</if>
		<if test="six_type_code != null and six_type_code != ''">
		six_type_code
		,
		</if>
		</trim>
		) VALUES (
		<trim suffix="" suffixOverrides=",">
		<if test="group_id != null and group_id != ''">
		to_number(#{group_id})
		,
		</if>
		<if test="hos_id != null and hos_id != ''">
		to_number(#{hos_id})
		,
		</if>
		<if test="copy_code != null and copy_code != ''">
		#{copy_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		#{ass_card_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		#{ass_ori_card_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_id != null and ass_id != ''">
		to_number(#{ass_id})
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		to_number(#{ass_no})
		,
		</if>
		<if test="gb_code != null and gb_code != ''">
		#{gb_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		to_number(#{ass_amount})
		,
		</if>
		<if test="price != null and price != ''">
		to_number(#{price})
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		to_number(#{depre_money})
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		to_number(#{manage_depre_money})
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		to_number(#{cur_money})
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		to_number(#{fore_money})
		,
		</if>
		<if test="buy_type != null and buy_type != ''">
		#{buy_type,jdbcType=VARCHAR}
		,
		</if>
		<if test="unit_code != null and unit_code != ''">
		#{unit_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="use_state != null and use_state != ''">
		to_number(#{use_state})
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		to_number(#{is_depr})
		,
		</if>
		<if test="depr_method != null and depr_method != ''">
		#{depr_method,jdbcType=VARCHAR}
		,
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		to_number(#{acc_depre_amount})
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		to_number(#{is_manage_depre})
		,
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		#{manage_depr_method,jdbcType=VARCHAR}
		,
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		to_number(#{manage_depre_amount})
		,
		</if>
		<if test="ven_id != null and ven_id != '' ">
		to_number(#{ven_id})
		,
		</if>
		<if test="ven_no != null and ven_no != '' ">
		to_number(#{ven_no})
		,
		</if>
		<if test="pact_code != null and pact_code != ''">
		#{pact_code}
		,
		</if>
		<if test="land_area != null and land_area != ''">
		to_number(#{land_area})
		,
		</if>
		<if test="cert_name != null and cert_name != ''">
		#{cert_name,jdbcType=VARCHAR}
		,
		</if>
		<if test="cert_code != null and cert_code != ''">
		#{cert_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="cert_date != null and cert_date != ''">
		to_date(#{cert_date},'YYYY-MM-DD')
		,
		</if>
		<if test="prop_code != null and prop_code != ''">
		#{prop_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="land_no != null and land_no != ''">
		#{land_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="gain_date != null and gain_date != ''">
		to_date(#{gain_date},'YYYY-MM-DD')
		,
		</if>
		<if test="run_date != null and run_date != ''">
		to_date(#{run_date},'YYYY-MM-DD')
		,
		</if>
		<if test="location != null and location != ''">
		#{location,jdbcType=VARCHAR}
		,
		</if>
		<if test="dept_id != null and dept_id != ''">
		to_number(#{dept_id})
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		to_number(#{dept_no})
		,
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		#{land_source_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="note != null and note != ''">
		#{note,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		#{ass_in_no}
		,
		</if>
		<if test="in_date != null and in_date != ''">
		to_date(#{in_date},'YYYY-MM-DD')
		,
		</if>
		<if test="is_init != null and is_init != ''">
		to_number(#{is_init})
		,
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		to_number(#{dispose_type})
		,
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		to_number(#{dispose_cost})
		,
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		to_number(#{dispose_income})
		,
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		to_number(#{dispose_tax})
		,
		</if>
		<if test="reg_no != null and reg_no != ''">
		#{reg_no}
		,
		</if>
		<if test="simple_name != null and simple_name != ''">
		#{simple_name}
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		to_number(#{proc_store_id})
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		to_number(#{proc_store_no})
		,
		</if>
		<if test="common_name != null and common_name != ''">
		#{common_name}
		,
		</if>
		<if test="six_type_code != null and six_type_code != ''">
		#{six_type_code}
		,
		</if>
		</trim>		
		)
	
	</insert>
	<insert id="addBatch" parameterType="java.util.List" >
	
		INSERT INTO ASS_CARD_LAND (
		group_id
		,
		hos_id
		,
		copy_code
		,
		ass_card_no
		,
		ass_ori_card_no
		,
		ass_id
		,
		ass_no
		,
		gb_code
		,
		ass_amount
		,
		price
		,
		depre_money
		,
		manage_depre_money
		,
		cur_money
		,
		fore_money
		,
		buy_type
		,
		unit_code
		,
		use_state
		,
		dispose_type
		,
		dispose_cost
		,
		dispose_income
		,
		dispose_tax
		,
		is_depr
		,
		depr_method
		,
		acc_depre_amount
		,
		is_manage_depre
		,
		manage_depr_method
		,
		manage_depre_amount
		,
		ven_id
		,
		ven_no
		,
		pact_code
		,
		land_area
		,
		cert_name
		,
		cert_code
		,
		cert_date
		,
		prop_code
		,
		land_no
		,
		gain_date
		,
		run_date
		,
		location
		,
		dept_id
		,
		dept_no
		,
		land_source_code
		,
		note
		,
		ass_in_no
		,
		in_date
		,
		is_init
		,
		apply_date
		,
		add_depre_month
		,
		add_manage_month
		,
		reg_no
		,
		simple_name
		,
		proc_store_id
		,
		proc_store_no
		,
		common_name
		,
		six_type_code
		) select t.* from(
		<foreach collection="list" item="item" index="index" separator=" union all " >
			select 		
			#{item.group_id,jdbcType=INTEGER}
			,
			#{item.hos_id,jdbcType=INTEGER}
			,
			#{item.copy_code,jdbcType=VARCHAR}
			,
			#{item.ass_card_no,jdbcType=VARCHAR}
			,
			#{item.ass_ori_card_no,jdbcType=VARCHAR}
			,
			#{item.ass_id,jdbcType=INTEGER}
			,
			#{item.ass_no,jdbcType=INTEGER}
			,
			#{item.gb_code,jdbcType=VARCHAR}
			,
			#{item.ass_amount,jdbcType=INTEGER}
			,
			#{item.price,jdbcType=INTEGER}
			,
			#{item.depre_money,jdbcType=INTEGER}
			,
			#{item.manage_depre_money,jdbcType=INTEGER}
			,
			#{item.cur_money,jdbcType=INTEGER}
			,
			#{item.fore_money,jdbcType=INTEGER}
			,
			#{item.buy_type,jdbcType=VARCHAR}
			,
			#{item.unit_code,jdbcType=VARCHAR}
			,
			#{item.use_state,jdbcType=INTEGER}
			,
			#{item.dispose_type,jdbcType=INTEGER}
			,
			#{item.dispose_cost,jdbcType=INTEGER}
			,
			#{item.dispose_income,jdbcType=INTEGER}
			,
			#{item.dispose_tax,jdbcType=INTEGER}
			,
			#{item.is_depr,jdbcType=INTEGER}
			,
			#{item.depr_method,jdbcType=VARCHAR}
			,
			#{item.acc_depre_amount,jdbcType=INTEGER}
			,
			#{item.is_manage_depre,jdbcType=INTEGER}
			,
			#{item.manage_depr_method,jdbcType=VARCHAR}
			,
			#{item.manage_depre_amount,jdbcType=INTEGER}
			,
			#{item.ven_id,jdbcType=INTEGER}
			,
			#{item.ven_no,jdbcType=INTEGER}
			,
			#{item.pact_code,jdbcType=VARCHAR}
			,
			#{item.land_area,jdbcType=INTEGER}
			,
			#{item.cert_name,jdbcType=VARCHAR}
			,
			#{item.cert_code,jdbcType=VARCHAR}
			,
			#{item.cert_date,jdbcType=DATE}
			,
			#{item.prop_code,jdbcType=VARCHAR}
			,
			#{item.land_no,jdbcType=VARCHAR}
			,
			#{item.gain_date,jdbcType=DATE}
			,
			#{item.run_date,jdbcType=DATE}
			,
			#{item.location,jdbcType=VARCHAR}
			,
			#{item.dept_id,jdbcType=INTEGER}
			,
			#{item.dept_no,jdbcType=INTEGER}
			,
			#{item.land_source_code,jdbcType=VARCHAR}
			,
			#{item.note,jdbcType=VARCHAR}
			,
			#{item.ass_in_no,jdbcType=VARCHAR}
			,
			#{item.in_date,jdbcType=DATE}
			,
			#{item.is_init,jdbcType=INTEGER}
			,
			#{item.apply_date,jdbcType=DATE}
			,
			#{item.add_depre_month,jdbcType=INTEGER}
			,
			#{item.add_manage_month,jdbcType=INTEGER}
			,
			#{item.reg_no}
			,
			<if test="item.simple_name             != null and   item.simple_name           != ''">#{item.simple_name}, </if>   
			<if test="item.simple_name               == null or   item.simple_name           == ''">null simple_name,</if>
		
			<if test="item.proc_store_id             != null and   item.proc_store_id         != ''">#{item.proc_store_id}, </if>   
			<if test="item.proc_store_id          == null or   item.proc_store_id        == ''">null proc_store_id,</if>
			
			<if test="item.proc_store_no            != null and   item.proc_store_no         != ''">#{item.proc_store_no}, </if>   
			<if test="item.proc_store_no         == null or   item.proc_store_no       == ''">null proc_store_no,</if>
			
			<if test="item.common_name            != null and   item.common_name         != ''">#{item.common_name}, </if>   
			<if test="item.common_name         == null or   item.common_name       == ''">null common_name,</if>
			
		    <if test="item.six_type_code            != null and   item.six_type_code         != ''">#{item.six_type_code} </if>   
			<if test="item.six_type_code         == null or   item.six_type_code      == ''">null six_type_code</if>
			
		    from dual
		</foreach>
		)t
	</insert>
	
	<update id="update" parameterType="java.util.Map">
	
		UPDATE ass_card_land 
		<trim prefix="SET"  suffixOverrides=","> 
		ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
		,
		<if test="ass_id != null and ass_id != ''">
		ass_id = to_number(#{ass_id})
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		ass_no = to_number(#{ass_no})
		,
		</if>
		gb_code = #{gb_code,jdbcType=VARCHAR}
		,
		<if test="ass_amount != null and ass_amount != ''">
		ass_amount = to_number(#{ass_amount})
		,
		</if>
		<if test="price != null and price != ''">
		price = to_number(#{price})
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		depre_money = to_number(#{depre_money})
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		manage_depre_money = to_number(#{manage_depre_money})
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		cur_money = to_number(#{cur_money})
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		fore_money = to_number(#{fore_money})
		,
		</if>
		buy_type = #{buy_type,jdbcType=VARCHAR}
		,
		unit_code = #{unit_code,jdbcType=VARCHAR}
		,
		<if test="use_state != null and use_state != ''">
		use_state = to_number(#{use_state})
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		is_depr = to_number(#{is_depr})
		,
		</if>
		depr_method = #{depr_method,jdbcType=VARCHAR}
		,
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		acc_depre_amount = to_number(#{acc_depre_amount})
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		is_manage_depre = to_number(#{is_manage_depre})
		,
		</if>
		manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		,
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		manage_depre_amount = to_number(#{manage_depre_amount})
		,
		</if>
		<if test="ven_id != null and ven_id != ''">
		ven_id = to_number(#{ven_id})
		,
		</if>
		<if test="ven_no != null and ven_no != ''">
		ven_no = to_number(#{ven_no})
		,
		</if>
		<if test="pact_code != null and pact_code != ''">
		pact_code = #{pact_code}
		,
		</if>
		<if test="land_area != null and land_area != ''">
		land_area = to_number(#{land_area})
		,
		</if>
		cert_name = #{cert_name,jdbcType=VARCHAR}
		,
		cert_code = #{cert_code,jdbcType=VARCHAR}
		,
		<if test="cert_date != null and cert_date != ''">
		cert_date = to_date(#{cert_date},'YYYY-MM-DD')
		,
		</if>
		prop_code = #{prop_code,jdbcType=VARCHAR}
		,
		land_no = #{land_no,jdbcType=VARCHAR}
		,
		<if test="gain_date != null and gain_date != ''">
		gain_date = to_date(#{gain_date},'YYYY-MM-DD')
		,
		</if>
		<if test="run_date != null and run_date != ''">
		run_date = to_date(#{run_date},'YYYY-MM-DD')
		,
		</if>
		location = #{location,jdbcType=VARCHAR}
		,
		<if test="dept_id != null and dept_id != ''">
		dept_id = to_number(#{dept_id})
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		dept_no = to_number(#{dept_no})
		,
		</if>
		land_source_code = #{land_source_code,jdbcType=VARCHAR}
		,
		note = #{note,jdbcType=VARCHAR}
		,
		<if test="ass_in_no != null and ass_in_no != ''">
		ass_in_no = #{ass_in_no}
		,
		</if>
		<if test="in_date != null and in_date != ''">
		in_date = to_date(#{in_date},'YYYY-MM-DD')
		,
		</if>
		<if test="is_init != null and is_init != ''">
		is_init = to_number(#{is_init})
		,
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		dispose_type = to_number(#{dispose_type})
		,
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		dispose_cost = to_number(#{dispose_cost})
		,
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		dispose_income = to_number(#{dispose_income})
		,
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		dispose_tax = to_number(#{dispose_tax})
		,
		</if>
		<if test="reg_no != null and reg_no != ''">
		reg_no = #{reg_no}
		,
		</if>
		<if test="simple_name != null and simple_name != ''">
		simple_name = #{simple_name}
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		proc_store_id = to_number(#{proc_store_id})
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		proc_store_no = to_number(#{proc_store_no})
		,
		</if>
		<if test="common_name != null and common_name != ''">
		common_name = #{common_name}
		,
		</if>
		<if test="six_type_code != null and six_type_code != ''">
		six_type_code = #{six_type_code}
		,
		</if>
		</trim>
		where                    
			group_id = #{group_id}
			AND hos_id = #{hos_id}
			AND copy_code = #{copy_code}
			AND ass_card_no = #{ass_card_no}
	</update>
	<update id="updateBatch" parameterType="java.util.List">
	
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land 
			<trim prefix="SET"  suffixOverrides=","> 
			<if test="item.ass_ori_card_no != null and item.ass_ori_card_no != ''">
			ass_ori_card_no = #{item.ass_ori_card_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_id != null and item.ass_id != ''">
			ass_id = #{item.ass_id}
			,
			</if>
			<if test="item.ass_no != null and item.ass_no != ''">
			ass_no = #{item.ass_no}
			,
			</if>
			<if test="item.gb_code != null and item.gb_code != ''">
			gb_code = #{item.gb_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_amount != null and item.ass_amount != ''">
			ass_amount = #{item.ass_amount}
			,
			</if>
			<if test="item.price != null and item.price != ''">
			price = #{item.price}
			,
			</if>
			<if test="item.depre_money != null and item.depre_money != ''">
			depre_money = #{item.depre_money}
			,
			</if>
			<if test="item.manage_depre_money != null and item.manage_depre_money != ''">
			manage_depre_money = #{item.manage_depre_money}
			,
			</if>
			<if test="item.cur_money != null and item.cur_money != ''">
			cur_money = #{item.cur_money}
			,
			</if>
			<if test="item.fore_money != null and item.fore_money != ''">
			fore_money = #{item.fore_money}
			,
			</if>
			<if test="item.buy_type != null and item.buy_type != ''">
			buy_type = #{item.buy_type,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.unit_code != null and item.unit_code != ''">
			unit_code = #{item.unit_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.use_state != null and item.use_state != ''">
			use_state = #{item.use_state}
			,
			</if>
			<if test="item.is_depr != null and item.is_depr != ''">
			is_depr = #{item.is_depr}
			,
			</if>
			<if test="item.depr_method != null and item.depr_method != ''">
			depr_method = #{item.depr_method,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.acc_depre_amount != null and item.acc_depre_amount != ''">
			acc_depre_amount = #{item.acc_depre_amount}
			,
			</if>
			<if test="item.is_manage_depre != null and item.is_manage_depre != ''">
			is_manage_depre = #{item.is_manage_depre}
			,
			</if>
			<if test="item.manage_depr_method != null and item.manage_depr_method != ''">
			manage_depr_method = #{item.manage_depr_method,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.manage_depre_amount != null and item.manage_depre_amount != ''">
			manage_depre_amount = #{item.manage_depre_amount}
			,
			</if>
			<if test="item.ven_id != null and item.ven_id != ''">
			ven_id = #{item.ven_id}
			,
			</if>
			<if test="item.ven_no != null and item.ven_no != ''">
			ven_no = #{item.ven_no}
			,
			</if>
			<if test="item.pact_code != null and item.pact_code != ''">
			pact_code = #{item.pact_code}
			,
			</if>
			<if test="item.land_area != null and item.land_area != ''">
			land_area = #{item.land_area}
			,
			</if>
			<if test="item.cert_name != null and item.cert_name != ''">
			cert_name = #{item.cert_name,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.cert_code != null and item.cert_code != ''">
			cert_code = #{item.cert_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.cert_date != null and item.cert_date != ''">
			cert_date = #{item.cert_date,jdbcType=DATE}
			,
			</if>
			<if test="item.prop_code != null and item.prop_code != ''">
			prop_code = #{item.prop_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.land_no != null and item.land_no != ''">
			land_no = #{item.land_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.gain_date != null and item.gain_date != ''">
			gain_date = #{item.gain_date,jdbcType=DATE}
			,
			</if>
			<if test="item.run_date != null and item.run_date != ''">
			run_date = #{item.run_date,jdbcType=DATE}
			,
			</if>
			<if test="item.location != null and item.location != ''">
			location = #{item.location,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.dept_id != null and item.dept_id != ''">
			dept_id = #{item.dept_id}
			,
			</if>
			<if test="item.dept_no != null and item.dept_no != ''">
			dept_no = #{item.dept_no}
			,
			</if>
			<if test="item.land_source_code != null and item.land_source_code != ''">
			land_source_code = #{item.land_source_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.note != null and item.note != ''">
			note = #{item.note,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_in_no != null and item.ass_in_no != ''">
			ass_in_no = #{item.ass_in_no}
			,
			</if>
			<if test="item.in_date != null and item.in_date != ''">
			in_date = #{item.in_date,jdbcType=DATE}
			,
			</if>
			<if test="item.is_init != null and item.is_init != ''">
			is_init = #{item.is_init}
			,
			</if>
			<if test="item.dispose_type != null and item.dispose_type != ''">
			dispose_type = #{item.dispose_type}
			,
			</if>
			<if test="item.dispose_cost != null and item.dispose_cost != ''">
			dispose_cost = #{item.dispose_cost}
			,
			</if>
			<if test="item.dispose_income != null and item.dispose_income != ''">
			dispose_income = #{item.dispose_income}
			,
			</if>
			<if test="item.dispose_tax != null and item.dispose_tax != ''">
			dispose_tax = #{item.dispose_tax}
			,
			</if>
			<if test="item.reg_no != null and item.reg_no != ''">
			reg_no = #{item.reg_no}
			,
			</if>
			<if test="item.common_name != null and item.common_name != ''">
			common_name = #{item.common_name}
			,
			</if>
			<if test="item.six_type_code != null and item.six_type_code != ''">
			six_type_code = #{item.six_type_code,jdbcType=VARCHAR}
			,
			</if>
			</trim>
			<where>                     
			<if test="item.group_id != null and item.group_id != ''">
			AND group_id = #{item.group_id}
			</if>  
			<if test="item.hos_id != null and item.hos_id != ''">
			AND hos_id = #{item.hos_id}
			</if>  
			<if test="item.copy_code != null and item.copy_code != ''">
			AND copy_code = #{item.copy_code,jdbcType=VARCHAR}
			</if>  
			<if test="item.ass_card_no != null and item.ass_card_no != ''">
			AND ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
			</if>  
			</where>  			
		</foreach>
	</update>
	
	<delete id="delete" parameterType="java.util.Map">
	
		DELETE FROM ass_card_land 
		<where>                     
		AND group_id = #{group_id}
		AND hos_id = #{hos_id}
		AND copy_code = #{copy_code,jdbcType=VARCHAR}
		AND ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</where>  
	</delete>
	<delete id="deleteBatch" parameterType="java.util.List">
		DELETE FROM ass_card_land 
		<where>
			<foreach collection="list" index="index" item="item" open="(" separator="or" close=")">
				group_id = #{item.group_id}
				AND hos_id = #{item.hos_id}
				AND copy_code = #{item.copy_code,jdbcType=VARCHAR}
				AND ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
			</foreach>
	    </where>  
	</delete>
	<select id="query" parameterType="java.util.Map" resultMap="assCardLand" >
		select * from (
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.is_init,
			case when a.is_init = 0 then '否' when a.is_init = 1 then '是' else '' end is_init_name,
			a.dispose_type,  
			adt.dispose_type_name dispose_type_name,
			a.dispose_cost,  
			a.dispose_income,
			a.dispose_tax,
			a.dispose_date,
			a.apply_date,
			a.add_depre_month,
			a.add_manage_month,
			a.reg_no,
			cert.cert_inv_name reg_no_name,
		    a.simple_name,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name,
		    a.common_name,
		    a.six_type_code,
		    ats.type_name six_type_code_name
		FROM ASS_CARD_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    left join ass_dispose_type adt on
	    a.dispose_type = adt.dispose_type_code
	    and adt.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join ASS_CERT_MAIN cert on
	    a.group_id = cert.group_id
	    and a.hos_id = cert.hos_id
	    and a.copy_code = cert.copy_code
	    and a.reg_no = cert.cert_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
	    left join ASS_TYPE_SIXEIGHT ats on
	    a.group_id = ats.group_id
	    and a.hos_id = ats.hos_id
	    and a.copy_code = ats.copy_code
	    and a.six_type_code = ats.type_code
		
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		<if test="user_id != null and  user_id != ''">
			and exists (
				select 1
				from v_user_data_perm b
				where a.group_id = b.group_id
					and a.hos_id = b.hos_id
					and to_char(a.dept_id) = b.perm_code
					and user_id = #{user_id,jdbcType= INTEGER}
					and TABLE_CODE = upper('HOS_DEPT_DICT')
					and (b.is_read = 1
						or b.is_write = 1)
			)
			and exists (
				select 1 from v_user_data_perm b where
				a.group_id=b.group_id 
				and a.hos_id=b.hos_id 
				and to_char(a.proc_store_id) = b.perm_code
				and user_id=#{user_id}
				AND TABLE_CODE = upper('hos_store_dict')
				and  b.is_write = 1
				
	          	union all
	          	
	          	select 1 from v_user_data_perm b where
				a.group_id=b.group_id 
				and a.hos_id=b.hos_id 
				and to_char(a.proc_store_id) = b.perm_code
				and user_id=#{user_id}
				AND TABLE_CODE = upper('hos_store_dict')
				and b.is_read = 1
          	)
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = to_number(#{ass_id})
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = to_number(#{ass_no})
		</if>
		<if test="ass_type_id != null and ass_type_id != ''">
		AND atd.ass_type_id = to_number(#{ass_type_id})
		</if>
		<if test="fina_type_code != null and fina_type_code != ''">
		AND atd.acc_type_code = #{fina_type_code}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code like '%${gb_code}%'
		</if>
		<if test="ass_amount != null and ass_amount != '' and ass_amount != 0">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != '' and price != '0' and price != 0">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = to_number(#{use_state})
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = to_number(#{ven_id})
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = to_number(#{ven_no})
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="in_date_beg != null and in_date_beg != ''">
		AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
		</if>
		<if test="in_date_end != null and in_date_end != ''">
		AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
		</if>
		<if test="run_date_beg != null and run_date_beg != '' ">
		AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
		</if>
		<if test="run_date_end != null and run_date_end != ''">
		AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
		</if>
		<if test="location != null and location != ''">
		AND a.location like '%${location}%'
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = to_number(#{dept_id})
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note like '%${note}%'
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="is_init != null and is_init != ''">
		AND a.is_init = to_number(#{is_init})
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		AND a.dispose_type = to_number(#{dispose_type})
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		AND a.dispose_cost = #{dispose_cost,jdbcType=VARCHAR}
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		AND a.dispose_income = #{dispose_income}
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		AND a.dispose_tax = #{dispose_tax}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND (
			upper(a.ass_card_no) like upper('%${ass_card_no}%')
			or ad.ass_name like '%${ass_card_no}%'
			or ad.spell_code like '%${ass_card_no}%'
		)
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
		</if>
		<if test="simple_name != null and simple_name != ''">
		AND a.simple_name like '%${simple_name}%'
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		AND a.proc_store_id = to_number(#{proc_store_id})
		</if>
		<if test="common_name != null and common_name != ''">
		AND a.common_name like '%${common_name}%'
		</if>
		<if test="six_type_code != null and six_type_code != ''">
		AND a.six_type_code = #{six_type_code}
		</if>
		</where>   
		union all
		
		SELECT 
			null group_id,
			null hos_id,
			null copy_code,
			'合计' ass_card_no,
			null ass_ori_card_no,
			null ass_id,
			null ass_no,
			null ass_id_code,
		  null ass_id_name,
			null gb_code,
			null gb_code_name,
			null ass_amount,
			sum(a.price) price,
			sum(a.depre_money) depre_money,
			sum(a.manage_depre_money) manage_depre_money,
			sum(a.cur_money) cur_money,
			sum(a.fore_money) fore_money,
			null buy_type,
			null buy_type_name,
			null unit_code,
			null unit_code_name,
			null use_state,
			null use_state_name,
			null is_depr,
			null is_depr_name,
			null depr_method,
			null depr_method_name,
			null acc_depre_amount,
			null is_manage_depre,
			null is_manage_depre_name,
			null manage_depr_method,
			null manage_depr_method_name,
			null manage_depre_amount,
			null ven_id,
			null ven_no,
			null ven_id_code,
		  null ven_id_name,
			null pact_code,
			null land_area,
			null cert_name,
			null cert_code,
			null cert_date,
			null prop_code,
			null prop_code_name,
			null land_no,
			null gain_date,
			null run_date,
			null location,
			null dept_id,
			null dept_no,
			null dept_id_code,
		  null dept_id_name,
			null land_source_code,
			null land_source_code_name,
			null note,
			null ass_in_no,
			null in_date,
			null is_init,
			null is_init_name,
			null dispose_type,  
			null dispose_type_name,
			sum(a.dispose_cost) dispose_cost,  
			sum(a.dispose_income) dispose_income,
			sum(a.dispose_tax) dispose_tax,
			null dispose_date,
			null apply_date,
			null add_depre_month,
			null add_manage_month,
			null reg_no,
			null reg_no_name,
		  null simple_name,
			  null proc_store_id,
			  null proc_store_no,
			  null proc_store_id_code,
		      null proc_store_id_name,
		      null common_name,
		      null six_type_code,
		      null six_type_code_name
		FROM ASS_CARD_LAND a
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		<if test="user_id != null and  user_id != ''">
			and exists (
				select 1
				from v_user_data_perm b
				where a.group_id = b.group_id
					and a.hos_id = b.hos_id
					and to_char(a.dept_id) = b.perm_code
					and user_id = #{user_id,jdbcType= INTEGER}
					and TABLE_CODE = upper('HOS_DEPT_DICT')
					and (b.is_read = 1
						or b.is_write = 1)
			)
			and exists (
				select 1 from v_user_data_perm b where
				a.group_id=b.group_id 
				and a.hos_id=b.hos_id 
				and to_char(a.proc_store_id) = b.perm_code
				and user_id=#{user_id}
				AND TABLE_CODE = upper('hos_store_dict')
				and  b.is_write = 1
				
	          	union all
	          	
	          	select 1 from v_user_data_perm b where
				a.group_id=b.group_id 
				and a.hos_id=b.hos_id 
				and to_char(a.proc_store_id) = b.perm_code
				and user_id=#{user_id}
				AND TABLE_CODE = upper('hos_store_dict')
				and b.is_read = 1
          	)
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = to_number(#{ass_id})
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = to_number(#{ass_no})
		</if>
		<if test="ass_type_id != null and ass_type_id != ''">
		AND atd.ass_type_id = to_number(#{ass_type_id})
		</if>
		<if test="fina_type_code != null and fina_type_code != ''">
		AND atd.acc_type_code = #{fina_type_code}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code like '%${gb_code}%'
		</if>
		<if test="ass_amount != null and ass_amount != '' and ass_amount != 0">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != '' and price != '0' and price != 0">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = to_number(#{use_state})
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = to_number(#{ven_id})
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = to_number(#{ven_no})
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="in_date_beg != null and in_date_beg != ''">
		AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
		</if>
		<if test="in_date_end != null and in_date_end != ''">
		AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
		</if>
		<if test="run_date_beg != null and run_date_beg != '' ">
		AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
		</if>
		<if test="run_date_end != null and run_date_end != ''">
		AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
		</if>
		<if test="location != null and location != ''">
		AND a.location like '%${location}%'
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = to_number(#{dept_id})
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note like '%${note}%'
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="is_init != null and is_init != ''">
		AND a.is_init = to_number(#{is_init})
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		AND a.dispose_type = to_number(#{dispose_type})
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		AND a.dispose_cost = #{dispose_cost,jdbcType=VARCHAR}
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		AND a.dispose_income = #{dispose_income}
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		AND a.dispose_tax = #{dispose_tax}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND (
			upper(a.ass_card_no) like upper('%${ass_card_no}%')
			or ad.ass_name like '%${ass_card_no}%'
			or ad.spell_code like '%${ass_card_no}%'
		)
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or t.name like lower('%${ass_ori_card_no}%'))
		</if>
		<if test="simple_name != null and simple_name != ''">
		AND a.simple_name like '%${simple_name}%'
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		AND a.proc_store_id = to_number(#{proc_store_id})
		</if>
		<if test="common_name != null and common_name != ''">
		AND a.common_name like '%${common_name}%'
		</if>
		<if test="six_type_code != null and six_type_code != ''">
		AND a.six_type_code = #{six_type_code}
		</if>
		</where> 
		) t
		order by t.ass_card_no desc
	</select>
	<select id="queryPrint" parameterType="java.util.Map" resultMap="assCardLandMap" >
		select * from (
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.is_init,
			case when a.is_init = 0 then '否' when a.is_init = 1 then '是' else '' end is_init_name,
			a.dispose_type,  
			adt.dispose_type_name dispose_type_name,
			a.dispose_cost,  
			a.dispose_income,
			a.dispose_tax,
			a.dispose_date,
			a.apply_date,
			a.add_depre_month,
			a.add_manage_month,
			a.reg_no,
			cert.cert_inv_name reg_no_name,
		    a.simple_name,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name,
		    a.common_name,
		    a.six_type_code,
		    ats.type_name six_type_code_name
		FROM ASS_CARD_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    left join ass_dispose_type adt on
	    a.dispose_type = adt.dispose_type_code
	    and adt.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join ASS_CERT_MAIN cert on
	    a.group_id = cert.group_id
	    and a.hos_id = cert.hos_id
	    and a.copy_code = cert.copy_code
	    and a.reg_no = cert.cert_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
	    left join ASS_TYPE_SIXEIGHT ats on
	    a.group_id = ats.group_id
	    and a.hos_id = ats.hos_id
	    and a.copy_code = ats.copy_code
	    and a.six_type_code = ats.type_code
		
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		<if test="user_id != null and  user_id != ''">
			and exists (
				select 1
				from v_user_data_perm b
				where a.group_id = b.group_id
					and a.hos_id = b.hos_id
					and to_char(a.dept_id) = b.perm_code
					and user_id = #{user_id,jdbcType= INTEGER}
					and TABLE_CODE = upper('HOS_DEPT_DICT')
					and (b.is_read = 1
						or b.is_write = 1)
			)
			and exists (
				select 1 from v_user_data_perm b where
				a.group_id=b.group_id 
				and a.hos_id=b.hos_id 
				and to_char(a.proc_store_id) = b.perm_code
				and user_id=#{user_id}
				AND TABLE_CODE = upper('hos_store_dict')
				and  b.is_write = 1
				
	          	union all
	          	
	          	select 1 from v_user_data_perm b where
				a.group_id=b.group_id 
				and a.hos_id=b.hos_id 
				and to_char(a.proc_store_id) = b.perm_code
				and user_id=#{user_id}
				AND TABLE_CODE = upper('hos_store_dict')
				and b.is_read = 1
          	)
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = to_number(#{ass_id})
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = to_number(#{ass_no})
		</if>
		<if test="ass_type_id != null and ass_type_id != ''">
		AND atd.ass_type_id = to_number(#{ass_type_id})
		</if>
		<if test="fina_type_code != null and fina_type_code != ''">
		AND atd.acc_type_code = #{fina_type_code}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code like '%${gb_code}%'
		</if>
		<if test="ass_amount != null and ass_amount != '' and ass_amount != 0">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != '' and price != '0' and price != 0">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = to_number(#{use_state})
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = to_number(#{ven_id})
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = to_number(#{ven_no})
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="in_date_beg != null and in_date_beg != ''">
		AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
		</if>
		<if test="in_date_end != null and in_date_end != ''">
		AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
		</if>
		<if test="run_date_beg != null and run_date_beg != '' ">
		AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
		</if>
		<if test="run_date_end != null and run_date_end != ''">
		AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
		</if>
		<if test="location != null and location != ''">
		AND a.location like '%${location}%'
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = to_number(#{dept_id})
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note like '%${note}%'
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="is_init != null and is_init != ''">
		AND a.is_init = to_number(#{is_init})
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		AND a.dispose_type = to_number(#{dispose_type})
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		AND a.dispose_cost = #{dispose_cost,jdbcType=VARCHAR}
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		AND a.dispose_income = #{dispose_income}
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		AND a.dispose_tax = #{dispose_tax}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND (
			upper(a.ass_card_no) like upper('%${ass_card_no}%')
			or ad.ass_name like '%${ass_card_no}%'
			or ad.spell_code like '%${ass_card_no}%'
		)
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
		</if>
		<if test="simple_name != null and simple_name != ''">
		AND a.simple_name like '%${simple_name}%'
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		AND a.proc_store_id = to_number(#{proc_store_id})
		</if>
		<if test="common_name != null and common_name != ''">
		AND a.common_name like '%${common_name}%'
		</if>
		<if test="six_type_code != null and six_type_code != ''">
		AND a.six_type_code = #{six_type_code}
		</if>
		</where>   
		union all
		
		SELECT 
			null group_id,
			null hos_id,
			null copy_code,
			'合计' ass_card_no,
			null ass_ori_card_no,
			null ass_id,
			null ass_no,
			null ass_id_code,
		  null ass_id_name,
			null gb_code,
			null gb_code_name,
			null ass_amount,
			sum(a.price) price,
			sum(a.depre_money) depre_money,
			sum(a.manage_depre_money) manage_depre_money,
			sum(a.cur_money) cur_money,
			sum(a.fore_money) fore_money,
			null buy_type,
			null buy_type_name,
			null unit_code,
			null unit_code_name,
			null use_state,
			null use_state_name,
			null is_depr,
			null is_depr_name,
			null depr_method,
			null depr_method_name,
			null acc_depre_amount,
			null is_manage_depre,
			null is_manage_depre_name,
			null manage_depr_method,
			null manage_depr_method_name,
			null manage_depre_amount,
			null ven_id,
			null ven_no,
			null ven_id_code,
		  null ven_id_name,
			null pact_code,
			null land_area,
			null cert_name,
			null cert_code,
			null cert_date,
			null prop_code,
			null prop_code_name,
			null land_no,
			null gain_date,
			null run_date,
			null location,
			null dept_id,
			null dept_no,
			null dept_id_code,
		  null dept_id_name,
			null land_source_code,
			null land_source_code_name,
			null note,
			null ass_in_no,
			null in_date,
			null is_init,
			null is_init_name,
			null dispose_type,  
			null dispose_type_name,
			sum(a.dispose_cost) dispose_cost,  
			sum(a.dispose_income) dispose_income,
			sum(a.dispose_tax) dispose_tax,
			null dispose_date,
			null apply_date,
			null add_depre_month,
			null add_manage_month,
			null reg_no,
			null reg_no_name,
		  null simple_name,
			  null proc_store_id,
			  null proc_store_no,
			  null proc_store_id_code,
		      null proc_store_id_name,
		      null common_name,
		      null six_type_code,
		      null six_type_code_name
		FROM ASS_CARD_LAND a
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		<if test="user_id != null and  user_id != ''">
			and exists (
				select 1
				from v_user_data_perm b
				where a.group_id = b.group_id
					and a.hos_id = b.hos_id
					and to_char(a.dept_id) = b.perm_code
					and user_id = #{user_id,jdbcType= INTEGER}
					and TABLE_CODE = upper('HOS_DEPT_DICT')
					and (b.is_read = 1
						or b.is_write = 1)
			)
			and exists (
				select 1 from v_user_data_perm b where
				a.group_id=b.group_id 
				and a.hos_id=b.hos_id 
				and to_char(a.proc_store_id) = b.perm_code
				and user_id=#{user_id}
				AND TABLE_CODE = upper('hos_store_dict')
				and  b.is_write = 1
				
	          	union all
	          	
	          	select 1 from v_user_data_perm b where
				a.group_id=b.group_id 
				and a.hos_id=b.hos_id 
				and to_char(a.proc_store_id) = b.perm_code
				and user_id=#{user_id}
				AND TABLE_CODE = upper('hos_store_dict')
				and b.is_read = 1
          	)
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = to_number(#{ass_id})
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = to_number(#{ass_no})
		</if>
		<if test="ass_type_id != null and ass_type_id != ''">
		AND atd.ass_type_id = to_number(#{ass_type_id})
		</if>
		<if test="fina_type_code != null and fina_type_code != ''">
		AND atd.acc_type_code = #{fina_type_code}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code like '%${gb_code}%'
		</if>
		<if test="ass_amount != null and ass_amount != '' and ass_amount != 0">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != '' and price != '0' and price != 0">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = to_number(#{use_state})
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = to_number(#{ven_id})
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = to_number(#{ven_no})
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="in_date_beg != null and in_date_beg != ''">
		AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
		</if>
		<if test="in_date_end != null and in_date_end != ''">
		AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
		</if>
		<if test="run_date_beg != null and run_date_beg != '' ">
		AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
		</if>
		<if test="run_date_end != null and run_date_end != ''">
		AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
		</if>
		<if test="location != null and location != ''">
		AND a.location like '%${location}%'
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = to_number(#{dept_id})
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note like '%${note}%'
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="is_init != null and is_init != ''">
		AND a.is_init = to_number(#{is_init})
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		AND a.dispose_type = to_number(#{dispose_type})
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		AND a.dispose_cost = #{dispose_cost,jdbcType=VARCHAR}
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		AND a.dispose_income = #{dispose_income}
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		AND a.dispose_tax = #{dispose_tax}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND (
			upper(a.ass_card_no) like upper('%${ass_card_no}%')
			or ad.ass_name like '%${ass_card_no}%'
			or ad.spell_code like '%${ass_card_no}%'
		)
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or t.name like lower('%${ass_ori_card_no}%'))
		</if>
		<if test="simple_name != null and simple_name != ''">
		AND a.simple_name like '%${simple_name}%'
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		AND a.proc_store_id = to_number(#{proc_store_id})
		</if>
		<if test="common_name != null and common_name != ''">
		AND a.common_name like '%${common_name}%'
		</if>
		<if test="six_type_code != null and six_type_code != ''">
		AND a.six_type_code = #{six_type_code}
		</if>
		</where> 
		) t
		order by t.ass_card_no desc
	</select>
	<select id="queryByCode" resultMap="assCardLand"  parameterType="java.util.Map" >
	
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.is_init,
			case when a.is_init = 0 then '否' when a.is_init = 1 then '是' else '' end is_init_name,
			a.dispose_type,  
			adt.dispose_type_name dispose_type_name,
			a.dispose_cost,  
			a.dispose_income,
			a.dispose_tax,
			a.dispose_date,
			a.apply_date,
			a.add_depre_month,
			a.add_manage_month,
			a.reg_no ,
			cert.cert_inv_name reg_no_name,
		      a.simple_name,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name,
		    a.common_name,
		    a.six_type_code,
		    ats.type_name six_type_code_name
		FROM ASS_CARD_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    
	    left join ass_dispose_type adt on
	    a.dispose_type = adt.dispose_type_code
	    and adt.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join ASS_CERT_MAIN cert on
	    a.group_id = cert.group_id
	    and a.hos_id = cert.hos_id
	    and a.copy_code = cert.copy_code
	    and a.reg_no = cert.cert_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
	    left join ASS_TYPE_SIXEIGHT ats on
	    a.group_id = ats.group_id
	    and a.hos_id = ats.hos_id
	    and a.copy_code = ats.copy_code
	    and a.six_type_code = ats.type_code
	    
		WHERE 
		a.group_id = #{group_id} 
		and a.hos_id = #{hos_id} 
		and a.copy_code = #{copy_code,jdbcType=VARCHAR} 
		<if test="ass_card_no != null and ass_card_no != ''">
		and a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		
	</select>
	<select id="queryByUniqueness" resultMap="assCardLand"  parameterType="java.util.Map" >
	
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.is_init,
			case when a.is_init = 0 then '否' when a.is_init = 1 then '是' else '' end is_init_name,
			a.dispose_type,  
			adt.dispose_type_name dispose_type_name,
			a.dispose_cost,  
			a.dispose_income,
			a.dispose_tax,
			a.reg_no,
		      a.simple_name,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name,
		    a.common_name,
		    a.six_type_code,
		    ats.type_name six_type_code_name
		FROM ASS_CARD_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    
	    left join ass_dispose_type adt on
	    a.dispose_type = adt.dispose_type_code
	    and adt.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
	    left join ASS_TYPE_SIXEIGHT ats on
	    a.group_id = ats.group_id
	    and a.hos_id = ats.hos_id
	    and a.copy_code = ats.copy_code
	    and a.six_type_code = ats.type_code
	    
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND a.group_id = #{group_id}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND a.hos_id = #{hos_id}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND a.ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = #{ass_id}
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = #{ass_no}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code = #{gb_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != ''">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = #{use_state}
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = #{ven_id}
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = #{ven_no}
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="location != null and location != ''">
		AND a.location = #{location,jdbcType=VARCHAR}
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = #{dept_id}
		</if>
		<if test="dept_no != null and dept_no != ''">
		AND a.dept_no = #{dept_no}
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note = #{note,jdbcType=VARCHAR}
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="is_init != null and is_init != ''">
		AND a.is_init = #{is_init}
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		AND a.dispose_type = #{dispose_type,jdbcType=VARCHAR}
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		AND a.dispose_cost = #{dispose_cost,jdbcType=VARCHAR}
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		AND a.dispose_income = #{dispose_income}
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		AND a.dispose_tax = #{dispose_tax}
		</if>
		</where>   
		order by a.ass_card_no asc
	</select>
	<select id="queryExists" resultMap="assCardLand"  parameterType="java.util.Map" >
	
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.is_init,
			case when a.is_init = 0 then '否' when a.is_init = 1 then '是' else '' end is_init_name,
			a.dispose_type,  
			adt.dispose_type_name dispose_type_name,
			a.dispose_cost,  
			a.dispose_income,
			a.dispose_tax,
			a.reg_no,
		      a.simple_name,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name,
		    a.common_name,
		    a.six_type_code,
		    ats.type_name six_type_code_name
		FROM ASS_CARD_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    left join ass_dispose_type adt on
	    a.dispose_type = adt.dispose_type_code
	    and adt.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
	    left join ASS_TYPE_SIXEIGHT ats on
	    a.group_id = ats.group_id
	    and a.hos_id = ats.hos_id
	    and a.copy_code = ats.copy_code
	    and a.six_type_code = ats.type_code
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND a.group_id = #{group_id}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND a.hos_id = #{hos_id}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND a.ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = #{ass_id}
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = #{ass_no}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code = #{gb_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != ''">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = #{use_state}
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = #{ven_id}
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = #{ven_no}
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="location != null and location != ''">
		AND a.location = #{location,jdbcType=VARCHAR}
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = #{dept_id}
		</if>
		<if test="dept_no != null and dept_no != ''">
		AND a.dept_no = #{dept_no}
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note = #{note,jdbcType=VARCHAR}
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="is_init != null and is_init != ''">
		AND a.is_init = #{is_init}
		</if>
		<if test="dispose_type != null and dispose_type != ''">
		AND a.dispose_type = #{dispose_type,jdbcType=VARCHAR}
		</if>
		<if test="dispose_cost != null and dispose_cost != ''">
		AND a.dispose_cost = #{dispose_cost,jdbcType=VARCHAR}
		</if>
		<if test="dispose_income != null and dispose_income != ''">
		AND a.dispose_income = #{dispose_income}
		</if>
		<if test="dispose_tax != null and dispose_tax != ''">
		AND a.dispose_tax = #{dispose_tax}
		</if>
		</where>   
		order by a.ass_card_no asc
	</select>
	
	<select id="queryByAssInNo" parameterType="java.util.Map" resultMap="assCardLandMap" >
	
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.is_init,
			case when a.is_init = 0 then '否' when a.is_init = 1 then '是' else '' end is_init_name,
			a.dispose_type,  
			adt.dispose_type_name dispose_type_name,
			a.dispose_cost,  
			a.dispose_income,
			a.dispose_tax,
			a.reg_no,
		      a.simple_name,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name,
		    a.common_name,
		    a.six_type_code,
		    ats.type_name six_type_code_name  
		FROM ASS_CARD_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    
	    left join ass_dispose_type adt on
	    a.dispose_type = adt.dispose_type_code
	    and adt.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
	    left join ASS_TYPE_SIXEIGHT ats on
	    a.group_id = ats.group_id
	    and a.hos_id = ats.hos_id
	    and a.copy_code = ats.copy_code
	    and a.six_type_code = ats.type_code
		
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code}
		<if test="ass_card_no != null and ass_card_no != ''">
		AND a.ass_card_no = #{ass_card_no}
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = #{ass_id}
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = #{ass_no}
		</if>
		</where>   
		order by a.ass_card_no desc
	</select>
	
	<!-- 采购入库和其他入库入库确认 -->
	<update id="updateConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				in_date = to_date(#{item.in_date},'YYYY-MM-DD'),
				use_state = 1
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_in_no = #{item.ass_in_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 采购退库和其他退库确认 -->
	<update id="updateBackConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dispose_type = #{item.dispose_type},
				use_state = 7,
				dispose_date = to_date(#{item.dispose_date},'YYYY-MM-DD')
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 资产调拨确认 -->
	<update id="updateSellOutConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dispose_type = #{item.dispose_type},
				use_state = 7,
				dispose_date = to_date(#{item.dispose_date},'YYYY-MM-DD'),
				dispose_income = #{item.dispose_income},
				dispose_tax = #{item.dispose_tax}
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 科室领用 确认-->
	<update id="updateDeptGetOutConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				is_dept = 1,
				run_date = to_date(#{item.run_date},'YYYY-MM-DD'),
				dept_id = #{item.dept_id},
				dept_no = #{item.dept_no}
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!--资产改造申报 确认-->
	<update id="updateAssRemouldAlandConfirmState" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				use_state= '6',
				dispose_type='51'
				where                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
		</foreach>
	</update>
		<!-- 改造记录确认 -->
	<update id="updateRemouldRLandConfirm" parameterType="java.util.Map">
	<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dispose_type = '51',
				use_state = 7<!-- ,
				dispose_date = to_date(#{item.dispose_date},'yyyy-MM-dd') -->
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
				</foreach>
	</update>
	
	
	
	<!-- 科室退库 确认-->
	<update id="updateDeptBackOutConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				is_dept = 0,
				store_id = #{item.store_id},
				store_no = #{item.store_no},
				dept_id = #{item.dept_id},
				dept_no = #{item.dept_no}
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 仓库转移确认 -->
	<update id="updateTranStoreConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				store_id = #{item.store_id},
				store_no = #{item.store_no},
				dept_id = #{item.dept_id},
				dept_no = #{item.dept_no}
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 科室转移确认 -->
	<update id="updateTranDeptConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dept_id = #{item.dept_id},
				dept_no = #{item.dept_no}
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 原值变动 -->
	<update id="updatePriceConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				price = #{item.price},
				cur_money = #{item.price} - nvl(depre_money,0),
				change_price = nvl(change_price,0) + #{item.change_price}
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 累计折旧变动 -->
	<update id="updateDepreMoneyConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				depre_money = nvl(#{item.new_depre},0),
				cur_money = nvl(price,0) - nvl(#{item.new_depre},0),
				change_depre = nvl(change_depre,0) + #{item.change_depre}
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<delete id="deleteBatchByAssInNo" parameterType="java.util.List">
		DELETE FROM ass_card_land 
		<where>
			<foreach collection="list" index="index" item="item" open="(" separator="or" close=")">
				group_id = #{item.group_id}
				AND hos_id = #{item.hos_id}
				AND copy_code = #{item.copy_code}
				AND ass_in_no = #{item.ass_in_no}
				<if test="item.ass_id != null and item.ass_id != ''">
				AND ass_id = #{item.ass_id}
				</if>
				<if test="item.ass_no != null and item.ass_no != ''">
				AND ass_no = #{item.ass_no}
				</if>
			</foreach>
	    </where>  
	</delete>
	
	<select id="queryCardExistsByAssInNo" parameterType="java.util.Map" resultType="java.lang.Integer">
		select count(1) from ASS_CARD_LAND
		   where 	group_id = #{group_id}
				AND hos_id = #{hos_id}
				AND copy_code = #{copy_code}
				AND ass_in_no = #{ass_in_no}
				<if test="ass_id != null and ass_id != ''">
				AND ass_id = #{ass_id}
				</if>
				<if test="ass_no != null and ass_no != ''">
				AND ass_no = #{ass_no}
				</if>
	</select>
	
	<!-- 资产处置申报确认 -->
	<update id="updateDisposalApplyConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dispose_type = #{item.dispose_type},
				use_state = 6,
				apply_date = to_date(#{item.apply_date},'YYYY-MM-DD')
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 资产处置记录确认 -->
	<update id="updateDisposalRecordConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dispose_type = #{item.dispose_type},
				use_state = 7,
				dispose_date = to_date(#{item.dispose_date},'YYYY-MM-DD'),
				dispose_cost = #{item.dispose_cost,jdbcType=INTEGER},
				dispose_income = #{item.dispose_income,jdbcType=INTEGER},
				dispose_tax = #{item.dispose_tax,jdbcType=INTEGER}
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 改造竣工确认 -->
	<update id="updateRemouldFLandConfirm" parameterType="java.util.Map">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dispose_type = '51',
				use_state = 7,
				dispose_date = to_date(#{item.dispose_date},'yyyy-MM-dd')
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
				</foreach>
	</update>
	
	<!-- 资产盘亏申报确认 -->
	<update id="updateChkApplyConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dispose_type = #{item.dispose_type},
				use_state = 6,
				apply_date = to_date(#{item.apply_date},'YYYY-MM-DD')
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	
	<!-- 资产盘亏记录确认 -->
	<update id="updateChkRecordConfirm" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ass_card_land set
				dispose_type = #{item.dispose_type},
				use_state = 7,
				dispose_date = to_date(#{item.dispose_date},'YYYY-MM-DD')
				<where>                     
					group_id = #{item.group_id}
					AND hos_id = #{item.hos_id}
					AND copy_code = #{item.copy_code}
					AND ass_card_no = #{item.ass_card_no}
				</where> 
		</foreach>
	</update>
	<!-- 维修申请确认 -->
	<update id="updateAssCardStateByCardNo" parameterType="java.util.Map">
		UPDATE ass_card_land 
		set
		use_state = 2
		where                    
			group_id = #{group_id}
			AND hos_id = #{hos_id}
			AND copy_code = #{copy_code}
			AND ass_card_no = #{ass_card_no}
	</update>
	<!-- 维修记录确认派工 -->
	<update id="updateAssCardStateByRecCardNo" parameterType="java.util.Map">
			UPDATE ass_card_land set
				use_state = #{use_state}
				<where>                     
					group_id = #{group_id}
					AND hos_id = #{hos_id}
					AND copy_code = #{copy_code}
					AND ass_card_no = #{ass_card_no}
				</where> 
	</update>
	
	<select id="queryAssCardLandPrint" resultType="java.util.Map"  parameterType="java.util.Map">
		select 
			a.ass_card_no id,
			a.ass_card_no,
			a.ass_ori_card_no,
			ad.ass_code,
			ad.ass_name ass_id,
			a.land_area,
			hu.unit_name unit_code,
			a.land_no,
			a.cert_name,
			a.cert_code,
			to_char(a.cert_date,'yyyy-mm-dd') cert_date,
			apd.prop_name prop_code,
			asd.land_source_name land_source_code,
			hsd.sup_name ven_id,
			hsd.sup_code ven_code,
			pact_code,
			abtd.bus_type_name buy_type,
			abtd.bus_type_code,
			a.ass_in_no,
			to_char(a.in_date,'yyyy-mm-dd') in_date,
			to_char(a.gain_date,'yyyy-mm-dd') gain_date,
			to_char(a.run_date,'yyyy-mm-dd') run_date,
			a.location,
			hdd.dept_code,
			hdd.dept_name dept_id,
			case when a.is_depr = 0  then '否' when a.is_depr = 1 then '是' else '' end is_depr,
			admd1.ass_depre_code,
			admd1.ass_depre_name depr_method,
			a.acc_depre_amount,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre,
			admd2.ass_depre_code,
			admd2.ass_depre_name manage_depr_method,
			a.manage_depre_amount,
			to_char(a.price,'FM999,999,990.00') price,
			to_char(a.depre_money,'FM999,999,990.00') depre_money,
			to_char(a.manage_depre_money,'FM999,999,990.00') manage_depre_money,
			to_char(a.cur_money,'FM999,999,990.00') cur_money,
			a.add_depre_month,
			a.add_manage_month,
			case when a.is_init = 0 then '否' when a.is_init = 1 then '是' else '' end is_init,
			a.gb_code,
			acus.state_code,
			acus.state_name use_state,
			adt.dispose_type_code,
			adt.dispose_type_name dispose_type,
			to_char(a.dispose_cost,'FM999,999,990.00') dispose_cost,
			to_char(a.dispose_income,'FM999,999,990.00') dispose_income,
			to_char(a.dispose_tax,'FM999,999,990.00') dispose_tax,
			a.note,
			a.reg_no,
			a.common_name
	from ass_card_land a
	
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    left join ass_dispose_type adt on
	    a.dispose_type = adt.dispose_type_code
	    and adt.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
		where a.group_id = #{group_id}
					AND a.hos_id = #{hos_id}
					AND a.copy_code = #{copy_code}
					<if test="is_list == true">
						AND a.ass_card_no in (${ass_card_nos})
					</if>
					<if test="is_list == false">
						AND a.ass_card_no = #{ass_card_no}
					</if>
		order by a.ass_card_no desc 			
	</select>
	<select id="queryByAssCardOldNo" parameterType="java.util.Map" resultMap="assCardLand" >
		
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.is_init,
			case when a.is_init = 0 then '否' when a.is_init = 1 then '是' else '' end is_init_name,
			a.dispose_type,  
			adt.dispose_type_name dispose_type_name,
			a.dispose_cost,  
			a.dispose_income,
			a.dispose_tax,
			a.dispose_date,
			a.apply_date,
			a.add_depre_month,
			a.add_manage_month,
			a.reg_no,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name,
		    a.common_name,
		    a.six_type_code,
		    ats.type_name six_type_code_name 
		FROM ASS_CARD_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
	    
	    left join ass_dispose_type adt on
	    a.dispose_type = adt.dispose_type_code
	    and adt.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
	    left join ASS_TYPE_SIXEIGHT ats on
	    a.group_id = ats.group_id
	    and a.hos_id = ats.hos_id
	    and a.copy_code = ats.copy_code
	    and a.six_type_code = ats.type_code
		
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
			<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
			AND a.ass_card_no =#{ass_ori_card_no,jdbcType=VARCHAR}
			</if>
			<!-- <if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND a.ass_card_no  in 
      <foreach collection="ass_ori_card_no" index="index" item="item" open="(" separator="," close=")" >    
                #{item,jdbcType=VARCHAR}   
            </foreach> 
		</if> -->
		</where>   
		
	
	</select>
	
	<select id="queryStore" parameterType="java.util.List" resultMap="assCardLandMap">
	select t1.group_id, t1.hos_id, t1.copy_code, t1.check_plan_no, t1.check_no
			, t1.ass_card_no, t1.ass_id, t1.ass_no, acc_amount, check_amount
	    , pl_amount, pl_reason, ass_name, ass_type_name,t5.*
    from ASS_CHECK_DETAIL_Land t1
    left join ass_no_dict t2 on t1.group_id = t2.group_id
    and t1.hos_id = t2.hos_id
    and t1.copy_code = t2.copy_code
    and t1.ass_id = t2.ass_id
    and t1.ass_no = t2.ass_no
    and t2.is_stop = 0 
    left join ass_type_dict t3 on t3.group_id = t2.group_id
    and t3.hos_id = t2.hos_id
    and t3.copy_code = t2.copy_code
    and t3.ass_type_id = t2.ass_type_id
    and t3.is_last = 1
    and t3.is_stop = 0 
    left join ass_card_Land t5 on t1.group_id = t5.group_id
    and t1.hos_id = t5.hos_id
    and t1.copy_code = t5.copy_code
    and t1.ass_card_no = t5.ass_card_no 
      left join ASS_CHECK_LAND t6 on t1.check_no = t6.check_no
    and t1.check_plan_no = t6.check_plan_no 
	
	where
	<foreach item="item" index="index" collection="list" open="(" separator="or" close=")"> 
    	<if test="item.hos_id != null and item.hos_id !=null">
			t1.hos_id = #{item.hos_id,jdbcType=INTEGER}  and	
		</if>
		<if test="item.check_no != null and item.check_no !=null">
			t1.check_no = #{item.check_no,jdbcType=INTEGER}  and	
		</if>
		<if test="item.group_id != null and item.group_id !=null">
			t1.group_id =#{item.group_id,jdbcType=INTEGER} 	and	
		</if>	
		<if test="item.copy_code != null and item.copy_code !=null">	
			t1.copy_code =#{item.copy_code,jdbcType=VARCHAR} and	
		</if>
		
		<if test="item.ass_id != null and item.ass_id !=null">
			t1.ass_id = #{item.ass_id,jdbcType=INTEGER}  and	
		</if>
		<if test="item.ass_no != null and item.ass_no !=null">	
			t1.ass_no = #{item.ass_no,jdbcType=VARCHAR} and	
		</if>
		<if test="item.ass_card_no != null and item.ass_card_no !=null">	
			t1.ass_card_no = #{item.ass_card_no,jdbcType=INTEGER} and 
		</if>
		<if test="item.pl_amount != null and item.pl_amount !=null">	
			t1.pl_amount &gt; 0 and 
		</if>	
		<if test="item.check_plan_no != null and item.check_plan_no !=null">	
			t1.check_plan_no =#{item.check_plan_no,jdbcType=VARCHAR}
		</if>
	</foreach>
	
	
	
	</select>
</mapper>

