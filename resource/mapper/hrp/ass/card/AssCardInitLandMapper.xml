<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<mapper namespace="com.chd.hrp.ass.dao.card.AssCardInitLandMapper">
	
	<resultMap id="assCardInitLand" type="com.chd.hrp.ass.entity.card.AssCardInitLand">  
		<result property="group_id" column="group_id"/>
		<result property="hos_id" column="hos_id"/>
		<result property="copy_code" column="copy_code"/>
		<result property="ass_card_no" column="ass_card_no"/>
		<result property="ass_ori_card_no" column="ass_ori_card_no"/>
		<result property="ass_id" column="ass_id"/>
		<result property="ass_no" column="ass_no"/>
		<result property="gb_code" column="gb_code"/>
		<result property="gb_code_name" column="gb_code_name"/>
		<result property="ass_amount" column="ass_amount"/>
		<result property="price" column="price"/>
		<result property="depre_money" column="depre_money"/>
		<result property="manage_depre_money" column="manage_depre_money"/>
		<result property="cur_money" column="cur_money"/>
		<result property="fore_money" column="fore_money"/>
		<result property="buy_type" column="buy_type"/>
		<result property="unit_code" column="unit_code"/>
		<result property="use_state" column="use_state"/>
		<result property="is_depr" column="is_depr"/>
		<result property="depr_method" column="depr_method"/>
		<result property="acc_depre_amount" column="acc_depre_amount"/>
		<result property="is_manage_depre" column="is_manage_depre"/>
		<result property="manage_depr_method" column="manage_depr_method"/>
		<result property="manage_depre_amount" column="manage_depre_amount"/>
		<result property="ven_id" column="ven_id"/>
		<result property="ven_no" column="ven_no"/>
		<result property="pact_code" column="pact_code"/>
		<result property="land_area" column="land_area"/>
		<result property="cert_name" column="cert_name"/>
		<result property="cert_code" column="cert_code"/>
		<result property="cert_date" column="cert_date"/>
		<result property="prop_code" column="prop_code"/>
		<result property="land_no" column="land_no"/>
		<result property="gain_date" column="gain_date"/>
		<result property="run_date" column="run_date"/>
		<result property="location" column="location"/>
		<result property="dept_id" column="dept_id"/>
		<result property="dept_no" column="dept_no"/>
		<result property="land_source_code" column="land_source_code"/>
		<result property="note" column="note"/>
		<result property="ass_in_no" column="ass_in_no"/>
		<result property="in_date" column="in_date"/>
		<result property="add_depre_month" column="add_depre_month" />
		<result property="add_manage_month" column="add_manage_month" />
	</resultMap>
		
	<resultMap id="assCardInitLandMap" type="java.util.Map">
		<result property="group_id" column="group_id"/>
		<result property="hos_id" column="hos_id"/>
		<result property="copy_code" column="copy_code"/>
		<result property="ass_card_no" column="ass_card_no"/>
		<result property="ass_ori_card_no" column="ass_ori_card_no"/>
		<result property="ass_id" column="ass_id"/>
		<result property="ass_no" column="ass_no"/>
		<result property="gb_code" column="gb_code"/>
		<result property="gb_code_name" column="gb_code_name"/>
		<result property="ass_amount" column="ass_amount"/>
		<result property="price" column="price"/>
		<result property="depre_money" column="depre_money"/>
		<result property="manage_depre_money" column="manage_depre_money"/>
		<result property="cur_money" column="cur_money"/>
		<result property="fore_money" column="fore_money"/>
		<result property="buy_type" column="buy_type"/>
		<result property="unit_code" column="unit_code"/>
		<result property="use_state" column="use_state"/>
		<result property="is_depr" column="is_depr"/>
		<result property="depr_method" column="depr_method"/>
		<result property="acc_depre_amount" column="acc_depre_amount"/>
		<result property="is_manage_depre" column="is_manage_depre"/>
		<result property="manage_depr_method" column="manage_depr_method"/>
		<result property="manage_depre_amount" column="manage_depre_amount"/>
		<result property="ven_id" column="ven_id"/>
		<result property="ven_no" column="ven_no"/>
		<result property="pact_code" column="pact_code"/>
		<result property="land_area" column="land_area"/>
		<result property="cert_name" column="cert_name"/>
		<result property="cert_code" column="cert_code"/>
		<result property="cert_date" column="cert_date"/>
		<result property="prop_code" column="prop_code"/>
		<result property="land_no" column="land_no"/>
		<result property="gain_date" column="gain_date"/>
		<result property="run_date" column="run_date"/>
		<result property="location" column="location"/>
		<result property="dept_id" column="dept_id"/>
		<result property="dept_no" column="dept_no"/>
		<result property="land_source_code" column="land_source_code"/>
		<result property="note" column="note"/>
		<result property="ass_in_no" column="ass_in_no"/>
		<result property="in_date" column="in_date"/>
		<result property="add_depre_month" column="add_depre_month" />
		<result property="add_manage_month" column="add_manage_month" />
	</resultMap>
	
	<insert id="add" useGeneratedKeys="true" >
	
		INSERT INTO ASS_CARD_INIT_LAND (
		<trim suffix="" suffixOverrides=",">
		<if test="group_id != null and group_id != ''">
		group_id
		,
		</if>
		<if test="hos_id != null and hos_id != ''">
		hos_id
		,
		</if>
		<if test="copy_code != null and copy_code != ''">
		copy_code
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		ass_card_no
		,
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		ass_ori_card_no
		,
		</if>
		<if test="ass_id != null and ass_id != ''">
		ass_id
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		ass_no
		,
		</if>
		<if test="gb_code != null and gb_code != ''">
		gb_code
		,
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		ass_amount
		,
		</if>
		<if test="price != null and price != ''">
		price
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		depre_money
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		manage_depre_money
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		cur_money
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		fore_money
		,
		</if>
		<if test="buy_type != null and buy_type != ''">
		buy_type
		,
		</if>
		<if test="unit_code != null and unit_code != ''">
		unit_code
		,
		</if>
		<if test="use_state != null and use_state != ''">
		use_state
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		is_depr
		,
		</if>
		<if test="depr_method != null and depr_method != ''">
		depr_method
		,
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		acc_depre_amount
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		is_manage_depre
		,
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		manage_depr_method
		,
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		manage_depre_amount
		,
		</if>
		<if test="ven_id != null and ven_id != '' ">
		ven_id
		,
		</if>
		<if test="ven_no != null and ven_no != '' ">
		ven_no
		,
		</if>
		<if test="pact_code != null and pact_code != ''">
		pact_code
		,
		</if>
		<if test="land_area != null and land_area != ''">
		land_area
		,
		</if>
		<if test="cert_name != null and cert_name != ''">
		cert_name
		,
		</if>
		<if test="cert_code != null and cert_code != ''">
		cert_code
		,
		</if>
		<if test="cert_date != null and cert_date != ''">
		cert_date
		,
		</if>
		<if test="prop_code != null and prop_code != ''">
		prop_code
		,
		</if>
		<if test="land_no != null and land_no != ''">
		land_no
		,
		</if>
		<if test="gain_date != null and gain_date != ''">
		gain_date
		,
		</if>
		<if test="run_date != null and run_date != ''">
		run_date
		,
		</if>
		<if test="location != null and location != ''">
		location
		,
		</if>
		<if test="dept_id != null and dept_id != ''">
		dept_id
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		dept_no
		,
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		land_source_code
		,
		</if>
		<if test="note != null and note != ''">
		note
		,
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		ass_in_no
		,
		</if>
		<if test="in_date != null and in_date != ''">
		in_date
		,
		</if>
		<if test="add_depre_month != null and add_depre_month != ''">
		add_depre_month
		,
		</if>
		<if test="add_manage_month != null and add_manage_month != ''">
		add_manage_month
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		proc_store_id
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		proc_store_no
		,
		</if>
		</trim>
		) VALUES (
		<trim suffix="" suffixOverrides=",">
		<if test="group_id != null and group_id != ''">
		to_number(#{group_id})
		,
		</if>
		<if test="hos_id != null and hos_id != ''">
		to_number(#{hos_id})
		,
		</if>
		<if test="copy_code != null and copy_code != ''">
		#{copy_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		#{ass_card_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		#{ass_ori_card_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_id != null and ass_id != ''">
		to_number(#{ass_id})
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		to_number(#{ass_no})
		,
		</if>
		<if test="gb_code != null and gb_code != ''">
		#{gb_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		to_number(#{ass_amount})
		,
		</if>
		<if test="price != null and price != ''">
		to_number(#{price})
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		to_number(#{depre_money})
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		to_number(#{manage_depre_money})
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		to_number(#{cur_money})
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		to_number(#{fore_money})
		,
		</if>
		<if test="buy_type != null and buy_type != ''">
		#{buy_type,jdbcType=VARCHAR}
		,
		</if>
		<if test="unit_code != null and unit_code != ''">
		#{unit_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="use_state != null and use_state != ''">
		to_number(#{use_state})
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		to_number(#{is_depr})
		,
		</if>
		<if test="depr_method != null and depr_method != ''">
		#{depr_method,jdbcType=VARCHAR}
		,
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		to_number(#{acc_depre_amount})
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		to_number(#{is_manage_depre})
		,
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		#{manage_depr_method,jdbcType=VARCHAR}
		,
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		to_number(#{manage_depre_amount})
		,
		</if>
		<if test="ven_id != null and ven_id != '' ">
		to_number(#{ven_id})
		,
		</if>
		<if test="ven_no != null and ven_no != '' ">
		to_number(#{ven_no})
		,
		</if>
		<if test="pact_code != null and pact_codepact_code != ''">
		#{pact_code}
		,
		</if>
		<if test="land_area != null and land_area != ''">
		to_number(#{land_area})
		,
		</if>
		<if test="cert_name != null and cert_name != ''">
		#{cert_name,jdbcType=VARCHAR}
		,
		</if>
		<if test="cert_code != null and cert_code != ''">
		#{cert_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="cert_date != null and cert_date != ''">
		to_date(#{cert_date},'YYYY-MM-DD')
		,
		</if>
		<if test="prop_code != null and prop_code != ''">
		#{prop_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="land_no != null and land_no != ''">
		#{land_no,jdbcType=VARCHAR}
		,
		</if>
		<if test="gain_date != null and gain_date != ''">
		to_date(#{gain_date},'YYYY-MM-DD')
		,
		</if>
		<if test="run_date != null and run_date != ''">
		to_date(#{run_date},'YYYY-MM-DD')
		,
		</if>
		<if test="location != null and location != ''">
		#{location,jdbcType=VARCHAR}
		,
		</if>
		<if test="dept_id != null and dept_id != ''">
		to_number(#{dept_id})
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		to_number(#{dept_no})
		,
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		#{land_source_code,jdbcType=VARCHAR}
		,
		</if>
		<if test="note != null and note != ''">
		#{note,jdbcType=VARCHAR}
		,
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		#{ass_in_no}
		,
		</if>
		<if test="in_date != null and in_date != ''">
		to_date(#{in_date},'YYYY-MM-DD')
		,
		</if>
		<if test="add_depre_month != null and add_depre_month != ''">
		to_number(#{add_depre_month})
		,
		</if>
		<if test="add_manage_month != null and add_manage_month != ''">
		to_number(#{add_manage_month})
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		to_number(#{proc_store_id})
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		to_number(#{proc_store_no})
		,
		</if>
		</trim>		
		)
	
	</insert>
	<insert id="addBatch" parameterType="java.util.List" >
	
		INSERT INTO ASS_CARD_INIT_LAND (
		group_id
		,
		hos_id
		,
		copy_code
		,
		ass_card_no
		,
		ass_ori_card_no
		,
		ass_id
		,
		ass_no
		,
		gb_code
		,
		ass_amount
		,
		price
		,
		depre_money
		,
		manage_depre_money
		,
		cur_money
		,
		fore_money
		,
		buy_type
		,
		unit_code
		,
		use_state
		,
		is_depr
		,
		depr_method
		,
		acc_depre_amount
		,
		is_manage_depre
		,
		manage_depr_method
		,
		manage_depre_amount
		,
		ven_id
		,
		ven_no
		,
		pact_code
		,
		land_area
		,
		cert_name
		,
		cert_code
		,
		cert_date
		,
		prop_code
		,
		land_no
		,
		gain_date
		,
		run_date
		,
		location
		,
		dept_id
		,
		dept_no
		,
		land_source_code
		,
		note
		,
		ass_in_no
		,
		in_date
		,
		proc_store_id
		,
		proc_store_no
		) select  t.* from(
		<foreach collection="list" item="item" index="index" separator=" union all " >
			select 		
			#{item.group_id}
			,
			#{item.hos_id}
			,
			#{item.copy_code,jdbcType=VARCHAR}
			,
			#{item.ass_card_no,jdbcType=VARCHAR}
			,
			#{item.ass_ori_card_no,jdbcType=VARCHAR}
			,
			#{item.ass_id}
			,
			#{item.ass_no}
			,
			#{item.gb_code,jdbcType=VARCHAR}
			,
			#{item.ass_amount}
			,
			#{item.price}
			,
			#{item.depre_money}
			,
			#{item.manage_depre_money}
			,
			#{item.cur_money}
			,
			#{item.fore_money}
			,
			#{item.buy_type,jdbcType=VARCHAR}
			,
			#{item.unit_code,jdbcType=VARCHAR}
			,
			#{item.use_state}
			,
			#{item.is_depr}
			,
			#{item.depr_method,jdbcType=VARCHAR}
			,
			#{item.acc_depre_amount}
			,
			#{item.is_manage_depre}
			,
			#{item.manage_depr_method,jdbcType=VARCHAR}
			,
			#{item.manage_depre_amount}
			,
			#{item.ven_id}
			,
			#{item.ven_no}
			,
			#{item.pact_code}
			,
			#{item.land_area}
			,
			#{item.cert_name,jdbcType=VARCHAR}
			,
			#{item.cert_code,jdbcType=VARCHAR}
			,
			#{item.cert_date,jdbcType=DATE}
			,
			#{item.prop_code,jdbcType=VARCHAR}
			,
			#{item.land_no,jdbcType=VARCHAR}
			,
			#{item.gain_date,jdbcType=DATE}
			,
			#{item.run_date,jdbcType=DATE}
			,
			#{item.location,jdbcType=VARCHAR}
			,
			#{item.dept_id}
			,
			#{item.dept_no}
			,
			#{item.land_source_code,jdbcType=VARCHAR}
			,
			#{item.note,jdbcType=VARCHAR}
			,
			#{item.ass_in_no}
			,
			#{item.in_date,jdbcType=DATE}
			,
		
			<if test="item.proc_store_id             != null and   item.proc_store_id         != ''">#{item.proc_store_id}, </if>   
			<if test="item.proc_store_id          == null or   item.proc_store_id        == ''">null proc_store_id,</if>
			
			<if test="item.proc_store_no            != null and   item.proc_store_no         != ''">#{item.proc_store_no} </if>   
			<if test="item.proc_store_no         == null or   item.proc_store_no       == ''">null proc_store_no</if>
		    from dual
		</foreach>
		)t
	</insert>
	
	<update id="update" parameterType="java.util.Map">
	
		UPDATE ASS_CARD_INIT_LAND 
		<trim prefix="SET"  suffixOverrides=","> 
		ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
		,
		<if test="ass_id != null and ass_id != ''">
		ass_id = to_number(#{ass_id})
		,
		</if>
		<if test="ass_no != null and ass_no != ''">
		ass_no = to_number(#{ass_no})
		,
		</if>
		gb_code = #{gb_code,jdbcType=VARCHAR}
		,
		<if test="ass_amount != null and ass_amount != ''">
		ass_amount = to_number(#{ass_amount})
		,
		</if>
		<if test="price != null and price != ''">
		price = to_number(#{price})
		,
		</if>
		<if test="depre_money != null and depre_money != ''">
		depre_money = to_number(#{depre_money})
		,
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		manage_depre_money = to_number(#{manage_depre_money})
		,
		</if>
		<if test="cur_money != null and cur_money != ''">
		cur_money = to_number(#{cur_money})
		,
		</if>
		<if test="fore_money != null and fore_money != ''">
		fore_money = to_number(#{fore_money})
		,
		</if>
		buy_type = #{buy_type,jdbcType=VARCHAR}
		,
		unit_code = #{unit_code,jdbcType=VARCHAR}
		,
		<if test="use_state != null and use_state != ''">
		use_state = to_number(#{use_state})
		,
		</if>
		<if test="is_depr != null and is_depr != ''">
		is_depr = to_number(#{is_depr})
		,
		</if>
		depr_method = #{depr_method,jdbcType=VARCHAR}
		,
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		acc_depre_amount = to_number(#{acc_depre_amount})
		,
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		is_manage_depre = to_number(#{is_manage_depre})
		,
		</if>
		manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		,
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		manage_depre_amount = to_number(#{manage_depre_amount})
		,
		</if>
		<if test="ven_id != null and ven_id != ''">
		ven_id = to_number(#{ven_id})
		,
		</if>
		<if test="ven_no != null and ven_no != ''">
		ven_no = to_number(#{ven_no})
		,
		</if>
		<if test="pact_code != null and pact_code != ''">
		pact_code = #{pact_code}
		,
		</if>
		<if test="land_area != null and land_area != ''">
		land_area = to_number(#{land_area})
		,
		</if>
		cert_name = #{cert_name,jdbcType=VARCHAR}
		,
		cert_code = #{cert_code,jdbcType=VARCHAR}
		,
		<if test="cert_date != null and cert_date != ''">
		cert_date = to_date(#{cert_date},'YYYY-MM-DD')
		,
		</if>
		prop_code = #{prop_code,jdbcType=VARCHAR}
		,
		land_no = #{land_no,jdbcType=VARCHAR}
		,
		<if test="gain_date != null and gain_date != ''">
		gain_date = to_date(#{gain_date},'YYYY-MM-DD')
		,
		</if>
		<if test="run_date != null and run_date != ''">
		run_date = to_date(#{run_date},'YYYY-MM-DD')
		,
		</if>
		location = #{location,jdbcType=VARCHAR}
		,
		<if test="dept_id != null and dept_id != ''">
		dept_id = to_number(#{dept_id})
		,
		</if>
		<if test="dept_no != null and dept_no != ''">
		dept_no = to_number(#{dept_no})
		,
		</if>
		land_source_code = #{land_source_code,jdbcType=VARCHAR}
		,
		note = #{note,jdbcType=VARCHAR}
		,
		<if test="ass_in_no != null and ass_in_no != ''">
		ass_in_no = #{ass_in_no}
		,
		</if>
		<if test="in_date != null and in_date != ''">
		in_date = to_date(#{in_date},'YYYY-MM-DD')
		,
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		proc_store_id = to_number(#{proc_store_id})
		,
		</if>
		<if test="proc_store_no != null and proc_store_no != ''">
		proc_store_no = to_number(#{proc_store_no})
		,
		</if>
		</trim>
		where                    
			group_id = #{group_id}
			AND hos_id = #{hos_id}
			AND copy_code = #{copy_code}
			AND ass_card_no = #{ass_card_no}
	</update>
	<update id="updateBatch" parameterType="java.util.List">
	
		<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";" >
			UPDATE ASS_CARD_INIT_LAND 
			<trim prefix="SET"  suffixOverrides=","> 
			<if test="item.ass_ori_card_no != null and item.ass_ori_card_no != ''">
			ass_ori_card_no = #{item.ass_ori_card_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_id != null and item.ass_id != ''">
			ass_id = #{item.ass_id}
			,
			</if>
			<if test="item.ass_no != null and item.ass_no != ''">
			ass_no = #{item.ass_no}
			,
			</if>
			<if test="item.gb_code != null and item.gb_code != ''">
			gb_code = #{item.gb_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_amount != null and item.ass_amount != ''">
			ass_amount = #{item.ass_amount}
			,
			</if>
			<if test="item.price != null and item.price != ''">
			price = #{item.price}
			,
			</if>
			<if test="item.depre_money != null and item.depre_money != ''">
			depre_money = #{item.depre_money}
			,
			</if>
			<if test="item.manage_depre_money != null and item.manage_depre_money != ''">
			manage_depre_money = #{item.manage_depre_money}
			,
			</if>
			<if test="item.cur_money != null and item.cur_money != ''">
			cur_money = #{item.cur_money}
			,
			</if>
			<if test="item.fore_money != null and item.fore_money != ''">
			fore_money = #{item.fore_money}
			,
			</if>
			<if test="item.buy_type != null and item.buy_type != ''">
			buy_type = #{item.buy_type,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.unit_code != null and item.unit_code != ''">
			unit_code = #{item.unit_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.use_state != null and item.use_state != ''">
			use_state = #{item.use_state}
			,
			</if>
			<if test="item.is_depr != null and item.is_depr != ''">
			is_depr = #{item.is_depr}
			,
			</if>
			<if test="item.depr_method != null and item.depr_method != ''">
			depr_method = #{item.depr_method,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.acc_depre_amount != null and item.acc_depre_amount != ''">
			acc_depre_amount = #{item.acc_depre_amount}
			,
			</if>
			<if test="item.is_manage_depre != null and item.is_manage_depre != ''">
			is_manage_depre = #{item.is_manage_depre}
			,
			</if>
			<if test="item.manage_depr_method != null and item.manage_depr_method != ''">
			manage_depr_method = #{item.manage_depr_method,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.manage_depre_amount != null and item.manage_depre_amount != ''">
			manage_depre_amount = #{item.manage_depre_amount}
			,
			</if>
			<if test="item.ven_id != null and item.ven_id != ''">
			ven_id = #{item.ven_id}
			,
			</if>
			<if test="item.ven_no != null and item.ven_no != ''">
			ven_no = #{item.ven_no}
			,
			</if>
			<if test="item.pact_code != null and item.pact_code != ''">
			pact_code = #{item.pact_code}
			,
			</if>
			<if test="item.land_area != null and item.land_area != ''">
			land_area = #{item.land_area}
			,
			</if>
			<if test="item.cert_name != null and item.cert_name != ''">
			cert_name = #{item.cert_name,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.cert_code != null and item.cert_code != ''">
			cert_code = #{item.cert_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.cert_date != null and item.cert_date != ''">
			cert_date = #{item.cert_date,jdbcType=DATE}
			,
			</if>
			<if test="item.prop_code != null and item.prop_code != ''">
			prop_code = #{item.prop_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.land_no != null and item.land_no != ''">
			land_no = #{item.land_no,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.gain_date != null and item.gain_date != ''">
			gain_date = #{item.gain_date,jdbcType=DATE}
			,
			</if>
			<if test="item.run_date != null and item.run_date != ''">
			run_date = #{item.run_date,jdbcType=DATE}
			,
			</if>
			<if test="item.location != null and item.location != ''">
			location = #{item.location,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.dept_id != null and item.dept_id != ''">
			dept_id = #{item.dept_id}
			,
			</if>
			<if test="item.dept_no != null and item.dept_no != ''">
			dept_no = #{item.dept_no}
			,
			</if>
			<if test="item.land_source_code != null and item.land_source_code != ''">
			land_source_code = #{item.land_source_code,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.note != null and item.note != ''">
			note = #{item.note,jdbcType=VARCHAR}
			,
			</if>
			<if test="item.ass_in_no != null and item.ass_in_no != ''">
			ass_in_no = #{item.ass_in_no}
			,
			</if>
			<if test="item.in_date != null and item.in_date != ''">
			in_date = #{item.in_date,jdbcType=DATE}
			,
			</if>
			<if test="item.proc_store_id != null and item.proc_store_id != ''">
			proc_store_id = to_number(#{item.proc_store_id})
			,
			</if>
			<if test="item.proc_store_no != null and item.proc_store_no != ''">
			proc_store_no = to_number(#{item.proc_store_no})
			,
			</if>
			</trim>
			<where>                     
			<if test="item.group_id != null and item.group_id != ''">
			AND group_id = #{item.group_id}
			</if>  
			<if test="item.hos_id != null and item.hos_id != ''">
			AND hos_id = #{item.hos_id}
			</if>  
			<if test="item.copy_code != null and item.copy_code != ''">
			AND copy_code = #{item.copy_code,jdbcType=VARCHAR}
			</if>  
			<if test="item.ass_card_no != null and item.ass_card_no != ''">
			AND ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
			</if>  
			</where>  			
		</foreach>
	</update>
	
	<delete id="delete" parameterType="java.util.Map">
	
		begin
			<if test="is_del_rel == 1">
			delete from ASS_ACCESSORY_INIT_LAND where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_RESOURCE_INIT_LAND where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_SHARE_DEPT_INIT_LAND where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_FILE_INIT_LAND where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_PHOTO_INIT_LAND where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_PAY_STAGE_INIT_LAND where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_DEPRE_ACC_INIT_LAND where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			delete from ASS_DEPRE_MANAGE_INIT_LAND where group_id = #{group_id} and hos_id = #{hos_id} and copy_code = #{copy_code};
			</if>
			
			DELETE FROM ASS_CARD_INIT_LAND 
			<where>                     
			AND group_id = #{group_id}
			AND hos_id = #{hos_id}
			AND copy_code = #{copy_code,jdbcType=VARCHAR}
			<if test="ass_card_no != null and ass_card_no != ''">
			AND ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
			</if>
			</where>
			;
		end;  
	</delete>
	<delete id="deleteBatch" parameterType="java.util.List">
		DELETE FROM ASS_CARD_INIT_LAND 
		<where>
			<foreach collection="list" index="index" item="item" open="(" separator="or" close=")">
				group_id = #{item.group_id}
				AND hos_id = #{item.hos_id}
				AND copy_code = #{item.copy_code,jdbcType=VARCHAR}
				AND ass_card_no = #{item.ass_card_no,jdbcType=VARCHAR}
			</foreach>
	    </where>  
	</delete>
	<select id="query" parameterType="java.util.Map" resultMap="assCardInitLand" >
		select * from (
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.add_depre_month,
			a.add_manage_month,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name  
		FROM ASS_CARD_INIT_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
		
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		<if test="ass_card_no != null and ass_card_no != ''">
		AND (
				upper(a.ass_card_no) like upper('%${ass_card_no}%')
				or ad.ass_name like '%${ass_card_no}%'
				or ad.spell_code like '%${ass_card_no}%'
			)
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = to_number(#{ass_id})
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = to_number(#{ass_no})
		</if>
		<if test="ass_type_id != null and ass_type_id != ''">
		AND atd.ass_type_id = to_number(#{ass_type_id})
		</if>
		<if test="fina_type_code != null and fina_type_code != ''">
		AND atd.acc_type_code = #{fina_type_code}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code like '%${gb_code}%'
		</if>
		<if test="ass_amount != null and ass_amount != '' and ass_amount != 0">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != '' and price != '0' and price != 0">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = to_number(#{use_state})
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = to_number(#{ven_id})
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = to_number(#{ven_no})
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="in_date_beg != null and in_date_beg != ''">
		AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
		</if>
		<if test="in_date_end != null and in_date_end != ''">
		AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
		</if>
		<if test="run_date_beg != null and run_date_beg != '' ">
		AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
		</if>
		<if test="run_date_end != null and run_date_end != ''">
		AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
		</if>
		<if test="location != null and location != ''">
		AND a.location like '%${location}%'
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = to_number(#{dept_id})
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note like '%${note}%'
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		AND a.proc_store_id = to_number(#{proc_store_id})
		</if>
		</where>   
		union all
		
		SELECT 
			null group_id,
			null hos_id,
			null copy_code,
			'合计' ass_card_no,
			null ass_ori_card_no,
			null ass_id,
			null ass_no,
			null ass_id_code,
		    null ass_id_name,
			null gb_code,
			null gb_code_name,
			null ass_amount,
			sum(a.price) price,
			sum(a.depre_money) depre_money,
			sum(a.manage_depre_money) manage_depre_money,
			sum(a.cur_money) cur_money,
			sum(a.fore_money) fore_money,
			null buy_type,
			null buy_type_name,
			null unit_code,
			null unit_code_name,
			null use_state,
			null use_state_name,
			null is_depr,
			null is_depr_name,
			null depr_method,
			null depr_method_name,
			null acc_depre_amount,
			null is_manage_depre,
			null is_manage_depre_name,
			null manage_depr_method,
			null manage_depr_method_name,
			null manage_depre_amount,
			null ven_id,
			null ven_no,
			null ven_id_code,
		    null ven_id_name,
			null pact_code,
			null land_area,
			null cert_name,
			null cert_code,
			null cert_date,
			null prop_code,
			null prop_code_name,
			null land_no,
			null gain_date,
			null run_date,
			null location,
			null dept_id,
			null dept_no,
			null dept_id_code,
		    null dept_id_name,
			null land_source_code,
			null land_source_code_name,
			null note,
			null ass_in_no,
			null in_date,
			null add_depre_month,
			null add_manage_month,
			  null proc_store_id,
			  null proc_store_no,
			  null proc_store_id_code,
		      null proc_store_id_name  
		FROM ASS_CARD_INIT_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
		
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		<if test="ass_card_no != null and ass_card_no != ''">
		AND (
				upper(a.ass_card_no) like upper('%${ass_card_no}%')
				or ad.ass_name like '%${ass_card_no}%'
				or ad.spell_code like '%${ass_card_no}%'
			)
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = to_number(#{ass_id})
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = to_number(#{ass_no})
		</if>
		<if test="ass_type_id != null and ass_type_id != ''">
		AND atd.ass_type_id = to_number(#{ass_type_id})
		</if>
		<if test="fina_type_code != null and fina_type_code != ''">
		AND atd.acc_type_code = #{fina_type_code}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code like '%${gb_code}%'
		</if>
		<if test="ass_amount != null and ass_amount != '' and ass_amount != 0">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != '' and price != '0' and price != 0">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = to_number(#{use_state})
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = to_number(#{ven_id})
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = to_number(#{ven_no})
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="in_date_beg != null and in_date_beg != ''">
		AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
		</if>
		<if test="in_date_end != null and in_date_end != ''">
		AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
		</if>
		<if test="run_date_beg != null and run_date_beg != '' ">
		AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
		</if>
		<if test="run_date_end != null and run_date_end != ''">
		AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
		</if>
		<if test="location != null and location != ''">
		AND a.location like '%${location}%'
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = to_number(#{dept_id})
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note like '%${note}%'
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		AND a.proc_store_id = to_number(#{proc_store_id})
		</if>
		</where> ) t
		order by t.ass_card_no desc
	</select>
	<select id="queryPrint" parameterType="java.util.Map" resultMap="assCardInitLandMap" >
		select * from (
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.add_depre_month,
			a.add_manage_month,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name  
		FROM ASS_CARD_INIT_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
		
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		<if test="ass_card_no != null and ass_card_no != ''">
		AND (
				upper(a.ass_card_no) like upper('%${ass_card_no}%')
				or ad.ass_name like '%${ass_card_no}%'
				or ad.spell_code like '%${ass_card_no}%'
			)
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = to_number(#{ass_id})
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = to_number(#{ass_no})
		</if>
		<if test="ass_type_id != null and ass_type_id != ''">
		AND atd.ass_type_id = to_number(#{ass_type_id})
		</if>
		<if test="fina_type_code != null and fina_type_code != ''">
		AND atd.acc_type_code = #{fina_type_code}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code like '%${gb_code}%'
		</if>
		<if test="ass_amount != null and ass_amount != '' and ass_amount != 0">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != '' and price != '0' and price != 0">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = to_number(#{use_state})
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = to_number(#{ven_id})
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = to_number(#{ven_no})
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="in_date_beg != null and in_date_beg != ''">
		AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
		</if>
		<if test="in_date_end != null and in_date_end != ''">
		AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
		</if>
		<if test="run_date_beg != null and run_date_beg != '' ">
		AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
		</if>
		<if test="run_date_end != null and run_date_end != ''">
		AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
		</if>
		<if test="location != null and location != ''">
		AND a.location like '%${location}%'
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = to_number(#{dept_id})
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note like '%${note}%'
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		AND a.proc_store_id = to_number(#{proc_store_id})
		</if>
		</where>   
		union all
		
		SELECT 
			null group_id,
			null hos_id,
			null copy_code,
			'合计' ass_card_no,
			null ass_ori_card_no,
			null ass_id,
			null ass_no,
			null ass_id_code,
		    null ass_id_name,
			null gb_code,
			null gb_code_name,
			null ass_amount,
			sum(a.price) price,
			sum(a.depre_money) depre_money,
			sum(a.manage_depre_money) manage_depre_money,
			sum(a.cur_money) cur_money,
			sum(a.fore_money) fore_money,
			null buy_type,
			null buy_type_name,
			null unit_code,
			null unit_code_name,
			null use_state,
			null use_state_name,
			null is_depr,
			null is_depr_name,
			null depr_method,
			null depr_method_name,
			null acc_depre_amount,
			null is_manage_depre,
			null is_manage_depre_name,
			null manage_depr_method,
			null manage_depr_method_name,
			null manage_depre_amount,
			null ven_id,
			null ven_no,
			null ven_id_code,
		    null ven_id_name,
			null pact_code,
			null land_area,
			null cert_name,
			null cert_code,
			null cert_date,
			null prop_code,
			null prop_code_name,
			null land_no,
			null gain_date,
			null run_date,
			null location,
			null dept_id,
			null dept_no,
			null dept_id_code,
		    null dept_id_name,
			null land_source_code,
			null land_source_code_name,
			null note,
			null ass_in_no,
			null in_date,
			null add_depre_month,
			null add_manage_month,
			  null proc_store_id,
			  null proc_store_no,
			  null proc_store_id_code,
		      null proc_store_id_name  
		FROM ASS_CARD_INIT_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join ass_type_dict atd on
	    ad.group_id = atd.group_id
	    and ad.hos_id = atd.hos_id
	    and ad.copy_code = atd.copy_code
	    and ad.ass_type_id = atd.ass_type_id
	    and atd.is_stop = 0  
		
		<where>                     
		AND a.group_id = #{group_id}
		AND a.hos_id = #{hos_id}
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		<if test="ass_card_no != null and ass_card_no != ''">
		AND (
				upper(a.ass_card_no) like upper('%${ass_card_no}%')
				or ad.ass_name like '%${ass_card_no}%'
				or ad.spell_code like '%${ass_card_no}%'
			)
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND (a.ass_ori_card_no like upper('%${ass_ori_card_no}%') or a.ass_ori_card_no like lower('%${ass_ori_card_no}%'))
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = to_number(#{ass_id})
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = to_number(#{ass_no})
		</if>
		<if test="ass_type_id != null and ass_type_id != ''">
		AND atd.ass_type_id = to_number(#{ass_type_id})
		</if>
		<if test="fina_type_code != null and fina_type_code != ''">
		AND atd.acc_type_code = #{fina_type_code}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code like '%${gb_code}%'
		</if>
		<if test="ass_amount != null and ass_amount != '' and ass_amount != 0">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != '' and price != '0' and price != 0">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = to_number(#{use_state})
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = to_number(#{ven_id})
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = to_number(#{ven_no})
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="in_date_beg != null and in_date_beg != ''">
		AND a.in_date &gt;= to_date(#{in_date_beg},'YYYY-MM-DD')
		</if>
		<if test="in_date_end != null and in_date_end != ''">
		AND a.in_date &lt;= to_date(#{in_date_end},'YYYY-MM-DD')
		</if>
		<if test="run_date_beg != null and run_date_beg != '' ">
		AND a.run_date &gt;= to_date(#{run_date_beg},'YYYY-MM-DD')
		</if>
		<if test="run_date_end != null and run_date_end != ''">
		AND a.run_date &lt;= to_date(#{run_date_end},'YYYY-MM-DD')
		</if>
		<if test="location != null and location != ''">
		AND a.location like '%${location}%'
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = to_number(#{dept_id})
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note like '%${note}%'
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		<if test="proc_store_id != null and proc_store_id != ''">
		AND a.proc_store_id = to_number(#{proc_store_id})
		</if>
		</where> ) t
		order by t.ass_card_no desc
	</select>
	<select id="queryByCode" resultMap="assCardInitLand"  parameterType="java.util.Map" >
	
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code || ' ' ||agc.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.add_depre_month,
			a.add_manage_month,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name   
		FROM ASS_CARD_INIT_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    left  join ass_gb_dict agc
			on
				a.gb_code = agc.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0		
				
		WHERE 
		a.group_id = #{group_id}   and 
		a.hos_id = #{hos_id}   and 
		a.copy_code = #{copy_code,jdbcType=VARCHAR}   and 
		a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR} 
	
	</select>
	<select id="queryByUniqueness" resultMap="assCardInitLand"  parameterType="java.util.Map" >
	
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name
		FROM ASS_CARD_INIT_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND a.group_id = #{group_id}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND a.hos_id = #{hos_id}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND a.ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = #{ass_id}
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = #{ass_no}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code = #{gb_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != ''">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = #{use_state}
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = #{ven_id}
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = #{ven_no}
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="location != null and location != ''">
		AND a.location = #{location,jdbcType=VARCHAR}
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = #{dept_id}
		</if>
		<if test="dept_no != null and dept_no != ''">
		AND a.dept_no = #{dept_no}
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note = #{note,jdbcType=VARCHAR}
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		</where>   
		order by a.ass_card_no asc
	</select>
	<select id="queryExists" resultMap="assCardInitLand"  parameterType="java.util.Map" >
	
		SELECT 
			a.group_id,
			a.hos_id,
			a.copy_code,
			a.ass_card_no,
			a.ass_ori_card_no,
			a.ass_id,
			a.ass_no,
			ad.ass_code ass_id_code,
		    ad.ass_name ass_id_name,
			a.gb_code,
			a.gb_code||' '||agd.gb_name gb_code_name,
			a.ass_amount,
			a.price,
			a.depre_money,
			a.manage_depre_money,
			a.cur_money,
			a.fore_money,
			a.buy_type,
			abtd.bus_type_name buy_type_name,
			a.unit_code,
			hu.unit_name unit_code_name,
			a.use_state,
			acus.state_name use_state_name,
			a.is_depr,
			case when a.is_depr = 0  then '否' when a.is_depr = 1  then '是' else '' end is_depr_name,
			a.depr_method,
			admd1.ass_depre_name depr_method_name,
			a.acc_depre_amount,
			a.is_manage_depre,
			case when a.is_manage_depre = 0 then '否' when a.is_manage_depre = 1 then '是' else '' end is_manage_depre_name,
			a.manage_depr_method,
			admd2.ass_depre_name manage_depr_method_name,
			a.manage_depre_amount,
			a.ven_id,
			a.ven_no,
			hsd.sup_code ven_id_code,
		    hsd.sup_name ven_id_name,
			a.pact_code,
			a.land_area,
			a.cert_name,
			a.cert_code,
			a.cert_date,
			a.prop_code,
			apd.prop_name prop_code_name,
			a.land_no,
			a.gain_date,
			a.run_date,
			a.location,
			a.dept_id,
			a.dept_no,
			hdd.dept_code dept_id_code,
		    hdd.dept_name dept_id_name,
			a.land_source_code,
			asd.land_source_name land_source_code_name,
			a.note,
			a.ass_in_no,
			a.in_date,
			a.proc_store_id,
			a.proc_store_no,
			htd_proc.store_code proc_store_id_code,
		    htd_proc.store_name proc_store_id_name
		FROM ASS_CARD_INIT_LAND a
		
		left join ass_no_dict ad on
	    a.group_id = ad.group_id
	    and a.hos_id = ad.hos_id
	    and a.copy_code = ad.copy_code
	    and a.ass_id = ad.ass_id
	    and ad.is_stop = 0  
	    
	    left join hos_unit hu on
	    a.group_id = hu.group_id
	    and a.hos_id = hu.hos_id
	    and a.unit_code = hu.unit_code  
	    
	    left join hos_sup_dict hsd on
	    a.group_id = hsd.group_id
	    and a.hos_id = hsd.hos_id
	    and a.ven_id = hsd.sup_id
	    and hsd.is_stop = 0  
	    
	    left join hos_dept_dict hdd on
	    a.group_id = hdd.group_id
	    and a.hos_id = hdd.hos_id
	    and a.dept_id = hdd.dept_id
	    and hdd.is_stop = 0  
	    
	    left join ass_bus_type_dict abtd on
	    a.group_id = abtd.group_id
	    and a.hos_id = abtd.hos_id
	    and a.copy_code = abtd.copy_code
	    and a.buy_type = abtd.bus_type_code
	    and abtd.is_stop = 0  
	    
	    left join ass_card_use_state acus on
	    a.use_state = acus.state_code
	    and acus.is_stop = 0
	    
	    left join ass_depre_method_dict admd1 on
	    a.depr_method = admd1.ass_depre_code
	    and admd1.is_stop = 0
	    
	    left join ass_depre_method_dict admd2 on
	    a.manage_depr_method = admd2.ass_depre_code
	    and admd2.is_stop = 0
	    
		
		left join ass_land_source_dict asd on
		a.group_id = asd.group_id
	    and a.hos_id = asd.hos_id
	    and a.copy_code = asd.copy_code
	    and a.land_source_code = asd.land_source_code
	    
	    left join ass_prop_dict apd on 
		a.group_id = apd.group_id
	    and a.hos_id = apd.hos_id
	    and a.copy_code = apd.copy_code
	    and a.prop_code = apd.prop_code
	    
	    left join ass_gb_dict agd on
	    a.gb_code = agd.gb_code
	    
	    left join hos_store_dict htd_proc on
	    a.group_id = htd_proc.group_id
	    and a.hos_id = htd_proc.hos_id
	    and a.proc_store_id = htd_proc.store_id
	    and htd_proc.is_stop = 0
	    
		<where>                     
		<if test="group_id != null and group_id != ''">
		AND a.group_id = #{group_id}
		</if>
		<if test="hos_id != null and hos_id != ''">
		AND a.hos_id = #{hos_id}
		</if>
		<if test="copy_code != null and copy_code != ''">
		AND a.copy_code = #{copy_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_card_no != null and ass_card_no != ''">
		AND a.ass_card_no = #{ass_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_ori_card_no != null and ass_ori_card_no != ''">
		AND a.ass_ori_card_no = #{ass_ori_card_no,jdbcType=VARCHAR}
		</if>
		<if test="ass_id != null and ass_id != ''">
		AND a.ass_id = #{ass_id}
		</if>
		<if test="ass_no != null and ass_no != ''">
		AND a.ass_no = #{ass_no}
		</if>
		<if test="gb_code != null and gb_code != ''">
		AND a.gb_code = #{gb_code,jdbcType=VARCHAR}
		</if>
		<if test="ass_amount != null and ass_amount != ''">
		AND a.ass_amount = #{ass_amount}
		</if>
		<if test="price != null and price != ''">
		AND a.price = #{price}
		</if>
		<if test="depre_money != null and depre_money != ''">
		AND a.depre_money = #{depre_money}
		</if>
		<if test="manage_depre_money != null and manage_depre_money != ''">
		AND a.manage_depre_money = #{manage_depre_money}
		</if>
		<if test="cur_money != null and cur_money != ''">
		AND a.cur_money = #{cur_money}
		</if>
		<if test="fore_money != null and fore_money != ''">
		AND a.fore_money = #{fore_money}
		</if>
		<if test="buy_type != null and buy_type != ''">
		AND a.buy_type = #{buy_type,jdbcType=VARCHAR}
		</if>
		<if test="unit_code != null and unit_code != ''">
		AND a.unit_code = #{unit_code,jdbcType=VARCHAR}
		</if>
		<if test="use_state != null and use_state != ''">
		AND a.use_state = #{use_state}
		</if>
		<if test="is_depr != null and is_depr != ''">
		AND a.is_depr = #{is_depr}
		</if>
		<if test="depr_method != null and depr_method != ''">
		AND a.depr_method = #{depr_method,jdbcType=VARCHAR}
		</if>
		<if test="acc_depre_amount != null and acc_depre_amount != ''">
		AND a.acc_depre_amount = #{acc_depre_amount}
		</if>
		<if test="is_manage_depre != null and is_manage_depre != ''">
		AND a.is_manage_depre = #{is_manage_depre}
		</if>
		<if test="manage_depr_method != null and manage_depr_method != ''">
		AND a.manage_depr_method = #{manage_depr_method,jdbcType=VARCHAR}
		</if>
		<if test="manage_depre_amount != null and manage_depre_amount != ''">
		AND a.manage_depre_amount = #{manage_depre_amount}
		</if>
		<if test="ven_id != null and ven_id != ''">
		AND a.ven_id = #{ven_id}
		</if>
		<if test="ven_no != null and ven_no != ''">
		AND a.ven_no = #{ven_no}
		</if>
		<if test="pact_code != null and pact_code != ''">
		AND a.pact_code = #{pact_code}
		</if>
		<if test="land_area != null and land_area != ''">
		AND a.land_area = #{land_area}
		</if>
		<if test="cert_name != null and cert_name != ''">
		AND a.cert_name = #{cert_name,jdbcType=VARCHAR}
		</if>
		<if test="cert_code != null and cert_code != ''">
		AND a.cert_code = #{cert_code,jdbcType=VARCHAR}
		</if>
		<if test="cert_date != null and cert_date != ''">
		AND a.cert_date = #{cert_date,jdbcType=DATE}
		</if>
		<if test="prop_code != null and prop_code != ''">
		AND a.prop_code = #{prop_code,jdbcType=VARCHAR}
		</if>
		<if test="land_no != null and land_no != ''">
		AND a.land_no = #{land_no,jdbcType=VARCHAR}
		</if>
		<if test="gain_date != null and gain_date != ''">
		AND a.gain_date = #{gain_date,jdbcType=DATE}
		</if>
		<if test="run_date != null and run_date != ''">
		AND a.run_date = #{run_date,jdbcType=DATE}
		</if>
		<if test="location != null and location != ''">
		AND a.location = #{location,jdbcType=VARCHAR}
		</if>
		<if test="dept_id != null and dept_id != ''">
		AND a.dept_id = #{dept_id}
		</if>
		<if test="dept_no != null and dept_no != ''">
		AND a.dept_no = #{dept_no}
		</if>
		<if test="land_source_code != null and land_source_code != ''">
		AND a.land_source_code = #{land_source_code,jdbcType=VARCHAR}
		</if>
		<if test="note != null and note != ''">
		AND a.note = #{note,jdbcType=VARCHAR}
		</if>
		<if test="ass_in_no != null and ass_in_no != ''">
		AND a.ass_in_no = #{ass_in_no}
		</if>
		<if test="in_date != null and in_date != ''">
		AND a.in_date = #{in_date,jdbcType=DATE}
		</if>
		</where>   
		order by a.ass_card_no asc
	</select>
	
	<select id="queryByAssOriCardNo" parameterType="java.util.Map" resultType="java.lang.Integer">
		SELECT count(0) 
		FROM ASS_CARD_INIT_LAND 
		WHERE 
			group_id = #{group_id}
			AND hos_id = #{hos_id}
			AND copy_code = #{copy_code}
			AND ass_ori_card_no = #{ass_ori_card_no}
	</select>
</mapper>

